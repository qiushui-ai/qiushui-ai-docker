const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bui4B3Xv.js","assets/index-JhwBvo6R.js","assets/index-C_oIiI4O.js","assets/index-BUdoD9QE.css","assets/index-CUusOuWT.js","assets/save-6smFJZBI.js","assets/index-DtgB0zWw.js","assets/index-CKlooDzy.js","assets/index-CC3zko4F.js","assets/index-_hTvFXNE.js","assets/index-CzcS3QBw.js","assets/index-JutOhxN4.js","assets/index-CW9RtvEm.js","assets/index-Da6hlfk-.js","assets/index-F1iwlRtn.js","assets/index-gizemT_p.js","assets/index-DnCbBP6K.js","assets/index-DviJ1OeI.js","assets/index-DX_gb89a.js","assets/index-CGJRVXLy.js","assets/index-bn0S1u2R.js","assets/index--m28_CRM.js","assets/index-ClLUp5br.js","assets/index-BGjr3wID.js","assets/dockerfile-BKs6k2Af.js","assets/simple-mode-GW_nhZxv.js","assets/factor-kuTfRLto.js","assets/nsis-LdVXkNf5.js","assets/pug-BmUsPMDj.js","assets/javascript-iSgyE4tI.js","assets/index-DFU_hC7c.js","assets/index-BlYPm64J.js"])))=>i.map(i=>d[i]);
var hx=n=>{throw TypeError(n)};var $y=(n,e,t)=>e.has(n)||hx("Cannot "+t);var V=(n,e,t)=>($y(n,e,"read from private field"),t?t.call(n):e.get(n)),be=(n,e,t)=>e.has(n)?hx("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),X=(n,e,t,r)=>($y(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),Pp=(n,e,t)=>($y(n,e,"access private method"),t);import{c as k3,a1 as Z,aq as Tg,ar as pl,as as Ki,at as Qn,au as dx,r as un,a as C3,av as S3,j as wt,I as gA,B as Eg,i as yA,X as bA,ap as wA,aw as x3,ax as _3,J as M3,ay as T3}from"./index-C_oIiI4O.js";import{f as px,a as E3,d as A3,e as pb,p as O3,z as L3,h as D3,u as mb,r as gb,v as Ka,S as mx,b as I3,o as vA,n as kA,g as N3,c as R3,i as P3,j as B3,k as H3,l as V3,m as F3,q as j3,s as $3,t as CA,w as z3,P as SA}from"./index-CUusOuWT.js";import{S as xA}from"./save-6smFJZBI.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ute=k3("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var _A=typeof global=="object"&&global&&global.Object===Object&&global,W3=typeof self=="object"&&self&&self.Object===Object&&self,Ga=_A||W3||Function("return this")(),Ag=Ga.Symbol,MA=Object.prototype,q3=MA.hasOwnProperty,U3=MA.toString,ef=Ag?Ag.toStringTag:void 0;function K3(n){var e=q3.call(n,ef),t=n[ef];try{n[ef]=void 0;var r=!0}catch{}var i=U3.call(n);return r&&(e?n[ef]=t:delete n[ef]),i}var G3=Object.prototype,J3=G3.toString;function Z3(n){return J3.call(n)}var Y3="[object Null]",X3="[object Undefined]",gx=Ag?Ag.toStringTag:void 0;function Jd(n){return n==null?n===void 0?X3:Y3:gx&&gx in Object(n)?K3(n):Z3(n)}function Au(n){return n!=null&&typeof n=="object"}var Q3="[object Symbol]";function e4(n){return typeof n=="symbol"||Au(n)&&Jd(n)==Q3}var yb=Array.isArray,t4=/\s/;function n4(n){for(var e=n.length;e--&&t4.test(n.charAt(e)););return e}var r4=/^\s+/;function i4(n){return n&&n.slice(0,n4(n)+1).replace(r4,"")}function li(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var yx=NaN,s4=/^[-+]0x[0-9a-f]+$/i,o4=/^0b[01]+$/i,l4=/^0o[0-7]+$/i,a4=parseInt;function bx(n){if(typeof n=="number")return n;if(e4(n))return yx;if(li(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=li(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=i4(n);var t=o4.test(n);return t||l4.test(n)?a4(n.slice(2),t?2:8):s4.test(n)?yx:+n}function TA(n){return n}var c4="[object AsyncFunction]",u4="[object Function]",f4="[object GeneratorFunction]",h4="[object Proxy]";function Ev(n){if(!li(n))return!1;var e=Jd(n);return e==u4||e==f4||e==c4||e==h4}var zy=Ga["__core-js_shared__"],wx=function(){var n=/[^.]+$/.exec(zy&&zy.keys&&zy.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function d4(n){return!!wx&&wx in n}var p4=Function.prototype,m4=p4.toString;function g4(n){if(n!=null){try{return m4.call(n)}catch{}try{return n+""}catch{}}return""}var y4=/[\\^$.*+?()[\]{}|]/g,b4=/^\[object .+?Constructor\]$/,w4=Function.prototype,v4=Object.prototype,k4=w4.toString,C4=v4.hasOwnProperty,S4=RegExp("^"+k4.call(C4).replace(y4,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function x4(n){if(!li(n)||d4(n))return!1;var e=Ev(n)?S4:b4;return e.test(g4(n))}function _4(n,e){return n==null?void 0:n[e]}function Av(n,e){var t=_4(n,e);return x4(t)?t:void 0}var vx=Object.create,M4=function(){function n(){}return function(e){if(!li(e))return{};if(vx)return vx(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}();function EA(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}function T4(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}var E4=800,A4=16,O4=Date.now;function L4(n){var e=0,t=0;return function(){var r=O4(),i=A4-(r-t);if(t=r,i>0){if(++e>=E4)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}function D4(n){return function(){return n}}var Og=function(){try{var n=Av(Object,"defineProperty");return n({},"",{}),n}catch{}}(),I4=Og?function(n,e){return Og(n,"toString",{configurable:!0,enumerable:!1,value:D4(e),writable:!0})}:TA,N4=L4(I4),R4=9007199254740991,P4=/^(?:0|[1-9]\d*)$/;function AA(n,e){var t=typeof n;return e=e??R4,!!e&&(t=="number"||t!="symbol"&&P4.test(n))&&n>-1&&n%1==0&&n<e}function Ov(n,e,t){e=="__proto__"&&Og?Og(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}function _0(n,e){return n===e||n!==n&&e!==e}var B4=Object.prototype,H4=B4.hasOwnProperty;function V4(n,e,t){var r=n[e];(!(H4.call(n,e)&&_0(r,t))||t===void 0&&!(e in n))&&Ov(n,e,t)}function F4(n,e,t,r){var i=!t;t||(t={});for(var s=-1,o=e.length;++s<o;){var l=e[s],a=void 0;a===void 0&&(a=n[l]),i?Ov(t,l,a):V4(t,l,a)}return t}var kx=Math.max;function j4(n,e,t){return e=kx(e===void 0?n.length-1:e,0),function(){for(var r=arguments,i=-1,s=kx(r.length-e,0),o=Array(s);++i<s;)o[i]=r[e+i];i=-1;for(var l=Array(e+1);++i<e;)l[i]=r[i];return l[e]=t(o),EA(n,this,l)}}function OA(n,e){return N4(j4(n,e,TA),n+"")}var $4=9007199254740991;function LA(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=$4}function Lv(n){return n!=null&&LA(n.length)&&!Ev(n)}function z4(n,e,t){if(!li(t))return!1;var r=typeof e;return(r=="number"?Lv(t)&&AA(e,t.length):r=="string"&&e in t)?_0(t[e],n):!1}function W4(n){return OA(function(e,t){var r=-1,i=t.length,s=i>1?t[i-1]:void 0,o=i>2?t[2]:void 0;for(s=n.length>3&&typeof s=="function"?(i--,s):void 0,o&&z4(t[0],t[1],o)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var l=t[r];l&&n(e,l,r,s)}return e})}var q4=Object.prototype;function DA(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||q4;return n===t}function U4(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var K4="[object Arguments]";function Cx(n){return Au(n)&&Jd(n)==K4}var IA=Object.prototype,G4=IA.hasOwnProperty,J4=IA.propertyIsEnumerable,bb=Cx(function(){return arguments}())?Cx:function(n){return Au(n)&&G4.call(n,"callee")&&!J4.call(n,"callee")};function Z4(){return!1}var NA=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Sx=NA&&typeof module=="object"&&module&&!module.nodeType&&module,Y4=Sx&&Sx.exports===NA,xx=Y4?Ga.Buffer:void 0,X4=xx?xx.isBuffer:void 0,RA=X4||Z4,Q4="[object Arguments]",e9="[object Array]",t9="[object Boolean]",n9="[object Date]",r9="[object Error]",i9="[object Function]",s9="[object Map]",o9="[object Number]",l9="[object Object]",a9="[object RegExp]",c9="[object Set]",u9="[object String]",f9="[object WeakMap]",h9="[object ArrayBuffer]",d9="[object DataView]",p9="[object Float32Array]",m9="[object Float64Array]",g9="[object Int8Array]",y9="[object Int16Array]",b9="[object Int32Array]",w9="[object Uint8Array]",v9="[object Uint8ClampedArray]",k9="[object Uint16Array]",C9="[object Uint32Array]",Xt={};Xt[p9]=Xt[m9]=Xt[g9]=Xt[y9]=Xt[b9]=Xt[w9]=Xt[v9]=Xt[k9]=Xt[C9]=!0;Xt[Q4]=Xt[e9]=Xt[h9]=Xt[t9]=Xt[d9]=Xt[n9]=Xt[r9]=Xt[i9]=Xt[s9]=Xt[o9]=Xt[l9]=Xt[a9]=Xt[c9]=Xt[u9]=Xt[f9]=!1;function S9(n){return Au(n)&&LA(n.length)&&!!Xt[Jd(n)]}function x9(n){return function(e){return n(e)}}var PA=typeof exports=="object"&&exports&&!exports.nodeType&&exports,rh=PA&&typeof module=="object"&&module&&!module.nodeType&&module,_9=rh&&rh.exports===PA,Wy=_9&&_A.process,_x=function(){try{var n=rh&&rh.require&&rh.require("util").types;return n||Wy&&Wy.binding&&Wy.binding("util")}catch{}}(),Mx=_x&&_x.isTypedArray,BA=Mx?x9(Mx):S9;function M9(n,e){var t=yb(n),r=!t&&bb(n),i=!t&&!r&&RA(n),s=!t&&!r&&!i&&BA(n),o=t||r||i||s,l=o?U4(n.length,String):[],a=l.length;for(var c in n)o&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||AA(c,a))||l.push(c);return l}function T9(n,e){return function(t){return n(e(t))}}function E9(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var A9=Object.prototype,O9=A9.hasOwnProperty;function L9(n){if(!li(n))return E9(n);var e=DA(n),t=[];for(var r in n)r=="constructor"&&(e||!O9.call(n,r))||t.push(r);return t}function HA(n){return Lv(n)?M9(n):L9(n)}var Ph=Av(Object,"create");function D9(){this.__data__=Ph?Ph(null):{},this.size=0}function I9(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var N9="__lodash_hash_undefined__",R9=Object.prototype,P9=R9.hasOwnProperty;function B9(n){var e=this.__data__;if(Ph){var t=e[n];return t===N9?void 0:t}return P9.call(e,n)?e[n]:void 0}var H9=Object.prototype,V9=H9.hasOwnProperty;function F9(n){var e=this.__data__;return Ph?e[n]!==void 0:V9.call(e,n)}var j9="__lodash_hash_undefined__";function $9(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=Ph&&e===void 0?j9:e,this}function Ia(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Ia.prototype.clear=D9;Ia.prototype.delete=I9;Ia.prototype.get=B9;Ia.prototype.has=F9;Ia.prototype.set=$9;function z9(){this.__data__=[],this.size=0}function M0(n,e){for(var t=n.length;t--;)if(_0(n[t][0],e))return t;return-1}var W9=Array.prototype,q9=W9.splice;function U9(n){var e=this.__data__,t=M0(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():q9.call(e,t,1),--this.size,!0}function K9(n){var e=this.__data__,t=M0(e,n);return t<0?void 0:e[t][1]}function G9(n){return M0(this.__data__,n)>-1}function J9(n,e){var t=this.__data__,r=M0(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}function _o(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}_o.prototype.clear=z9;_o.prototype.delete=U9;_o.prototype.get=K9;_o.prototype.has=G9;_o.prototype.set=J9;var VA=Av(Ga,"Map");function Z9(){this.size=0,this.__data__={hash:new Ia,map:new(VA||_o),string:new Ia}}function Y9(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function T0(n,e){var t=n.__data__;return Y9(e)?t[typeof e=="string"?"string":"hash"]:t.map}function X9(n){var e=T0(this,n).delete(n);return this.size-=e?1:0,e}function Q9(n){return T0(this,n).get(n)}function e8(n){return T0(this,n).has(n)}function t8(n,e){var t=T0(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}function Ou(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Ou.prototype.clear=Z9;Ou.prototype.delete=X9;Ou.prototype.get=Q9;Ou.prototype.has=e8;Ou.prototype.set=t8;var FA=T9(Object.getPrototypeOf,Object),n8="[object Object]",r8=Function.prototype,i8=Object.prototype,jA=r8.toString,s8=i8.hasOwnProperty,o8=jA.call(Object);function l8(n){if(!Au(n)||Jd(n)!=n8)return!1;var e=FA(n);if(e===null)return!0;var t=s8.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&jA.call(t)==o8}function a8(){this.__data__=new _o,this.size=0}function c8(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function u8(n){return this.__data__.get(n)}function f8(n){return this.__data__.has(n)}var h8=200;function d8(n,e){var t=this.__data__;if(t instanceof _o){var r=t.__data__;if(!VA||r.length<h8-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new Ou(r)}return t.set(n,e),this.size=t.size,this}function Lu(n){var e=this.__data__=new _o(n);this.size=e.size}Lu.prototype.clear=a8;Lu.prototype.delete=c8;Lu.prototype.get=u8;Lu.prototype.has=f8;Lu.prototype.set=d8;var $A=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Tx=$A&&typeof module=="object"&&module&&!module.nodeType&&module,p8=Tx&&Tx.exports===$A,Ex=p8?Ga.Buffer:void 0;Ex&&Ex.allocUnsafe;function m8(n,e){return n.slice()}var Ax=Ga.Uint8Array;function g8(n){var e=new n.constructor(n.byteLength);return new Ax(e).set(new Ax(n)),e}function y8(n,e){var t=g8(n.buffer);return new n.constructor(t,n.byteOffset,n.length)}function b8(n){return typeof n.constructor=="function"&&!DA(n)?M4(FA(n)):{}}function w8(n){return function(e,t,r){for(var i=-1,s=Object(e),o=r(e),l=o.length;l--;){var a=o[++i];if(t(s[a],a,s)===!1)break}return e}}var v8=w8(),qy=function(){return Ga.Date.now()},k8="Expected a function",C8=Math.max,S8=Math.min;function E0(n,e,t){var r,i,s,o,l,a,c=0,u=!1,f=!1,p=!0;if(typeof n!="function")throw new TypeError(k8);e=bx(e)||0,li(t)&&(u=!!t.leading,f="maxWait"in t,s=f?C8(bx(t.maxWait)||0,e):s,p="trailing"in t?!!t.trailing:p);function g(A){var I=r,B=i;return r=i=void 0,c=A,o=n.apply(B,I),o}function y(A){return c=A,l=setTimeout(x,e),u?g(A):o}function v(A){var I=A-a,B=A-c,R=e-I;return f?S8(R,s-B):R}function k(A){var I=A-a,B=A-c;return a===void 0||I>=e||I<0||f&&B>=s}function x(){var A=qy();if(k(A))return _(A);l=setTimeout(x,v(A))}function _(A){return l=void 0,p&&r?g(A):(r=i=void 0,o)}function M(){l!==void 0&&clearTimeout(l),c=0,r=a=i=l=void 0}function T(){return l===void 0?o:_(qy())}function S(){var A=qy(),I=k(A);if(r=arguments,i=this,a=A,I){if(l===void 0)return y(a);if(f)return clearTimeout(l),l=setTimeout(x,e),g(a)}return l===void 0&&(l=setTimeout(x,e)),o}return S.cancel=M,S.flush=T,S}function wb(n,e,t){(t!==void 0&&!_0(n[e],t)||t===void 0&&!(e in n))&&Ov(n,e,t)}function x8(n){return Au(n)&&Lv(n)}function vb(n,e){if(!(e==="constructor"&&typeof n[e]=="function")&&e!="__proto__")return n[e]}function _8(n){return F4(n,HA(n))}function M8(n,e,t,r,i,s,o){var l=vb(n,t),a=vb(e,t),c=o.get(a);if(c){wb(n,t,c);return}var u=s?s(l,a,t+"",n,e,o):void 0,f=u===void 0;if(f){var p=yb(a),g=!p&&RA(a),y=!p&&!g&&BA(a);u=a,p||g||y?yb(l)?u=l:x8(l)?u=T4(l):g?(f=!1,u=m8(a)):y?(f=!1,u=y8(a)):u=[]:l8(a)||bb(a)?(u=l,bb(l)?u=_8(l):(!li(l)||Ev(l))&&(u=b8(a))):f=!1}f&&(o.set(a,u),i(u,a,r,s,o),o.delete(a)),wb(n,t,u)}function Dv(n,e,t,r,i){n!==e&&v8(e,function(s,o){if(i||(i=new Lu),li(s))M8(n,e,o,t,Dv,r,i);else{var l=r?r(vb(n,o),s,o+"",n,e,i):void 0;l===void 0&&(l=s),wb(n,o,l)}},HA)}function zA(n,e,t,r,i,s){return li(n)&&li(e)&&(s.set(e,n),Dv(n,e,void 0,zA,s),s.delete(e)),n}var T8=W4(function(n,e,t,r){Dv(n,e,t,r)}),E8=OA(function(n){return n.push(void 0,zA),EA(T8,void 0,n)}),A8="Expected a function";function A0(n,e,t){var r=!0,i=!0;if(typeof n!="function")throw new TypeError(A8);return li(t)&&(r="leading"in t?!!t.leading:r,i="trailing"in t?!!t.trailing:i),E0(n,e,{leading:r,maxWait:e,trailing:i})}const O8=1024;let L8=0,yi=class{constructor(e,t){this.from=e,this.to=t}};class pt{constructor(e={}){this.id=L8++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=ai.match(e)),t=>{let r=e(t);return r===void 0?null:[this,r]}}}pt.closedBy=new pt({deserialize:n=>n.split(" ")});pt.openedBy=new pt({deserialize:n=>n.split(" ")});pt.group=new pt({deserialize:n=>n.split(" ")});pt.isolate=new pt({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});pt.contextHash=new pt({perNode:!0});pt.lookAhead=new pt({perNode:!0});pt.mounted=new pt({perNode:!0});class Bh{constructor(e,t,r){this.tree=e,this.overlay=t,this.parser=r}static get(e){return e&&e.props&&e.props[pt.mounted.id]}}const D8=Object.create(null);let ai=class WA{constructor(e,t,r,i=0){this.name=e,this.props=t,this.id=r,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):D8,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new WA(e.name||"",t,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(pt.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let i of r.split(" "))t[i]=e[r];return r=>{for(let i=r.prop(pt.group),s=-1;s<(i?i.length:0);s++){let o=t[s<0?r.name:i[s]];if(o)return o}}}};ai.none=new ai("",Object.create(null),0,8);class Iv{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let i=null;for(let s of e){let o=s(r);if(o){i||(i=Object.assign({},r.props));let l=o[1],a=o[0];a.combine&&a.id in i&&(l=a.combine(i[a.id],l)),i[a.id]=l}}t.push(i?new ai(r.name,i,r.id,r.flags):r)}return new Iv(t)}}const Bp=new WeakMap,Ox=new WeakMap;var fn;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(fn||(fn={}));class Jt{constructor(e,t,r,i,s){if(this.type=e,this.children=t,this.positions=r,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=Bh.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let r of this.children){let i=r.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Lg(this.topNode,e)}cursorAt(e,t=0,r=0){let i=Bp.get(this)||this.topNode,s=new Lg(i);return s.moveTo(e,t),Bp.set(this,s._tree),s}get topNode(){return new ar(this,0,0,null)}resolve(e,t=0){let r=Hh(Bp.get(this)||this.topNode,e,t,!1);return Bp.set(this,r),r}resolveInner(e,t=0){let r=Hh(Ox.get(this)||this.topNode,e,t,!0);return Ox.set(this,r),r}resolveStack(e,t=0){return R8(this,e,t)}iterate(e){let{enter:t,leave:r,from:i=0,to:s=this.length}=e,o=e.mode||0,l=(o&fn.IncludeAnonymous)>0;for(let a=this.cursor(o|fn.IncludeAnonymous);;){let c=!1;if(a.from<=s&&a.to>=i&&(!l&&a.type.isAnonymous||t(a)!==!1)){if(a.firstChild())continue;c=!0}for(;c&&r&&(l||!a.type.isAnonymous)&&r(a),!a.nextSibling();){if(!a.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Pv(ai.none,this.children,this.positions,0,this.children.length,0,this.length,(t,r,i)=>new Jt(this.type,t,r,i,this.propValues),e.makeTree||((t,r,i)=>new Jt(ai.none,t,r,i)))}static build(e){return P8(e)}}Jt.empty=new Jt(ai.none,[],[],0);class Nv{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Nv(this.buffer,this.index)}}class ml{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return ai.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,r,i,s){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(qA(s,i,o[a+1],o[a+2])&&(l=a,r>0));a=o[a+3]);return l}slice(e,t,r){let i=this.buffer,s=new Uint16Array(t-e),o=0;for(let l=e,a=0;l<t;){s[a++]=i[l++],s[a++]=i[l++]-r;let c=s[a++]=i[l++]-r;s[a++]=i[l++]-e,o=Math.max(o,c)}return new ml(s,o,this.set)}}function qA(n,e,t,r){switch(n){case-2:return t<e;case-1:return r>=e&&t<e;case 0:return t<e&&r>e;case 1:return t<=e&&r>e;case 2:return r>e;case 4:return!0}}function Hh(n,e,t,r){for(var i;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!r&&n instanceof ar&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=r?0:fn.IgnoreOverlays;if(r)for(let o=n,l=o.parent;l;o=l,l=o.parent)o instanceof ar&&o.index<0&&((i=l.enter(e,t,s))===null||i===void 0?void 0:i.from)!=o.from&&(n=l);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class UA{cursor(e=0){return new Lg(this,e)}getChild(e,t=null,r=null){let i=Lx(this,e,t,r);return i.length?i[0]:null}getChildren(e,t=null,r=null){return Lx(this,e,t,r)}resolve(e,t=0){return Hh(this,e,t,!1)}resolveInner(e,t=0){return Hh(this,e,t,!0)}matchContext(e){return kb(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(r=t,t=i.prevSibling):t=i}return r}get node(){return this}get next(){return this.parent}}class ar extends UA{constructor(e,t,r,i){super(),this._tree=e,this.from=t,this.index=r,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,i,s=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,c=t>0?l.length:-1;e!=c;e+=t){let u=l[e],f=a[e]+o.from;if(qA(i,r,f,f+u.length)){if(u instanceof ml){if(s&fn.ExcludeBuffers)continue;let p=u.findChild(0,u.buffer.length,t,r-f,i);if(p>-1)return new ks(new I8(o,u,e,f),null,p)}else if(s&fn.IncludeAnonymous||!u.type.isAnonymous||Rv(u)){let p;if(!(s&fn.IgnoreMounts)&&(p=Bh.get(u))&&!p.overlay)return new ar(p.tree,f,e,o);let g=new ar(u,f,e,o);return s&fn.IncludeAnonymous||!g.type.isAnonymous?g:g.nextChild(t<0?u.children.length-1:0,t,r,i)}}}if(s&fn.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let i;if(!(r&fn.IgnoreOverlays)&&(i=Bh.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:o,to:l}of i.overlay)if((t>0?o<=s:o<s)&&(t<0?l>=s:l>s))return new ar(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Lx(n,e,t,r){let i=n.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=i.type.is(t),!i.nextSibling())return s}for(;;){if(r!=null&&i.type.is(r))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return r==null?s:[]}}function kb(n,e,t=e.length-1){for(let r=n;t>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[t]&&e[t]!=r.name)return!1;t--}}return!0}class I8{constructor(e,t,r,i){this.parent=e,this.buffer=t,this.index=r,this.start=i}}class ks extends UA{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,r);return s<0?null:new ks(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){if(r&fn.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new ks(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new ks(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new ks(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,i=this.index+4,s=r.buffer[this.index+3];if(s>i){let o=r.buffer[this.index+1];e.push(r.slice(i,s,o)),t.push(0)}return new Jt(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function KA(n){if(!n.length)return null;let e=0,t=n[0];for(let s=1;s<n.length;s++){let o=n[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let r=t instanceof ar&&t.index<0?null:t.parent,i=n.slice();return r?i[e]=r:i.splice(e,1),new N8(i,t)}class N8{constructor(e,t){this.heads=e,this.node=t}get next(){return KA(this.heads)}}function R8(n,e,t){let r=n.resolveInner(e,t),i=null;for(let s=r instanceof ar?r:r.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(i||(i=[r])).push(o.resolve(e,t)),s=o}else{let o=Bh.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let l=new ar(o.tree,o.overlay[0].from+s.from,-1,s);(i||(i=[r])).push(Hh(l,e,t,!1))}}return i?KA(i):r}class Lg{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof ar)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:r,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=r+i.buffer[e+1],this.to=r+i.buffer[e+2],!0}yield(e){return e?e instanceof ar?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?r&fn.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&fn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&fn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let i=r<0?0:this.stack[r]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(i)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:r}=i)}else({index:t,_parent:r}=this._tree);for(;r;{index:t,_parent:r}=r)if(t>-1)for(let s=t+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let l=r._tree.children[s];if(this.mode&fn.IncludeAnonymous||l instanceof ml||!l.type.isAnonymous||Rv(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==i){if(i==this.index)return o;t=o,r=s+1;break e}i=this.stack[--s]}for(let i=r;i<this.stack.length;i++)t=new ks(this.buffer,t,this.stack[i]);return this.bufferNode=new ks(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,i=!0}}}matchContext(e){if(!this.buffer)return kb(this.node.parent,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return kb(this._tree,e,i);let o=r[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[i]&&e[i]!=o.name)return!1;i--}}return!0}}function Rv(n){return n.children.some(e=>e instanceof ml||!e.type.isAnonymous||Rv(e))}function P8(n){var e;let{buffer:t,nodeSet:r,maxBufferLength:i=O8,reused:s=[],minRepeatType:o=r.types.length}=n,l=Array.isArray(t)?new Nv(t,t.length):t,a=r.types,c=0,u=0;function f(S,A,I,B,R,K){let{id:U,start:z,end:oe,size:ne}=l,ve=u,ke=c;if(ne<0)if(l.next(),ne==-1){let He=s[U];I.push(He),B.push(z-S);return}else if(ne==-3){c=U;return}else if(ne==-4){u=U;return}else throw new RangeError(`Unrecognized record size: ${ne}`);let Se=a[U],Te,Ge,Xe=z-S;if(oe-z<=i&&(Ge=k(l.pos-A,R))){let He=new Uint16Array(Ge.size-Ge.skip),j=l.pos-Ge.size,Ze=He.length;for(;l.pos>j;)Ze=x(Ge.start,He,Ze);Te=new ml(He,oe-Ge.start,r),Xe=Ge.start-S}else{let He=l.pos-ne;l.next();let j=[],Ze=[],sn=U>=o?U:-1,st=0,Nt=oe;for(;l.pos>He;)sn>=0&&l.id==sn&&l.size>=0?(l.end<=Nt-i&&(y(j,Ze,z,st,l.end,Nt,sn,ve,ke),st=j.length,Nt=l.end),l.next()):K>2500?p(z,He,j,Ze):f(z,He,j,Ze,sn,K+1);if(sn>=0&&st>0&&st<j.length&&y(j,Ze,z,st,z,Nt,sn,ve,ke),j.reverse(),Ze.reverse(),sn>-1&&st>0){let ie=g(Se,ke);Te=Pv(Se,j,Ze,0,j.length,0,oe-z,ie,ie)}else Te=v(Se,j,Ze,oe-z,ve-oe,ke)}I.push(Te),B.push(Xe)}function p(S,A,I,B){let R=[],K=0,U=-1;for(;l.pos>A;){let{id:z,start:oe,end:ne,size:ve}=l;if(ve>4)l.next();else{if(U>-1&&oe<U)break;U<0&&(U=ne-i),R.push(z,oe,ne),K++,l.next()}}if(K){let z=new Uint16Array(K*4),oe=R[R.length-2];for(let ne=R.length-3,ve=0;ne>=0;ne-=3)z[ve++]=R[ne],z[ve++]=R[ne+1]-oe,z[ve++]=R[ne+2]-oe,z[ve++]=ve;I.push(new ml(z,R[2]-oe,r)),B.push(oe-S)}}function g(S,A){return(I,B,R)=>{let K=0,U=I.length-1,z,oe;if(U>=0&&(z=I[U])instanceof Jt){if(!U&&z.type==S&&z.length==R)return z;(oe=z.prop(pt.lookAhead))&&(K=B[U]+z.length+oe)}return v(S,I,B,R,K,A)}}function y(S,A,I,B,R,K,U,z,oe){let ne=[],ve=[];for(;S.length>B;)ne.push(S.pop()),ve.push(A.pop()+I-R);S.push(v(r.types[U],ne,ve,K-R,z-K,oe)),A.push(R-I)}function v(S,A,I,B,R,K,U){if(K){let z=[pt.contextHash,K];U=U?[z].concat(U):[z]}if(R>25){let z=[pt.lookAhead,R];U=U?[z].concat(U):[z]}return new Jt(S,A,I,B,U)}function k(S,A){let I=l.fork(),B=0,R=0,K=0,U=I.end-i,z={size:0,start:0,skip:0};e:for(let oe=I.pos-S;I.pos>oe;){let ne=I.size;if(I.id==A&&ne>=0){z.size=B,z.start=R,z.skip=K,K+=4,B+=4,I.next();continue}let ve=I.pos-ne;if(ne<0||ve<oe||I.start<U)break;let ke=I.id>=o?4:0,Se=I.start;for(I.next();I.pos>ve;){if(I.size<0)if(I.size==-3)ke+=4;else break e;else I.id>=o&&(ke+=4);I.next()}R=Se,B+=ne,K+=ke}return(A<0||B==S)&&(z.size=B,z.start=R,z.skip=K),z.size>4?z:void 0}function x(S,A,I){let{id:B,start:R,end:K,size:U}=l;if(l.next(),U>=0&&B<o){let z=I;if(U>4){let oe=l.pos-(U-4);for(;l.pos>oe;)I=x(S,A,I)}A[--I]=z,A[--I]=K-S,A[--I]=R-S,A[--I]=B}else U==-3?c=B:U==-4&&(u=B);return I}let _=[],M=[];for(;l.pos>0;)f(n.start||0,n.bufferStart||0,_,M,-1,0);let T=(e=n.length)!==null&&e!==void 0?e:_.length?M[0]+_[0].length:0;return new Jt(a[n.topID],_.reverse(),M.reverse(),T)}const Dx=new WeakMap;function _m(n,e){if(!n.isAnonymous||e instanceof ml||e.type!=n)return 1;let t=Dx.get(e);if(t==null){t=1;for(let r of e.children){if(r.type!=n||!(r instanceof Jt)){t=1;break}t+=_m(n,r)}Dx.set(e,t)}return t}function Pv(n,e,t,r,i,s,o,l,a){let c=0;for(let y=r;y<i;y++)c+=_m(n,e[y]);let u=Math.ceil(c*1.5/8),f=[],p=[];function g(y,v,k,x,_){for(let M=k;M<x;){let T=M,S=v[M],A=_m(n,y[M]);for(M++;M<x;M++){let I=_m(n,y[M]);if(A+I>=u)break;A+=I}if(M==T+1){if(A>u){let I=y[T];g(I.children,I.positions,0,I.children.length,v[T]+_);continue}f.push(y[T])}else{let I=v[M-1]+y[M-1].length-S;f.push(Pv(n,y,v,T,M,S,I,null,a))}p.push(S+_-s)}}return g(e,t,r,i,0),(l||a)(f,p,o)}class Gte{constructor(){this.map=new WeakMap}setBuffer(e,t,r){let i=this.map.get(e);i||this.map.set(e,i=new Map),i.set(t,r)}getBuffer(e,t){let r=this.map.get(e);return r&&r.get(t)}set(e,t){e instanceof ks?this.setBuffer(e.context.buffer,e.index,t):e instanceof ar&&this.map.set(e.tree,t)}get(e){return e instanceof ks?this.getBuffer(e.context.buffer,e.index):e instanceof ar?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class mo{constructor(e,t,r,i,s=!1,o=!1){this.from=e,this.to=t,this.tree=r,this.offset=i,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],r=!1){let i=[new mo(0,e.length,e,0,!1,r)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,r=128){if(!t.length)return e;let i=[],s=1,o=e.length?e[0]:null;for(let l=0,a=0,c=0;;l++){let u=l<t.length?t[l]:null,f=u?u.fromA:1e9;if(f-a>=r)for(;o&&o.from<f;){let p=o;if(a>=p.from||f<=p.to||c){let g=Math.max(p.from,a)-c,y=Math.min(p.to,f)-c;p=g>=y?null:new mo(g,y,p.tree,p.offset+c,l>0,!!u)}if(p&&i.push(p),o.to>f)break;o=s<e.length?e[s++]:null}if(!u)break;a=u.toA,c=u.toA-u.toB}return i}}class GA{startParse(e,t,r){return typeof e=="string"&&(e=new B8(e)),r=r?r.length?r.map(i=>new yi(i.from,i.to)):[new yi(0,0)]:[new yi(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let i=this.startParse(e,t,r);for(;;){let s=i.advance();if(s)return s}}}class B8{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function Jte(n){return(e,t,r,i)=>new V8(e,n,t,r,i)}class Ix{constructor(e,t,r,i,s){this.parser=e,this.parse=t,this.overlay=r,this.target=i,this.from=s}}function Nx(n){if(!n.length||n.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(n))}class H8{constructor(e,t,r,i,s,o,l){this.parser=e,this.predicate=t,this.mounts=r,this.index=i,this.start=s,this.target=o,this.prev=l,this.depth=0,this.ranges=[]}}const Cb=new pt({perNode:!0});class V8{constructor(e,t,r,i,s){this.nest=t,this.input=r,this.fragments=i,this.ranges=s,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let r=this.baseParse.advance();if(!r)return null;if(this.baseParse=null,this.baseTree=r,this.startInner(),this.stoppedAt!=null)for(let i of this.inner)i.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let r=this.baseTree;return this.stoppedAt!=null&&(r=new Jt(r.type,r.children,r.positions,r.length,r.propValues.concat([[Cb,this.stoppedAt]]))),r}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let r=Object.assign(Object.create(null),e.target.props);r[pt.mounted.id]=new Bh(t,e.overlay,e.parser),e.target.props=r}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new $8(this.fragments),t=null,r=null,i=new Lg(new ar(this.baseTree,this.ranges[0].from,0,null),fn.IncludeAnonymous|fn.IgnoreMounts);e:for(let s,o;;){let l=!0,a;if(this.stoppedAt!=null&&i.from>=this.stoppedAt)l=!1;else if(e.hasNode(i)){if(t){let c=t.mounts.find(u=>u.frag.from<=i.from&&u.frag.to>=i.to&&u.mount.overlay);if(c)for(let u of c.mount.overlay){let f=u.from+c.pos,p=u.to+c.pos;f>=i.from&&p<=i.to&&!t.ranges.some(g=>g.from<p&&g.to>f)&&t.ranges.push({from:f,to:p})}}l=!1}else if(r&&(o=F8(r.ranges,i.from,i.to)))l=o!=2;else if(!i.type.isAnonymous&&(s=this.nest(i,this.input))&&(i.from<i.to||!s.overlay)){i.tree||(j8(i),t&&t.depth++,r&&r.depth++);let c=e.findMounts(i.from,s.parser);if(typeof s.overlay=="function")t=new H8(s.parser,s.overlay,c,this.inner.length,i.from,i.tree,t);else{let u=Bx(this.ranges,s.overlay||(i.from<i.to?[new yi(i.from,i.to)]:[]));u.length&&Nx(u),(u.length||!s.overlay)&&this.inner.push(new Ix(s.parser,u.length?s.parser.startParse(this.input,Hx(c,u),u):s.parser.startParse(""),s.overlay?s.overlay.map(f=>new yi(f.from-i.from,f.to-i.from)):null,i.tree,u.length?u[0].from:i.from)),s.overlay?u.length&&(r={ranges:u,depth:0,prev:r}):l=!1}}else if(t&&(a=t.predicate(i))&&(a===!0&&(a=new yi(i.from,i.to)),a.from<a.to)){let c=t.ranges.length-1;c>=0&&t.ranges[c].to==a.from?t.ranges[c]={from:t.ranges[c].from,to:a.to}:t.ranges.push(a)}if(l&&i.firstChild())t&&t.depth++,r&&r.depth++;else for(;!i.nextSibling();){if(!i.parent())break e;if(t&&!--t.depth){let c=Bx(this.ranges,t.ranges);c.length&&(Nx(c),this.inner.splice(t.index,0,new Ix(t.parser,t.parser.startParse(this.input,Hx(t.mounts,c),c),t.ranges.map(u=>new yi(u.from-t.start,u.to-t.start)),t.target,c[0].from))),t=t.prev}r&&!--r.depth&&(r=r.prev)}}}}function F8(n,e,t){for(let r of n){if(r.from>=t)break;if(r.to>e)return r.from<=e&&r.to>=t?2:1}return 0}function Rx(n,e,t,r,i,s){if(e<t){let o=n.buffer[e+1];r.push(n.slice(e,t,o)),i.push(o-s)}}function j8(n){let{node:e}=n,t=[],r=e.context.buffer;do t.push(n.index),n.parent();while(!n.tree);let i=n.tree,s=i.children.indexOf(r),o=i.children[s],l=o.buffer,a=[s];function c(u,f,p,g,y,v){let k=t[v],x=[],_=[];Rx(o,u,k,x,_,g);let M=l[k+1],T=l[k+2];a.push(x.length);let S=v?c(k+4,l[k+3],o.set.types[l[k]],M,T-M,v-1):e.toTree();return x.push(S),_.push(M-g),Rx(o,l[k+3],f,x,_,g),new Jt(p,x,_,y)}i.children[s]=c(0,l.length,ai.none,0,o.length,t.length-1);for(let u of a){let f=n.tree.children[u],p=n.tree.positions[u];n.yield(new ar(f,p+n.from,u,n._tree))}}class Px{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(fn.IncludeAnonymous|fn.IgnoreMounts)}moveTo(e){let{cursor:t}=this,r=e-this.offset;for(;!this.done&&t.from<r;)t.to>=e&&t.enter(r,1,fn.IgnoreOverlays|fn.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof Jt)t=t.children[0];else break}return!1}}class $8{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let r=this.curFrag=e[0];this.curTo=(t=r.tree.prop(Cb))!==null&&t!==void 0?t:r.to,this.inner=new Px(r.tree,-r.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(Cb))!==null&&e!==void 0?e:t.to,this.inner=new Px(t.tree,-t.offset)}}findMounts(e,t){var r;let i=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let s=this.inner.cursor.node;s;s=s.parent){let o=(r=s.tree)===null||r===void 0?void 0:r.prop(pt.mounted);if(o&&o.parser==t)for(let l=this.fragI;l<this.fragments.length;l++){let a=this.fragments[l];if(a.from>=s.to)break;a.tree==this.curFrag.tree&&i.push({frag:a,pos:s.from-a.offset,mount:o})}}}return i}}function Bx(n,e){let t=null,r=e;for(let i=1,s=0;i<n.length;i++){let o=n[i-1].to,l=n[i].from;for(;s<r.length;s++){let a=r[s];if(a.from>=l)break;a.to<=o||(t||(r=t=e.slice()),a.from<o?(t[s]=new yi(a.from,o),a.to>l&&t.splice(s+1,0,new yi(l,a.to))):a.to>l?t[s--]=new yi(l,a.to):t.splice(s--,1))}}return r}function z8(n,e,t,r){let i=0,s=0,o=!1,l=!1,a=-1e9,c=[];for(;;){let u=i==n.length?1e9:o?n[i].to:n[i].from,f=s==e.length?1e9:l?e[s].to:e[s].from;if(o!=l){let p=Math.max(a,t),g=Math.min(u,f,r);p<g&&c.push(new yi(p,g))}if(a=Math.min(u,f),a==1e9)break;u==a&&(o?(o=!1,i++):o=!0),f==a&&(l?(l=!1,s++):l=!0)}return c}function Hx(n,e){let t=[];for(let{pos:r,mount:i,frag:s}of n){let o=r+(i.overlay?i.overlay[0].from:0),l=o+i.tree.length,a=Math.max(s.from,o),c=Math.min(s.to,l);if(i.overlay){let u=i.overlay.map(p=>new yi(p.from+r,p.to+r)),f=z8(e,u,a,c);for(let p=0,g=a;;p++){let y=p==f.length,v=y?c:f[p].from;if(v>g&&t.push(new mo(g,v,i.tree,-o,s.from>=g||s.openStart,s.to<=v||s.openEnd)),y)break;g=f[p].to}}else t.push(new mo(a,c,i.tree,-o,s.from>=o||s.openStart,s.to<=l||s.openEnd))}return t}let Sb=[],JA=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?JA:Sb).push(t=t+n[e])})();function W8(n){if(n<768)return!1;for(let e=0,t=Sb.length;;){let r=e+t>>1;if(n<Sb[r])t=r;else if(n>=JA[r])e=r+1;else return!0;if(e==t)return!1}}function Vx(n){return n>=127462&&n<=127487}const Fx=8205;function q8(n,e,t=!0,r=!0){return(t?ZA:U8)(n,e,r)}function ZA(n,e,t){if(e==n.length)return e;e&&YA(n.charCodeAt(e))&&XA(n.charCodeAt(e-1))&&e--;let r=Uy(n,e);for(e+=jx(r);e<n.length;){let i=Uy(n,e);if(r==Fx||i==Fx||t&&W8(i))e+=jx(i),r=i;else if(Vx(i)){let s=0,o=e-2;for(;o>=0&&Vx(Uy(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function U8(n,e,t){for(;e>0;){let r=ZA(n,e-2,t);if(r<e)return r;e--}return 0}function Uy(n,e){let t=n.charCodeAt(e);if(!XA(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return YA(r)?(t-55296<<10)+(r-56320)+65536:t}function YA(n){return n>=56320&&n<57344}function XA(n){return n>=55296&&n<56320}function jx(n){return n<65536?1:2}let Tt=class QA{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){[e,t]=fu(this,e,t);let i=[];return this.decompose(0,e,i,2),r.length&&r.decompose(0,r.length,i,3),this.decompose(t,this.length,i,1),Mm.from(i,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=fu(this,e,t);let r=[];return this.decompose(e,t,r,0),Mm.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),i=new ih(this),s=new ih(e);for(let o=t,l=t;;){if(i.next(o),s.next(o),o=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(l+=i.value.length,i.done||l>=r)return!0}}iter(e=1){return new ih(this,e)}iterRange(e,t=this.length){return new e2(this,e,t)}iterLines(e,t){let r;if(e==null)r=this.iter();else{t==null&&(t=this.lines+1);let i=this.line(e).from;r=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new t2(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?QA.empty:e.length<=32?new wn(e):Mm.from(wn.split(e,[]))}};class wn extends Tt{constructor(e,t=K8(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.text[s],l=i+o.length;if((t?r:l)>=e)return new G8(i,l,r,o);i=l+1,r++}}decompose(e,t,r,i){let s=e<=0&&t>=this.length?this:new wn($x(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(i&1){let o=r.pop(),l=Tm(s.text,o.text.slice(),0,s.length);if(l.length<=32)r.push(new wn(l,o.length+s.length));else{let a=l.length>>1;r.push(new wn(l.slice(0,a)),new wn(l.slice(a)))}}else r.push(s)}replace(e,t,r){if(!(r instanceof wn))return super.replace(e,t,r);[e,t]=fu(this,e,t);let i=Tm(this.text,Tm(r.text,$x(this.text,0,e)),t),s=this.length+r.length-(t-e);return i.length<=32?new wn(i,s):Mm.from(wn.split(i,[]),s)}sliceString(e,t=this.length,r=`
`){[e,t]=fu(this,e,t);let i="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(i+=r),e<a&&t>s&&(i+=l.slice(Math.max(0,e-s),t-s)),s=a+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],i=-1;for(let s of e)r.push(s),i+=s.length+1,r.length==32&&(t.push(new wn(r,i)),r=[],i=-1);return i>-1&&t.push(new wn(r,i)),t}}let Mm=class cc extends Tt{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let r of e)this.lines+=r.lines}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.children[s],l=i+o.length,a=r+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,r,i);i=l+1,r=a+1}}decompose(e,t,r,i){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&t>=o){let c=i&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!c?r.push(l):l.decompose(e-o,t-o,r,c)}o=a+1}}replace(e,t,r){if([e,t]=fu(this,e,t),r.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let o=this.children[i],l=s+o.length;if(e>=s&&t<=l){let a=o.replace(e-s,t-s,r),c=this.lines-o.lines+a.lines;if(a.lines<c>>4&&a.lines>c>>6){let u=this.children.slice();return u[i]=a,new cc(u,this.length-(t-e)+r.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,t,r)}sliceString(e,t=this.length,r=`
`){[e,t]=fu(this,e,t);let i="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(i+=r),e<a&&t>o&&(i+=l.sliceString(e-o,t-o,r)),o=a+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof cc))return 0;let r=0,[i,s,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,s+=t){if(i==o||s==l)return r;let a=this.children[i],c=e.children[s];if(a!=c)return r+a.scanIdentical(c,t);r+=a.length+1}}static from(e,t=e.reduce((r,i)=>r+i.length+1,-1)){let r=0;for(let g of e)r+=g.lines;if(r<32){let g=[];for(let y of e)y.flatten(g);return new wn(g,t)}let i=Math.max(32,r>>5),s=i<<1,o=i>>1,l=[],a=0,c=-1,u=[];function f(g){let y;if(g.lines>s&&g instanceof cc)for(let v of g.children)f(v);else g.lines>o&&(a>o||!a)?(p(),l.push(g)):g instanceof wn&&a&&(y=u[u.length-1])instanceof wn&&g.lines+y.lines<=32?(a+=g.lines,c+=g.length+1,u[u.length-1]=new wn(y.text.concat(g.text),y.length+1+g.length)):(a+g.lines>i&&p(),a+=g.lines,c+=g.length+1,u.push(g))}function p(){a!=0&&(l.push(u.length==1?u[0]:cc.from(u,c)),c=-1,a=u.length=0)}for(let g of e)f(g);return p(),l.length==1?l[0]:new cc(l,t)}};Tt.empty=new wn([""],0);function K8(n){let e=-1;for(let t of n)e+=t.length+1;return e}function Tm(n,e,t=0,r=1e9){for(let i=0,s=0,o=!0;s<n.length&&i<=r;s++){let l=n[s],a=i+l.length;a>=t&&(a>r&&(l=l.slice(0,r-i)),i<t&&(l=l.slice(t-i)),o?(e[e.length-1]+=l,o=!1):e.push(l)),i=a+1}return e}function $x(n,e,t){return Tm(n,[""],e,t)}class ih{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof wn?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,i=this.nodes[r],s=this.offsets[r],o=s>>1,l=i instanceof wn?i.text.length:i.children.length;if(o==(t>0?l:0)){if(r==0)return this.done=!0,this.value="",this;t>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[r]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof wn){let a=i.text[o+(t<0?-1:0)];if(this.offsets[r]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=i.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof wn?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class e2{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new ih(e,t>r?-1:1),this.pos=t>r?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let r=t<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=r?i:t<0?i.slice(i.length-r):i.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class t2{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:r,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Tt.prototype[Symbol.iterator]=function(){return this.iter()},ih.prototype[Symbol.iterator]=e2.prototype[Symbol.iterator]=t2.prototype[Symbol.iterator]=function(){return this});class G8{constructor(e,t,r,i){this.from=e,this.to=t,this.number=r,this.text=i}get length(){return this.to-this.from}}function fu(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function Xn(n,e,t=!0,r=!0){return q8(n,e,t,r)}function J8(n){return n>=56320&&n<57344}function Z8(n){return n>=55296&&n<56320}function Vr(n,e){let t=n.charCodeAt(e);if(!Z8(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return J8(r)?(t-55296<<10)+(r-56320)+65536:t}function Bv(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function bs(n){return n<65536?1:2}const xb=/\r\n?|\n/;var Yn=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(Yn||(Yn={}));class _s{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,r=0,i=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(r,i,s),i+=s):i+=o,r+=s}}iterChangedRanges(e,t=!1){_b(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];i<0?e.push(r,i):e.push(i,r)}return new _s(e)}composeDesc(e){return this.empty?e:e.empty?this:n2(this,e)}mapDesc(e,t=!1){return e.empty?this:Mb(this,e,t)}mapPos(e,t=-1,r=Yn.Simple){let i=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],c=i+l;if(a<0){if(c>e)return s+(e-i);s+=l}else{if(r!=Yn.Simple&&c>=e&&(r==Yn.TrackDel&&i<e&&c>e||r==Yn.TrackBefore&&i<e||r==Yn.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!l)return e==i||t<0?s:s+a;s+=a}i=c}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,t=e){for(let r=0,i=0;r<this.sections.length&&i<=t;){let s=this.sections[r++],o=this.sections[r++],l=i+s;if(o>=0&&i<=t&&l>=e)return i<e&&l>t?"cover":!0;i=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+r+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new _s(e)}static create(e){return new _s(e)}}class Ln extends _s{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return _b(this,(t,r,i,s,o)=>e=e.replace(i,i+(r-t),o),!1),e}mapDesc(e,t=!1){return Mb(this,e,t,!0)}invert(e){let t=this.sections.slice(),r=[];for(let i=0,s=0;i<t.length;i+=2){let o=t[i],l=t[i+1];if(l>=0){t[i]=l,t[i+1]=o;let a=i>>1;for(;r.length<a;)r.push(Tt.empty);r.push(o?e.slice(s,s+o):Tt.empty)}s+=o}return new Ln(t,r)}compose(e){return this.empty?e:e.empty?this:n2(this,e,!0)}map(e,t=!1){return e.empty?this:Mb(this,e,t,!0)}iterChanges(e,t=!1){_b(this,e,t)}get desc(){return _s.create(this.sections)}filter(e){let t=[],r=[],i=[],s=new Vh(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let u=Math.min(s.len,a-l);ir(i,u,-1);let f=s.ins==-1?-1:s.off==0?s.ins:0;ir(t,u,f),f>0&&rl(r,t,s.text),s.forward(u),l+=u}let c=e[o++];for(;l<c;){if(s.done)break e;let u=Math.min(s.len,c-l);ir(t,u,-1),ir(i,u,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(u),l+=u}}return{changes:new Ln(t,r),filtered:_s.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t],i=this.sections[t+1];i<0?e.push(r):i==0?e.push([r]):e.push([r].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,r){let i=[],s=[],o=0,l=null;function a(u=!1){if(!u&&!i.length)return;o<t&&ir(i,t-o,-1);let f=new Ln(i,s);l=l?l.compose(f.map(l)):f,i=[],s=[],o=0}function c(u){if(Array.isArray(u))for(let f of u)c(f);else if(u instanceof Ln){if(u.length!=t)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${t})`);a(),l=l?l.compose(u.map(l)):u}else{let{from:f,to:p=f,insert:g}=u;if(f>p||f<0||p>t)throw new RangeError(`Invalid change range ${f} to ${p} (in doc of length ${t})`);let y=g?typeof g=="string"?Tt.of(g.split(r||xb)):g:Tt.empty,v=y.length;if(f==p&&v==0)return;f<o&&a(),f>o&&ir(i,f-o,-1),ir(i,p-f,v),rl(s,i,y),o=p}}return c(e),a(!l),l}static empty(e){return new Ln(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],r=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;r.length<i;)r.push(Tt.empty);r[i]=Tt.of(s.slice(1)),t.push(s[0],r[i].length)}}}return new Ln(t,r)}static createSet(e,t){return new Ln(e,t)}}function ir(n,e,t,r=!1){if(e==0&&t<=0)return;let i=n.length-2;i>=0&&t<=0&&t==n[i+1]?n[i]+=e:i>=0&&e==0&&n[i]==0?n[i+1]+=t:r?(n[i]+=e,n[i+1]+=t):n.push(e,t)}function rl(n,e,t){if(t.length==0)return;let r=e.length-2>>1;if(r<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<r;)n.push(Tt.empty);n.push(t)}}function _b(n,e,t){let r=n.inserted;for(let i=0,s=0,o=0;o<n.sections.length;){let l=n.sections[o++],a=n.sections[o++];if(a<0)i+=l,s+=l;else{let c=i,u=s,f=Tt.empty;for(;c+=l,u+=a,a&&r&&(f=f.append(r[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)l=n.sections[o++],a=n.sections[o++];e(i,c,s,u,f),i=c,s=u}}}function Mb(n,e,t,r=!1){let i=[],s=r?[]:null,o=new Vh(n),l=new Vh(e);for(let a=-1;;){if(o.done&&l.len||l.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&l.ins==-1){let c=Math.min(o.len,l.len);ir(i,c,-1),o.forward(c),l.forward(c)}else if(l.ins>=0&&(o.ins<0||a==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!t))){let c=l.len;for(ir(i,l.ins,-1);c;){let u=Math.min(o.len,c);o.ins>=0&&a<o.i&&o.len<=u&&(ir(i,0,o.ins),s&&rl(s,i,o.text),a=o.i),o.forward(u),c-=u}l.next()}else if(o.ins>=0){let c=0,u=o.len;for(;u;)if(l.ins==-1){let f=Math.min(u,l.len);c+=f,u-=f,l.forward(f)}else if(l.ins==0&&l.len<u)u-=l.len,l.next();else break;ir(i,c,a<o.i?o.ins:0),s&&a<o.i&&rl(s,i,o.text),a=o.i,o.forward(o.len-u)}else{if(o.done&&l.done)return s?Ln.createSet(i,s):_s.create(i);throw new Error("Mismatched change set lengths")}}}function n2(n,e,t=!1){let r=[],i=t?[]:null,s=new Vh(n),o=new Vh(e);for(let l=!1;;){if(s.done&&o.done)return i?Ln.createSet(r,i):_s.create(r);if(s.ins==0)ir(r,s.len,0,l),s.next();else if(o.len==0&&!o.done)ir(r,0,o.ins,l),i&&rl(i,r,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),c=r.length;if(s.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;ir(r,a,u,l),i&&u&&rl(i,r,o.text)}else o.ins==-1?(ir(r,s.off?0:s.len,a,l),i&&rl(i,r,s.textBit(a))):(ir(r,s.off?0:s.len,o.off?0:o.ins,l),i&&!o.off&&rl(i,r,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||r.length>c),s.forward2(a),o.forward(a)}}}}class Vh{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Tt.empty:e[t]}textBit(e){let{inserted:t}=this.set,r=this.i-2>>1;return r>=t.length&&!e?Tt.empty:t[r].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}let Hp=class Tb{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let r,i;return this.empty?r=i=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),r==this.from&&i==this.to?this:new Tb(r,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return re.range(e,t);let r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return re.range(this.anchor,r)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return re.range(e.anchor,e.head)}static create(e,t,r){return new Tb(e,t,r)}};class re{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:re.create(this.ranges.map(r=>r.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new re([this.main],0)}addRange(e,t=!0){return re.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let r=this.ranges.slice();return r[t]=e,re.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new re(e.ranges.map(t=>Hp.fromJSON(t)),e.main)}static single(e,t=e){return new re([re.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=r:s.from<r)return re.normalized(e.slice(),t);r=s.to}return new re(e,t)}static cursor(e,t=0,r,i){return Hp.create(e,e,(t==0?0:t<0?8:16)|(r==null?7:Math.min(6,r))|(i??16777215)<<6)}static range(e,t,r,i){let s=(r??16777215)<<6|(i==null?7:Math.min(6,i));return t<e?Hp.create(t,e,48|s):Hp.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let r=e[t];e.sort((i,s)=>i.from-s.from),t=e.indexOf(r);for(let i=1;i<e.length;i++){let s=e[i],o=e[i-1];if(s.empty?s.from<=o.to:s.from<o.to){let l=o.from,a=Math.max(s.to,o.to);i<=t&&t--,e.splice(--i,2,s.anchor>s.head?re.range(a,l):re.range(l,a))}}return new re(e,t)}}function r2(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Hv=0;class Ie{constructor(e,t,r,i,s){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=i,this.id=Hv++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new Ie(e.combine||(t=>t),e.compareInput||((t,r)=>t===r),e.compare||(e.combine?(t,r)=>t===r:Vv),!!e.static,e.enables)}of(e){return new Em([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Em(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Em(e,this,2,t)}from(e,t){return t||(t=r=>r),this.compute([e],r=>t(r.field(e)))}}function Vv(n,e){return n==e||n.length==e.length&&n.every((t,r)=>t===e[r])}class Em{constructor(e,t,r,i){this.dependencies=e,this.facet=t,this.type=r,this.value=i,this.id=Hv++}dynamicSlot(e){var t;let r=this.value,i=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,c=!1,u=[];for(let f of this.dependencies)f=="doc"?a=!0:f=="selection"?c=!0:((t=e[f.id])!==null&&t!==void 0?t:1)&1||u.push(e[f.id]);return{create(f){return f.values[o]=r(f),1},update(f,p){if(a&&p.docChanged||c&&(p.docChanged||p.selection)||Eb(f,u)){let g=r(f);if(l?!zx(g,f.values[o],i):!i(g,f.values[o]))return f.values[o]=g,1}return 0},reconfigure:(f,p)=>{let g,y=p.config.address[s];if(y!=null){let v=Dg(p,y);if(this.dependencies.every(k=>k instanceof Ie?p.facet(k)===f.facet(k):k instanceof jn?p.field(k,!1)==f.field(k,!1):!0)||(l?zx(g=r(f),v,i):i(g=r(f),v)))return f.values[o]=v,0}else g=r(f);return f.values[o]=g,1}}}}function zx(n,e,t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function Eb(n,e){let t=!1;for(let r of e)sh(n,r)&1&&(t=!0);return t}function Y8(n,e,t){let r=t.map(a=>n[a.id]),i=t.map(a=>a.type),s=r.filter(a=>!(a&1)),o=n[e.id]>>1;function l(a){let c=[];for(let u=0;u<r.length;u++){let f=Dg(a,r[u]);if(i[u]==2)for(let p of f)c.push(p);else c.push(f)}return e.combine(c)}return{create(a){for(let c of r)sh(a,c);return a.values[o]=l(a),1},update(a,c){if(!Eb(a,s))return 0;let u=l(a);return e.compare(u,a.values[o])?0:(a.values[o]=u,1)},reconfigure(a,c){let u=Eb(a,r),f=c.config.facets[e.id],p=c.facet(e);if(f&&!u&&Vv(t,f))return a.values[o]=p,0;let g=l(a);return e.compare(g,p)?(a.values[o]=p,0):(a.values[o]=g,1)}}}const Vp=Ie.define({static:!0});class jn{constructor(e,t,r,i,s){this.id=e,this.createF=t,this.updateF=r,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let t=new jn(Hv++,e.create,e.update,e.compare||((r,i)=>r===i),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Vp).find(r=>r.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:r=>(r.values[t]=this.create(r),1),update:(r,i)=>{let s=r.values[t],o=this.updateF(s,i);return this.compareF(s,o)?0:(r.values[t]=o,1)},reconfigure:(r,i)=>{let s=r.facet(Vp),o=i.facet(Vp),l;return(l=s.find(a=>a.field==this))&&l!=o.find(a=>a.field==this)?(r.values[t]=l.create(r),1):i.config.address[this.id]!=null?(r.values[t]=i.field(this),0):(r.values[t]=this.create(r),1)}}}init(e){return[this,Vp.of({field:this,create:e})]}get extension(){return this}}const Xl={lowest:4,low:3,default:2,high:1,highest:0};function tf(n){return e=>new i2(e,n)}const Cl={highest:tf(Xl.highest),high:tf(Xl.high),default:tf(Xl.default),low:tf(Xl.low),lowest:tf(Xl.lowest)};class i2{constructor(e,t){this.inner=e,this.prec=t}}class hu{of(e){return new Ab(this,e)}reconfigure(e){return hu.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Ab{constructor(e,t){this.compartment=e,this.inner=t}}let Wx=class s2{constructor(e,t,r,i,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=i,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,r){let i=[],s=Object.create(null),o=new Map;for(let p of X8(e,t,o))p instanceof jn?i.push(p):(s[p.facet.id]||(s[p.facet.id]=[])).push(p);let l=Object.create(null),a=[],c=[];for(let p of i)l[p.id]=c.length<<1,c.push(g=>p.slot(g));let u=r==null?void 0:r.config.facets;for(let p in s){let g=s[p],y=g[0].facet,v=u&&u[p]||[];if(g.every(k=>k.type==0))if(l[y.id]=a.length<<1|1,Vv(v,g))a.push(r.facet(y));else{let k=y.combine(g.map(x=>x.value));a.push(r&&y.compare(k,r.facet(y))?r.facet(y):k)}else{for(let k of g)k.type==0?(l[k.id]=a.length<<1|1,a.push(k.value)):(l[k.id]=c.length<<1,c.push(x=>k.dynamicSlot(x)));l[y.id]=c.length<<1,c.push(k=>Y8(k,y,g))}}let f=c.map(p=>p(l));return new s2(e,o,f,l,a,s)}};function X8(n,e,t){let r=[[],[],[],[],[]],i=new Map;function s(o,l){let a=i.get(o);if(a!=null){if(a<=l)return;let c=r[a].indexOf(o);c>-1&&r[a].splice(c,1),o instanceof Ab&&t.delete(o.compartment)}if(i.set(o,l),Array.isArray(o))for(let c of o)s(c,l);else if(o instanceof Ab){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;t.set(o.compartment,c),s(c,l)}else if(o instanceof i2)s(o.inner,o.prec);else if(o instanceof jn)r[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof Em)r[l].push(o),o.facet.extensions&&s(o.facet.extensions,Xl.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(c,l)}}return s(n,Xl.default),r.reduce((o,l)=>o.concat(l))}function sh(n,e){if(e&1)return 2;let t=e>>1,r=n.status[t];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;n.status[t]=4;let i=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|i}function Dg(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const o2=Ie.define(),Ob=Ie.define({combine:n=>n.some(e=>e),static:!0}),l2=Ie.define({combine:n=>n.length?n[0]:void 0,static:!0}),a2=Ie.define(),c2=Ie.define(),u2=Ie.define(),f2=Ie.define({combine:n=>n.length?n[0]:!1});class Mo{constructor(e,t){this.type=e,this.value=t}static define(){return new Q8}}class Q8{of(e){return new Mo(this,e)}}class e7{constructor(e){this.map=e}of(e){return new it(this,e)}}class it{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new it(this.type,t)}is(e){return this.type==e}static define(e={}){return new e7(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let r=[];for(let i of e){let s=i.map(t);s&&r.push(s)}return r}}it.reconfigure=it.define();it.appendConfig=it.define();let Sr=class wf{constructor(e,t,r,i,s,o){this.startState=e,this.changes=t,this.selection=r,this.effects=i,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,r&&r2(r,t.newLength),s.some(l=>l.type==wf.time)||(this.annotations=s.concat(wf.time.of(Date.now())))}static create(e,t,r,i,s,o){return new wf(e,t,r,i,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(wf.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}};Sr.time=Mo.define();Sr.userEvent=Mo.define();Sr.addToHistory=Mo.define();Sr.remote=Mo.define();function t7(n,e){let t=[];for(let r=0,i=0;;){let s,o;if(r<n.length&&(i==e.length||e[i]>=n[r]))s=n[r++],o=n[r++];else if(i<e.length)s=e[i++],o=e[i++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function h2(n,e,t){var r;let i,s,o;return t?(i=e.changes,s=Ln.empty(e.changes.length),o=n.changes.compose(e.changes)):(i=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(i)),{changes:o,selection:e.selection?e.selection.map(s):(r=n.selection)===null||r===void 0?void 0:r.map(i),effects:it.mapEffects(n.effects,i).concat(it.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function Lb(n,e,t){let r=e.selection,i=Mc(e.annotations);return e.userEvent&&(i=i.concat(Sr.userEvent.of(e.userEvent))),{changes:e.changes instanceof Ln?e.changes:Ln.of(e.changes||[],t,n.facet(l2)),selection:r&&(r instanceof re?r:re.single(r.anchor,r.head)),effects:Mc(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function d2(n,e,t){let r=Lb(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;r=h2(r,Lb(n,e[s],o?r.changes.newLength:n.doc.length),o)}let i=Sr.create(n,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return r7(t?n7(i):i)}function n7(n){let e=n.startState,t=!0;for(let i of e.facet(a2)){let s=i(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:t7(t,s))}if(t!==!0){let i,s;if(t===!1)s=n.changes.invertedDesc,i=Ln.empty(e.doc.length);else{let o=n.changes.filter(t);i=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=Sr.create(e,i,n.selection&&n.selection.map(s),it.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let r=e.facet(c2);for(let i=r.length-1;i>=0;i--){let s=r[i](n);s instanceof Sr?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Sr?n=s[0]:n=d2(e,Mc(s),!1)}return n}function r7(n){let e=n.startState,t=e.facet(u2),r=n;for(let i=t.length-1;i>=0;i--){let s=t[i](n);s&&Object.keys(s).length&&(r=h2(r,Lb(e,s,n.changes.newLength),!0))}return r==n?n:Sr.create(e,n.changes,n.selection,r.effects,r.annotations,r.scrollIntoView)}const i7=[];function Mc(n){return n==null?i7:Array.isArray(n)?n:[n]}var on=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(on||(on={}));const s7=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Db;try{Db=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function o7(n){if(Db)return Db.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||s7.test(t)))return!0}return!1}function l7(n){return e=>{if(!/\S/.test(e))return on.Space;if(o7(e))return on.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return on.Word;return on.Other}}let ln=class Ri{constructor(e,t,r,i,s,o){this.config=e,this.doc=t,this.selection=r,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)sh(this,l<<1);this.computeSlot=null}field(e,t=!0){let r=this.config.address[e.id];if(r==null){if(t)throw new RangeError("Field is not present in this state");return}return sh(this,r),Dg(this,r)}update(...e){return d2(this,e,!0)}applyTransaction(e){let t=this.config,{base:r,compartments:i}=t;for(let l of e.effects)l.is(hu.reconfigure)?(t&&(i=new Map,t.compartments.forEach((a,c)=>i.set(c,a)),t=null),i.set(l.value.compartment,l.value.extension)):l.is(it.reconfigure)?(t=null,r=l.value):l.is(it.appendConfig)&&(t=null,r=Mc(r).concat(l.value));let s;t?s=e.startState.values.slice():(t=Wx.resolve(r,i,this),s=new Ri(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(a,c)=>c.reconfigure(a,this),null).values);let o=e.startState.facet(Ob)?e.newSelection:e.newSelection.asSingle();new Ri(t,e.newDoc,o,s,(l,a)=>a.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:re.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,r=e(t.ranges[0]),i=this.changes(r.changes),s=[r.range],o=Mc(r.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),c=this.changes(a.changes),u=c.map(i);for(let p=0;p<l;p++)s[p]=s[p].map(u);let f=i.mapDesc(c,!0);s.push(a.range.map(f)),i=i.compose(u),o=it.mapEffects(o,u).concat(it.mapEffects(Mc(a.effects),f))}return{changes:i,selection:re.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Ln?e:Ln.of(e,this.doc.length,this.facet(Ri.lineSeparator))}toText(e){return Tt.of(e.split(this.facet(Ri.lineSeparator)||xb))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(sh(this,t),Dg(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let i=e[r];i instanceof jn&&this.config.address[i.id]!=null&&(t[r]=i.spec.toJSON(this.field(e[r]),this))}return t}static fromJSON(e,t={},r){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(r){for(let s in r)if(Object.prototype.hasOwnProperty.call(e,s)){let o=r[s],l=e[s];i.push(o.init(a=>o.spec.fromJSON(l,a)))}}return Ri.create({doc:e.doc,selection:re.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(e={}){let t=Wx.resolve(e.extensions||[],new Map),r=e.doc instanceof Tt?e.doc:Tt.of((e.doc||"").split(t.staticFacet(Ri.lineSeparator)||xb)),i=e.selection?e.selection instanceof re?e.selection:re.single(e.selection.anchor,e.selection.head):re.single(0);return r2(i,r.length),t.staticFacet(Ob)||(i=i.asSingle()),new Ri(t,r,i,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Ri.tabSize)}get lineBreak(){return this.facet(Ri.lineSeparator)||`
`}get readOnly(){return this.facet(f2)}phrase(e,...t){for(let r of this.facet(Ri.phrases))if(Object.prototype.hasOwnProperty.call(r,e)){e=r[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(r,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>t.length?r:t[s-1]})),e}languageDataAt(e,t,r=-1){let i=[];for(let s of this.facet(o2))for(let o of s(this,t,r))Object.prototype.hasOwnProperty.call(o,e)&&i.push(o[e]);return i}charCategorizer(e){return l7(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:r,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-r,l=e-r;for(;o>0;){let a=Xn(t,o,!1);if(s(t.slice(a,o))!=on.Word)break;o=a}for(;l<i;){let a=Xn(t,l);if(s(t.slice(l,a))!=on.Word)break;l=a}return o==l?null:re.range(o+r,l+r)}};ln.allowMultipleSelections=Ob;ln.tabSize=Ie.define({combine:n=>n.length?n[0]:4});ln.lineSeparator=l2;ln.readOnly=f2;ln.phrases=Ie.define({compare(n,e){let t=Object.keys(n),r=Object.keys(e);return t.length==r.length&&t.every(i=>n[i]==e[i])}});ln.languageData=o2;ln.changeFilter=a2;ln.transactionFilter=c2;ln.transactionExtender=u2;hu.reconfigure=it.define();function Is(n,e,t={}){let r={};for(let i of n)for(let s of Object.keys(i)){let o=i[s],l=r[s];if(l===void 0)r[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(t,s))r[s]=t[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let i in e)r[i]===void 0&&(r[i]=e[i]);return r}class Na{eq(e){return this==e}range(e,t=e){return Fh.create(e,t,this)}}Na.prototype.startSide=Na.prototype.endSide=0;Na.prototype.point=!1;Na.prototype.mapMode=Yn.TrackDel;class Fh{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new Fh(e,t,r)}}function Ib(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Fv{constructor(e,t,r,i){this.from=e,this.to=t,this.value=r,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,r,i=0){let s=r?this.to:this.from;for(let o=i,l=s.length;;){if(o==l)return o;let a=o+l>>1,c=s[a]-e||(r?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return c>=0?o:l;c>=0?l=a:o=a+1}}between(e,t,r,i){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(r,1e9,!1,s);s<o;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let r=[],i=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let c=this.value[a],u=this.from[a]+e,f=this.to[a]+e,p,g;if(u==f){let y=t.mapPos(u,c.startSide,c.mapMode);if(y==null||(p=g=y,c.startSide!=c.endSide&&(g=t.mapPos(u,c.endSide),g<p)))continue}else if(p=t.mapPos(u,c.startSide),g=t.mapPos(f,c.endSide),p>g||p==g&&c.startSide>0&&c.endSide<=0)continue;(g-p||c.endSide-c.startSide)<0||(o<0&&(o=p),c.point&&(l=Math.max(l,g-p)),r.push(c),i.push(p-o),s.push(g-o))}return{mapped:r.length?new Fv(i,s,r,l):null,pos:o}}}class xt{constructor(e,t,r,i){this.chunkPos=e,this.chunk=t,this.nextLayer=r,this.maxPoint=i}static create(e,t,r,i){return new xt(e,t,r,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:r=!1,filterFrom:i=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(r&&(t=t.slice().sort(Ib)),this.isEmpty)return t.length?xt.of(t):this;let l=new p2(this,null,-1).goto(0),a=0,c=[],u=new bo;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let f=t[a++];u.addInner(f.from,f.to,f.value)||c.push(f)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||i>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&u.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||i>l.to||s<l.from||o(l.from,l.to,l.value))&&(u.addInner(l.from,l.to,l.value)||c.push(Fh.create(l.from,l.to,l.value))),l.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?xt.empty:this.nextLayer.update({add:c,filter:o,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],r=[],i=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],c=e.touchesRange(l,l+a.length);if(c===!1)i=Math.max(i,a.maxPoint),t.push(a),r.push(e.mapPos(l));else if(c===!0){let{mapped:u,pos:f}=a.map(l,e);u&&(i=Math.max(i,u.maxPoint),t.push(u),r.push(f))}}let s=this.nextLayer.map(e);return t.length==0?s:new xt(r,t,s||xt.empty,i)}between(e,t,r){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],o=this.chunk[i];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,r)===!1)return}this.nextLayer.between(e,t,r)}}iter(e=0){return jh.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return jh.from(e).goto(t)}static compare(e,t,r,i,s=-1){let o=e.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),l=t.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),a=qx(o,l,r),c=new nf(o,a,s),u=new nf(l,a,s);r.iterGaps((f,p,g)=>Ux(c,f,u,p,g,i)),r.empty&&r.length==0&&Ux(c,0,u,0,0,i)}static eq(e,t,r=0,i){i==null&&(i=999999999);let s=e.filter(u=>!u.isEmpty&&t.indexOf(u)<0),o=t.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=qx(s,o),a=new nf(s,l,0).goto(r),c=new nf(o,l,0).goto(r);for(;;){if(a.to!=c.to||!Nb(a.active,c.active)||a.point&&(!c.point||!a.point.eq(c.point)))return!1;if(a.to>i)return!0;a.next(),c.next()}}static spans(e,t,r,i,s=-1){let o=new nf(e,null,s).goto(t),l=t,a=o.openStart;for(;;){let c=Math.min(o.to,r);if(o.point){let u=o.activeForPoint(o.to),f=o.pointFrom<t?u.length+1:o.point.startSide<0?u.length:Math.min(u.length,a);i.point(l,c,o.point,u,f,o.pointRank),a=Math.min(o.openEnd(c),u.length)}else c>l&&(i.span(l,c,o.active,a),a=o.openEnd(c));if(o.to>r)return a+(o.point&&o.to>r?1:0);l=o.to,o.next()}}static of(e,t=!1){let r=new bo;for(let i of e instanceof Fh?[e]:t?a7(e):e)r.add(i.from,i.to,i.value);return r.finish()}static join(e){if(!e.length)return xt.empty;let t=e[e.length-1];for(let r=e.length-2;r>=0;r--)for(let i=e[r];i!=xt.empty;i=i.nextLayer)t=new xt(i.chunkPos,i.chunk,t,Math.max(i.maxPoint,t.maxPoint));return t}}xt.empty=new xt([],[],null,-1);function a7(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let r=n[t];if(Ib(e,r)>0)return n.slice().sort(Ib);e=r}return n}xt.empty.nextLayer=xt.empty;class bo{finishChunk(e){this.chunks.push(new Fv(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new bo)).add(e,t,r)}addInner(e,t,r){let i=e-this.lastTo||r.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(xt.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=xt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function qx(n,e,t){let r=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&r.set(s.chunk[o],s.chunkPos[o]);let i=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=r.get(s.chunk[o]);l!=null&&(t?t.mapPos(l):l)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(l,l+s.chunk[o].length))&&i.add(s.chunk[o])}return i}class p2{constructor(e,t,r,i=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!r||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],r=e+t.from[this.rangeIndex];if(this.from=r,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class jh{constructor(e){this.heap=e}static from(e,t=null,r=-1){let i=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&i.push(new p2(o,t,r,s));return i.length==1?i[0]:new jh(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let r of this.heap)r.goto(e,t);for(let r=this.heap.length>>1;r>=0;r--)Ky(this.heap,r);return this.next(),this}forward(e,t){for(let r of this.heap)r.forward(e,t);for(let r=this.heap.length>>1;r>=0;r--)Ky(this.heap,r);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Ky(this.heap,0)}}}function Ky(n,e){for(let t=n[e];;){let r=(e<<1)+1;if(r>=n.length)break;let i=n[r];if(r+1<n.length&&i.compare(n[r+1])>=0&&(i=n[r+1],r++),t.compare(i)<0)break;n[r]=t,n[e]=i,e=r}}class nf{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=jh.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Fp(this.active,e),Fp(this.activeTo,e),Fp(this.activeRank,e),this.minActive=Kx(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:i,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||i-this.activeTo[t])>0;)t++;jp(this.active,t,r),jp(this.activeTo,t,i),jp(this.activeRank,t,s),e&&jp(e,t,this.cursor.from),this.minActive=Kx(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),r&&Fp(r,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(r),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let i=r.length-1;i>=0&&r[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&t.push(this.active[r]);return t.reverse()}openEnd(e){let t=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)t++;return t}}function Ux(n,e,t,r,i,s){n.goto(e),t.goto(r);let o=r+i,l=r,a=r-e;for(;;){let c=n.to+a-t.to,u=c||n.endSide-t.endSide,f=u<0?n.to+a:t.to,p=Math.min(f,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&Nb(n.activeForPoint(n.to),t.activeForPoint(t.to))||s.comparePoint(l,p,n.point,t.point):p>l&&!Nb(n.active,t.active)&&s.compareRange(l,p,n.active,t.active),f>o)break;(c||n.openEnd!=t.openEnd)&&s.boundChange&&s.boundChange(f),l=f,u<=0&&n.next(),u>=0&&t.next()}}function Nb(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function Fp(n,e){for(let t=e,r=n.length-1;t<r;t++)n[t]=n[t+1];n.pop()}function jp(n,e,t){for(let r=n.length-1;r>=e;r--)n[r+1]=n[r];n[e]=t}function Kx(n,e){let t=-1,r=1e9;for(let i=0;i<e.length;i++)(e[i]-r||n[i].endSide-n[t].endSide)<0&&(t=i,r=e[i]);return t}function Du(n,e,t=n.length){let r=0;for(let i=0;i<t&&i<n.length;)n.charCodeAt(i)==9?(r+=e-r%e,i++):(r++,i=Xn(n,i));return r}function Rb(n,e,t,r){for(let i=0,s=0;;){if(s>=e)return i;if(i==n.length)break;s+=n.charCodeAt(i)==9?t-s%t:1,i=Xn(n,i)}return r===!0?-1:n.length}const Pb="",Gx=typeof Symbol>"u"?"__"+Pb:Symbol.for(Pb),Bb=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Jx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class gl{constructor(e,t){this.rules=[];let{finish:r}=t||{};function i(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,l,a,c){let u=[],f=/^@(\w+)\b/.exec(o[0]),p=f&&f[1]=="keyframes";if(f&&l==null)return a.push(o[0]+";");for(let g in l){let y=l[g];if(/&/.test(g))s(g.split(/,\s*/).map(v=>o.map(k=>v.replace(/&/,k))).reduce((v,k)=>v.concat(k)),y,a);else if(y&&typeof y=="object"){if(!f)throw new RangeError("The value of a property ("+g+") should be a primitive value.");s(i(g),y,u,p)}else y!=null&&u.push(g.replace(/_.*/,"").replace(/[A-Z]/g,v=>"-"+v.toLowerCase())+": "+y+";")}(u.length||p)&&a.push((r&&!f&&!c?o.map(r):o).join(", ")+" {"+u.join(" ")+"}")}for(let o in e)s(i(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Jx[Gx]||1;return Jx[Gx]=e+1,Pb+e.toString(36)}static mount(e,t,r){let i=e[Bb],s=r&&r.nonce;i?s&&i.setNonce(s):i=new c7(e,s),i.mount(Array.isArray(t)?t:[t],e)}}let Zx=new Map;class c7{constructor(e,t){let r=e.ownerDocument||e,i=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let s=Zx.get(r);if(s)return e[Bb]=s;this.sheet=new i.CSSStyleSheet,Zx.set(r,this)}else this.styleTag=r.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[Bb]=this}mount(e,t){let r=this.sheet,i=0,s=0;for(let o=0;o<e.length;o++){let l=e[o],a=this.modules.indexOf(l);if(a<s&&a>-1&&(this.modules.splice(a,1),s--,a=-1),a==-1){if(this.modules.splice(s++,0,l),r)for(let c=0;c<l.rules.length;c++)r.insertRule(l.rules[c],i++)}else{for(;s<a;)i+=this.modules[s++].rules.length;i+=l.rules.length,s++}}if(r)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let a=0;a<this.modules.length;a++)o+=this.modules[a].getRules()+`
`;this.styleTag.textContent=o;let l=t.head||t;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var wo={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},$h={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},u7=typeof navigator<"u"&&/Mac/.test(navigator.platform),f7=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Gn=0;Gn<10;Gn++)wo[48+Gn]=wo[96+Gn]=String(Gn);for(var Gn=1;Gn<=24;Gn++)wo[Gn+111]="F"+Gn;for(var Gn=65;Gn<=90;Gn++)wo[Gn]=String.fromCharCode(Gn+32),$h[Gn]=String.fromCharCode(Gn);for(var Gy in wo)$h.hasOwnProperty(Gy)||($h[Gy]=wo[Gy]);function m2(n){var e=u7&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||f7&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?$h:wo)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Ht(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=t[r];typeof i=="string"?n.setAttribute(r,i):i!=null&&(n[r]=i)}e++}for(;e<arguments.length;e++)g2(n,arguments[e]);return n}function g2(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)g2(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}let wr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Hb=typeof document<"u"?document:{documentElement:{style:{}}};const Vb=/Edge\/(\d+)/.exec(wr.userAgent),y2=/MSIE \d/.test(wr.userAgent),Fb=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(wr.userAgent),O0=!!(y2||Fb||Vb),Yx=!O0&&/gecko\/(\d+)/i.test(wr.userAgent),Jy=!O0&&/Chrome\/(\d+)/.exec(wr.userAgent),Xx="webkitFontSmoothing"in Hb.documentElement.style,jb=!O0&&/Apple Computer/.test(wr.vendor),Qx=jb&&(/Mobile\/\w+/.test(wr.userAgent)||wr.maxTouchPoints>2);var Oe={mac:Qx||/Mac/.test(wr.platform),windows:/Win/.test(wr.platform),linux:/Linux|X11/.test(wr.platform),ie:O0,ie_version:y2?Hb.documentMode||6:Fb?+Fb[1]:Vb?+Vb[1]:0,gecko:Yx,gecko_version:Yx?+(/Firefox\/(\d+)/.exec(wr.userAgent)||[0,0])[1]:0,chrome:!!Jy,chrome_version:Jy?+Jy[1]:0,ios:Qx,android:/Android\b/.test(wr.userAgent),webkit:Xx,webkit_version:Xx?+(/\bAppleWebKit\/(\d+)/.exec(wr.userAgent)||[0,0])[1]:0,safari:jb,safari_version:jb?+(/\bVersion\/(\d+(\.\d+)?)/.exec(wr.userAgent)||[0,0])[1]:0,tabSize:Hb.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function zh(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function $b(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function Am(n,e){if(!e.anchorNode)return!1;try{return $b(n,e.anchorNode)}catch{return!1}}function Wh(n){return n.nodeType==3?Pa(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function oh(n,e,t,r){return t?e_(n,e,t,r,-1)||e_(n,e,t,r,1):!1}function Ra(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function Ig(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function e_(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Es(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=Ra(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=i<0?Es(n):0}else return!1}}function Es(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function L0(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function h7(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function b2(n,e){let t=e.width/n.offsetWidth,r=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.height-n.offsetHeight)<1)&&(r=1),{scaleX:t,scaleY:r}}function d7(n,e,t,r,i,s,o,l){let a=n.ownerDocument,c=a.defaultView||window;for(let u=n,f=!1;u&&!f;)if(u.nodeType==1){let p,g=u==a.body,y=1,v=1;if(g)p=h7(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(f=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let _=u.getBoundingClientRect();({scaleX:y,scaleY:v}=b2(u,_)),p={left:_.left,right:_.left+u.clientWidth*y,top:_.top,bottom:_.top+u.clientHeight*v}}let k=0,x=0;if(i=="nearest")e.top<p.top?(x=e.top-(p.top+o),t>0&&e.bottom>p.bottom+x&&(x=e.bottom-p.bottom+o)):e.bottom>p.bottom&&(x=e.bottom-p.bottom+o,t<0&&e.top-x<p.top&&(x=e.top-(p.top+o)));else{let _=e.bottom-e.top,M=p.bottom-p.top;x=(i=="center"&&_<=M?e.top+_/2-M/2:i=="start"||i=="center"&&t<0?e.top-o:e.bottom-M+o)-p.top}if(r=="nearest"?e.left<p.left?(k=e.left-(p.left+s),t>0&&e.right>p.right+k&&(k=e.right-p.right+s)):e.right>p.right&&(k=e.right-p.right+s,t<0&&e.left<p.left+k&&(k=e.left-(p.left+s))):k=(r=="center"?e.left+(e.right-e.left)/2-(p.right-p.left)/2:r=="start"==l?e.left-s:e.right-(p.right-p.left)+s)-p.left,k||x)if(g)c.scrollBy(k,x);else{let _=0,M=0;if(x){let T=u.scrollTop;u.scrollTop+=x/v,M=(u.scrollTop-T)*v}if(k){let T=u.scrollLeft;u.scrollLeft+=k/y,_=(u.scrollLeft-T)*y}e={left:e.left-_,top:e.top-M,right:e.right-_,bottom:e.bottom-M},_&&Math.abs(_-k)<1&&(r="nearest"),M&&Math.abs(M-x)<1&&(i="nearest")}if(g)break;(e.top<p.top||e.bottom>p.bottom||e.left<p.left||e.right>p.right)&&(e={left:Math.max(e.left,p.left),right:Math.min(e.right,p.right),top:Math.max(e.top,p.top),bottom:Math.min(e.bottom,p.bottom)}),u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function p7(n){let e=n.ownerDocument,t,r;for(let i=n.parentNode;i&&!(i==e.body||t&&r);)if(i.nodeType==1)!r&&i.scrollHeight>i.clientHeight&&(r=i),!t&&i.scrollWidth>i.clientWidth&&(t=i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;return{x:t,y:r}}class m7{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?Es(t):0),r,Math.min(e.focusOffset,r?Es(r):0))}set(e,t,r,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=i}}let ql=null;Oe.safari&&Oe.safari_version>=26&&(ql=!1);function w2(n){if(n.setActive)return n.setActive();if(ql)return n.focus(ql);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(ql==null?{get preventScroll(){return ql={preventScroll:!0},!0}}:void 0),!ql){ql=!1;for(let t=0;t<e.length;){let r=e[t++],i=e[t++],s=e[t++];r.scrollTop!=i&&(r.scrollTop=i),r.scrollLeft!=s&&(r.scrollLeft=s)}}}let t_;function Pa(n,e,t=e){let r=t_||(t_=document.createRange());return r.setEnd(n,t),r.setStart(n,e),r}function Tc(n,e,t,r){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0};r&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=r);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,n.dispatchEvent(s);let o=new KeyboardEvent("keyup",i);return o.synthetic=!0,n.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function g7(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function v2(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function y7(n,e){let t=e.focusNode,r=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=r)return!1;for(r=Math.min(r,Es(t));;)if(r){if(t.nodeType!=1)return!1;let i=t.childNodes[r-1];i.contentEditable=="false"?r--:(t=i,r=Es(t))}else{if(t==n)return!0;r=Ra(t),t=t.parentNode}}function k2(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function C2(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r>0)return{node:t,offset:r};if(t.nodeType==1&&r>0){if(t.contentEditable=="false")return null;t=t.childNodes[r-1],r=Es(t)}else if(t.parentNode&&!Ig(t))r=Ra(t),t=t.parentNode;else return null}}function S2(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r<t.nodeValue.length)return{node:t,offset:r};if(t.nodeType==1&&r<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[r],r=0}else if(t.parentNode&&!Ig(t))r=Ra(t)+1,t=t.parentNode;else return null}}class or{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new or(e.parentNode,Ra(e),t)}static after(e,t){return new or(e.parentNode,Ra(e)+1,t)}}const jv=[];class Pt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let r of this.children){if(r==e)return t;t+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let r=this.dom,i=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=i?i.nextSibling:r.firstChild)){let l=Pt.get(s);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,t),o.flags&=-8}if(s=i?i.nextSibling:r.firstChild,t&&!t.written&&t.node==r&&s!=o.dom&&(t.written=!0),o.dom.parentNode==r)for(;s&&s!=o.dom;)s=n_(s);else r.insertBefore(o.dom,s);i=o.dom}for(s=i?i.nextSibling:r.firstChild,s&&t&&t.node==r&&(t.written=!0);s;)s=n_(s)}else if(this.flags&1)for(let r of this.children)r.flags&7&&(r.sync(e,t),r.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let r;if(e==this.dom)r=this.dom.childNodes[t];else{let i=Es(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;i==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?i=-1:i=1),e=s}i<0?r=e:r=e.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!Pt.get(r);)r=r.nextSibling;if(!r)return this.length;for(let i=0,s=0;;i++){let o=this.children[i];if(o.dom==r)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,r=0){let i=-1,s=-1,o=-1,l=-1;for(let a=0,c=r,u=r;a<this.children.length;a++){let f=this.children[a],p=c+f.length;if(c<e&&p>t)return f.domBoundsAround(e,t,c);if(p>=e&&i==-1&&(i=a,s=c),c>t&&f.dom.parentNode==this.dom){o=a,l=u;break}u=p,c=p+f.breakAfter}return{from:s,to:l<0?r+this.length:l,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,r=jv){this.markDirty();for(let i=e;i<t;i++){let s=this.children[i];s.parent==this&&r.indexOf(s)<0&&s.destroy()}r.length<250?this.children.splice(e,t-e,...r):this.children=[].concat(this.children.slice(0,e),r,this.children.slice(t));for(let i=0;i<r.length;i++)r[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new x2(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,r,i,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}Pt.prototype.breakAfter=0;function n_(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class x2{constructor(e,t,r){this.children=e,this.pos=t,this.i=r,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function _2(n,e,t,r,i,s,o,l,a){let{children:c}=n,u=c.length?c[e]:null,f=s.length?s[s.length-1]:null,p=f?f.breakAfter:o;if(!(e==r&&u&&!o&&!p&&s.length<2&&u.merge(t,i,s.length?f:null,t==0,l,a))){if(r<c.length){let g=c[r];g&&(i<g.length||g.breakAfter&&(f!=null&&f.breakAfter))?(e==r&&(g=g.split(i),i=0),!p&&f&&g.merge(0,i,f,!0,0,a)?s[s.length-1]=g:((i||g.children.length&&!g.children[0].length)&&g.merge(0,i,null,!1,0,a),s.push(g))):g!=null&&g.breakAfter&&(f?f.breakAfter=1:o=1),r++}for(u&&(u.breakAfter=o,t>0&&(!o&&s.length&&u.merge(t,u.length,s[0],!1,l,0)?u.breakAfter=s.shift().breakAfter:(t<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(t,u.length,null,!1,l,0),e++));e<r&&s.length;)if(c[r-1].become(s[s.length-1]))r--,s.pop(),a=s.length?0:l;else if(c[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&r<c.length&&!c[e-1].breakAfter&&c[r].merge(0,0,c[e-1],!1,l,a)&&e--,(e<r||s.length)&&n.replaceChildren(e,r,s)}}function M2(n,e,t,r,i,s){let o=n.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:c,off:u}=o.findPos(e,-1),f=e-t;for(let p of r)f+=p.length;n.length+=f,_2(n,c,u,l,a,r,0,i,s)}const b7=256;class Gi extends Pt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,r){return this.flags&8||r&&(!(r instanceof Gi)||this.length-(t-e)+r.length>b7||r.flags&8)?!1:(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Gi(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new or(this.dom,e)}domBoundsAround(e,t,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return w7(this.dom,e,t)}}class vo extends Pt{constructor(e,t=[],r=0){super(),this.mark=e,this.children=t,this.length=r;for(let i of t)i.setParent(this)}setAttrs(e){if(v2(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,r,i,s,o){return r&&(!(r instanceof vo&&r.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(M2(this,e,t,r?r.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],r=0,i=-1,s=0;for(let l of this.children){let a=r+l.length;a>e&&t.push(r<e?l.split(e-r):l),i<0&&r>=e&&(i=s),r=a,s++}let o=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new vo(this.mark,t,o)}domAtPos(e){return T2(this,e)}coordsAt(e,t){return A2(this,e,t)}}function w7(n,e,t){let r=n.nodeValue.length;e>r&&(e=r);let i=e,s=e,o=0;e==0&&t<0||e==r&&t>=0?Oe.chrome||Oe.gecko||(e?(i--,o=1):s<r&&(s++,o=-1)):t<0?i--:s<r&&s++;let l=Pa(n,i,s).getClientRects();if(!l.length)return null;let a=l[(o?o<0:t>=0)?0:l.length-1];return Oe.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,c=>c.width)||a),o?L0(a,o<0):a||null}class il extends Pt{static create(e,t,r){return new il(e,t,r)}constructor(e,t,r){super(),this.widget=e,this.length=t,this.side=r,this.prevWidget=null}split(e){let t=il.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,r,i,s,o){return r&&(!(r instanceof il)||!this.widget.compare(r.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-t),!0)}become(e){return e instanceof il&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Tt.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,r=t&&t.state.doc,i=this.posAtStart;return r?r.slice(i,i+this.length):Tt.empty}domAtPos(e){return(this.length?e==0:this.side>0)?or.before(this.dom):or.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let r=this.widget.coordsAt(this.dom,e,t);if(r)return r;let i=this.dom.getClientRects(),s=null;if(!i.length)return null;let o=this.side?this.side<0:e>0;for(let l=o?i.length-1:0;s=i[l],!(e>0?l==0:l==i.length-1||s.top<s.bottom);l+=o?-1:1);return L0(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class du extends Pt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof du&&e.side==this.side}split(){return new du(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?or.before(this.dom):or.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Tt.empty}get isHidden(){return!0}}Gi.prototype.children=il.prototype.children=du.prototype.children=jv;function T2(n,e){let t=n.dom,{children:r}=n,i=0;for(let s=0;i<r.length;i++){let o=r[i],l=s+o.length;if(!(l==s&&o.getSide()<=0)){if(e>s&&e<l&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=l}}for(let s=i;s>0;s--){let o=r[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=i;s<r.length;s++){let o=r[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new or(t,0)}function E2(n,e,t){let r,{children:i}=n;t>0&&e instanceof vo&&i.length&&(r=i[i.length-1])instanceof vo&&r.mark.eq(e.mark)?E2(r,e.children[0],t-1):(i.push(e),e.setParent(n)),n.length+=e.length}function A2(n,e,t){let r=null,i=-1,s=null,o=-1;function l(c,u){for(let f=0,p=0;f<c.children.length&&p<=u;f++){let g=c.children[f],y=p+g.length;y>=u&&(g.children.length?l(g,u-p):(!s||s.isHidden&&(t>0||k7(s,g)))&&(y>u||p==y&&g.getSide()>0)?(s=g,o=u-p):(p<u||p==y&&g.getSide()<0&&!g.isHidden)&&(r=g,i=u-p)),p=y}}l(n,e);let a=(t<0?r:s)||r||s;return a?a.coordsAt(Math.max(0,a==r?i:o),t):v7(n)}function v7(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=Wh(e);return t[t.length-1]||null}function k7(n,e){let t=n.coordsAt(0,1),r=e.coordsAt(0,1);return t&&r&&r.top<t.bottom}function zb(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const r_=Object.create(null);function Ng(n,e,t){if(n==e)return!0;n||(n=r_),e||(e=r_);let r=Object.keys(n),i=Object.keys(e);if(r.length-(t&&r.indexOf(t)>-1?1:0)!=i.length-(t&&i.indexOf(t)>-1?1:0))return!1;for(let s of r)if(s!=t&&(i.indexOf(s)==-1||n[s]!==e[s]))return!1;return!0}function Wb(n,e,t){let r=!1;if(e)for(let i in e)t&&i in t||(r=!0,i=="style"?n.style.cssText="":n.removeAttribute(i));if(t)for(let i in t)e&&e[i]==t[i]||(r=!0,i=="style"?n.style.cssText=t[i]:n.setAttribute(i,t[i]));return r}function C7(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let r=n.attributes[t];e[r.name]=r.value}return e}let To=class{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}};var xr=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(xr||(xr={}));let Je=class extends Na{constructor(e,t,r,i){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=i}get heightRelevant(){return!1}static mark(e){return new Zd(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new yl(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,i;if(e.isBlockGap)r=-5e8,i=4e8;else{let{start:s,end:o}=O2(e,t);r=(s?t?-3e8:-1:5e8)-1,i=(o?t?2e8:1:-6e8)+1}return new yl(e,r,i,t,e.widget||null,!0)}static line(e){return new Yd(e)}static set(e,t=!1){return xt.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}};Je.none=xt.empty;class Zd extends Je{constructor(e){let{start:t,end:r}=O2(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,r;return this==e||e instanceof Zd&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((r=e.attrs)===null||r===void 0?void 0:r.class))&&Ng(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Zd.prototype.point=!1;class Yd extends Je{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Yd&&this.spec.class==e.spec.class&&Ng(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Yd.prototype.mapMode=Yn.TrackBefore;Yd.prototype.point=!0;class yl extends Je{constructor(e,t,r,i,s,o){super(t,r,s,e),this.block=i,this.isReplace=o,this.mapMode=i?t<=0?Yn.TrackBefore:Yn.TrackAfter:Yn.TrackDel}get type(){return this.startSide!=this.endSide?xr.WidgetRange:this.startSide<=0?xr.WidgetBefore:xr.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof yl&&S7(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}yl.prototype.point=!0;function O2(n,e=!1){let{inclusiveStart:t,inclusiveEnd:r}=n;return t==null&&(t=n.inclusive),r==null&&(r=n.inclusive),{start:t??e,end:r??e}}function S7(n,e){return n==e||!!(n&&e&&n.compare(e))}function Om(n,e,t,r=0){let i=t.length-1;i>=0&&t[i]+r>=n?t[i]=Math.max(t[i],e):t.push(n,e)}class _n extends Pt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,r,i,s,o){if(r){if(!(r instanceof _n))return!1;this.dom||r.transferDOM(this)}return i&&this.setDeco(r?r.attrs:null),M2(this,e,t,r?r.children.slice():[],s,o),!0}split(e){let t=new _n;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:r,off:i}=this.childPos(e);i&&(t.append(this.children[r].split(i),0),this.children[r].merge(i,this.children[r].length,null,!1,0,0),r++);for(let s=r;s<this.children.length;s++)t.append(this.children[s],0);for(;r>0&&this.children[r-1].length==0;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Ng(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){E2(this,e,t)}addLineDeco(e){let t=e.spec.attributes,r=e.spec.class;t&&(this.attrs=zb(t,this.attrs||{})),r&&(this.attrs=zb({class:r},this.attrs||{}))}domAtPos(e){return T2(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var r;this.dom?this.flags&4&&(v2(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Wb(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let i=this.dom.lastChild;for(;i&&Pt.get(i)instanceof vo;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((r=Pt.get(i))===null||r===void 0?void 0:r.isEditable)==!1&&(!Oe.ios||!this.children.some(s=>s instanceof Gi))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let r of this.children){if(!(r instanceof Gi)||/[^ -~]/.test(r.text))return null;let i=Wh(r.dom);if(i.length!=1)return null;e+=i[0].width,t=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let r=A2(this,e,t);if(!this.children.length&&r&&this.parent){let{heightOracle:i}=this.parent.view.viewState,s=r.bottom-r.top;if(Math.abs(s-i.lineHeight)<2&&i.textHeight<s){let o=(s-i.textHeight)/2;return{top:r.top+o,bottom:r.bottom-o,left:r.left,right:r.left}}}return r}become(e){return e instanceof _n&&this.children.length==0&&e.children.length==0&&Ng(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let r=0,i=0;r<e.children.length;r++){let s=e.children[r],o=i+s.length;if(o>=t){if(s instanceof _n)return s;if(o>t)break}i=o+s.breakAfter}return null}}class go extends Pt{constructor(e,t,r){super(),this.widget=e,this.length=t,this.deco=r,this.breakAfter=0,this.prevWidget=null}merge(e,t,r,i,s,o){return r&&(!(r instanceof go)||!this.widget.compare(r.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?or.before(this.dom):or.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let r=new go(this.widget,t,this.deco);return r.breakAfter=this.breakAfter,r}get children(){return jv}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Tt.empty}domBoundsAround(){return null}become(e){return e instanceof go&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let r=this.widget.coordsAt(this.dom,e,t);return r||(this.widget instanceof qb?null:L0(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:r}=this.deco;return t==r?!1:e<0?t<0:r>0}}class qb extends To{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class lh{constructor(e,t,r,i){this.doc=e,this.pos=t,this.end=r,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof go&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new _n),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append($p(new du(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof go)&&this.getLine()}buildText(e,t,r){for(;e>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:l,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(l){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=o,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e),s=Math.min(i,512);this.flushBuffer(t.slice(t.length-r)),this.getLine().append($p(new Gi(this.text.slice(this.textOff,this.textOff+s)),t),r),this.atCursorPos=!0,this.textOff+=s,e-=s,r=i<=s?0:t.length}}span(e,t,r,i){this.buildText(t-e,r,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,r,i,s,o){if(this.disallowBlockEffectsFor[o]&&r instanceof yl){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=t-e;if(r instanceof yl)if(r.block)r.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new go(r.widget||pu.block,l,r));else{let a=il.create(r.widget||pu.inline,l,l?0:r.startSide),c=this.atCursorPos&&!a.isEditable&&s<=i.length&&(e<t||r.startSide>0),u=!a.isEditable&&(e<t||s>i.length||r.startSide<=0),f=this.getLine();this.pendingBuffer==2&&!c&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),c&&(f.append($p(new du(1),i),s),s=i.length+Math.max(0,s-i.length)),f.append($p(a,i),s),this.atCursorPos=u,this.pendingBuffer=u?e<t||s>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,r,i,s){let o=new lh(e,t,r,s);return o.openEnd=xt.spans(i,t,r,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function $p(n,e){for(let t of e)n=new vo(t,[n],n.length);return n}class pu extends To{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}pu.inline=new pu("span");pu.block=new pu("div");var tn=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(tn||(tn={}));const Ba=tn.LTR,$v=tn.RTL;function L2(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const x7=L2("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),_7=L2("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Ub=Object.create(null),as=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);Ub[e]=t,Ub[t]=-e}function D2(n){return n<=247?x7[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?_7[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const M7=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class sl{get dir(){return this.level%2?$v:Ba}constructor(e,t,r){this.from=e,this.to=t,this.level=r}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,r,i){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=t&&l.to>=t){if(l.level==r)return o;(s<0||(i!=0?i<0?l.from<t:l.to>t:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function I2(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let r=n[t],i=e[t];if(r.from!=i.from||r.to!=i.to||r.direction!=i.direction||!I2(r.inner,i.inner))return!1}return!0}const Vt=[];function T7(n,e,t,r,i){for(let s=0;s<=r.length;s++){let o=s?r[s-1].to:e,l=s<r.length?r[s].from:t,a=s?256:i;for(let c=o,u=a,f=a;c<l;c++){let p=D2(n.charCodeAt(c));p==512?p=u:p==8&&f==4&&(p=16),Vt[c]=p==4?2:p,p&7&&(f=p),u=p}for(let c=o,u=a,f=a;c<l;c++){let p=Vt[c];if(p==128)c<l-1&&u==Vt[c+1]&&u&24?p=Vt[c]=u:Vt[c]=256;else if(p==64){let g=c+1;for(;g<l&&Vt[g]==64;)g++;let y=c&&u==8||g<t&&Vt[g]==8?f==1?1:8:256;for(let v=c;v<g;v++)Vt[v]=y;c=g-1}else p==8&&f==1&&(Vt[c]=1);u=p,p&7&&(f=p)}}}function E7(n,e,t,r,i){let s=i==1?2:1;for(let o=0,l=0,a=0;o<=r.length;o++){let c=o?r[o-1].to:e,u=o<r.length?r[o].from:t;for(let f=c,p,g,y;f<u;f++)if(g=Ub[p=n.charCodeAt(f)])if(g<0){for(let v=l-3;v>=0;v-=3)if(as[v+1]==-g){let k=as[v+2],x=k&2?i:k&4?k&1?s:i:0;x&&(Vt[f]=Vt[as[v]]=x),l=v;break}}else{if(as.length==189)break;as[l++]=f,as[l++]=p,as[l++]=a}else if((y=Vt[f])==2||y==1){let v=y==i;a=v?0:1;for(let k=l-3;k>=0;k-=3){let x=as[k+2];if(x&2)break;if(v)as[k+2]|=2;else{if(x&4)break;as[k+2]|=4}}}}}function A7(n,e,t,r){for(let i=0,s=r;i<=t.length;i++){let o=i?t[i-1].to:n,l=i<t.length?t[i].from:e;for(let a=o;a<l;){let c=Vt[a];if(c==256){let u=a+1;for(;;)if(u==l){if(i==t.length)break;u=t[i++].to,l=i<t.length?t[i].from:e}else if(Vt[u]==256)u++;else break;let f=s==1,p=(u<e?Vt[u]:r)==1,g=f==p?f?1:2:r;for(let y=u,v=i,k=v?t[v-1].to:n;y>a;)y==k&&(y=t[--v].from,k=v?t[v-1].to:n),Vt[--y]=g;a=u}else s=c,a++}}}function Kb(n,e,t,r,i,s,o){let l=r%2?2:1;if(r%2==i%2)for(let a=e,c=0;a<t;){let u=!0,f=!1;if(c==s.length||a<s[c].from){let v=Vt[a];v!=l&&(u=!1,f=v==16)}let p=!u&&l==1?[]:null,g=u?r:r+1,y=a;e:for(;;)if(c<s.length&&y==s[c].from){if(f)break e;let v=s[c];if(!u)for(let k=v.to,x=c+1;;){if(k==t)break e;if(x<s.length&&s[x].from==k)k=s[x++].to;else{if(Vt[k]==l)break e;break}}if(c++,p)p.push(v);else{v.from>a&&o.push(new sl(a,v.from,g));let k=v.direction==Ba!=!(g%2);Gb(n,k?r+1:r,i,v.inner,v.from,v.to,o),a=v.to}y=v.to}else{if(y==t||(u?Vt[y]!=l:Vt[y]==l))break;y++}p?Kb(n,a,y,r+1,i,p,o):a<y&&o.push(new sl(a,y,g)),a=y}else for(let a=t,c=s.length;a>e;){let u=!0,f=!1;if(!c||a>s[c-1].to){let v=Vt[a-1];v!=l&&(u=!1,f=v==16)}let p=!u&&l==1?[]:null,g=u?r:r+1,y=a;e:for(;;)if(c&&y==s[c-1].to){if(f)break e;let v=s[--c];if(!u)for(let k=v.from,x=c;;){if(k==e)break e;if(x&&s[x-1].to==k)k=s[--x].from;else{if(Vt[k-1]==l)break e;break}}if(p)p.push(v);else{v.to<a&&o.push(new sl(v.to,a,g));let k=v.direction==Ba!=!(g%2);Gb(n,k?r+1:r,i,v.inner,v.from,v.to,o),a=v.from}y=v.from}else{if(y==e||(u?Vt[y-1]!=l:Vt[y-1]==l))break;y--}p?Kb(n,y,a,r+1,i,p,o):y<a&&o.push(new sl(y,a,g)),a=y}}function Gb(n,e,t,r,i,s,o){let l=e%2?2:1;T7(n,i,s,r,l),E7(n,i,s,r,l),A7(i,s,r,l),Kb(n,i,s,e,t,r,o)}function O7(n,e,t){if(!n)return[new sl(0,0,e==$v?1:0)];if(e==Ba&&!t.length&&!M7.test(n))return N2(n.length);if(t.length)for(;n.length>Vt.length;)Vt[Vt.length]=256;let r=[],i=e==Ba?0:1;return Gb(n,i,i,t,0,n.length,r),r}function N2(n){return[new sl(0,n,0)]}let R2="";function L7(n,e,t,r,i){var s;let o=r.head-n.from,l=sl.find(e,o,(s=r.bidiLevel)!==null&&s!==void 0?s:-1,r.assoc),a=e[l],c=a.side(i,t);if(o==c){let p=l+=i?1:-1;if(p<0||p>=e.length)return null;a=e[l=p],o=a.side(!i,t),c=a.side(i,t)}let u=Xn(n.text,o,a.forward(i,t));(u<a.from||u>a.to)&&(u=c),R2=n.text.slice(Math.min(o,u),Math.max(o,u));let f=l==(i?e.length-1:0)?null:e[l+(i?1:-1)];return f&&u==c&&f.level+(i?0:1)<a.level?re.cursor(f.side(!i,t)+n.from,f.forward(i,t)?1:-1,f.level):re.cursor(u+n.from,a.forward(i,t)?-1:1,a.level)}function D7(n,e,t){for(let r=e;r<t;r++){let i=D2(n.charCodeAt(r));if(i==1)return Ba;if(i==2||i==4)return $v}return Ba}const P2=Ie.define(),B2=Ie.define(),H2=Ie.define(),V2=Ie.define(),Jb=Ie.define(),F2=Ie.define(),j2=Ie.define(),zv=Ie.define(),Wv=Ie.define(),$2=Ie.define({combine:n=>n.some(e=>e)}),z2=Ie.define({combine:n=>n.some(e=>e)}),W2=Ie.define();class Ec{constructor(e,t="nearest",r="nearest",i=5,s=5,o=!1){this.range=e,this.y=t,this.x=r,this.yMargin=i,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new Ec(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ec(re.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const zp=it.define({map:(n,e)=>n.map(e)}),q2=it.define();function jr(n,e,t){let r=n.facet(V2);r.length?r[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const ao=Ie.define({combine:n=>n.length?n[0]:!0});let I7=0;const Sc=Ie.define({combine(n){return n.filter((e,t)=>{for(let r=0;r<t;r++)if(n[r].plugin==e.plugin)return!1;return!0})}});class En{constructor(e,t,r,i,s){this.id=e,this.create=t,this.domEventHandlers=r,this.domEventObservers=i,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(Sc.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Sc.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:r,eventObservers:i,provide:s,decorations:o}=t||{};return new En(I7++,e,r,i,l=>{let a=[];return o&&a.push(qh.of(c=>{let u=c.plugin(l);return u?o(u):Je.none})),s&&a.push(s(l)),a})}static fromClass(e,t){return En.define((r,i)=>new e(r,i),t)}}class Zy{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(r){if(jr(t.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){jr(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(r){jr(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const U2=Ie.define(),qv=Ie.define(),qh=Ie.define(),K2=Ie.define(),Xd=Ie.define(),G2=Ie.define();function i_(n,e){let t=n.state.facet(G2);if(!t.length)return t;let r=t.map(s=>s instanceof Function?s(n):s),i=[];return xt.spans(r,e.from,e.to,{point(){},span(s,o,l,a){let c=s-e.from,u=o-e.from,f=i;for(let p=l.length-1;p>=0;p--,a--){let g=l[p].spec.bidiIsolate,y;if(g==null&&(g=D7(e.text,c,u)),a>0&&f.length&&(y=f[f.length-1]).to==c&&y.direction==g)y.to=u,f=y.inner;else{let v={from:c,to:u,direction:g,inner:[]};f.push(v),f=v.inner}}}}),i}const J2=Ie.define();function Uv(n){let e=0,t=0,r=0,i=0;for(let s of n.state.facet(J2)){let o=s(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(r=Math.max(r,o.top)),o.bottom!=null&&(i=Math.max(i,o.bottom)))}return{left:e,right:t,top:r,bottom:i}}const vf=Ie.define();class ki{constructor(e,t,r,i){this.fromA=e,this.toA=t,this.fromB=r,this.toB=i}join(e){return new ki(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>r.toA)){if(i.toA<r.fromA)break;r=r.join(i),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(t.length==0)return e;let r=[];for(let i=0,s=0,o=0,l=0;;i++){let a=i==e.length?null:e[i],c=o-l,u=a?a.fromB:1e9;for(;s<t.length&&t[s]<u;){let f=t[s],p=t[s+1],g=Math.max(l,f),y=Math.min(u,p);if(g<=y&&new ki(g+c,y+c,g,y).addToSet(r),p>u)break;s+=2}if(!a)return r;new ki(a.fromA,a.toA,a.fromB,a.toB).addToSet(r),o=a.toA,l=a.toB}}}class Rg{constructor(e,t,r){this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=Ln.empty(this.startState.doc.length);for(let s of r)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,o,l,a)=>i.push(new ki(s,o,l,a))),this.changedRanges=i}static create(e,t,r){return new Rg(e,t,r)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class s_ extends Pt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Je.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new _n],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ki(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let r=e.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?i=this.domChanged.newSel.head:!F7(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let s=i>-1?R7(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:u}=this.hasComposition;r=new ki(c,u,e.changes.mapPos(c,-1),e.changes.mapPos(u,1)).addToSet(r.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Oe.ie||Oe.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),a=H7(o,l,e.changes);return r=ki.extendWithRanges(r,a),!(this.flags&7)&&r.length==0?!1:(this.updateInner(r,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,r);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=Oe.chrome||Oe.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||i.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof go&&o.widget instanceof qb&&s.push(o.dom);i.updateGaps(s)}updateChildren(e,t,r){let i=r?r.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let o=i.length-1;;o--){let l=o>=0?i[o]:null;if(!l)break;let{fromA:a,toA:c,fromB:u,toB:f}=l,p,g,y,v;if(r&&r.range.fromB<f&&r.range.toB>u){let T=lh.build(this.view.state.doc,u,r.range.fromB,this.decorations,this.dynamicDecorationMap),S=lh.build(this.view.state.doc,r.range.toB,f,this.decorations,this.dynamicDecorationMap);g=T.breakAtStart,y=T.openStart,v=S.openEnd;let A=this.compositionView(r);S.breakAtStart?A.breakAfter=1:S.content.length&&A.merge(A.length,A.length,S.content[0],!1,S.openStart,0)&&(A.breakAfter=S.content[0].breakAfter,S.content.shift()),T.content.length&&A.merge(0,0,T.content[T.content.length-1],!0,0,T.openEnd)&&T.content.pop(),p=T.content.concat(A).concat(S.content)}else({content:p,breakAtStart:g,openStart:y,openEnd:v}=lh.build(this.view.state.doc,u,f,this.decorations,this.dynamicDecorationMap));let{i:k,off:x}=s.findPos(c,1),{i:_,off:M}=s.findPos(a,-1);_2(this,_,M,k,x,p,g,y,v)}r&&this.fixCompositionDOM(r)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let r of t.effects)r.is(q2)&&(this.editContextFormatting=r.value)}compositionView(e){let t=new Gi(e.text.nodeValue);t.flags|=8;for(let{deco:i}of e.marks)t=new vo(i,[t],t.length);let r=new _n;return r.append(t,0),r}fixCompositionDOM(e){let t=(s,o)=>{o.flags|=8|(o.children.some(a=>a.flags&7)?1:0),this.markedForComposition.add(o);let l=Pt.get(s);l&&l!=o&&(l.dom=null),o.setDOM(s)},r=this.childPos(e.range.fromB,1),i=this.children[r.i];t(e.line,i);for(let s=e.marks.length-1;s>=-1;s--)r=i.childPos(r.off,1),i=i.children[r.i],t(s>=0?e.marks[s].node:e.text,i)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,i=r==this.dom,s=!i&&!(this.view.state.facet(ao)||this.dom.tabIndex>-1)&&Am(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(i||t||s))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),c=l.empty?a:this.moveToLine(this.domAtPos(l.head));if(Oe.gecko&&l.empty&&!this.hasComposition&&N7(a)){let f=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(f,a.node.childNodes[a.offset]||null)),a=c=new or(f,0),o=!0}let u=this.view.observer.selectionRange;(o||!u.focusNode||(!oh(a.node,a.offset,u.anchorNode,u.anchorOffset)||!oh(c.node,c.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,l))&&(this.view.observer.ignore(()=>{Oe.android&&Oe.chrome&&this.dom.contains(u.focusNode)&&V7(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let f=zh(this.view.root);if(f)if(l.empty){if(Oe.gecko){let p=P7(a.node,a.offset);if(p&&p!=3){let g=(p==1?C2:S2)(a.node,a.offset);g&&(a=new or(g.node,g.offset))}}f.collapse(a.node,a.offset),l.bidiLevel!=null&&f.caretBidiLevel!==void 0&&(f.caretBidiLevel=l.bidiLevel)}else if(f.extend){f.collapse(a.node,a.offset);try{f.extend(c.node,c.offset)}catch{}}else{let p=document.createRange();l.anchor>l.head&&([a,c]=[c,a]),p.setEnd(c.node,c.offset),p.setStart(a.node,a.offset),f.removeAllRanges(),f.addRange(p)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(a,c)),this.impreciseAnchor=a.precise?null:new or(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new or(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&oh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,r=zh(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!r||!t.empty||!t.assoc||!r.modify)return;let o=_n.find(this,t.head);if(!o)return;let l=o.posAtStart;if(t.head==l||t.head==l+o.length)return;let a=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!a||!c||a.bottom>c.top)return;let u=this.domAtPos(t.head+t.assoc);r.collapse(u.node,u.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let f=e.observer.selectionRange;e.docView.posFromDOM(f.anchorNode,f.anchorOffset)!=t.from&&r.collapse(i,s)}moveToLine(e){let t=this.dom,r;if(e.node!=t)return e;for(let i=e.offset;!r&&i<t.childNodes.length;i++){let s=Pt.get(t.childNodes[i]);s instanceof _n&&(r=s.domAtPos(0))}for(let i=e.offset-1;!r&&i>=0;i--){let s=Pt.get(t.childNodes[i]);s instanceof _n&&(r=s.domAtPos(s.length))}return r?new or(r.node,r.offset,!0):e}nearest(e){for(let t=e;t;){let r=Pt.get(t);if(r&&r.rootView==this)return r;t=t.parentNode}return null}posFromDOM(e,t){let r=this.nearest(e);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(e,t)+r.posAtStart}domAtPos(e){let{i:t,off:r}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let i=this.children[t];if(r<i.length||i instanceof _n)break;t++,r=0}return this.children[t].domAtPos(r)}coordsAt(e,t){let r=null,i=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],a=s-l.breakAfter,c=a-l.length;if(a<e)break;if(c<=e&&(c<e||l.covers(-1))&&(a>e||l.covers(1))&&(!r||l instanceof _n&&!(r instanceof _n&&t>=0)))r=l,i=c;else if(r&&c==e&&a==e&&l instanceof go&&Math.abs(t)<2){if(l.deco.startSide<0)break;o&&(r=null)}s=c}return r?r.coordsAt(e-i,t):null}coordsForChar(e){let{i:t,off:r}=this.childPos(e,1),i=this.children[t];if(!(i instanceof _n))return null;for(;i.children.length;){let{i:l,off:a}=i.childPos(r,1);for(;;l++){if(l==i.children.length)return null;if((i=i.children[l]).length)break}r=a}if(!(i instanceof Gi))return null;let s=Xn(i.text,r);if(s==r)return null;let o=Pa(i.dom,r,s).getClientRects();for(let l=0;l<o.length;l++){let a=o[l];if(l==o.length-1||a.top<a.bottom&&a.left<a.right)return a}return null}measureVisibleLineHeights(e){let t=[],{from:r,to:i}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==tn.LTR;for(let c=0,u=0;u<this.children.length;u++){let f=this.children[u],p=c+f.length;if(p>i)break;if(c>=r){let g=f.dom.getBoundingClientRect();if(t.push(g.height),o){let y=f.dom.lastChild,v=y?Wh(y):[];if(v.length){let k=v[v.length-1],x=a?k.right-g.left:g.right-k.left;x>l&&(l=x,this.minWidth=s,this.minWidthFrom=c,this.minWidthTo=p)}}}c=p+f.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?tn.RTL:tn.LTR}measureTextSize(){for(let s of this.children)if(s instanceof _n){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),t,r,i;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Wh(e.firstChild)[0];t=e.getBoundingClientRect().height,r=s?s.width/27:7,i=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:r,textHeight:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new x2(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,i=0;;i++){let s=i==t.viewports.length?null:t.viewports[i],o=s?s.from-1:this.length;if(o>r){let l=(t.lineBlockAt(o).bottom-t.lineBlockAt(r).top)/this.view.scaleY;e.push(Je.replace({widget:new qb(l),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!s)break;r=s.to+1}return Je.set(e)}updateDeco(){let e=1,t=this.view.state.facet(qh).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),r=!1,i=this.view.state.facet(K2).map((s,o)=>{let l=typeof s=="function";return l&&(r=!0),l?s(this.view):s});for(i.length&&(this.dynamicDecorationMap[e++]=r,t.push(xt.join(i))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(W2))try{if(c(this.view,e.range,e))return!0}catch(u){jr(this.view.state,u,"scroll handler")}let{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),i;if(!r)return;!t.empty&&(i=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,i.left),top:Math.min(r.top,i.top),right:Math.max(r.right,i.right),bottom:Math.max(r.bottom,i.bottom)});let s=Uv(this.view),o={left:r.left-s.left,top:r.top-s.top,right:r.right+s.right,bottom:r.bottom+s.bottom},{offsetWidth:l,offsetHeight:a}=this.view.scrollDOM;d7(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==tn.LTR)}}function N7(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function Z2(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let r=C2(t.focusNode,t.focusOffset),i=S2(t.focusNode,t.focusOffset),s=r||i;if(i&&r&&i.node!=r.node){let l=Pt.get(i.node);if(!l||l instanceof Gi&&l.text!=i.node.nodeValue)s=i;else if(n.docView.lastCompositionAfterCursor){let a=Pt.get(r.node);!a||a instanceof Gi&&a.text!=r.node.nodeValue||(s=i)}}if(n.docView.lastCompositionAfterCursor=s!=r,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function R7(n,e,t){let r=Z2(n,t);if(!r)return null;let{node:i,from:s,to:o}=r,l=i.nodeValue;if(/[\n\r]/.test(l)||n.state.doc.sliceString(r.from,r.to)!=l)return null;let a=e.invertedDesc,c=new ki(a.mapPos(s),a.mapPos(o),s,o),u=[];for(let f=i.parentNode;;f=f.parentNode){let p=Pt.get(f);if(p instanceof vo)u.push({node:f,deco:p.mark});else{if(p instanceof _n||f.nodeName=="DIV"&&f.parentNode==n.contentDOM)return{range:c,text:i,marks:u,line:f};if(f!=n.contentDOM)u.push({node:f,deco:new Zd({inclusive:!0,attributes:C7(f),tagName:f.tagName.toLowerCase()})});else return null}}}function P7(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let B7=class{constructor(){this.changes=[]}compareRange(e,t){Om(e,t,this.changes)}comparePoint(e,t){Om(e,t,this.changes)}boundChange(e){Om(e,e,this.changes)}};function H7(n,e,t){let r=new B7;return xt.compare(n,e,t,r),r.changes}function V7(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function F7(n,e){let t=!1;return e&&n.iterChangedRanges((r,i)=>{r<e.to&&i>e.from&&(t=!0)}),t}function j7(n,e,t=1){let r=n.charCategorizer(e),i=n.doc.lineAt(e),s=e-i.from;if(i.length==0)return re.cursor(e);s==0?t=1:s==i.length&&(t=-1);let o=s,l=s;t<0?o=Xn(i.text,s,!1):l=Xn(i.text,s);let a=r(i.text.slice(o,l));for(;o>0;){let c=Xn(i.text,o,!1);if(r(i.text.slice(c,o))!=a)break;o=c}for(;l<i.length;){let c=Xn(i.text,l);if(r(i.text.slice(l,c))!=a)break;l=c}return re.range(o+i.from,l+i.from)}function $7(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function z7(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function Yy(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function o_(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function l_(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function Zb(n,e,t){let r,i,s,o,l=!1,a,c,u,f;for(let y=n.firstChild;y;y=y.nextSibling){let v=Wh(y);for(let k=0;k<v.length;k++){let x=v[k];i&&Yy(i,x)&&(x=o_(l_(x,i.bottom),i.top));let _=$7(e,x),M=z7(t,x);if(_==0&&M==0)return y.nodeType==3?a_(y,e,t):Zb(y,e,t);(!r||o>M||o==M&&s>_)&&(r=y,i=x,s=_,o=M,l=_?e<x.left?k>0:k<v.length-1:!0),_==0?t>x.bottom&&(!u||u.bottom<x.bottom)?(a=y,u=x):t<x.top&&(!f||f.top>x.top)&&(c=y,f=x):u&&Yy(u,x)?u=l_(u,x.bottom):f&&Yy(f,x)&&(f=o_(f,x.top))}}if(u&&u.bottom>=t?(r=a,i=u):f&&f.top<=t&&(r=c,i=f),!r)return{node:n,offset:0};let p=Math.max(i.left,Math.min(i.right,e));if(r.nodeType==3)return a_(r,p,t);if(l&&r.contentEditable!="false")return Zb(r,p,t);let g=Array.prototype.indexOf.call(n.childNodes,r)+(e>=(i.left+i.right)/2?1:0);return{node:n,offset:g}}function a_(n,e,t){let r=n.nodeValue.length,i=-1,s=1e9,o=0;for(let l=0;l<r;l++){let a=Pa(n,l,l+1).getClientRects();for(let c=0;c<a.length;c++){let u=a[c];if(u.top==u.bottom)continue;o||(o=e-u.left);let f=(u.top>t?u.top-t:t-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&f<s){let p=e>=(u.left+u.right)/2,g=p;if((Oe.chrome||Oe.gecko)&&Pa(n,l).getBoundingClientRect().left==u.right&&(g=!p),f<=0)return{node:n,offset:l+(g?1:0)};i=l+(g?1:0),s=f}}}return{node:n,offset:i>-1?i:o>0?n.nodeValue.length:0}}function Y2(n,e,t,r=-1){var i,s;let o=n.contentDOM.getBoundingClientRect(),l=o.top+n.viewState.paddingTop,a,{docHeight:c}=n.viewState,{x:u,y:f}=e,p=f-l;if(p<0)return 0;if(p>c)return n.state.doc.length;for(let T=n.viewState.heightOracle.textHeight/2,S=!1;a=n.elementAtHeight(p),a.type!=xr.Text;)for(;p=r>0?a.bottom+T:a.top-T,!(p>=0&&p<=c);){if(S)return t?null:0;S=!0,r=-r}f=l+p;let g=a.from;if(g<n.viewport.from)return n.viewport.from==0?0:t?null:c_(n,o,a,u,f);if(g>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:c_(n,o,a,u,f);let y=n.dom.ownerDocument,v=n.root.elementFromPoint?n.root:y,k=v.elementFromPoint(u,f);k&&!n.contentDOM.contains(k)&&(k=null),k||(u=Math.max(o.left+1,Math.min(o.right-1,u)),k=v.elementFromPoint(u,f),k&&!n.contentDOM.contains(k)&&(k=null));let x,_=-1;if(k&&((i=n.docView.nearest(k))===null||i===void 0?void 0:i.isEditable)!=!1){if(y.caretPositionFromPoint){let T=y.caretPositionFromPoint(u,f);T&&({offsetNode:x,offset:_}=T)}else if(y.caretRangeFromPoint){let T=y.caretRangeFromPoint(u,f);T&&({startContainer:x,startOffset:_}=T)}x&&(!n.contentDOM.contains(x)||Oe.safari&&W7(x,_,u)||Oe.chrome&&q7(x,_,u))&&(x=void 0),x&&(_=Math.min(Es(x),_))}if(!x||!n.docView.dom.contains(x)){let T=_n.find(n.docView,g);if(!T)return p>a.top+a.height/2?a.to:a.from;({node:x,offset:_}=Zb(T.dom,u,f))}let M=n.docView.nearest(x);if(!M)return null;if(M.isWidget&&((s=M.dom)===null||s===void 0?void 0:s.nodeType)==1){let T=M.dom.getBoundingClientRect();return e.y<T.top||e.y<=T.bottom&&e.x<=(T.left+T.right)/2?M.posAtStart:M.posAtEnd}else return M.localPosFromDOM(x,_)+M.posAtStart}function c_(n,e,t,r,i){let s=Math.round((r-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let l=n.viewState.heightOracle.textHeight,a=Math.floor((i-t.top-(n.defaultLineHeight-l)*.5)/l);s+=a*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+Rb(o,s,n.state.tabSize)}function X2(n,e,t){let r,i=n;if(n.nodeType!=3||e!=(r=n.nodeValue.length))return!1;for(;;){let s=i.nextSibling;if(s){if(s.nodeName=="BR")break;return!1}else{let o=i.parentNode;if(!o||o.nodeName=="DIV")break;i=o}}return Pa(n,r-1,r).getBoundingClientRect().right>t}function W7(n,e,t){return X2(n,e,t)}function q7(n,e,t){if(e!=0)return X2(n,e,t);for(let i=n;;){let s=i.parentNode;if(!s||s.nodeType!=1||s.firstChild!=i)return!1;if(s.classList.contains("cm-line"))break;i=s}let r=n.nodeType==1?n.getBoundingClientRect():Pa(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-r.left>5}function Yb(n,e,t){let r=n.lineBlockAt(e);if(Array.isArray(r.type)){let i;for(let s of r.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!i||s.type==xr.Text&&(i.type!=s.type||(t<0?s.from<e:s.to>e)))&&(i=s)}}return i||r}return r}function U7(n,e,t,r){let i=Yb(n,e.head,e.assoc||-1),s=!r||i.type!=xr.Text||!(n.lineWrapping||i.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let o=n.dom.getBoundingClientRect(),l=n.textDirectionAt(i.from),a=n.posAtCoords({x:t==(l==tn.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(a!=null)return re.cursor(a,t?-1:1)}return re.cursor(t?i.to:i.from,t?-1:1)}function u_(n,e,t,r){let i=n.state.doc.lineAt(e.head),s=n.bidiSpans(i),o=n.textDirectionAt(i.from);for(let l=e,a=null;;){let c=L7(i,s,o,l,t),u=R2;if(!c){if(i.number==(t?n.state.doc.lines:1))return l;u=`
`,i=n.state.doc.line(i.number+(t?1:-1)),s=n.bidiSpans(i),c=n.visualLineSide(i,!t)}if(a){if(!a(u))return l}else{if(!r)return c;a=r(u)}l=c}}function K7(n,e,t){let r=n.state.charCategorizer(e),i=r(t);return s=>{let o=r(s);return i==on.Space&&(i=o),i==o}}function G7(n,e,t,r){let i=e.head,s=t?1:-1;if(i==(t?n.state.doc.length:0))return re.cursor(i,e.assoc);let o=e.goalColumn,l,a=n.contentDOM.getBoundingClientRect(),c=n.coordsAtPos(i,e.assoc||-1),u=n.documentTop;if(c)o==null&&(o=c.left-a.left),l=s<0?c.top:c.bottom;else{let g=n.viewState.lineBlockAt(i);o==null&&(o=Math.min(a.right-a.left,n.defaultCharacterWidth*(i-g.from))),l=(s<0?g.top:g.bottom)+u}let f=a.left+o,p=r??n.viewState.heightOracle.textHeight>>1;for(let g=0;;g+=10){let y=l+(p+g)*s,v=Y2(n,{x:f,y},!1,s);if(y<a.top||y>a.bottom||(s<0?v<i:v>i)){let k=n.docView.coordsForChar(v),x=!k||y<k.top?-1:1;return re.cursor(v,x,void 0,o)}}}function ah(n,e,t){for(;;){let r=0;for(let i of n)i.between(e-1,e+1,(s,o,l)=>{if(e>s&&e<o){let a=r||t||(e-s<o-e?-1:1);e=a<0?s:o,r=a}});if(!r)return e}}function Q2(n,e){let t=null;for(let r=0;r<e.ranges.length;r++){let i=e.ranges[r],s=null;if(i.empty){let o=ah(n,i.from,0);o!=i.from&&(s=re.cursor(o,-1))}else{let o=ah(n,i.from,-1),l=ah(n,i.to,1);(o!=i.from||l!=i.to)&&(s=re.range(i.from==i.anchor?o:l,i.from==i.head?o:l))}s&&(t||(t=e.ranges.slice()),t[r]=s)}return t?re.create(t,e.mainIndex):e}function Xy(n,e,t){let r=ah(n.state.facet(Xd).map(i=>i(n)),t.from,e.head>t.from?-1:1);return r==t.from?t:re.cursor(r,r<t.from?1:-1)}const kf="";class J7{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(ln.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=kf}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let i=e;;){this.findPointBefore(r,i);let s=this.text.length;this.readNode(i);let o=i.nextSibling;if(o==t)break;let l=Pt.get(i),a=Pt.get(o);(l&&a?l.breakAfter:(l?l.breakAfter:Ig(i))||Ig(o)&&(i.nodeName!="BR"||i.cmIgnore)&&this.text.length>s)&&!Y7(o,t)&&this.lineBreak(),i=o}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(l=i.exec(t))&&(s=l.index,o=l[0].length),this.append(t.slice(r,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);r=s+o}}readNode(e){if(e.cmIgnore)return;let t=Pt.get(e),r=t&&t.overrideDOMText;if(r!=null){this.findPointInside(e,r.length);for(let i=r.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(e.nodeType==3?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(Z7(e,r.node,r.offset)?t:0))}}function Z7(n,e,t){for(;;){if(!e||t<Es(e))return!1;if(e==n)return!0;t=Ra(e)+1,e=e.parentNode}}function Y7(n,e){let t;for(;!(n==e||!n);n=n.nextSibling){let r=Pt.get(n);if(!(r!=null&&r.isWidget||n.cmIgnore))return!1;r&&(t||(t=[])).push(r)}if(t)for(let r of t){let i=r.overrideDOMText;if(i!=null&&i.length)return!1}return!0}class f_{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class X7{constructor(e,t,r,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,r,0))){let l=s||o?[]:e6(e),a=new J7(l,e.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=t6(l,this.bounds.from)}else{let l=e.observer.selectionRange,a=s&&s.node==l.focusNode&&s.offset==l.focusOffset||!$b(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),c=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!$b(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),u=e.viewport;if((Oe.ios||Oe.chrome)&&e.state.selection.main.empty&&a!=c&&(u.from>0||u.to<e.state.doc.length)){let f=Math.min(a,c),p=Math.max(a,c),g=u.from-f,y=u.to-p;(g==0||g==1||f==0)&&(y==0||y==-1||p==e.state.doc.length)&&(a=0,c=e.state.doc.length)}this.newSel=re.single(c,a)}}}function eO(n,e){let t,{newSel:r}=e,i=n.state.selection.main,s=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:l}=e.bounds,a=i.from,c=null;(s===8||Oe.android&&e.text.length<l-o)&&(a=i.to,c="end");let u=tO(n.state.doc.sliceString(o,l,kf),e.text,a-o,c);u&&(Oe.chrome&&s==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==kf+kf&&u.toB--,t={from:o+u.from,to:o+u.toA,insert:Tt.of(e.text.slice(u.from,u.toB).split(kf))})}else r&&(!n.hasFocus&&n.state.facet(ao)||r.main.eq(i))&&(r=null);if(!t&&!r)return!1;if(!t&&e.typeOver&&!i.empty&&r&&r.main.empty?t={from:i.from,to:i.to,insert:n.state.doc.slice(i.from,i.to)}:(Oe.mac||Oe.android)&&t&&t.from==t.to&&t.from==i.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(r&&t.insert.length==2&&(r=re.single(r.main.anchor-1,r.main.head-1)),t={from:t.from,to:t.to,insert:Tt.of([t.insert.toString().replace("."," ")])}):t&&t.from>=i.from&&t.to<=i.to&&(t.from!=i.from||t.to!=i.to)&&i.to-i.from-(t.to-t.from)<=4?t={from:i.from,to:i.to,insert:n.state.doc.slice(i.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,i.to))}:Oe.chrome&&t&&t.from==t.to&&t.from==i.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(r&&(r=re.single(r.main.anchor-1,r.main.head-1)),t={from:i.from,to:i.to,insert:Tt.of([" "])}),t)return Kv(n,t,r,s);if(r&&!r.main.eq(i)){let o=!1,l="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),l=n.inputState.lastSelectionOrigin,l=="select.pointer"&&(r=Q2(n.state.facet(Xd).map(a=>a(n)),r))),n.dispatch({selection:r,scrollIntoView:o,userEvent:l}),!0}else return!1}function Kv(n,e,t,r=-1){if(Oe.ios&&n.inputState.flushIOSKey(e))return!0;let i=n.state.selection.main;if(Oe.android&&(e.to==i.to&&(e.from==i.from||e.from==i.from-1&&n.state.sliceDoc(e.from,i.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Tc(n.contentDOM,"Enter",13)||(e.from==i.from-1&&e.to==i.to&&e.insert.length==0||r==8&&e.insert.length<e.to-e.from&&e.to>i.head)&&Tc(n.contentDOM,"Backspace",8)||e.from==i.from&&e.to==i.to+1&&e.insert.length==0&&Tc(n.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,l=()=>o||(o=Q7(n,e,t));return n.state.facet(F2).some(a=>a(n,e.from,e.to,s,l))||n.dispatch(l()),!0}function Q7(n,e,t){let r,i=n.state,s=i.selection.main,o=-1;if(e.from==e.to&&e.from<s.from||e.from>s.to){let a=e.from<s.from?-1:1,c=a<0?s.from:s.to,u=ah(i.facet(Xd).map(f=>f(n)),c,a);e.from==u&&(o=u)}if(o>-1)r={changes:e,selection:re.cursor(e.from+e.insert.length,-1)};else if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let a=s.from<e.from?i.sliceDoc(s.from,e.from):"",c=s.to>e.to?i.sliceDoc(e.to,s.to):"";r=i.replaceSelection(n.state.toText(a+e.insert.sliceString(0,void 0,n.state.lineBreak)+c))}else{let a=i.changes(e),c=t&&t.main.to<=a.newLength?t.main:void 0;if(i.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let u=n.state.sliceDoc(e.from,e.to),f,p=t&&Z2(n,t.main.head);if(p){let v=e.insert.length-(e.to-e.from);f={from:p.from,to:p.to-v}}else f=n.state.doc.lineAt(s.head);let g=s.to-e.to,y=s.to-s.from;r=i.changeByRange(v=>{if(v.from==s.from&&v.to==s.to)return{changes:a,range:c||v.map(a)};let k=v.to-g,x=k-u.length;if(v.to-v.from!=y||n.state.sliceDoc(x,k)!=u||v.to>=f.from&&v.from<=f.to)return{range:v};let _=i.changes({from:x,to:k,insert:e.insert}),M=v.to-s.to;return{changes:_,range:c?re.range(Math.max(0,c.anchor+M),Math.max(0,c.head+M)):v.map(_)}})}else r={changes:a,selection:c&&i.selection.replaceRange(c)}}let l="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,l+=".compose",n.inputState.compositionFirstChange&&(l+=".start",n.inputState.compositionFirstChange=!1)),i.update(r,{userEvent:l,scrollIntoView:!0})}function tO(n,e,t,r){let i=Math.min(n.length,e.length),s=0;for(;s<i&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&n.length==e.length)return null;let o=n.length,l=e.length;for(;o>0&&l>0&&n.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(r=="end"){let a=Math.max(0,s-Math.min(o,l));t-=o+a-s}if(o<s&&n.length<e.length){let a=t<=s&&t>=o?s-t:0;s-=a,l=s+(l-o),o=s}else if(l<s){let a=t<=s&&t>=l?s-t:0;s-=a,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}function e6(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new f_(t,r)),(i!=t||s!=r)&&e.push(new f_(i,s))),e}function t6(n,e){if(n.length==0)return null;let t=n[0].pos,r=n.length==2?n[1].pos:t;return t>-1&&r>-1?re.single(t+e,r+e):null}let n6=class{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Oe.safari&&e.contentDOM.addEventListener("input",()=>null),Oe.gecko&&b6(e.contentDOM.ownerDocument)}handleEvent(e){!u6(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let r=this.handlers[e];if(r){for(let i of r.observers)i(this.view,t);for(let i of r.handlers){if(t.defaultPrevented)break;if(i(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=r6(e),r=this.handlers,i=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,l=r[s];l&&o!=!l.handlers.length&&(i.removeEventListener(s,this.handleEvent),l=null),l||i.addEventListener(s,this.handleEvent,{passive:o})}for(let s in r)s!="scroll"&&!t[s]&&i.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&rO.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Oe.android&&Oe.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return Oe.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=nO.find(r=>r.keyCode==e.keyCode))&&!e.ctrlKey||i6.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Tc(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:Oe.safari&&!Oe.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}};function h_(n,e){return(t,r)=>{try{return e.call(n,r,t)}catch(i){jr(t.state,i)}}}function r6(n){let e=Object.create(null);function t(r){return e[r]||(e[r]={observers:[],handlers:[]})}for(let r of n){let i=r.spec,s=i&&i.plugin.domEventHandlers,o=i&&i.plugin.domEventObservers;if(s)for(let l in s){let a=s[l];a&&t(l).handlers.push(h_(r.value,a))}if(o)for(let l in o){let a=o[l];a&&t(l).observers.push(h_(r.value,a))}}for(let r in Ji)t(r).handlers.push(Ji[r]);for(let r in _i)t(r).observers.push(_i[r]);return e}const nO=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],i6="dthko",rO=[16,17,18,20,91,92,224,225],Wp=6;function qp(n){return Math.max(0,n)*.7+8}function s6(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class o6{constructor(e,t,r,i){this.view=e,this.startEvent=t,this.style=r,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=p7(e.contentDOM),this.atoms=e.state.facet(Xd).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(ln.allowMultipleSelections)&&l6(e,t),this.dragging=c6(e,t)&&oO(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&s6(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,r=0,i=0,s=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:l}=this.scrollParents.y.getBoundingClientRect());let a=Uv(this.view);e.clientX-a.left<=i+Wp?t=-qp(i-e.clientX):e.clientX+a.right>=o-Wp&&(t=qp(e.clientX-o)),e.clientY-a.top<=s+Wp?r=-qp(s-e.clientY):e.clientY+a.bottom>=l-Wp&&(r=qp(e.clientY-l)),this.setScrollSpeed(t,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,r=Q2(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function l6(n,e){let t=n.state.facet(P2);return t.length?t[0](e):Oe.mac?e.metaKey:e.ctrlKey}function a6(n,e){let t=n.state.facet(B2);return t.length?t[0](e):Oe.mac?!e.altKey:!e.ctrlKey}function c6(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let r=zh(n.root);if(!r||r.rangeCount==0)return!0;let i=r.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let o=i[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function u6(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,r;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(r=Pt.get(t))&&r.ignoreEvent(e))return!1;return!0}const Ji=Object.create(null),_i=Object.create(null),iO=Oe.ie&&Oe.ie_version<15||Oe.ios&&Oe.webkit_version<604;function f6(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),sO(n,t.value)},50)}function D0(n,e,t){for(let r of n.facet(e))t=r(t,n);return t}function sO(n,e){e=D0(n.state,zv,e);let{state:t}=n,r,i=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(Xb!=null&&t.selection.ranges.every(a=>a.empty)&&Xb==s.toString()){let a=-1;r=t.changeByRange(c=>{let u=t.doc.lineAt(c.from);if(u.from==a)return{range:c};a=u.from;let f=t.toText((o?s.line(i++).text:e)+t.lineBreak);return{changes:{from:u.from,insert:f},range:re.cursor(c.from+f.length)}})}else o?r=t.changeByRange(a=>{let c=s.line(i++);return{changes:{from:a.from,to:a.to,insert:c.text},range:re.cursor(a.from+c.length)}}):r=t.replaceSelection(s);n.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}_i.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};Ji.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);_i.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};_i.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Ji.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let r of n.state.facet(H2))if(t=r(n,e),t)break;if(!t&&e.button==0&&(t=p6(n,e)),t){let r=!n.hasFocus;n.inputState.startMouseSelection(new o6(n,e,t,r)),r&&n.observer.ignore(()=>{w2(n.contentDOM);let s=n.root.activeElement;s&&!s.contains(n.contentDOM)&&s.blur()});let i=n.inputState.mouseSelection;if(i)return i.start(e),i.dragging===!1}else n.inputState.setSelectionOrigin("select.pointer");return!1};function d_(n,e,t,r){if(r==1)return re.cursor(e,t);if(r==2)return j7(n.state,e,t);{let i=_n.find(n.docView,e),s=n.state.doc.lineAt(i?i.posAtEnd:e),o=i?i.posAtStart:s.from,l=i?i.posAtEnd:s.to;return l<n.state.doc.length&&l==s.to&&l++,re.range(o,l)}}let p_=(n,e,t)=>e>=t.top&&e<=t.bottom&&n>=t.left&&n<=t.right;function h6(n,e,t,r){let i=_n.find(n.docView,e);if(!i)return 1;let s=e-i.posAtStart;if(s==0)return 1;if(s==i.length)return-1;let o=i.coordsAt(s,-1);if(o&&p_(t,r,o))return-1;let l=i.coordsAt(s,1);return l&&p_(t,r,l)?1:o&&o.bottom>=r?-1:1}function m_(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:h6(n,t,e.clientX,e.clientY)}}const d6=Oe.ie&&Oe.ie_version<=11;let g_=null,y_=0,b_=0;function oO(n){if(!d6)return n.detail;let e=g_,t=b_;return g_=n,b_=Date.now(),y_=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(y_+1)%3:1}function p6(n,e){let t=m_(n,e),r=oO(e),i=n.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),i=i.map(s.changes))},get(s,o,l){let a=m_(n,s),c,u=d_(n,a.pos,a.bias,r);if(t.pos!=a.pos&&!o){let f=d_(n,t.pos,t.bias,r),p=Math.min(f.from,u.from),g=Math.max(f.to,u.to);u=p<u.from?re.range(p,g):re.range(g,p)}return o?i.replaceRange(i.main.extend(u.from,u.to)):l&&r==1&&i.ranges.length>1&&(c=m6(i,a.pos))?c:l?i.addRange(u):re.create([u])}}}function m6(n,e){for(let t=0;t<n.ranges.length;t++){let{from:r,to:i}=n.ranges[t];if(r<=e&&i>=e)return re.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}Ji.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let i=n.docView.nearest(e.target);if(i&&i.isWidget){let s=i.posAtStart,o=s+i.length;(s>=t.to||o<=t.from)&&(t=re.range(s,o))}}let{inputState:r}=n;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",D0(n.state,Wv,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Ji.dragend=n=>(n.inputState.draggedContent=null,!1);function w_(n,e,t,r){if(t=D0(n.state,zv,t),!t)return;let i=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=n.inputState,o=r&&s&&a6(n,e)?{from:s.from,to:s.to}:null,l={from:i,insert:t},a=n.state.changes(o?[o,l]:l);n.focus(),n.dispatch({changes:a,selection:{anchor:a.mapPos(i,-1),head:a.mapPos(i,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}Ji.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let r=Array(t.length),i=0,s=()=>{++i==t.length&&w_(n,e,r.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(r[o]=l.result),s()},l.readAsText(t[o])}return!0}else{let r=e.dataTransfer.getData("Text");if(r)return w_(n,e,r,!0),!0}return!1};Ji.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=iO?null:e.clipboardData;return t?(sO(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(f6(n),!1)};function g6(n,e){let t=n.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),n.focus()},50)}function y6(n){let e=[],t=[],r=!1;for(let i of n.selection.ranges)i.empty||(e.push(n.sliceDoc(i.from,i.to)),t.push(i));if(!e.length){let i=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>i&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),i=o.number}r=!0}return{text:D0(n,Wv,e.join(n.lineBreak)),ranges:t,linewise:r}}let Xb=null;Ji.copy=Ji.cut=(n,e)=>{let{text:t,ranges:r,linewise:i}=y6(n.state);if(!t&&!i)return!1;Xb=i?t:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let s=iO?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(g6(n,t),!1)};const lO=Mo.define();function aO(n,e){let t=[];for(let r of n.facet(j2)){let i=r(n,e);i&&t.push(i)}return t.length?n.update({effects:t,annotations:lO.of(!0)}):null}function cO(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=aO(n.state,e);t?n.dispatch(t):n.update([])}},10)}_i.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),cO(n)};_i.blur=n=>{n.observer.clearSelectionRange(),cO(n)};_i.compositionstart=_i.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};_i.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Oe.chrome&&Oe.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};_i.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Ji.beforeinput=(n,e)=>{var t,r;if(e.inputType=="insertReplacementText"&&n.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let l=o[0],a=n.posAtDOM(l.startContainer,l.startOffset),c=n.posAtDOM(l.endContainer,l.endOffset);return Kv(n,{from:a,to:c,insert:n.state.toText(s)},null),!0}}let i;if(Oe.chrome&&Oe.android&&(i=nO.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return Oe.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),Oe.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>_i.compositionend(n,e),20),!1};const v_=new Set;function b6(n){v_.has(n)||(v_.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const k_=["pre-wrap","normal","pre-line","break-spaces"];let mu=!1;function C_(){mu=!1}class w6{constructor(e){this.lineWrapping=e,this.doc=Tt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return k_.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let i=e[r];i<0?r++:this.heightSamples[Math.floor(i*10)]||(t=!0,this.heightSamples[Math.floor(i*10)]=!0)}return t}refresh(e,t,r,i,s,o){let l=k_.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=t,this.charWidth=r,this.textHeight=i,this.lineLength=s,a){this.heightSamples={};for(let c=0;c<o.length;c++){let u=o[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return a}}class v6{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class ws{constructor(e,t,r,i,s){this.from=e,this.length=t,this.top=r,this.height=i,this._content=s}get type(){return typeof this._content=="number"?xr.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof yl?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new ws(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var en=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(en||(en={}));const Lm=.001;class _r{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Lm&&(mu=!0),this.height=e)}replace(e,t,r){return _r.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,i){let s=this,o=r.doc;for(let l=i.length-1;l>=0;l--){let{fromA:a,toA:c,fromB:u,toB:f}=i[l],p=s.lineAt(a,en.ByPosNoHeight,r.setDoc(t),0,0),g=p.to>=c?p:s.lineAt(c,en.ByPosNoHeight,r,0,0);for(f+=g.to-c,c=g.to;l>0&&p.from<=i[l-1].toA;)a=i[l-1].fromA,u=i[l-1].fromB,l--,a<p.from&&(p=s.lineAt(a,en.ByPosNoHeight,r,0,0));u+=p.from-a,a=p.from;let y=Gv.build(r.setDoc(o),e,u,f);s=Pg(s,s.replace(a,c,y))}return s.updateHeight(r,0)}static empty(){return new ni(0,0)}static of(e){if(e.length==1)return e[0];let t=0,r=e.length,i=0,s=0;for(;;)if(t==r)if(i>s*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),r+=1+l.break,i-=l.size}else if(s>i*2){let l=e[r];l.break?e.splice(r,1,l.left,null,l.right):e.splice(r,1,l.left,l.right),r+=2+l.break,s-=l.size}else break;else if(i<s){let l=e[t++];l&&(i+=l.size)}else{let l=e[--r];l&&(s+=l.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,r++),new k6(_r.of(e.slice(0,t)),o,_r.of(e.slice(r)))}}function Pg(n,e){return n==e?n:(n.constructor!=e.constructor&&(mu=!0),e)}_r.prototype.size=1;class uO extends _r{constructor(e,t,r){super(e,t),this.deco=r}blockAt(e,t,r,i){return new ws(i,this.length,r,this.height,this.deco||0)}lineAt(e,t,r,i,s){return this.blockAt(0,r,i,s)}forEachLine(e,t,r,i,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,r,i,s))}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class ni extends uO{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,r,i){return new ws(i,this.length,r,this.height,this.breaks)}replace(e,t,r){let i=r[0];return r.length==1&&(i instanceof ni||i instanceof Kn&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof Kn?i=new ni(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):_r.of(r)}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more?this.setHeight(i.heights[i.index++]):(r||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Kn extends _r{constructor(e){super(e,0)}heightMetrics(e,t){let r=e.doc.lineAt(t).number,i=e.doc.lineAt(t+this.length).number,s=i-r+1,o,l=0;if(e.lineWrapping){let a=Math.min(this.height,e.lineHeight*s);o=a/s,this.length>s+1&&(l=(this.height-a)/(this.length-s-1))}else o=this.height/s;return{firstLine:r,lastLine:i,perLine:o,perChar:l}}blockAt(e,t,r,i){let{firstLine:s,lastLine:o,perLine:l,perChar:a}=this.heightMetrics(t,i);if(t.lineWrapping){let c=i+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),u=t.doc.lineAt(c),f=l+u.length*a,p=Math.max(r,e-f/2);return new ws(u.from,u.length,p,f,0)}else{let c=Math.max(0,Math.min(o-s,Math.floor((e-r)/l))),{from:u,length:f}=t.doc.line(s+c);return new ws(u,f,r+l*c,l,0)}}lineAt(e,t,r,i,s){if(t==en.ByHeight)return this.blockAt(e,r,i,s);if(t==en.ByPosNoHeight){let{from:g,to:y}=r.doc.lineAt(e);return new ws(g,y-g,0,0,0)}let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(r,s),c=r.doc.lineAt(e),u=l+c.length*a,f=c.number-o,p=i+l*f+a*(c.from-s-f);return new ws(c.from,c.length,Math.max(i,Math.min(p,i+this.height-u)),u,0)}forEachLine(e,t,r,i,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:l,perLine:a,perChar:c}=this.heightMetrics(r,s);for(let u=e,f=i;u<=t;){let p=r.doc.lineAt(u);if(u==e){let y=p.number-l;f+=a*y+c*(e-s-y)}let g=a+c*p.length;o(new ws(p.from,p.length,f,g,0)),f+=g,u=p.to+1}}replace(e,t,r){let i=this.length-t;if(i>0){let s=r[r.length-1];s instanceof Kn?r[r.length-1]=new Kn(s.length+i):r.push(null,new Kn(i-1))}if(e>0){let s=r[0];s instanceof Kn?r[0]=new Kn(e+s.length):r.unshift(new Kn(e-1),null)}return _r.of(r)}decomposeLeft(e,t){t.push(new Kn(e-1),null)}decomposeRight(e,t){t.push(null,new Kn(this.length-e-1))}updateHeight(e,t=0,r=!1,i){let s=t+this.length;if(i&&i.from<=t+this.length&&i.more){let o=[],l=Math.max(t,i.from),a=-1;for(i.from>t&&o.push(new Kn(i.from-t-1).updateHeight(e,t));l<=s&&i.more;){let u=e.doc.lineAt(l).length;o.length&&o.push(null);let f=i.heights[i.index++];a==-1?a=f:Math.abs(f-a)>=Lm&&(a=-2);let p=new ni(u,f);p.outdated=!1,o.push(p),l+=u+1}l<=s&&o.push(null,new Kn(s-l).updateHeight(e,l));let c=_r.of(o);return(a<0||Math.abs(c.height-this.height)>=Lm||Math.abs(a-this.heightMetrics(e,t).perLine)>=Lm)&&(mu=!0),Pg(this,c)}else(r||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class k6 extends _r{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return this.flags&1}blockAt(e,t,r,i){let s=r+this.left.height;return e<s?this.left.blockAt(e,t,r,i):this.right.blockAt(e,t,s,i+this.left.length+this.break)}lineAt(e,t,r,i,s){let o=i+this.left.height,l=s+this.left.length+this.break,a=t==en.ByHeight?e<o:e<l,c=a?this.left.lineAt(e,t,r,i,s):this.right.lineAt(e,t,r,o,l);if(this.break||(a?c.to<l:c.from>l))return c;let u=t==en.ByPosNoHeight?en.ByPosNoHeight:en.ByPos;return a?c.join(this.right.lineAt(l,u,r,o,l)):this.left.lineAt(l,u,r,i,s).join(c)}forEachLine(e,t,r,i,s,o){let l=i+this.left.height,a=s+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,r,i,s,o),t>=a&&this.right.forEachLine(e,t,r,l,a,o);else{let c=this.lineAt(a,en.ByPos,r,i,s);e<c.from&&this.left.forEachLine(e,c.from-1,r,i,s,o),c.to>=e&&c.from<=t&&o(c),t>c.to&&this.right.forEachLine(c.to+1,t,r,l,a,o)}}replace(e,t,r){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,r));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of r)s.push(l);if(e>0&&S_(s,o-1),t<this.length){let l=s.length;this.decomposeRight(t,s),S_(s,l)}return _r.of(s)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(r++,e>=r&&t.push(null)),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,i=r+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?_r.of(this.break?[e,null,t]:[e,t]):(this.left=Pg(this.left,e),this.right=Pg(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,i){let{left:s,right:o}=this,l=t+s.length+this.break,a=null;return i&&i.from<=t+s.length&&i.more?a=s=s.updateHeight(e,t,r,i):s.updateHeight(e,t,r),i&&i.from<=l+o.length&&i.more?a=o=o.updateHeight(e,l,r,i):o.updateHeight(e,l,r),a?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function S_(n,e){let t,r;n[e]==null&&(t=n[e-1])instanceof Kn&&(r=n[e+1])instanceof Kn&&n.splice(e-1,3,new Kn(t.length+1+r.length))}const C6=5;class Gv{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let r=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof ni?i.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new ni(r-this.pos,-1)),this.writtenTo=r,t>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let i=r.widget?r.widget.estimatedHeight:0,s=r.widget?r.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let o=t-e;r.block?this.addBlock(new uO(o,i,r)):(o||s||i>=C6)&&this.addLineDeco(i,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new ni(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let r=new Kn(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof ni)return e;let t=new ni(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,r){let i=this.ensureLine();i.length+=r,i.collapsed+=r,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof ni)&&!this.isCovered?this.nodes.push(new ni(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=e;for(let i of this.nodes)i instanceof ni&&i.updateHeight(this.oracle,r),r+=i?i.length:1;return this.nodes}static build(e,t,r,i){let s=new Gv(r,e);return xt.spans(t,r,i,s,0),s.finish(r)}}function S6(n,e,t){let r=new x6;return xt.compare(n,e,t,r,0),r.changes}class x6{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,i){(e<t||r&&r.heightRelevant||i&&i.heightRelevant)&&Om(e,t,this.changes,5)}}function _6(n,e){let t=n.getBoundingClientRect(),r=n.ownerDocument,i=r.defaultView||window,s=Math.max(0,t.left),o=Math.min(i.innerWidth,t.right),l=Math.max(0,t.top),a=Math.min(i.innerHeight,t.bottom);for(let c=n.parentNode;c&&c!=r.body;)if(c.nodeType==1){let u=c,f=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&f.overflow!="visible"){let p=u.getBoundingClientRect();s=Math.max(s,p.left),o=Math.min(o,p.right),l=Math.max(l,p.top),a=Math.min(c==n.parentNode?i.innerHeight:a,p.bottom)}c=f.position=="absolute"||f.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:l-(t.top+e),bottom:Math.max(l,a)-(t.top+e)}}function M6(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function T6(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Qy{constructor(e,t,r,i){this.from=e,this.to=t,this.size=r,this.displaySize=i}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],s=t[r];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e,t){return Je.replace({widget:new E6(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class E6 extends To{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class x_{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=__,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=tn.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(qv).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new w6(t),this.stateDeco=e.facet(qh).filter(r=>typeof r!="function"),this.heightMap=_r.empty().applyChanges(this.stateDeco,Tt.empty,this.heightOracle.setDoc(e.doc),[new ki(0,0,0,e.doc.length)]);for(let r=0;r<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());r++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Je.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let i=r?t.head:t.anchor;if(!e.some(({from:s,to:o})=>i>=s&&i<=o)){let{from:s,to:o}=this.lineBlockAt(i);e.push(new Up(s,o))}}return this.viewports=e.sort((r,i)=>r.from-i.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?__:new Jv(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Cf(e,this.scaler))})}update(e,t=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=this.state.facet(qh).filter(u=>typeof u!="function");let i=e.changedRanges,s=ki.extendWithRanges(i,S6(r,this.stateDeco,e?e.changes:Ln.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);C_(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||mu)&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let a=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let c=a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(z2)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,r=window.getComputedStyle(t),i=this.heightOracle,s=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?tn.RTL:tn.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),l=t.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let c=0,u=0;if(l.width&&l.height){let{scaleX:T,scaleY:S}=b2(t,l);(T>.005&&Math.abs(this.scaleX-T)>.005||S>.005&&Math.abs(this.scaleY-S)>.005)&&(this.scaleX=T,this.scaleY=S,c|=16,o=a=!0)}let f=(parseInt(r.paddingTop)||0)*this.scaleY,p=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=f||this.paddingBottom!=p)&&(this.paddingTop=f,this.paddingBottom=p,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let g=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=g&&(this.scrollAnchorHeight=-1,this.scrollTop=g),this.scrolledToBottom=k2(e.scrollDOM);let y=(this.printing?T6:_6)(t,this.paddingTop),v=y.top-this.pixelViewport.top,k=y.bottom-this.pixelViewport.bottom;this.pixelViewport=y;let x=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(x!=this.inView&&(this.inView=x,x&&(a=!0)),!this.inView&&!this.scrollTarget&&!M6(e.dom))return 0;let _=l.width;if((this.contentDOMWidth!=_||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),a){let T=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(T)&&(o=!0),o||i.lineWrapping&&Math.abs(_-this.contentDOMWidth)>i.charWidth){let{lineHeight:S,charWidth:A,textHeight:I}=e.docView.measureTextSize();o=S>0&&i.refresh(s,S,A,I,Math.max(5,_/A),T),o&&(e.docView.minWidth=0,c|=16)}v>0&&k>0?u=Math.max(v,k):v<0&&k<0&&(u=Math.min(v,k)),C_();for(let S of this.viewports){let A=S.from==this.viewport.from?T:e.docView.measureVisibleLineHeights(S);this.heightMap=(o?_r.empty().applyChanges(this.stateDeco,Tt.empty,this.heightOracle,[new ki(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,o,new v6(S.from,A))}mu&&(c|=2)}let M=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return M&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),c|=this.updateForViewport()),(c&2||M)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,a=new Up(i.lineAt(o-r*1e3,en.ByHeight,s,0,0).from,i.lineAt(l+(1-r)*1e3,en.ByHeight,s,0,0).to);if(t){let{head:c}=t.range;if(c<a.from||c>a.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),f=i.lineAt(c,en.ByPos,s,0,0),p;t.y=="center"?p=(f.top+f.bottom)/2-u/2:t.y=="start"||t.y=="nearest"&&c<a.from?p=f.top:p=f.bottom-u,a=new Up(i.lineAt(p-1e3/2,en.ByHeight,s,0,0).from,i.lineAt(p+u+1e3/2,en.ByHeight,s,0,0).to)}}return a}mapViewport(e,t){let r=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new Up(this.heightMap.lineAt(r,en.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,en.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,en.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,en.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||i<=o-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||s>=l+Math.max(10,Math.min(r,250)))&&i>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let i of e)t.touchesRange(i.from,i.to)||r.push(new Qy(t.mapPos(i.from),t.mapPos(i.to),i.size,i.displaySize));return r}ensureLineGaps(e,t){let r=this.heightOracle.lineWrapping,i=r?1e4:2e3,s=i>>1,o=i<<1;if(this.defaultTextDirection!=tn.LTR&&!r)return[];let l=[],a=(u,f,p,g)=>{if(f-u<s)return;let y=this.state.selection.main,v=[y.from];y.empty||v.push(y.to);for(let x of v)if(x>u&&x<f){a(u,x-10,p,g),a(x+10,f,p,g);return}let k=O6(e,x=>x.from>=p.from&&x.to<=p.to&&Math.abs(x.from-u)<s&&Math.abs(x.to-f)<s&&!v.some(_=>x.from<_&&x.to>_));if(!k){if(f<p.to&&t&&r&&t.visibleRanges.some(M=>M.from<=f&&M.to>=f)){let M=t.moveToLineBoundary(re.cursor(f),!1,!0).head;M>u&&(f=M)}let x=this.gapSize(p,u,f,g),_=r||x<2e6?x:2e6;k=new Qy(u,f,x,_)}l.push(k)},c=u=>{if(u.length<o||u.type!=xr.Text)return;let f=A6(u.from,u.to,this.stateDeco);if(f.total<o)return;let p=this.scrollTarget?this.scrollTarget.range.head:null,g,y;if(r){let v=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,k,x;if(p!=null){let _=Gp(f,p),M=((this.visibleBottom-this.visibleTop)/2+v)/u.height;k=_-M,x=_+M}else k=(this.visibleTop-u.top-v)/u.height,x=(this.visibleBottom-u.top+v)/u.height;g=Kp(f,k),y=Kp(f,x)}else{let v=f.total*this.heightOracle.charWidth,k=i*this.heightOracle.charWidth,x=0;if(v>2e6)for(let A of e)A.from>=u.from&&A.from<u.to&&A.size!=A.displaySize&&A.from*this.heightOracle.charWidth+x<this.pixelViewport.left&&(x=A.size-A.displaySize);let _=this.pixelViewport.left+x,M=this.pixelViewport.right+x,T,S;if(p!=null){let A=Gp(f,p),I=((M-_)/2+k)/v;T=A-I,S=A+I}else T=(_-k)/v,S=(M+k)/v;g=Kp(f,T),y=Kp(f,S)}g>u.from&&a(u.from,g,u,f),y<u.to&&a(y,u.to,u,f)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(c):c(u);return l}gapSize(e,t,r,i){let s=Gp(i,r)-Gp(i,t);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){Qy.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Je.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let r=[];xt.spans(t,this.viewport.from,this.viewport.to,{span(s,o){r.push({from:s,to:o})},point(){}},20);let i=0;if(r.length!=this.visibleRanges.length)i=12;else for(let s=0;s<r.length&&!(i&8);s++){let o=this.visibleRanges[s],l=r[s];(o.from!=l.from||o.to!=l.to)&&(i|=4,e&&e.mapPos(o.from,-1)==l.from&&e.mapPos(o.to,1)==l.to||(i|=8))}return this.visibleRanges=r,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Cf(this.heightMap.lineAt(e,en.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Cf(this.heightMap.lineAt(this.scaler.fromDOM(e),en.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Cf(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Up{constructor(e,t){this.from=e,this.to=t}}function A6(n,e,t){let r=[],i=n,s=0;return xt.spans(t,n,e,{span(){},point(o,l){o>i&&(r.push({from:i,to:o}),s+=o-i),i=l}},20),i<e&&(r.push({from:i,to:e}),s+=e-i),{total:s,ranges:r}}function Kp({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let r=Math.floor(n*t);for(let i=0;;i++){let{from:s,to:o}=e[i],l=o-s;if(r<=l)return s+r;r-=l}}function Gp(n,e){let t=0;for(let{from:r,to:i}of n.ranges){if(e<=i){t+=e-r;break}t+=i-r}return t/n.total}function O6(n,e){for(let t of n)if(e(t))return t}const __={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};class Jv{constructor(e,t,r){let i=0,s=0,o=0;this.viewports=r.map(({from:l,to:a})=>{let c=t.lineAt(l,en.ByPos,e,0,0).top,u=t.lineAt(a,en.ByPos,e,0,0).bottom;return i+=u-c,{from:l,to:a,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(t.height-i);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return i+(e-r)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);r=s.bottom,i=s.domBottom}}fromDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return r+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);r=s.bottom,i=s.domBottom}}eq(e){return e instanceof Jv?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,r)=>t.from==e.viewports[r].from&&t.to==e.viewports[r].to):!1}}function Cf(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),r=e.toDOM(n.bottom);return new ws(n.from,n.length,t,r-t,Array.isArray(n._content)?n._content.map(i=>Cf(i,e)):n._content)}const Jp=Ie.define({combine:n=>n.join(" ")}),Qb=Ie.define({combine:n=>n.indexOf(!0)>-1}),ew=gl.newName(),fO=gl.newName(),hO=gl.newName(),dO={"&light":"."+fO,"&dark":"."+hO};function tw(n,e,t){return new gl(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,i=>{if(i=="&")return n;if(!t||!t[i])throw new RangeError(`Unsupported selector: ${i}`);return t[i]}):n+" "+r}})}const L6=tw("."+ew,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},dO),D6={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},e1=Oe.ie&&Oe.ie_version<=11;let I6=class{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new m7,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let r of t)this.queue.push(r);(Oe.ie&&Oe.ie_version<=11||Oe.ios&&e.composing)&&t.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&Oe.android&&e.constructor.EDIT_CONTEXT!==!1&&!(Oe.chrome&&Oe.chrome_version<126)&&(this.editContext=new R6(e),e.state.facet(ao)&&(e.contentDOM.editContext=this.editContext.editContext)),e1&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,i=this.selectionRange;if(r.state.facet(ao)?r.root.activeElement!=this.dom:!Am(this.dom,i))return;let s=i.anchorNode&&r.docView.nearest(i.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(Oe.ie&&Oe.ie_version<=11||Oe.android&&Oe.chrome)&&!r.state.selection.main.empty&&i.focusNode&&oh(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=zh(e.root);if(!t)return!1;let r=Oe.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&N6(this.view,t)||t;if(!r||this.selectionRange.eq(r))return!1;let i=Am(this.dom,r);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&y7(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(r.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=t)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,D6),e1&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),e1&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var r;if(!this.delayedAndroidKey){let i=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Tc(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,r=-1,i=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(i=!0),t==-1?{from:t,to:r}=o:(t=Math.min(o.from,t),r=Math.max(o.to,r)))}return{from:t,to:r,typeOver:i}}readChange(){let{from:e,to:t,typeOver:r}=this.processRecords(),i=this.selectionChanged&&Am(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new X7(this.view,e,t,r);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let r=this.view.state,i=eO(this.view,t);return this.view.state==r&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),i}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let r=M_(t,e.previousSibling||e.target.previousSibling,-1),i=M_(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ao)!=e.state.facet(ao)&&(e.view.contentDOM.editContext=e.state.facet(ao)?this.editContext.editContext:null))}destroy(){var e,t,r;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}};function M_(n,e,t){for(;e;){let r=Pt.get(e);if(r&&r.parent==n)return r;let i=e.parentNode;e=i!=n.dom?i:t>0?e.nextSibling:e.previousSibling}return null}function T_(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor);return oh(o.node,o.offset,i,s)&&([t,r,i,s]=[i,s,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}}function N6(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return T_(n,i)}let t=null;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",r,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",r,!0),t?T_(n,t):null}class R6{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=r=>{let i=e.state.selection.main,{anchor:s,head:o}=i,l=this.toEditorPos(r.updateRangeStart),a=this.toEditorPos(r.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:l,drifted:!1});let c=a-l>r.text.length;l==this.from&&s<this.from?l=s:a==this.to&&s>this.to&&(a=s);let u=tO(e.state.sliceDoc(l,a),r.text,(c?i.from:i.to)-l,c?"end":null);if(!u){let p=re.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));p.main.eq(i)||e.dispatch({selection:p,userEvent:"select"});return}let f={from:u.from+l,to:u.toA+l,insert:Tt.of(r.text.slice(u.from,u.toB).split(`
`))};if((Oe.mac||Oe.android)&&f.from==o-1&&/^\. ?$/.test(r.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(f={from:l,to:a,insert:Tt.of([r.text.replace("."," ")])}),this.pendingContextChange=f,!e.state.readOnly){let p=this.to-this.from+(f.to-f.from+f.insert.length);Kv(e,f,re.single(this.toEditorPos(r.selectionStart,p),this.toEditorPos(r.selectionEnd,p)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),f.from<f.to&&!f.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,r.updateRangeStart-1),Math.min(t.text.length,r.updateRangeStart+1)))&&this.handlers.compositionend(r)},this.handlers.characterboundsupdate=r=>{let i=[],s=null;for(let o=this.toEditorPos(r.rangeStart),l=this.toEditorPos(r.rangeEnd);o<l;o++){let a=e.coordsForChar(o);s=a&&new DOMRect(a.left,a.top,a.right-a.left,a.bottom-a.top)||s||new DOMRect,i.push(s)}t.updateCharacterBounds(r.rangeStart,i)},this.handlers.textformatupdate=r=>{let i=[];for(let s of r.getTextFormats()){let o=s.underlineStyle,l=s.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(l)){let a=this.toEditorPos(s.rangeStart),c=this.toEditorPos(s.rangeEnd);if(a<c){let u=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(l)?1:2}px`;i.push(Je.mark({attributes:{style:u}}).range(a,c))}}}e.dispatch({effects:q2.of(Je.set(i))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:r}=this.composing;this.composing=null,r&&this.reset(e.state)}};for(let r in this.handlers)t.addEventListener(r,this.handlers[r]);this.measureReq={read:r=>{this.editContext.updateControlBounds(r.contentDOM.getBoundingClientRect());let i=zh(r.root);i&&i.rangeCount&&this.editContext.updateSelectionBounds(i.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,r=!1,i=this.pendingContextChange;return e.changes.iterChanges((s,o,l,a,c)=>{if(r)return;let u=c.length-(o-s);if(i&&o>=i.to)if(i.from==s&&i.to==o&&i.insert.eq(c)){i=this.pendingContextChange=null,t+=u,this.to+=u;return}else i=null,this.revertPending(e.state);if(s+=t,o+=t,o<=this.from)this.from+=u,this.to+=u;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+c.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),c.toString()),this.to+=u}t+=u}),i&&!r&&this.revertPending(e.state),!r}update(e){let t=this.pendingContextChange,r=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(r.from,r.to)&&e.transactions.some(i=>!i.isUserEvent("input.type")&&i.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),i=this.toContextPos(t.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=i)&&this.editContext.updateSelection(r,i)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let r=this.composing;return r&&r.drifted?r.editorBase+(e-r.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}let Re=class nw{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:r}=e;this.dispatchTransactions=e.dispatchTransactions||r&&(i=>i.forEach(s=>r(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||g7(e.parent)||document,this.viewState=new x_(e.state||ln.create(e)),e.scrollTo&&e.scrollTo.is(zp)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Sc).map(i=>new Zy(i));for(let i of this.plugins)i.update(this);this.observer=new I6(this),this.inputState=new n6(this),this.inputState.ensureHandlers(this.plugins),this.docView=new s_(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof Sr?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,r=!1,i,s=this.state;for(let p of e){if(p.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=p.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,l=0,a=null;e.some(p=>p.annotation(lO))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=aO(s,o),a||(l=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(u=null)):this.observer.clear(),s.facet(ln.phrases)!=this.state.facet(ln.phrases))return this.setState(s);i=Rg.create(this,s,e),i.flags|=l;let f=this.viewState.scrollTarget;try{this.updateState=2;for(let p of e){if(f&&(f=f.map(p.changes)),p.scrollIntoView){let{main:g}=p.state.selection;f=new Ec(g.empty?g:re.cursor(g.head,g.head>g.anchor?-1:1))}for(let g of p.effects)g.is(zp)&&(f=g.value.clip(this.state))}this.viewState.update(i,f),this.bidiCache=Bg.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),t=this.docView.update(i),this.state.facet(vf)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(p=>p.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(Jp)!=i.state.facet(Jp)&&(this.viewState.mustMeasureContent=!0),(t||r||f||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!i.empty)for(let p of this.state.facet(Jb))try{p(i)}catch(g){jr(this.state,g,"update listener")}(a||u)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),u&&!eO(this,u)&&c.force&&Tc(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new x_(e),this.plugins=e.facet(Sc).map(r=>new Zy(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView.destroy(),this.docView=new s_(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Sc),r=e.state.facet(Sc);if(t!=r){let i=[];for(let s of r){let o=t.indexOf(s);if(o<0)i.push(new Zy(s));else{let l=this.plugins[o];l.mustUpdate=e,i.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);t!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(r){jr(this.state,r,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,r=this.scrollDOM,i=r.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if(k2(r))s=-1,o=this.viewState.heightMap.height;else{let g=this.viewState.scrollAnchorAt(i);s=g.from,o=g.top}this.updateState=1;let a=this.viewState.measure(this);if(!a&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];a&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(g=>{try{return g.read(this)}catch(y){return jr(this.state,y),E_}}),f=Rg.create(this,this.state,[]),p=!1;f.flags|=a,t?t.flags|=a:t=f,this.updateState=2,f.empty||(this.updatePlugins(f),this.inputState.update(f),this.updateAttrs(),p=this.docView.update(f),p&&this.docViewUpdate());for(let g=0;g<c.length;g++)if(u[g]!=E_)try{let y=c[g];y.write&&y.write(u[g],this)}catch(y){jr(this.state,y)}if(p&&this.docView.updateSelection(!0),!f.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let y=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(y>1||y<-1){i=i+y,r.scrollTop=i/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let l of this.state.facet(Jb))l(t)}get themeClasses(){return ew+" "+(this.state.facet(Qb)?hO:fO)+" "+this.state.facet(Jp)}updateAttrs(){let e=A_(this,U2,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(ao)?"true":"false",class:"cm-content",style:`${Oe.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),A_(this,qv,t);let r=this.observer.ignore(()=>{let i=Wb(this.contentDOM,this.contentAttrs,t),s=Wb(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=t,r}showAnnouncements(e){let t=!0;for(let r of e)for(let i of r.effects)if(i.is(nw.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(vf);let e=this.state.facet(nw.cspNonce);gl.mount(this.root,this.styleModules.concat(L6).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(r=>r.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return Xy(this,e,u_(this,e,t,r))}moveByGroup(e,t){return Xy(this,e,u_(this,e,t,r=>K7(this,e.head,r)))}visualLineSide(e,t){let r=this.bidiSpans(e),i=this.textDirectionAt(e.from),s=r[t?r.length-1:0];return re.cursor(s.side(t,i)+e.from,s.forward(!t,i)?1:-1)}moveToLineBoundary(e,t,r=!0){return U7(this,e,t,r)}moveVertically(e,t,r){return Xy(this,e,G7(this,e,t,r))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Y2(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),o=s[sl.find(s,e-i.from,-1,t)];return L0(r,o.dir==tn.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet($2)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>P6)return N2(e.length);let t=this.textDirectionAt(e.from),r;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||I2(s.isolates,r=i_(this,e))))return s.order;r||(r=i_(this,e));let i=O7(e.text,t,r);return this.bidiCache.push(new Bg(e.from,e.to,t,r,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Oe.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{w2(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return zp.of(new Ec(typeof e=="number"?re.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return zp.of(new Ec(re.cursor(r.from),"start","start",r.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return En.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return En.define(()=>({}),{eventObservers:e})}static theme(e,t){let r=gl.newName(),i=[Jp.of(r),vf.of(tw(`.${r}`,e))];return t&&t.dark&&i.push(Qb.of(!0)),i}static baseTheme(e){return Cl.lowest(vf.of(tw("."+ew,e,dO)))}static findFromDOM(e){var t;let r=e.querySelector(".cm-content"),i=r&&Pt.get(r)||Pt.get(e);return((t=i==null?void 0:i.rootView)===null||t===void 0?void 0:t.view)||null}};Re.styleModule=vf;Re.inputHandler=F2;Re.clipboardInputFilter=zv;Re.clipboardOutputFilter=Wv;Re.scrollHandler=W2;Re.focusChangeEffect=j2;Re.perLineTextDirection=$2;Re.exceptionSink=V2;Re.updateListener=Jb;Re.editable=ao;Re.mouseSelectionStyle=H2;Re.dragMovesSelection=B2;Re.clickAddsSelectionRange=P2;Re.decorations=qh;Re.outerDecorations=K2;Re.atomicRanges=Xd;Re.bidiIsolatedRanges=G2;Re.scrollMargins=J2;Re.darkTheme=Qb;Re.cspNonce=Ie.define({combine:n=>n.length?n[0]:""});Re.contentAttributes=qv;Re.editorAttributes=U2;Re.lineWrapping=Re.contentAttributes.of({class:"cm-lineWrapping"});Re.announce=it.define();const P6=4096,E_={};class Bg{constructor(e,t,r,i,s,o){this.from=e,this.to=t,this.dir=r,this.isolates=i,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let r=[],i=e.length?e[e.length-1].dir:tn.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==i&&!t.touchesRange(o.from,o.to)&&r.push(new Bg(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return r}}function A_(n,e,t){for(let r=n.state.facet(e),i=r.length-1;i>=0;i--){let s=r[i],o=typeof s=="function"?s(n):s;o&&zb(o,t)}return t}const B6=Oe.mac?"mac":Oe.windows?"win":Oe.linux?"linux":"key";function H6(n,e){const t=n.split(/-(?!$)/);let r=t[t.length-1];r=="Space"&&(r=" ");let i,s,o,l;for(let a=0;a<t.length-1;++a){const c=t[a];if(/^(cmd|meta|m)$/i.test(c))l=!0;else if(/^a(lt)?$/i.test(c))i=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return i&&(r="Alt-"+r),s&&(r="Ctrl-"+r),l&&(r="Meta-"+r),o&&(r="Shift-"+r),r}function Zp(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const V6=Cl.default(Re.domEventHandlers({keydown(n,e){return mO(pO(e.state),n,e,"editor")}})),Iu=Ie.define({enables:V6}),O_=new WeakMap;function pO(n){let e=n.facet(Iu),t=O_.get(e);return t||O_.set(e,t=$6(e.reduce((r,i)=>r.concat(i),[]))),t}function F6(n,e,t){return mO(pO(n.state),e,n,t)}let Zo=null;const j6=4e3;function $6(n,e=B6){let t=Object.create(null),r=Object.create(null),i=(o,l)=>{let a=r[o];if(a==null)r[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,a,c,u)=>{var f,p;let g=t[o]||(t[o]=Object.create(null)),y=l.split(/ (?!$)/).map(x=>H6(x,e));for(let x=1;x<y.length;x++){let _=y.slice(0,x).join(" ");i(_,!0),g[_]||(g[_]={preventDefault:!0,stopPropagation:!1,run:[M=>{let T=Zo={view:M,prefix:_,scope:o};return setTimeout(()=>{Zo==T&&(Zo=null)},j6),!0}]})}let v=y.join(" ");i(v,!1);let k=g[v]||(g[v]={preventDefault:!1,stopPropagation:!1,run:((p=(f=g._any)===null||f===void 0?void 0:f.run)===null||p===void 0?void 0:p.slice())||[]});a&&k.run.push(a),c&&(k.preventDefault=!0),u&&(k.stopPropagation=!0)};for(let o of n){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of l){let u=t[c]||(t[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:f}=o;for(let p in u)u[p].run.push(g=>f(g,rw))}let a=o[e]||o.key;if(a)for(let c of l)s(c,a,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(c,"Shift-"+a,o.shift,o.preventDefault,o.stopPropagation)}return t}let rw=null;function mO(n,e,t,r){rw=e;let i=m2(e),s=Vr(i,0),o=bs(s)==i.length&&i!=" ",l="",a=!1,c=!1,u=!1;Zo&&Zo.view==t&&Zo.scope==r&&(l=Zo.prefix+" ",rO.indexOf(e.keyCode)<0&&(c=!0,Zo=null));let f=new Set,p=k=>{if(k){for(let x of k.run)if(!f.has(x)&&(f.add(x),x(t)))return k.stopPropagation&&(u=!0),!0;k.preventDefault&&(k.stopPropagation&&(u=!0),c=!0)}return!1},g=n[r],y,v;return g&&(p(g[l+Zp(i,e,!o)])?a=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Oe.windows&&e.ctrlKey&&e.altKey)&&!(Oe.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(y=wo[e.keyCode])&&y!=i?(p(g[l+Zp(y,e,!0)])||e.shiftKey&&(v=$h[e.keyCode])!=i&&v!=y&&p(g[l+Zp(v,e,!1)]))&&(a=!0):o&&e.shiftKey&&p(g[l+Zp(i,e,!0)])&&(a=!0),!a&&p(g._any)&&(a=!0)),c&&(a=!0),a&&u&&e.stopPropagation(),rw=null,a}class Qd{constructor(e,t,r,i,s){this.className=e,this.left=t,this.top=r,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,r){if(r.empty){let i=e.coordsAtPos(r.head,r.assoc||1);if(!i)return[];let s=gO(e);return[new Qd(t,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}else return z6(e,t,r)}}function gO(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==tn.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function L_(n,e,t,r){let i=n.coordsAtPos(e,t*2);if(!i)return r;let s=n.dom.getBoundingClientRect(),o=(i.top+i.bottom)/2,l=n.posAtCoords({x:s.left+1,y:o}),a=n.posAtCoords({x:s.right-1,y:o});return l==null||a==null?r:{from:Math.max(r.from,Math.min(l,a)),to:Math.min(r.to,Math.max(l,a))}}function z6(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let r=Math.max(t.from,n.viewport.from),i=Math.min(t.to,n.viewport.to),s=n.textDirection==tn.LTR,o=n.contentDOM,l=o.getBoundingClientRect(),a=gO(n),c=o.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),f=l.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),p=l.right-(u?parseInt(u.paddingRight):0),g=Yb(n,r,1),y=Yb(n,i,-1),v=g.type==xr.Text?g:null,k=y.type==xr.Text?y:null;if(v&&(n.lineWrapping||g.widgetLineBreaks)&&(v=L_(n,r,1,v)),k&&(n.lineWrapping||y.widgetLineBreaks)&&(k=L_(n,i,-1,k)),v&&k&&v.from==k.from&&v.to==k.to)return _(M(t.from,t.to,v));{let S=v?M(t.from,null,v):T(g,!1),A=k?M(null,t.to,k):T(y,!0),I=[];return(v||g).to<(k||y).from-(v&&k?1:0)||g.widgetLineBreaks>1&&S.bottom+n.defaultLineHeight/2<A.top?I.push(x(f,S.bottom,p,A.top)):S.bottom<A.top&&n.elementAtHeight((S.bottom+A.top)/2).type==xr.Text&&(S.bottom=A.top=(S.bottom+A.top)/2),_(S).concat(I).concat(_(A))}function x(S,A,I,B){return new Qd(e,S-a.left,A-a.top,I-S,B-A)}function _({top:S,bottom:A,horizontal:I}){let B=[];for(let R=0;R<I.length;R+=2)B.push(x(I[R],S,I[R+1],A));return B}function M(S,A,I){let B=1e9,R=-1e9,K=[];function U(ne,ve,ke,Se,Te){let Ge=n.coordsAtPos(ne,ne==I.to?-2:2),Xe=n.coordsAtPos(ke,ke==I.from?2:-2);!Ge||!Xe||(B=Math.min(Ge.top,Xe.top,B),R=Math.max(Ge.bottom,Xe.bottom,R),Te==tn.LTR?K.push(s&&ve?f:Ge.left,s&&Se?p:Xe.right):K.push(!s&&Se?f:Xe.left,!s&&ve?p:Ge.right))}let z=S??I.from,oe=A??I.to;for(let ne of n.visibleRanges)if(ne.to>z&&ne.from<oe)for(let ve=Math.max(ne.from,z),ke=Math.min(ne.to,oe);;){let Se=n.state.doc.lineAt(ve);for(let Te of n.bidiSpans(Se)){let Ge=Te.from+Se.from,Xe=Te.to+Se.from;if(Ge>=ke)break;Xe>ve&&U(Math.max(Ge,ve),S==null&&Ge<=z,Math.min(Xe,ke),A==null&&Xe>=oe,Te.dir)}if(ve=Se.to+1,ve>=ke)break}return K.length==0&&U(z,S==null,oe,A==null,n.textDirection),{top:B,bottom:R,horizontal:K}}function T(S,A){let I=l.top+(A?S.top:S.bottom);return{top:I,bottom:I,horizontal:[]}}}function W6(n,e){return n.constructor==e.constructor&&n.eq(e)}class q6{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Dm)!=e.state.facet(Dm)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,r=e.facet(Dm);for(;t<r.length&&r[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,r)=>!W6(t,this.drawn[r]))){let t=this.dom.firstChild,r=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[r].constructor&&i.update(t,this.drawn[r])?(t=t.nextSibling,r++):this.dom.insertBefore(i.draw(),t);for(;t;){let i=t.nextSibling;t.remove(),t=i}this.drawn=e,Oe.safari&&Oe.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Dm=Ie.define();function yO(n){return[En.define(e=>new q6(e,n)),Dm.of(n)]}const Uh=Ie.define({combine(n){return Is(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function bO(n={}){return[Uh.of(n),U6,K6,G6,z2.of(!0)]}function wO(n){return n.startState.facet(Uh)!=n.state.facet(Uh)}const U6=yO({above:!0,markers(n){let{state:e}=n,t=e.facet(Uh),r=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty||t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=i.empty?i:re.cursor(i.head,i.head>i.anchor?-1:1);for(let a of Qd.forRange(n,o,l))r.push(a)}}return r},update(n,e){n.transactions.some(r=>r.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=wO(n);return t&&D_(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){D_(e.state,n)},class:"cm-cursorLayer"});function D_(n,e){e.style.animationDuration=n.facet(Uh).cursorBlinkRate+"ms"}const K6=yO({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Qd.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||wO(n)},class:"cm-selectionLayer"}),G6=Cl.highest(Re.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),vO=it.define({map(n,e){return n==null?null:e.mapPos(n)}}),Sf=jn.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,r)=>r.is(vO)?r.value:t,n)}}),J6=En.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(Sf);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Sf)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(Sf),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let r=n.scrollDOM.getBoundingClientRect();return{left:t.left-r.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-r.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Sf)!=n&&this.view.dispatch({effects:vO.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Z6(){return[Sf,J6]}function I_(n,e,t,r,i){e.lastIndex=0;for(let s=n.iterRange(t,r),o=t,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)i(o+l.index,l)}function Y6(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let r=[];for(let{from:i,to:s}of t)i=Math.max(n.state.doc.lineAt(i).from,i-e),s=Math.min(n.state.doc.lineAt(s).to,s+e),r.length&&r[r.length-1].to>=i?r[r.length-1].to=s:r.push({from:i,to:s});return r}class X6{constructor(e){const{regexp:t,decoration:r,decorate:i,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(l,a,c,u)=>i(u,c,c+l[0].length,l,a);else if(typeof r=="function")this.addMatch=(l,a,c,u)=>{let f=r(l,a,c);f&&u(c,c+l[0].length,f)};else if(r)this.addMatch=(l,a,c,u)=>u(c,c+l[0].length,r);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new bo,r=t.add.bind(t);for(let{from:i,to:s}of Y6(e,this.maxLength))I_(e.state.doc,this.regexp,i,s,(o,l)=>this.addMatch(l,e,o,r));return t.finish()}updateDeco(e,t){let r=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,a)=>{a>=e.view.viewport.from&&l<=e.view.viewport.to&&(r=Math.min(l,r),i=Math.max(a,i))}),e.viewportMoved||i-r>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),r,i):t}updateRange(e,t,r,i){for(let s of e.visibleRanges){let o=Math.max(s.from,r),l=Math.min(s.to,i);if(l>=o){let a=e.state.doc.lineAt(o),c=a.to<l?e.state.doc.lineAt(l):a,u=Math.max(s.from,a.from),f=Math.min(s.to,c.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){u=o;break}for(;l<c.to;l++)if(this.boundary.test(c.text[l-c.from])){f=l;break}}let p=[],g,y=(v,k,x)=>p.push(x.range(v,k));if(a==c)for(this.regexp.lastIndex=u-a.from;(g=this.regexp.exec(a.text))&&g.index<f-a.from;)this.addMatch(g,e,g.index+a.from,y);else I_(e.state.doc,this.regexp,u,f,(v,k)=>this.addMatch(k,e,v,y));t=t.update({filterFrom:u,filterTo:f,filter:(v,k)=>v<u||k>f,add:p})}}return t}}const iw=/x/.unicode!=null?"gu":"g",Q6=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,iw),eB={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let t1=null;function tB(){var n;if(t1==null&&typeof document<"u"&&document.body){let e=document.body.style;t1=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return t1||!1}const Im=Ie.define({combine(n){let e=Is(n,{render:null,specialChars:Q6,addSpecialChars:null});return(e.replaceTabs=!tB())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,iw)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,iw)),e}});function nB(n={}){return[Im.of(n),rB()]}let N_=null;function rB(){return N_||(N_=En.fromClass(class{constructor(n){this.view=n,this.decorations=Je.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(Im)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new X6({regexp:n.specialChars,decoration:(e,t,r)=>{let{doc:i}=t.state,s=Vr(e[0],0);if(s==9){let o=i.lineAt(r),l=t.state.tabSize,a=Du(o.text,l,r-o.from);return Je.replace({widget:new lB((l-a%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=Je.replace({widget:new oB(n,s)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(Im);n.startState.facet(Im)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const iB="";function sB(n){return n>=32?iB:n==10?"":String.fromCharCode(9216+n)}class oB extends To{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=sB(this.code),r=e.state.phrase("Control character")+" "+(eB[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,r,t);if(i)return i;let s=document.createElement("span");return s.textContent=t,s.title=r,s.setAttribute("aria-label",r),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class lB extends To{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function aB(){return uB}const cB=Je.line({class:"cm-activeLine"}),uB=En.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let r of n.state.selection.ranges){let i=n.lineBlockAt(r.head);i.from>e&&(t.push(cB.range(i.from)),e=i.from)}return Je.set(t)}},{decorations:n=>n.decorations}),sw=2e3;function fB(n,e,t){let r=Math.min(e.line,t.line),i=Math.max(e.line,t.line),s=[];if(e.off>sw||t.off>sw||e.col<0||t.col<0){let o=Math.min(e.off,t.off),l=Math.max(e.off,t.off);for(let a=r;a<=i;a++){let c=n.doc.line(a);c.length<=l&&s.push(re.range(c.from+o,c.to+l))}}else{let o=Math.min(e.col,t.col),l=Math.max(e.col,t.col);for(let a=r;a<=i;a++){let c=n.doc.line(a),u=Rb(c.text,o,n.tabSize,!0);if(u<0)s.push(re.cursor(c.to));else{let f=Rb(c.text,l,n.tabSize);s.push(re.range(c.from+u,c.from+f))}}}return s}function hB(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function R_(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),r=n.state.doc.lineAt(t),i=t-r.from,s=i>sw?-1:i==r.length?hB(n,e.clientX):Du(r.text,n.state.tabSize,t-r.from);return{line:r.number,col:s,off:i}}function dB(n,e){let t=R_(n,e),r=n.state.selection;return t?{update(i){if(i.docChanged){let s=i.changes.mapPos(i.startState.doc.line(t.line).from),o=i.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},r=r.map(i.changes)}},get(i,s,o){let l=R_(n,i);if(!l)return r;let a=fB(n.state,t,l);return a.length?o?re.create(a.concat(r.ranges)):re.create(a):r}}:null}function pB(n){let e=t=>t.altKey&&t.button==0;return Re.mouseSelectionStyle.of((t,r)=>e(r)?dB(t,r):null)}const mB={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},gB={style:"cursor: crosshair"};function yB(n={}){let[e,t]=mB[n.key||"Alt"],r=En.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventObservers:{keydown(i){this.set(i.keyCode==e||t(i))},keyup(i){(i.keyCode==e||!t(i))&&this.set(!1)},mousemove(i){this.set(t(i))}}});return[r,Re.contentAttributes.of(i=>{var s;return!((s=i.plugin(r))===null||s===void 0)&&s.isDown?gB:null})]}const rf="-10000px";class kO{constructor(e,t,r,i){this.facet=t,this.createTooltipView=r,this.removeTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=r(o,s))}update(e,t){var r;let i=e.state.facet(this.facet),s=i.filter(a=>a);if(i===this.input){for(let a of this.tooltipViews)a.update&&a.update(e);return!1}let o=[],l=t?[]:null;for(let a=0;a<s.length;a++){let c=s[a],u=-1;if(c){for(let f=0;f<this.tooltips.length;f++){let p=this.tooltips[f];p&&p.create==c.create&&(u=f)}if(u<0)o[a]=this.createTooltipView(c,a?o[a-1]:null),l&&(l[a]=!!c.above);else{let f=o[a]=this.tooltipViews[u];l&&(l[a]=t[u]),f.update&&f.update(e)}}}for(let a of this.tooltipViews)o.indexOf(a)<0&&(this.removeTooltipView(a),(r=a.destroy)===null||r===void 0||r.call(a));return t&&(l.forEach((a,c)=>t[c]=a),t.length=l.length),this.input=i,this.tooltips=s,this.tooltipViews=o,!0}}function bB(n){let e=n.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const n1=Ie.define({combine:n=>{var e,t,r;return{position:Oe.ios?"absolute":((e=n.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(i=>i.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((r=n.find(i=>i.tooltipSpace))===null||r===void 0?void 0:r.tooltipSpace)||bB}}}),P_=new WeakMap,Zv=En.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(n1);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new kO(n,Yv,(t,r)=>this.createTooltip(t,r),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,r=n.state.facet(n1);if(r.position!=this.position&&!this.madeAbsolute){this.position=r.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;t=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),r=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",t.dom.appendChild(i)}return t.dom.style.position=this.position,t.dom.style.top=rf,t.dom.style.left="0px",this.container.insertBefore(t.dom,r),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let r of this.manager.tooltipViews)r.dom.remove(),(n=r.destroy)===null||n===void 0||n.call(r);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(Oe.gecko)t=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==rf&&s.style.left=="0px"){let o=s.getBoundingClientRect();t=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(t||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(n=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let r=this.view.scrollDOM.getBoundingClientRect(),i=Uv(this.view);return{visible:{left:r.left+i.left,top:r.top+i.top,right:r.right-i.right,bottom:r.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let l=this.manager.tooltipViews[o];return l.getCoords?l.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(n1).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{visible:t,space:r,scaleX:i,scaleY:s}=n,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:u}=c,f=n.pos[l],p=n.size[l];if(!f||a.clip!==!1&&(f.bottom<=Math.max(t.top,r.top)||f.top>=Math.min(t.bottom,r.bottom)||f.right<Math.max(t.left,r.left)-.1||f.left>Math.min(t.right,r.right)+.1)){u.style.top=rf;continue}let g=a.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,y=g?7:0,v=p.right-p.left,k=(e=P_.get(c))!==null&&e!==void 0?e:p.bottom-p.top,x=c.offset||vB,_=this.view.textDirection==tn.LTR,M=p.width>r.right-r.left?_?r.left:r.right-p.width:_?Math.max(r.left,Math.min(f.left-(g?14:0)+x.x,r.right-v)):Math.min(Math.max(r.left,f.left-v+(g?14:0)-x.x),r.right-v),T=this.above[l];!a.strictSide&&(T?f.top-k-y-x.y<r.top:f.bottom+k+y+x.y>r.bottom)&&T==r.bottom-f.bottom>f.top-r.top&&(T=this.above[l]=!T);let S=(T?f.top-r.top:r.bottom-f.bottom)-y;if(S<k&&c.resize!==!1){if(S<this.view.defaultLineHeight){u.style.top=rf;continue}P_.set(c,k),u.style.height=(k=S)/s+"px"}else u.style.height&&(u.style.height="");let A=T?f.top-k-y-x.y:f.bottom+y+x.y,I=M+v;if(c.overlap!==!0)for(let B of o)B.left<I&&B.right>M&&B.top<A+k&&B.bottom>A&&(A=T?B.top-k-2-y:B.bottom+y+2);if(this.position=="absolute"?(u.style.top=(A-n.parent.top)/s+"px",B_(u,(M-n.parent.left)/i)):(u.style.top=A/s+"px",B_(u,M/i)),g){let B=f.left+(_?x.x:-x.x)-(M+14-7);g.style.left=B/i+"px"}c.overlap!==!0&&o.push({left:M,top:A,right:I,bottom:A+k}),u.classList.toggle("cm-tooltip-above",T),u.classList.toggle("cm-tooltip-below",!T),c.positioned&&c.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=rf}},{eventObservers:{scroll(){this.maybeMeasure()}}});function B_(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const wB=Re.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),vB={x:0,y:0},Yv=Ie.define({enables:[Zv,wB]}),Hg=Ie.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class I0{static create(e){return new I0(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new kO(e,Hg,(t,r)=>this.createHostedView(t,r),t=>t.dom.remove())}createHostedView(e,t){let r=e.create(this.view);return r.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(r.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&r.mount&&r.mount(this.view),r}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let r of this.manager.tooltipViews){let i=r[e];if(i!==void 0){if(t===void 0)t=i;else if(t!==i)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const kB=Yv.compute([Hg],n=>{let e=n.facet(Hg);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var r;return(r=t.end)!==null&&r!==void 0?r:t.pos})),create:I0.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class CB{constructor(e,t,r,i,s){this.view=e,this.source=t,this.field=r,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,r=e.docView.nearest(t.target);if(!r)return;let i,s=1;if(r instanceof il)i=r.posAtStart;else{if(i=e.posAtCoords(t),i==null)return;let l=e.coordsAtPos(i);if(!l||t.y<l.top||t.y>l.bottom||t.x<l.left-e.defaultCharacterWidth||t.x>l.right+e.defaultCharacterWidth)return;let a=e.bidiSpans(e.state.doc.lineAt(i)).find(u=>u.from<=i&&u.to>=i),c=a&&a.dir==tn.RTL?-1:1;s=t.x<l.left?-c:c}let o=this.source(e,i,s);if(o!=null&&o.then){let l=this.pending={pos:i};o.then(a=>{this.pending==l&&(this.pending=null,a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])}))},a=>jr(e.state,a,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(Zv),t=e?e.manager.tooltips.findIndex(r=>r.create==I0.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,r;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:s}=this;if(i.length&&s&&!SB(s.dom,e)||this.pending){let{pos:o}=i[0]||this.pending,l=(r=(t=i[0])===null||t===void 0?void 0:t.end)!==null&&r!==void 0?r:o;(o==l?this.view.posAtCoords(this.lastMove)!=o:!xB(this.view,o,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:r}=this;r&&r.dom.contains(e.relatedTarget)?this.watchTooltipLeave(r.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=r=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(r.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Yp=4;function SB(n,e){let{left:t,right:r,top:i,bottom:s}=n.getBoundingClientRect(),o;if(o=n.querySelector(".cm-tooltip-arrow")){let l=o.getBoundingClientRect();i=Math.min(l.top,i),s=Math.max(l.bottom,s)}return e.clientX>=t-Yp&&e.clientX<=r+Yp&&e.clientY>=i-Yp&&e.clientY<=s+Yp}function xB(n,e,t,r,i,s){let o=n.scrollDOM.getBoundingClientRect(),l=n.documentTop+n.documentPadding.top+n.contentHeight;if(o.left>r||o.right<r||o.top>i||Math.min(o.bottom,l)<i)return!1;let a=n.posAtCoords({x:r,y:i},!1);return a>=e&&a<=t}function _B(n,e={}){let t=it.define(),r=jn.define({create(){return[]},update(i,s){if(i.length&&(e.hideOnChange&&(s.docChanged||s.selection)?i=[]:e.hideOn&&(i=i.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let l of i){let a=s.changes.mapPos(l.pos,-1,Yn.TrackDel);if(a!=null){let c=Object.assign(Object.create(null),l);c.pos=a,c.end!=null&&(c.end=s.changes.mapPos(c.end)),o.push(c)}}i=o}for(let o of s.effects)o.is(t)&&(i=o.value),o.is(MB)&&(i=[]);return i},provide:i=>Hg.from(i)});return{active:r,extension:[r,En.define(i=>new CB(i,n,r,t,e.hoverTime||300)),kB]}}function CO(n,e){let t=n.plugin(Zv);if(!t)return null;let r=t.manager.tooltips.indexOf(e);return r<0?null:t.manager.tooltipViews[r]}const MB=it.define(),H_=Ie.define({combine(n){let e,t;for(let r of n)e=e||r.topContainer,t=t||r.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Kh(n,e){let t=n.plugin(SO),r=t?t.specs.indexOf(e):-1;return r>-1?t.panels[r]:null}const SO=En.fromClass(class{constructor(n){this.input=n.state.facet(Gh),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(H_);this.top=new Xp(n,!0,e.topContainer),this.bottom=new Xp(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(H_);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Xp(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Xp(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Gh);if(t!=this.input){let r=t.filter(a=>a),i=[],s=[],o=[],l=[];for(let a of r){let c=this.specs.indexOf(a),u;c<0?(u=a(n.view),l.push(u)):(u=this.panels[c],u.update&&u.update(n)),i.push(u),(u.top?s:o).push(u)}this.specs=r,this.panels=i,this.top.sync(s),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let r of this.panels)r.update&&r.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>Re.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Xp{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=V_(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=V_(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function V_(n){let e=n.nextSibling;return n.remove(),e}const Gh=Ie.define({enables:SO});class ko extends Na{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}ko.prototype.elementClass="";ko.prototype.toDOM=void 0;ko.prototype.mapMode=Yn.TrackBefore;ko.prototype.startSide=ko.prototype.endSide=-1;ko.prototype.point=!0;const Nm=Ie.define(),TB=Ie.define(),EB={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>xt.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},ch=Ie.define();function AB(n){return[xO(),ch.of({...EB,...n})]}const F_=Ie.define({combine:n=>n.some(e=>e)});function xO(n){return[OB]}const OB=En.fromClass(class{constructor(n){this.view=n,this.domAfter=null,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(ch).map(e=>new $_(n,e)),this.fixed=!n.state.facet(F_);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,r=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(r<(t.to-t.from)*.8)}if(n.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(F_)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=xt.iter(this.view.state.facet(Nm),this.view.viewport.from),r=[],i=this.gutters.map(s=>new LB(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(r.length&&(r=[]),Array.isArray(s.type)){let o=!0;for(let l of s.type)if(l.type==xr.Text&&o){ow(t,r,l.from);for(let a of i)a.line(this.view,l,r);o=!1}else if(l.widget)for(let a of i)a.widget(this.view,l)}else if(s.type==xr.Text){ow(t,r,s.from);for(let o of i)o.line(this.view,s,r)}else if(s.widget)for(let o of i)o.widget(this.view,s);for(let s of i)s.finish();n&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(n){let e=n.startState.facet(ch),t=n.state.facet(ch),r=n.docChanged||n.heightChanged||n.viewportChanged||!xt.eq(n.startState.facet(Nm),n.state.facet(Nm),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let i of this.gutters)i.update(n)&&(r=!0);else{r=!0;let i=[];for(let s of t){let o=e.indexOf(s);o<0?i.push(new $_(this.view,s)):(this.gutters[o].update(n),i.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)s.config.side=="after"?this.getDOMAfter().appendChild(s.dom):this.dom.appendChild(s.dom);this.gutters=i}return r}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:n=>Re.scrollMargins.of(e=>{let t=e.plugin(n);if(!t||t.gutters.length==0||!t.fixed)return null;let r=t.dom.offsetWidth*e.scaleX,i=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==tn.LTR?{left:r,right:i}:{right:r,left:i}})});function j_(n){return Array.isArray(n)?n:[n]}function ow(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class LB{constructor(e,t,r){this.gutter=e,this.height=r,this.i=0,this.cursor=xt.iter(e.markers,t.from)}addElement(e,t,r){let{gutter:i}=this,s=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==i.elements.length){let l=new _O(e,o,s,r);i.elements.push(l),i.dom.appendChild(l.dom)}else i.elements[this.i].update(e,o,s,r);this.height=t.bottom,this.i++}line(e,t,r){let i=[];ow(this.cursor,i,t.from),r.length&&(i=i.concat(r));let s=this.gutter.config.lineMarker(e,t,i);s&&i.unshift(s);let o=this.gutter;i.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,i)}widget(e,t){let r=this.gutter.config.widgetMarker(e,t.widget,t),i=r?[r]:null;for(let s of e.state.facet(TB)){let o=s(e,t.widget,t);o&&(i||(i=[])).push(o)}i&&this.addElement(e,t,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class $_{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let r in t.domEventHandlers)this.dom.addEventListener(r,i=>{let s=i.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let a=s.getBoundingClientRect();o=(a.top+a.bottom)/2}else o=i.clientY;let l=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[r](e,l,i)&&i.preventDefault()});this.markers=j_(t.markers(e)),t.initialSpacer&&(this.spacer=new _O(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=j_(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let r=e.view.viewport;return!xt.eq(this.markers,t,r.from,r.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class _O{constructor(e,t,r,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,r,i)}update(e,t,r,i){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),DB(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let r="cm-gutterElement",i=this.dom.firstChild;for(let s=0,o=0;;){let l=o,a=s<t.length?t[s++]:null,c=!1;if(a){let u=a.elementClass;u&&(r+=" "+u);for(let f=o;f<this.markers.length;f++)if(this.markers[f].compare(a)){l=f,c=!0;break}}else l=this.markers.length;for(;o<l;){let u=this.markers[o++];if(u.toDOM){u.destroy(i);let f=i.nextSibling;i.remove(),i=f}}if(!a)break;a.toDOM&&(c?i=i.nextSibling:this.dom.insertBefore(a.toDOM(e),i)),c&&o++}this.dom.className=r,this.markers=t}destroy(){this.setMarkers(null,[])}}function DB(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const IB=Ie.define(),NB=Ie.define(),xc=Ie.define({combine(n){return Is(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let r=Object.assign({},e);for(let i in t){let s=r[i],o=t[i];r[i]=s?(l,a,c)=>s(l,a,c)||o(l,a,c):o}return r}})}});class r1 extends ko{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function i1(n,e){return n.state.facet(xc).formatNumber(e,n.state)}const RB=ch.compute([xc],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(IB)},lineMarker(e,t,r){return r.some(i=>i.toDOM)?null:new r1(i1(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,r)=>{for(let i of e.state.facet(NB)){let s=i(e,t,r);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(xc)!=e.state.facet(xc),initialSpacer(e){return new r1(i1(e,z_(e.state.doc.lines)))},updateSpacer(e,t){let r=i1(t.view,z_(t.view.state.doc.lines));return r==e.number?e:new r1(r)},domEventHandlers:n.facet(xc).domEventHandlers,side:"before"}));function PB(n={}){return[xc.of(n),xO(),RB]}function z_(n){let e=9;for(;e<n;)e=e*10+9;return e}const BB=new class extends ko{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},HB=Nm.compute(["selection"],n=>{let e=[],t=-1;for(let r of n.selection.ranges){let i=n.doc.lineAt(r.head).from;i>t&&(t=i,e.push(BB.range(i)))}return xt.of(e)});function VB(){return HB}let FB=0;class mi{constructor(e,t,r,i){this.name=e,this.set=t,this.base=r,this.modified=i,this.id=FB++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let r=typeof e=="string"?e:"?";if(e instanceof mi&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let i=new mi(r,[],null,[]);if(i.set.push(i),t)for(let s of t.set)i.set.push(s);return i}static defineModifier(e){let t=new Vg(e);return r=>r.modified.indexOf(t)>-1?r:Vg.get(r.base||r,r.modified.concat(t).sort((i,s)=>i.id-s.id))}}let jB=0;class Vg{constructor(e){this.name=e,this.instances=[],this.id=jB++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(l=>l.base==e&&$B(t,l.modified));if(r)return r;let i=[],s=new mi(e.name,i,e,t);for(let l of t)l.instances.push(s);let o=zB(t);for(let l of e.set)if(!l.modified.length)for(let a of o)i.push(Vg.get(l,a));return s}}function $B(n,e){return n.length==e.length&&n.every((t,r)=>t==e[r])}function zB(n){let e=[[]];for(let t=0;t<n.length;t++)for(let r=0,i=e.length;r<i;r++)e.push(e[r].concat(n[t]));return e.sort((t,r)=>r.length-t.length)}function WB(n){let e=Object.create(null);for(let t in n){let r=n[t];Array.isArray(r)||(r=[r]);for(let i of t.split(" "))if(i){let s=[],o=2,l=i;for(let f=0;;){if(l=="..."&&f>0&&f+3==i.length){o=1;break}let p=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!p)throw new RangeError("Invalid path: "+i);if(s.push(p[0]=="*"?"":p[0][0]=='"'?JSON.parse(p[0]):p[0]),f+=p[0].length,f==i.length)break;let g=i[f++];if(f==i.length&&g=="!"){o=0;break}if(g!="/")throw new RangeError("Invalid path: "+i);l=i.slice(f)}let a=s.length-1,c=s[a];if(!c)throw new RangeError("Invalid path: "+i);let u=new Jh(r,o,a>0?s.slice(0,a):null);e[c]=u.sort(e[c])}}return MO.add(e)}const MO=new pt({combine(n,e){let t,r,i;for(;n||e;){if(!n||e&&n.depth>=e.depth?(i=e,e=e.next):(i=n,n=n.next),t&&t.mode==i.mode&&!i.context&&!t.context)continue;let s=new Jh(i.tags,i.mode,i.context);t?t.next=s:r=s,t=s}return r}});class Jh{constructor(e,t,r,i){this.tags=e,this.mode=t,this.context=r,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Jh.empty=new Jh([],2,null);function TO(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:r,all:i=null}=e||{};return{style:s=>{let o=i;for(let l of s)for(let a of l.set){let c=t[a.id];if(c){o=o?o+" "+c:c;break}}return o},scope:r}}function qB(n,e){let t=null;for(let r of n){let i=r.style(e);i&&(t=t?t+" "+i:i)}return t}function UB(n,e,t,r=0,i=n.length){let s=new KB(r,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),r,i,"",s.highlighters),s.flush(i)}class KB{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,i,s){let{type:o,from:l,to:a}=e;if(l>=r||a<=t)return;o.isTop&&(s=this.highlighters.filter(g=>!g.scope||g.scope(o)));let c=i,u=GB(e)||Jh.empty,f=qB(s,u.tags);if(f&&(c&&(c+=" "),c+=f,u.mode==1&&(i+=(i?" ":"")+f)),this.startSpan(Math.max(t,l),c),u.opaque)return;let p=e.tree&&e.tree.prop(pt.mounted);if(p&&p.overlay){let g=e.node.enter(p.overlay[0].from+l,1),y=this.highlighters.filter(k=>!k.scope||k.scope(p.tree.type)),v=e.firstChild();for(let k=0,x=l;;k++){let _=k<p.overlay.length?p.overlay[k]:null,M=_?_.from+l:a,T=Math.max(t,x),S=Math.min(r,M);if(T<S&&v)for(;e.from<S&&(this.highlightRange(e,T,S,i,s),this.startSpan(Math.min(S,e.to),c),!(e.to>=M||!e.nextSibling())););if(!_||M>r)break;x=_.to+l,x>t&&(this.highlightRange(g.cursor(),Math.max(t,_.from+l),Math.min(r,x),"",y),this.startSpan(Math.min(r,x),c))}v&&e.parent()}else if(e.firstChild()){p&&(i="");do if(!(e.to<=t)){if(e.from>=r)break;this.highlightRange(e,t,r,i,s),this.startSpan(Math.min(r,e.to),c)}while(e.nextSibling());e.parent()}}}function GB(n){let e=n.type.prop(MO);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const Ee=mi.define,Qp=Ee(),zo=Ee(),W_=Ee(zo),q_=Ee(zo),Wo=Ee(),em=Ee(Wo),s1=Ee(Wo),hs=Ee(),Bl=Ee(hs),cs=Ee(),us=Ee(),lw=Ee(),sf=Ee(lw),tm=Ee(),ee={comment:Qp,lineComment:Ee(Qp),blockComment:Ee(Qp),docComment:Ee(Qp),name:zo,variableName:Ee(zo),typeName:W_,tagName:Ee(W_),propertyName:q_,attributeName:Ee(q_),className:Ee(zo),labelName:Ee(zo),namespace:Ee(zo),macroName:Ee(zo),literal:Wo,string:em,docString:Ee(em),character:Ee(em),attributeValue:Ee(em),number:s1,integer:Ee(s1),float:Ee(s1),bool:Ee(Wo),regexp:Ee(Wo),escape:Ee(Wo),color:Ee(Wo),url:Ee(Wo),keyword:cs,self:Ee(cs),null:Ee(cs),atom:Ee(cs),unit:Ee(cs),modifier:Ee(cs),operatorKeyword:Ee(cs),controlKeyword:Ee(cs),definitionKeyword:Ee(cs),moduleKeyword:Ee(cs),operator:us,derefOperator:Ee(us),arithmeticOperator:Ee(us),logicOperator:Ee(us),bitwiseOperator:Ee(us),compareOperator:Ee(us),updateOperator:Ee(us),definitionOperator:Ee(us),typeOperator:Ee(us),controlOperator:Ee(us),punctuation:lw,separator:Ee(lw),bracket:sf,angleBracket:Ee(sf),squareBracket:Ee(sf),paren:Ee(sf),brace:Ee(sf),content:hs,heading:Bl,heading1:Ee(Bl),heading2:Ee(Bl),heading3:Ee(Bl),heading4:Ee(Bl),heading5:Ee(Bl),heading6:Ee(Bl),contentSeparator:Ee(hs),list:Ee(hs),quote:Ee(hs),emphasis:Ee(hs),strong:Ee(hs),link:Ee(hs),monospace:Ee(hs),strikethrough:Ee(hs),inserted:Ee(),deleted:Ee(),changed:Ee(),invalid:Ee(),meta:tm,documentMeta:Ee(tm),annotation:Ee(tm),processingInstruction:Ee(tm),definition:mi.defineModifier("definition"),constant:mi.defineModifier("constant"),function:mi.defineModifier("function"),standard:mi.defineModifier("standard"),local:mi.defineModifier("local"),special:mi.defineModifier("special")};for(let n in ee){let e=ee[n];e instanceof mi&&(e.name=n)}TO([{tag:ee.link,class:"tok-link"},{tag:ee.heading,class:"tok-heading"},{tag:ee.emphasis,class:"tok-emphasis"},{tag:ee.strong,class:"tok-strong"},{tag:ee.keyword,class:"tok-keyword"},{tag:ee.atom,class:"tok-atom"},{tag:ee.bool,class:"tok-bool"},{tag:ee.url,class:"tok-url"},{tag:ee.labelName,class:"tok-labelName"},{tag:ee.inserted,class:"tok-inserted"},{tag:ee.deleted,class:"tok-deleted"},{tag:ee.literal,class:"tok-literal"},{tag:ee.string,class:"tok-string"},{tag:ee.number,class:"tok-number"},{tag:[ee.regexp,ee.escape,ee.special(ee.string)],class:"tok-string2"},{tag:ee.variableName,class:"tok-variableName"},{tag:ee.local(ee.variableName),class:"tok-variableName tok-local"},{tag:ee.definition(ee.variableName),class:"tok-variableName tok-definition"},{tag:ee.special(ee.variableName),class:"tok-variableName2"},{tag:ee.definition(ee.propertyName),class:"tok-propertyName tok-definition"},{tag:ee.typeName,class:"tok-typeName"},{tag:ee.namespace,class:"tok-namespace"},{tag:ee.className,class:"tok-className"},{tag:ee.macroName,class:"tok-macroName"},{tag:ee.propertyName,class:"tok-propertyName"},{tag:ee.operator,class:"tok-operator"},{tag:ee.comment,class:"tok-comment"},{tag:ee.meta,class:"tok-meta"},{tag:ee.invalid,class:"tok-invalid"},{tag:ee.punctuation,class:"tok-punctuation"}]);var o1;const ta=new pt;function EO(n){return Ie.define({combine:n?e=>e.concat(n):void 0})}const JB=new pt;class bi{constructor(e,t,r=[],i=""){this.data=e,this.name=i,ln.prototype.hasOwnProperty("tree")||Object.defineProperty(ln.prototype,"tree",{get(){return er(this)}}),this.parser=t,this.extension=[bl.of(this),ln.languageData.of((s,o,l)=>{let a=U_(s,o,l),c=a.type.prop(ta);if(!c)return[];let u=s.facet(c),f=a.type.prop(JB);if(f){let p=a.resolve(o-a.from,l);for(let g of f)if(g.test(p,s)){let y=s.facet(g.facet);return g.type=="replace"?y:y.concat(u)}}return u})].concat(r)}isActiveAt(e,t,r=-1){return U_(e,t,r).type.prop(ta)==this.data}findRegions(e){let t=e.facet(bl);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let r=[],i=(s,o)=>{if(s.prop(ta)==this.data){r.push({from:o,to:o+s.length});return}let l=s.prop(pt.mounted);if(l){if(l.tree.prop(ta)==this.data){if(l.overlay)for(let a of l.overlay)r.push({from:a.from+o,to:a.to+o});else r.push({from:o,to:o+s.length});return}else if(l.overlay){let a=r.length;if(i(l.tree,l.overlay[0].from+o),r.length>a)return}}for(let a=0;a<s.children.length;a++){let c=s.children[a];c instanceof Jt&&i(c,s.positions[a]+o)}};return i(er(e),0),r}get allowsNesting(){return!0}}bi.setState=it.define();function U_(n,e,t){let r=n.facet(bl),i=er(n).topNode;if(!r||r.allowsNesting)for(let s=i;s;s=s.enter(e,t,fn.ExcludeBuffers))s.type.isTop&&(i=s);return i}class aw extends bi{constructor(e,t,r){super(e,t,[],r),this.parser=t}static define(e){let t=EO(e.languageData);return new aw(t,e.parser.configure({props:[ta.add(r=>r.isTop?t:void 0)]}),e.name)}configure(e,t){return new aw(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function er(n){let e=n.field(bi.state,!1);return e?e.tree:Jt.empty}class ZB{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let of=null,cw=class uw{constructor(e,t,r=[],i,s,o,l,a){this.parser=e,this.state=t,this.fragments=r,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new uw(e,t,[],Jt.empty,0,r,[],null)}startParse(){return this.parser.startParse(new ZB(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Jt.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(mo.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(mo.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=of;of=this;try{return e()}finally{of=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=K_(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((c,u,f,p)=>a.push({fromA:c,toA:u,fromB:f,toB:p})),r=mo.applyChanges(r,a),i=Jt.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),f=e.mapPos(c.to,-1);u<f&&l.push({from:u,to:f})}}}return new uw(this.parser,t,r,i,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:i,to:s}=this.skipped[r];i<e.to&&s>e.from&&(this.fragments=K_(this.fragments,i,s),this.skipped.splice(r--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends GA{createParse(t,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let a=of;if(a){for(let c of i)a.tempSkipped.push(c);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new Jt(ai.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return of}};function K_(n,e,t){return mo.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class gu{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new gu(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=cw.create(e.facet(bl).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new gu(r)}}bi.state=jn.define({create:gu.init,update(n,e){for(let t of e.effects)if(t.is(bi.setState))return t.value;return e.startState.facet(bl)!=e.state.facet(bl)?gu.init(e.state):n.apply(e)}});let AO=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(AO=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const l1=typeof navigator<"u"&&(!((o1=navigator.scheduling)===null||o1===void 0)&&o1.isInputPending)?()=>navigator.scheduling.isInputPending():null,YB=En.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(bi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(bi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=AO(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:i}}=this.view,s=r.field(bi.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!l1?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<i&&r.doc.length>i+1e3,a=s.context.work(()=>l1&&l1()||Date.now()>o,i+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:bi.setState.of(new gu(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>jr(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),bl=Ie.define({combine(n){return n.length?n[0]:null},enables:n=>[bi.state,YB,Re.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class XB{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}class G{constructor(e,t,r,i,s,o=void 0){this.name=e,this.alias=t,this.extensions=r,this.filename=i,this.loadFunc=s,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:r}=e;if(!t){if(!r)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(r)}return new G(e.name,(e.alias||[]).concat(e.name).map(i=>i.toLowerCase()),e.extensions||[],e.filename,t,r)}static matchFilename(e,t){for(let i of e)if(i.filename&&i.filename.test(t))return i;let r=/\.([^.]+)$/.exec(t);if(r){for(let i of e)if(i.extensions.indexOf(r[1])>-1)return i}return null}static matchLanguageName(e,t,r=!0){t=t.toLowerCase();for(let i of e)if(i.alias.some(s=>s==t))return i;if(r)for(let i of e)for(let s of i.alias){let o=t.indexOf(s);if(o>-1&&(s.length>2||!/\w/.test(t[o-1])&&!/\w/.test(t[o+s.length])))return i}return null}}const QB=Ie.define(),N0=Ie.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function Ha(n){let e=n.facet(N0);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function Zh(n,e){let t="",r=n.tabSize,i=n.facet(N0)[0];if(i=="	"){for(;e>=r;)t+="	",e-=r;i=" "}for(let s=0;s<e;s++)t+=i;return t}function Xv(n,e){n instanceof ln&&(n=new R0(n));for(let r of n.state.facet(QB)){let i=r(n,e);if(i!==void 0)return i}let t=er(n.state);return t.length>=e?eH(n,t,e):null}class R0{constructor(e,t={}){this.state=e,this.options=t,this.unit=Ha(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=r.from&&i<=r.to?s&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:r.text.slice(i-r.from),from:i}:{text:r.text.slice(0,i-r.from),from:r.from}:r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:i}=this.lineAt(e,t);return r.slice(e-i,Math.min(r.length,e+100-i))}column(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.countColumn(r,e-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,t=e.length){return Du(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(i);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const OO=new pt;function eH(n,e,t){let r=e.resolveStack(t),i=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(i!=r.node){let s=[];for(let o=i;o&&!(o.from<r.node.from||o.to>r.node.to||o.from==r.node.from&&o.type==r.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)r={node:s[o],next:r}}return LO(r,n,t)}function LO(n,e,t){for(let r=n;r;r=r.next){let i=nH(r.node);if(i)return i(Qv.create(e,t,r))}return 0}function tH(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function nH(n){let e=n.type.prop(OO);if(e)return e;let t=n.firstChild,r;if(t&&(r=t.type.prop(pt.closedBy))){let i=n.lastChild,s=i&&r.indexOf(i.name)>-1;return o=>DO(o,!0,1,void 0,s&&!tH(o)?i.from:void 0)}return n.parent==null?rH:null}function rH(){return 0}class Qv extends R0{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.context=r}get node(){return this.context.node}static create(e,t,r){return new Qv(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(t.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(iH(r,e))break;t=this.state.doc.lineAt(r.from)}return this.lineIndent(t.from)}continue(){return LO(this.context.next,this.base,this.pos)}}function iH(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function sH(n){let e=n.node,t=e.childAfter(e.from),r=e.lastChild;if(!t)return null;let i=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==r)return null;if(!a.type.isSkipped){if(a.from>=o)return null;let c=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+c}}l=a.to}}function nne({closing:n,align:e=!0,units:t=1}){return r=>DO(r,e,t,n)}function DO(n,e,t,r,i){let s=n.textAfter,o=s.match(/^\s*/)[0].length,l=r&&s.slice(o,o+r.length)==r||i==n.pos+o,a=e?sH(n):null;return a?l?n.column(a.from):n.column(a.to):n.baseIndent+(l?0:n.unit*t)}const rne=n=>n.baseIndent;function ine({except:n,units:e=1}={}){return t=>{let r=n&&n.test(t.textAfter);return t.baseIndent+(r?0:e*t.unit)}}const oH=200;function lH(){return ln.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:r}=n.newSelection.main,i=t.lineAt(r);if(r>i.from+oH)return n;let s=t.sliceString(i.from,r);if(!e.some(c=>c.test(s)))return n;let{state:o}=n,l=-1,a=[];for(let{head:c}of o.selection.ranges){let u=o.doc.lineAt(c);if(u.from==l)continue;l=u.from;let f=Xv(o,u.from);if(f==null)continue;let p=/^\s*/.exec(u.text)[0],g=Zh(o,f);p!=g&&a.push({from:u.from,to:u.from+p.length,insert:g})}return a.length?[n,{changes:a,sequential:!0}]:n})}const aH=Ie.define(),cH=new pt;function sne(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function uH(n,e,t){let r=er(n);if(r.length<t)return null;let i=r.resolveStack(t,1),s=null;for(let o=i;o;o=o.next){let l=o.node;if(l.to<=t||l.from>t)continue;if(s&&l.from<e)break;let a=l.type.prop(cH);if(a&&(l.to<r.length-50||r.length==n.doc.length||!fH(l))){let c=a(l,n);c&&c.from<=t&&c.from>=e&&c.to>t&&(s=c)}}return s}function fH(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function Fg(n,e,t){for(let r of n.facet(aH)){let i=r(n,e,t);if(i)return i}return uH(n,e,t)}function IO(n,e){let t=e.mapPos(n.from,1),r=e.mapPos(n.to,-1);return t>=r?void 0:{from:t,to:r}}const P0=it.define({map:IO}),ep=it.define({map:IO});function NO(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(r=>r.from<=t&&r.to>=t)||e.push(n.lineBlockAt(t));return e}const Va=jn.define({create(){return Je.none},update(n,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,r)=>n=G_(n,t,r)),n=n.map(e.changes);for(let t of e.effects)if(t.is(P0)&&!hH(n,t.value.from,t.value.to)){let{preparePlaceholder:r}=e.state.facet(BO),i=r?Je.replace({widget:new wH(r(e.state,t.value))}):J_;n=n.update({add:[i.range(t.value.from,t.value.to)]})}else t.is(ep)&&(n=n.update({filter:(r,i)=>t.value.from!=r||t.value.to!=i,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(n=G_(n,e.selection.main.head)),n},provide:n=>Re.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(r,i)=>{t.push(r,i)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let r=n[t++],i=n[t++];if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(J_.range(r,i))}return Je.set(e,!0)}});function G_(n,e,t=e){let r=!1;return n.between(e,t,(i,s)=>{i<t&&s>e&&(r=!0)}),r?n.update({filterFrom:e,filterTo:t,filter:(i,s)=>i>=t||s<=e}):n}function jg(n,e,t){var r;let i=null;return(r=n.field(Va,!1))===null||r===void 0||r.between(e,t,(s,o)=>{(!i||i.from>s)&&(i={from:s,to:o})}),i}function hH(n,e,t){let r=!1;return n.between(e,e,(i,s)=>{i==e&&s==t&&(r=!0)}),r}function RO(n,e){return n.field(Va,!1)?e:e.concat(it.appendConfig.of(HO()))}const dH=n=>{for(let e of NO(n)){let t=Fg(n.state,e.from,e.to);if(t)return n.dispatch({effects:RO(n.state,[P0.of(t),PO(n,t)])}),!0}return!1},pH=n=>{if(!n.state.field(Va,!1))return!1;let e=[];for(let t of NO(n)){let r=jg(n.state,t.from,t.to);r&&e.push(ep.of(r),PO(n,r,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function PO(n,e,t=!0){let r=n.state.doc.lineAt(e.from).number,i=n.state.doc.lineAt(e.to).number;return Re.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${r} ${n.state.phrase("to")} ${i}.`)}const mH=n=>{let{state:e}=n,t=[];for(let r=0;r<e.doc.length;){let i=n.lineBlockAt(r),s=Fg(e,i.from,i.to);s&&t.push(P0.of(s)),r=(s?n.lineBlockAt(s.to):i).to+1}return t.length&&n.dispatch({effects:RO(n.state,t)}),!!t.length},gH=n=>{let e=n.state.field(Va,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(r,i)=>{t.push(ep.of({from:r,to:i}))}),n.dispatch({effects:t}),!0},yH=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:dH},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:pH},{key:"Ctrl-Alt-[",run:mH},{key:"Ctrl-Alt-]",run:gH}],bH={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},BO=Ie.define({combine(n){return Is(n,bH)}});function HO(n){return[Va,CH]}function VO(n,e){let{state:t}=n,r=t.facet(BO),i=o=>{let l=n.lineBlockAt(n.posAtDOM(o.target)),a=jg(n.state,l.from,l.to);a&&n.dispatch({effects:ep.of(a)}),o.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(n,i,e);let s=document.createElement("span");return s.textContent=r.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const J_=Je.replace({widget:new class extends To{toDOM(n){return VO(n,null)}}});class wH extends To{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return VO(e,this.value)}}const vH={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class a1 extends ko{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function kH(n={}){let e={...vH,...n},t=new a1(e,!0),r=new a1(e,!1),i=En.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(bl)!=o.state.facet(bl)||o.startState.field(Va,!1)!=o.state.field(Va,!1)||er(o.startState)!=er(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new bo;for(let a of o.viewportLineBlocks){let c=jg(o.state,a.from,a.to)?r:Fg(o.state,a.from,a.to)?t:null;c&&l.add(a.from,a.from,c)}return l.finish()}}),{domEventHandlers:s}=e;return[i,AB({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(i))===null||l===void 0?void 0:l.markers)||xt.empty},initialSpacer(){return new a1(e,!1)},domEventHandlers:{...s,click:(o,l,a)=>{if(s.click&&s.click(o,l,a))return!0;let c=jg(o.state,l.from,l.to);if(c)return o.dispatch({effects:ep.of(c)}),!0;let u=Fg(o.state,l.from,l.to);return u?(o.dispatch({effects:P0.of(u)}),!0):!1}}}),HO()]}const CH=Re.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class tp{constructor(e,t){this.specs=e;let r;function i(l){let a=gl.newName();return(r||(r=Object.create(null)))["."+a]=l,a}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,o=t.scope;this.scope=o instanceof bi?l=>l.prop(ta)==o.data:o?l=>l==o:void 0,this.style=TO(e.map(l=>({tag:l.tag,class:l.class||i(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=r?new gl(r):null,this.themeType=t.themeType}static define(e,t){return new tp(e,t||{})}}const fw=Ie.define(),FO=Ie.define({combine(n){return n.length?[n[0]]:null}});function c1(n){let e=n.facet(fw);return e.length?e:n.facet(FO)}function jO(n,e){let t=[xH],r;return n instanceof tp&&(n.module&&t.push(Re.styleModule.of(n.module)),r=n.themeType),e!=null&&e.fallback?t.push(FO.of(n)):r?t.push(fw.computeN([Re.darkTheme],i=>i.facet(Re.darkTheme)==(r=="dark")?[n]:[])):t.push(fw.of(n)),t}class SH{constructor(e){this.markCache=Object.create(null),this.tree=er(e.state),this.decorations=this.buildDeco(e,c1(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=er(e.state),r=c1(e.state),i=r!=c1(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!i&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return Je.none;let r=new bo;for(let{from:i,to:s}of e.visibleRanges)UB(this.tree,t,(o,l,a)=>{r.add(o,l,this.markCache[a]||(this.markCache[a]=Je.mark({class:a})))},i,s);return r.finish()}}const xH=Cl.high(En.fromClass(SH,{decorations:n=>n.decorations})),_H=tp.define([{tag:ee.meta,color:"#404740"},{tag:ee.link,textDecoration:"underline"},{tag:ee.heading,textDecoration:"underline",fontWeight:"bold"},{tag:ee.emphasis,fontStyle:"italic"},{tag:ee.strong,fontWeight:"bold"},{tag:ee.strikethrough,textDecoration:"line-through"},{tag:ee.keyword,color:"#708"},{tag:[ee.atom,ee.bool,ee.url,ee.contentSeparator,ee.labelName],color:"#219"},{tag:[ee.literal,ee.inserted],color:"#164"},{tag:[ee.string,ee.deleted],color:"#a11"},{tag:[ee.regexp,ee.escape,ee.special(ee.string)],color:"#e40"},{tag:ee.definition(ee.variableName),color:"#00f"},{tag:ee.local(ee.variableName),color:"#30a"},{tag:[ee.typeName,ee.namespace],color:"#085"},{tag:ee.className,color:"#167"},{tag:[ee.special(ee.variableName),ee.macroName],color:"#256"},{tag:ee.definition(ee.propertyName),color:"#00c"},{tag:ee.comment,color:"#940"},{tag:ee.invalid,color:"#f00"}]),MH=Re.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),$O=1e4,zO="()[]{}",WO=Ie.define({combine(n){return Is(n,{afterCursor:!0,brackets:zO,maxScanDistance:$O,renderMatch:AH})}}),TH=Je.mark({class:"cm-matchingBracket"}),EH=Je.mark({class:"cm-nonmatchingBracket"});function AH(n){let e=[],t=n.matched?TH:EH;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const OH=jn.define({create(){return Je.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],r=e.state.facet(WO);for(let i of e.state.selection.ranges){if(!i.empty)continue;let s=Cs(e.state,i.head,-1,r)||i.head>0&&Cs(e.state,i.head-1,1,r)||r.afterCursor&&(Cs(e.state,i.head,1,r)||i.head<e.state.doc.length&&Cs(e.state,i.head+1,-1,r));s&&(t=t.concat(r.renderMatch(s,e.state)))}return Je.set(t,!0)},provide:n=>Re.decorations.from(n)}),LH=[OH,MH];function DH(n={}){return[WO.of(n),LH]}const IH=new pt;function hw(n,e,t){let r=n.prop(e<0?pt.openedBy:pt.closedBy);if(r)return r;if(n.name.length==1){let i=t.indexOf(n.name);if(i>-1&&i%2==(e<0?1:0))return[t[i+e]]}return null}function dw(n){let e=n.type.prop(IH);return e?e(n.node):n}function Cs(n,e,t,r={}){let i=r.maxScanDistance||$O,s=r.brackets||zO,o=er(n),l=o.resolveInner(e,t);for(let a=l;a;a=a.parent){let c=hw(a.type,t,s);if(c&&a.from<a.to){let u=dw(a);if(u&&(t>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return NH(n,e,t,a,u,c,s)}}return RH(n,e,t,o,l.type,i,s)}function NH(n,e,t,r,i,s,o){let l=r.parent,a={from:i.from,to:i.to},c=0,u=l==null?void 0:l.cursor();if(u&&(t<0?u.childBefore(r.from):u.childAfter(r.to)))do if(t<0?u.to<=r.from:u.from>=r.to){if(c==0&&s.indexOf(u.type.name)>-1&&u.from<u.to){let f=dw(u);return{start:a,end:f?{from:f.from,to:f.to}:void 0,matched:!0}}else if(hw(u.type,t,o))c++;else if(hw(u.type,-t,o)){if(c==0){let f=dw(u);return{start:a,end:f&&f.from<f.to?{from:f.from,to:f.to}:void 0,matched:!1}}c--}}while(t<0?u.prevSibling():u.nextSibling());return{start:a,matched:!1}}function RH(n,e,t,r,i,s,o){let l=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},u=n.doc.iterRange(e,t>0?n.doc.length:0),f=0;for(let p=0;!u.next().done&&p<=s;){let g=u.value;t<0&&(p+=g.length);let y=e+p*t;for(let v=t>0?0:g.length-1,k=t>0?g.length:-1;v!=k;v+=t){let x=o.indexOf(g[v]);if(!(x<0||r.resolveInner(y+v,1).type!=i))if(x%2==0==t>0)f++;else{if(f==1)return{start:c,end:{from:y+v,to:y+v+1},matched:x>>1==a>>1};f--}}t>0&&(p+=g.length)}return u.done?{start:c,matched:!1}:null}function Z_(n,e,t,r=0,i=0){e==null&&(e=n.search(/[^\s\u00a0]/),e==-1&&(e=n.length));let s=i;for(let o=r;o<e;o++)n.charCodeAt(o)==9?s+=t-s%t:s++;return s}class qO{constructor(e,t,r,i){this.string=e,this.tabSize=t,this.indentUnit=r,this.overrideIndent=i,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),r;if(typeof e=="string"?r=t==e:r=t&&(e instanceof RegExp?e.test(t):e(t)),r)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Z_(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:Z_(this.string,null,this.tabSize)}match(e,t,r){if(typeof e=="string"){let i=o=>r?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return i(s)==i(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&t!==!1&&(this.pos+=i[0].length),i)}}current(){return this.string.slice(this.start,this.pos)}}function PH(n){return{name:n.name||"",token:n.token,blankLine:n.blankLine||(()=>{}),startState:n.startState||(()=>!0),copyState:n.copyState||BH,indent:n.indent||(()=>null),languageData:n.languageData||{},tokenTable:n.tokenTable||nk,mergeTokens:n.mergeTokens!==!1}}function BH(n){if(typeof n!="object")return n;let e={};for(let t in n){let r=n[t];e[t]=r instanceof Array?r.slice():r}return e}const Y_=new WeakMap;class ek extends bi{constructor(e){let t=EO(e.languageData),r=PH(e),i,s=new class extends GA{createParse(o,l,a){return new VH(i,o,l,a)}};super(t,s,[],e.name),this.topNode=$H(t,this),i=this,this.streamParser=r,this.stateAfter=new pt({perNode:!0}),this.tokenTable=e.tokenTable?new JO(r.tokenTable):jH}static define(e){return new ek(e)}getIndent(e){let t,{overrideIndentation:r}=e.options;r&&(t=Y_.get(e.state),t!=null&&t<e.pos-1e4&&(t=void 0));let i=tk(this,e.node.tree,e.node.from,e.node.from,t??e.pos),s,o;if(i?(o=i.state,s=i.pos+1):(o=this.streamParser.startState(e.unit),s=e.node.from),e.pos-s>1e4)return null;for(;s<e.pos;){let a=e.state.doc.lineAt(s),c=Math.min(e.pos,a.to);if(a.length){let u=r?r(a.from):-1,f=new qO(a.text,e.state.tabSize,e.unit,u<0?void 0:u);for(;f.pos<c-a.from;)KO(this.streamParser.token,f,o)}else this.streamParser.blankLine(o,e.unit);if(c==e.pos)break;s=a.to+1}let l=e.lineAt(e.pos);return r&&t==null&&Y_.set(e.state,l.from),this.streamParser.indent(o,/^\s*(.*)/.exec(l.text)[1],e)}get allowsNesting(){return!1}}function tk(n,e,t,r,i){let s=t>=r&&t+e.length<=i&&e.prop(n.stateAfter);if(s)return{state:n.streamParser.copyState(s),pos:t+e.length};for(let o=e.children.length-1;o>=0;o--){let l=e.children[o],a=t+e.positions[o],c=l instanceof Jt&&a<i&&tk(n,l,a,r,i);if(c)return c}return null}function UO(n,e,t,r,i){if(i&&t<=0&&r>=e.length)return e;!i&&t==0&&e.type==n.topNode&&(i=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],l=e.children[s],a;if(o<r&&l instanceof Jt){if(!(a=UO(n,l,t-o,r-o,i)))break;return i?new Jt(e.type,e.children.slice(0,s).concat(a),e.positions.slice(0,s+1),o+a.length):a}}return null}function HH(n,e,t,r,i){for(let s of e){let o=s.from+(s.openStart?25:0),l=s.to-(s.openEnd?25:0),a=o<=t&&l>t&&tk(n,s.tree,0-s.offset,t,l),c;if(a&&a.pos<=r&&(c=UO(n,s.tree,t+s.offset,a.pos+s.offset,!1)))return{state:a.state,tree:c}}return{state:n.streamParser.startState(i?Ha(i):4),tree:Jt.empty}}class VH{constructor(e,t,r,i){this.lang=e,this.input=t,this.fragments=r,this.ranges=i,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=i[i.length-1].to;let s=cw.get(),o=i[0].from,{state:l,tree:a}=HH(e,r,o,this.to,s==null?void 0:s.state);this.state=l,this.parsedPos=this.chunkStart=o+a.length;for(let c=0;c<a.children.length;c++)this.chunks.push(a.children[c]),this.chunkPos.push(a.positions[c]);s&&this.parsedPos<s.viewport.from-1e5&&i.some(c=>c.from<=s.viewport.from&&c.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(Ha(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=cw.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),r=Math.min(t,this.chunkStart+512);for(e&&(r=Math.min(r,e.viewport.to));this.parsedPos<r;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let r=t.indexOf(`
`);r>-1&&(t=t.slice(0,r))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),r=e+t.length;for(let i=this.rangeIndex;;){let s=this.ranges[i].to;if(s>=r||(t=t.slice(0,s-(r-t.length)),i++,i==this.ranges.length))break;let o=this.ranges[i].from,l=this.lineAfter(o);t+=l,r=o+l.length}return{line:t,end:r}}skipGapsTo(e,t,r){for(;;){let i=this.ranges[this.rangeIndex].to,s=e+t;if(r>0?i>s:i>=s)break;let o=this.ranges[++this.rangeIndex].from;t+=o-i}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,r,i){let s=4;if(this.ranges.length>1){i=this.skipGapsTo(t,i,1),t+=i;let l=this.chunk.length;i=this.skipGapsTo(r,i,-1),r+=i,s+=this.chunk.length-l}let o=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&s==4&&o>=0&&this.chunk[o]==e&&this.chunk[o+2]==t?this.chunk[o+2]=r:this.chunk.push(e,t,r,s),i}parseLine(e){let{line:t,end:r}=this.nextLine(),i=0,{streamParser:s}=this.lang,o=new qO(t,e?e.state.tabSize:4,e?Ha(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let l=KO(s.token,o,this.state);if(l&&(i=this.emitToken(this.lang.tokenTable.resolve(l),this.parsedPos+o.start,this.parsedPos+o.pos,i)),o.start>1e4)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Jt.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:FH,topID:0,maxBufferLength:512,reused:this.chunkReused});e=new Jt(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Jt(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function KO(n,e,t){e.start=e.pos;for(let r=0;r<10;r++){let i=n(e,t);if(e.pos>e.start)return i}throw new Error("Stream parser failed to advance stream.")}const nk=Object.create(null),Yh=[ai.none],FH=new Iv(Yh),X_=[],Q_=Object.create(null),GO=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])GO[n]=ZO(nk,e);class JO{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),GO)}resolve(e){return e?this.table[e]||(this.table[e]=ZO(this.extra,e)):0}}const jH=new JO(nk);function u1(n,e){X_.indexOf(n)>-1||(X_.push(n),console.warn(e))}function ZO(n,e){let t=[];for(let l of e.split(" ")){let a=[];for(let c of l.split(".")){let u=n[c]||ee[c];u?typeof u=="function"?a.length?a=a.map(u):u1(c,`Modifier ${c} used at start of tag`):a.length?u1(c,`Tag ${c} used as modifier`):a=Array.isArray(u)?u:[u]:u1(c,`Unknown highlighting tag ${c}`)}for(let c of a)t.push(c)}if(!t.length)return 0;let r=e.replace(/ /g,"_"),i=r+" "+t.map(l=>l.id),s=Q_[i];if(s)return s.id;let o=Q_[i]=ai.define({id:Yh.length,name:r,props:[WB({[r]:t})]});return Yh.push(o),o.id}function $H(n,e){let t=ai.define({id:Yh.length,name:"Document",props:[ta.add(()=>n),OO.add(()=>r=>e.getIndent(r))],top:!0});return Yh.push(t),t}tn.RTL,tn.LTR;function se(n){return new XB(ek.define(n))}function Bo(n){return Z(()=>import("./index-Bui4B3Xv.js"),__vite__mapDeps([0,1,2,3,4,5])).then(e=>e.sql({dialect:e[n]}))}const zH=[G.of({name:"C",extensions:["c","h","ino"],load(){return Z(()=>import("./index-DtgB0zWw.js"),__vite__mapDeps([6,1,2,3,4,5])).then(n=>n.cpp())}}),G.of({name:"C++",alias:["cpp"],extensions:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],load(){return Z(()=>import("./index-DtgB0zWw.js"),__vite__mapDeps([6,1,2,3,4,5])).then(n=>n.cpp())}}),G.of({name:"CQL",alias:["cassandra"],extensions:["cql"],load(){return Bo("Cassandra")}}),G.of({name:"CSS",extensions:["css"],load(){return Z(()=>import("./index-CKlooDzy.js"),__vite__mapDeps([7,1,2,3,4,5])).then(n=>n.css())}}),G.of({name:"Go",extensions:["go"],load(){return Z(()=>import("./index-CC3zko4F.js"),__vite__mapDeps([8,1,2,3,4,5])).then(n=>n.go())}}),G.of({name:"HTML",alias:["xhtml"],extensions:["html","htm","handlebars","hbs"],load(){return Z(()=>import("./index-_hTvFXNE.js"),__vite__mapDeps([9,1,7,2,3,4,5,10])).then(n=>n.html())}}),G.of({name:"Java",extensions:["java"],load(){return Z(()=>import("./index-JutOhxN4.js"),__vite__mapDeps([11,1,2,3,4,5])).then(n=>n.java())}}),G.of({name:"JavaScript",alias:["ecmascript","js","node"],extensions:["js","mjs","cjs"],load(){return Z(()=>import("./index-CzcS3QBw.js"),__vite__mapDeps([10,1,2,3,4,5])).then(n=>n.javascript())}}),G.of({name:"Jinja",extensions:["j2","jinja","jinja2"],load(){return Z(()=>import("./index-CW9RtvEm.js"),__vite__mapDeps([12,9,1,7,2,3,4,5,10])).then(n=>n.jinja())}}),G.of({name:"JSON",alias:["json5"],extensions:["json","map"],load(){return Z(()=>import("./index-Da6hlfk-.js"),__vite__mapDeps([13,1,2,3,4,5])).then(n=>n.json())}}),G.of({name:"JSX",extensions:["jsx"],load(){return Z(()=>import("./index-CzcS3QBw.js"),__vite__mapDeps([10,1,2,3,4,5])).then(n=>n.javascript({jsx:!0}))}}),G.of({name:"LESS",extensions:["less"],load(){return Z(()=>import("./index-F1iwlRtn.js"),__vite__mapDeps([14,7,1,2,3,4,5])).then(n=>n.less())}}),G.of({name:"Liquid",extensions:["liquid"],load(){return Z(()=>import("./index-gizemT_p.js"),__vite__mapDeps([15,9,1,7,2,3,4,5,10])).then(n=>n.liquid())}}),G.of({name:"MariaDB SQL",load(){return Bo("MariaSQL")}}),G.of({name:"Markdown",extensions:["md","markdown","mkd"],load(){return Z(()=>import("./index-DnCbBP6K.js"),__vite__mapDeps([16,9,1,7,2,3,4,5,10])).then(n=>n.markdown())}}),G.of({name:"MS SQL",load(){return Bo("MSSQL")}}),G.of({name:"MySQL",load(){return Bo("MySQL")}}),G.of({name:"PHP",extensions:["php","php3","php4","php5","php7","phtml"],load(){return Z(()=>import("./index-DviJ1OeI.js"),__vite__mapDeps([17,1,9,7,2,3,4,5,10])).then(n=>n.php())}}),G.of({name:"PLSQL",extensions:["pls"],load(){return Bo("PLSQL")}}),G.of({name:"PostgreSQL",load(){return Bo("PostgreSQL")}}),G.of({name:"Python",extensions:["BUILD","bzl","py","pyw"],filename:/^(BUCK|BUILD)$/,load(){return Z(()=>import("./index-DX_gb89a.js"),__vite__mapDeps([18,1,2,3,4,5])).then(n=>n.python())}}),G.of({name:"Rust",extensions:["rs"],load(){return Z(()=>import("./index-CGJRVXLy.js"),__vite__mapDeps([19,1,2,3,4,5])).then(n=>n.rust())}}),G.of({name:"Sass",extensions:["sass"],load(){return Z(()=>import("./index-bn0S1u2R.js"),__vite__mapDeps([20,1,7,2,3,4,5])).then(n=>n.sass({indented:!0}))}}),G.of({name:"SCSS",extensions:["scss"],load(){return Z(()=>import("./index-bn0S1u2R.js"),__vite__mapDeps([20,1,7,2,3,4,5])).then(n=>n.sass())}}),G.of({name:"SQL",extensions:["sql"],load(){return Bo("StandardSQL")}}),G.of({name:"SQLite",load(){return Bo("SQLite")}}),G.of({name:"TSX",extensions:["tsx"],load(){return Z(()=>import("./index-CzcS3QBw.js"),__vite__mapDeps([10,1,2,3,4,5])).then(n=>n.javascript({jsx:!0,typescript:!0}))}}),G.of({name:"TypeScript",alias:["ts"],extensions:["ts","mts","cts"],load(){return Z(()=>import("./index-CzcS3QBw.js"),__vite__mapDeps([10,1,2,3,4,5])).then(n=>n.javascript({typescript:!0}))}}),G.of({name:"WebAssembly",extensions:["wat","wast"],load(){return Z(()=>import("./index--m28_CRM.js"),__vite__mapDeps([21,1,2,3,4,5])).then(n=>n.wast())}}),G.of({name:"XML",alias:["rss","wsdl","xsd"],extensions:["xml","xsl","xsd","svg"],load(){return Z(()=>import("./index-ClLUp5br.js"),__vite__mapDeps([22,1,2,3,4,5])).then(n=>n.xml())}}),G.of({name:"YAML",alias:["yml"],extensions:["yaml","yml"],load(){return Z(()=>import("./index-BGjr3wID.js"),__vite__mapDeps([23,1,2,3,4,5])).then(n=>n.yaml())}}),G.of({name:"APL",extensions:["dyalog","apl"],load(){return Z(()=>import("./apl-B4CMkyY2.js"),[]).then(n=>se(n.apl))}}),G.of({name:"PGP",alias:["asciiarmor"],extensions:["asc","pgp","sig"],load(){return Z(()=>import("./asciiarmor-Df11BRmG.js"),[]).then(n=>se(n.asciiArmor))}}),G.of({name:"ASN.1",extensions:["asn","asn1"],load(){return Z(()=>import("./asn1-CGOzndHr.js"),[]).then(n=>se(n.asn1({})))}}),G.of({name:"Asterisk",filename:/^extensions\.conf$/i,load(){return Z(()=>import("./asterisk-B-8jnY81.js"),[]).then(n=>se(n.asterisk))}}),G.of({name:"Brainfuck",extensions:["b","bf"],load(){return Z(()=>import("./brainfuck-C4LP7Hcl.js"),[]).then(n=>se(n.brainfuck))}}),G.of({name:"Cobol",extensions:["cob","cpy"],load(){return Z(()=>import("./cobol-XrqhtCFE.js"),[]).then(n=>se(n.cobol))}}),G.of({name:"C#",alias:["csharp","cs"],extensions:["cs"],load(){return Z(()=>import("./clike-DGpXaapd.js"),[]).then(n=>se(n.csharp))}}),G.of({name:"Clojure",extensions:["clj","cljc","cljx"],load(){return Z(()=>import("./clojure-BMjYHr_A.js"),[]).then(n=>se(n.clojure))}}),G.of({name:"ClojureScript",extensions:["cljs"],load(){return Z(()=>import("./clojure-BMjYHr_A.js"),[]).then(n=>se(n.clojure))}}),G.of({name:"Closure Stylesheets (GSS)",extensions:["gss"],load(){return Z(()=>import("./css-BnMrqG3P.js"),[]).then(n=>se(n.gss))}}),G.of({name:"CMake",extensions:["cmake","cmake.in"],filename:/^CMakeLists\.txt$/,load(){return Z(()=>import("./cmake-BQqOBYOt.js"),[]).then(n=>se(n.cmake))}}),G.of({name:"CoffeeScript",alias:["coffee","coffee-script"],extensions:["coffee"],load(){return Z(()=>import("./coffeescript-S37ZYGWr.js"),[]).then(n=>se(n.coffeeScript))}}),G.of({name:"Common Lisp",alias:["lisp"],extensions:["cl","lisp","el"],load(){return Z(()=>import("./commonlisp-DBKNyK5s.js"),[]).then(n=>se(n.commonLisp))}}),G.of({name:"Cypher",extensions:["cyp","cypher"],load(){return Z(()=>import("./cypher-C_CwsFkJ.js"),[]).then(n=>se(n.cypher))}}),G.of({name:"Cython",extensions:["pyx","pxd","pxi"],load(){return Z(()=>import("./python-BuPzkPfP.js"),[]).then(n=>se(n.cython))}}),G.of({name:"Crystal",extensions:["cr"],load(){return Z(()=>import("./crystal-SjHAIU92.js"),[]).then(n=>se(n.crystal))}}),G.of({name:"D",extensions:["d"],load(){return Z(()=>import("./d-pRatUO7H.js"),[]).then(n=>se(n.d))}}),G.of({name:"Dart",extensions:["dart"],load(){return Z(()=>import("./clike-DGpXaapd.js"),[]).then(n=>se(n.dart))}}),G.of({name:"diff",extensions:["diff","patch"],load(){return Z(()=>import("./diff-DbItnlRl.js"),[]).then(n=>se(n.diff))}}),G.of({name:"Dockerfile",filename:/^Dockerfile$/,load(){return Z(()=>import("./dockerfile-BKs6k2Af.js"),__vite__mapDeps([24,25])).then(n=>se(n.dockerFile))}}),G.of({name:"DTD",extensions:["dtd"],load(){return Z(()=>import("./dtd-DF_7sFjM.js"),[]).then(n=>se(n.dtd))}}),G.of({name:"Dylan",extensions:["dylan","dyl","intr"],load(){return Z(()=>import("./dylan-DwRh75JA.js"),[]).then(n=>se(n.dylan))}}),G.of({name:"EBNF",load(){return Z(()=>import("./ebnf-CDyGwa7X.js"),[]).then(n=>se(n.ebnf))}}),G.of({name:"ECL",extensions:["ecl"],load(){return Z(()=>import("./ecl-Cabwm37j.js"),[]).then(n=>se(n.ecl))}}),G.of({name:"edn",extensions:["edn"],load(){return Z(()=>import("./clojure-BMjYHr_A.js"),[]).then(n=>se(n.clojure))}}),G.of({name:"Eiffel",extensions:["e"],load(){return Z(()=>import("./eiffel-CnydiIhH.js"),[]).then(n=>se(n.eiffel))}}),G.of({name:"Elm",extensions:["elm"],load(){return Z(()=>import("./elm-vLlmbW-K.js"),[]).then(n=>se(n.elm))}}),G.of({name:"Erlang",extensions:["erl"],load(){return Z(()=>import("./erlang-BNw1qcRV.js"),[]).then(n=>se(n.erlang))}}),G.of({name:"Esper",load(){return Z(()=>import("./sql-C4g8LzGK.js"),[]).then(n=>se(n.esper))}}),G.of({name:"Factor",extensions:["factor"],load(){return Z(()=>import("./factor-kuTfRLto.js"),__vite__mapDeps([26,25])).then(n=>se(n.factor))}}),G.of({name:"FCL",load(){return Z(()=>import("./fcl-Kvtd6kyn.js"),[]).then(n=>se(n.fcl))}}),G.of({name:"Forth",extensions:["forth","fth","4th"],load(){return Z(()=>import("./forth-Ffai-XNe.js"),[]).then(n=>se(n.forth))}}),G.of({name:"Fortran",extensions:["f","for","f77","f90","f95"],load(){return Z(()=>import("./fortran-DYz_wnZ1.js"),[]).then(n=>se(n.fortran))}}),G.of({name:"F#",alias:["fsharp"],extensions:["fs"],load(){return Z(()=>import("./mllike-C_8OmSiT.js"),[]).then(n=>se(n.fSharp))}}),G.of({name:"Gas",extensions:["s"],load(){return Z(()=>import("./gas-Bneqetm1.js"),[]).then(n=>se(n.gas))}}),G.of({name:"Gherkin",extensions:["feature"],load(){return Z(()=>import("./gherkin-heZmZLOM.js"),[]).then(n=>se(n.gherkin))}}),G.of({name:"Groovy",extensions:["groovy","gradle"],filename:/^Jenkinsfile$/,load(){return Z(()=>import("./groovy-D9Dt4D0W.js"),[]).then(n=>se(n.groovy))}}),G.of({name:"Haskell",extensions:["hs"],load(){return Z(()=>import("./haskell-BWDZoCOh.js"),[]).then(n=>se(n.haskell))}}),G.of({name:"Haxe",extensions:["hx"],load(){return Z(()=>import("./haxe-pv4rovob.js"),[]).then(n=>se(n.haxe))}}),G.of({name:"HXML",extensions:["hxml"],load(){return Z(()=>import("./haxe-pv4rovob.js"),[]).then(n=>se(n.hxml))}}),G.of({name:"HTTP",load(){return Z(()=>import("./http-DBlCnlav.js"),[]).then(n=>se(n.http))}}),G.of({name:"IDL",extensions:["pro"],load(){return Z(()=>import("./idl-BEugSyMb.js"),[]).then(n=>se(n.idl))}}),G.of({name:"JSON-LD",alias:["jsonld"],extensions:["jsonld"],load(){return Z(()=>import("./javascript-iSgyE4tI.js"),[]).then(n=>se(n.jsonld))}}),G.of({name:"Julia",extensions:["jl"],load(){return Z(()=>import("./julia-DuME0IfC.js"),[]).then(n=>se(n.julia))}}),G.of({name:"Kotlin",extensions:["kt","kts"],load(){return Z(()=>import("./clike-DGpXaapd.js"),[]).then(n=>se(n.kotlin))}}),G.of({name:"LiveScript",alias:["ls"],extensions:["ls"],load(){return Z(()=>import("./livescript-k3uCVVjK.js"),[]).then(n=>se(n.liveScript))}}),G.of({name:"Lua",extensions:["lua"],load(){return Z(()=>import("./lua-BgMRiT3U.js"),[]).then(n=>se(n.lua))}}),G.of({name:"mIRC",extensions:["mrc"],load(){return Z(()=>import("./mirc-CjQqDB4T.js"),[]).then(n=>se(n.mirc))}}),G.of({name:"Mathematica",extensions:["m","nb","wl","wls"],load(){return Z(()=>import("./mathematica-DTrFuWx2.js"),[]).then(n=>se(n.mathematica))}}),G.of({name:"Modelica",extensions:["mo"],load(){return Z(()=>import("./modelica-Dc1JOy9r.js"),[]).then(n=>se(n.modelica))}}),G.of({name:"MUMPS",extensions:["mps"],load(){return Z(()=>import("./mumps-BT43cFF4.js"),[]).then(n=>se(n.mumps))}}),G.of({name:"Mbox",extensions:["mbox"],load(){return Z(()=>import("./mbox-CNhZ1qSd.js"),[]).then(n=>se(n.mbox))}}),G.of({name:"Nginx",filename:/nginx.*\.conf$/i,load(){return Z(()=>import("./nginx-DdIZxoE0.js"),[]).then(n=>se(n.nginx))}}),G.of({name:"NSIS",extensions:["nsh","nsi"],load(){return Z(()=>import("./nsis-LdVXkNf5.js"),__vite__mapDeps([27,25])).then(n=>se(n.nsis))}}),G.of({name:"NTriples",extensions:["nt","nq"],load(){return Z(()=>import("./ntriples-BfvgReVJ.js"),[]).then(n=>se(n.ntriples))}}),G.of({name:"Objective-C",alias:["objective-c","objc"],extensions:["m"],load(){return Z(()=>import("./clike-DGpXaapd.js"),[]).then(n=>se(n.objectiveC))}}),G.of({name:"Objective-C++",alias:["objective-c++","objc++"],extensions:["mm"],load(){return Z(()=>import("./clike-DGpXaapd.js"),[]).then(n=>se(n.objectiveCpp))}}),G.of({name:"OCaml",extensions:["ml","mli","mll","mly"],load(){return Z(()=>import("./mllike-C_8OmSiT.js"),[]).then(n=>se(n.oCaml))}}),G.of({name:"Octave",extensions:["m"],load(){return Z(()=>import("./octave-Ck1zUtKM.js"),[]).then(n=>se(n.octave))}}),G.of({name:"Oz",extensions:["oz"],load(){return Z(()=>import("./oz-BzwKVEFT.js"),[]).then(n=>se(n.oz))}}),G.of({name:"Pascal",extensions:["p","pas"],load(){return Z(()=>import("./pascal--L3eBynH.js"),[]).then(n=>se(n.pascal))}}),G.of({name:"Perl",extensions:["pl","pm"],load(){return Z(()=>import("./perl-CdXCOZ3F.js"),[]).then(n=>se(n.perl))}}),G.of({name:"Pig",extensions:["pig"],load(){return Z(()=>import("./pig-CevX1Tat.js"),[]).then(n=>se(n.pig))}}),G.of({name:"PowerShell",extensions:["ps1","psd1","psm1"],load(){return Z(()=>import("./powershell-CFHJl5sT.js"),[]).then(n=>se(n.powerShell))}}),G.of({name:"Properties files",alias:["ini","properties"],extensions:["properties","ini","in"],load(){return Z(()=>import("./properties-C78fOPTZ.js"),[]).then(n=>se(n.properties))}}),G.of({name:"ProtoBuf",extensions:["proto"],load(){return Z(()=>import("./protobuf-ChK-085T.js"),[]).then(n=>se(n.protobuf))}}),G.of({name:"Pug",alias:["jade"],extensions:["pug","jade"],load(){return Z(()=>import("./pug-BmUsPMDj.js"),__vite__mapDeps([28,29])).then(n=>se(n.pug))}}),G.of({name:"Puppet",extensions:["pp"],load(){return Z(()=>import("./puppet-DMA9R1ak.js"),[]).then(n=>se(n.puppet))}}),G.of({name:"Q",extensions:["q"],load(){return Z(()=>import("./q-pXgVlZs6.js"),[]).then(n=>se(n.q))}}),G.of({name:"R",alias:["rscript"],extensions:["r","R"],load(){return Z(()=>import("./r-DUYO_cvP.js"),[]).then(n=>se(n.r))}}),G.of({name:"RPM Changes",load(){return Z(()=>import("./rpm-CTu-6PCP.js"),[]).then(n=>se(n.rpmChanges))}}),G.of({name:"RPM Spec",extensions:["spec"],load(){return Z(()=>import("./rpm-CTu-6PCP.js"),[]).then(n=>se(n.rpmSpec))}}),G.of({name:"Ruby",alias:["jruby","macruby","rake","rb","rbx"],extensions:["rb"],filename:/^(Gemfile|Rakefile)$/,load(){return Z(()=>import("./ruby-B2Rjki9n.js"),[]).then(n=>se(n.ruby))}}),G.of({name:"SAS",extensions:["sas"],load(){return Z(()=>import("./sas-B4kiWyti.js"),[]).then(n=>se(n.sas))}}),G.of({name:"Scala",extensions:["scala"],load(){return Z(()=>import("./clike-DGpXaapd.js"),[]).then(n=>se(n.scala))}}),G.of({name:"Scheme",extensions:["scm","ss"],load(){return Z(()=>import("./scheme-C41bIUwD.js"),[]).then(n=>se(n.scheme))}}),G.of({name:"Shell",alias:["bash","sh","zsh"],extensions:["sh","ksh","bash"],filename:/^PKGBUILD$/,load(){return Z(()=>import("./shell-CjFT_Tl9.js"),[]).then(n=>se(n.shell))}}),G.of({name:"Sieve",extensions:["siv","sieve"],load(){return Z(()=>import("./sieve-C3Gn_uJK.js"),[]).then(n=>se(n.sieve))}}),G.of({name:"Smalltalk",extensions:["st"],load(){return Z(()=>import("./smalltalk-CnHTOXQT.js"),[]).then(n=>se(n.smalltalk))}}),G.of({name:"Solr",load(){return Z(()=>import("./solr-DehyRSwq.js"),[]).then(n=>se(n.solr))}}),G.of({name:"SML",extensions:["sml","sig","fun","smackspec"],load(){return Z(()=>import("./mllike-C_8OmSiT.js"),[]).then(n=>se(n.sml))}}),G.of({name:"SPARQL",alias:["sparul"],extensions:["rq","sparql"],load(){return Z(()=>import("./sparql-DkYu6x3z.js"),[]).then(n=>se(n.sparql))}}),G.of({name:"Spreadsheet",alias:["excel","formula"],load(){return Z(()=>import("./spreadsheet-BCZA_wO0.js"),[]).then(n=>se(n.spreadsheet))}}),G.of({name:"Squirrel",extensions:["nut"],load(){return Z(()=>import("./clike-DGpXaapd.js"),[]).then(n=>se(n.squirrel))}}),G.of({name:"Stylus",extensions:["styl"],load(){return Z(()=>import("./stylus-B533Al4x.js"),[]).then(n=>se(n.stylus))}}),G.of({name:"Swift",extensions:["swift"],load(){return Z(()=>import("./swift-BzpIVaGY.js"),[]).then(n=>se(n.swift))}}),G.of({name:"sTeX",load(){return Z(()=>import("./stex-C3f8Ysf7.js"),[]).then(n=>se(n.stex))}}),G.of({name:"LaTeX",alias:["tex"],extensions:["text","ltx","tex"],load(){return Z(()=>import("./stex-C3f8Ysf7.js"),[]).then(n=>se(n.stex))}}),G.of({name:"SystemVerilog",extensions:["v","sv","svh"],load(){return Z(()=>import("./verilog-C6RDOZhf.js"),[]).then(n=>se(n.verilog))}}),G.of({name:"Tcl",extensions:["tcl"],load(){return Z(()=>import("./tcl-DVfN8rqt.js"),[]).then(n=>se(n.tcl))}}),G.of({name:"Textile",extensions:["textile"],load(){return Z(()=>import("./textile-CnDTJFAw.js"),[]).then(n=>se(n.textile))}}),G.of({name:"TiddlyWiki",load(){return Z(()=>import("./tiddlywiki-DO-Gjzrf.js"),[]).then(n=>se(n.tiddlyWiki))}}),G.of({name:"Tiki wiki",load(){return Z(()=>import("./tiki-DGYXhP31.js"),[]).then(n=>se(n.tiki))}}),G.of({name:"TOML",extensions:["toml"],load(){return Z(()=>import("./toml-Bm5Em-hy.js"),[]).then(n=>se(n.toml))}}),G.of({name:"Troff",extensions:["1","2","3","4","5","6","7","8","9"],load(){return Z(()=>import("./troff-wAsdV37c.js"),[]).then(n=>se(n.troff))}}),G.of({name:"TTCN",extensions:["ttcn","ttcn3","ttcnpp"],load(){return Z(()=>import("./ttcn-CiGrtVSZ.js"),[]).then(n=>se(n.ttcn))}}),G.of({name:"TTCN_CFG",extensions:["cfg"],load(){return Z(()=>import("./ttcn-cfg-BIkV9KBc.js"),[]).then(n=>se(n.ttcnCfg))}}),G.of({name:"Turtle",extensions:["ttl"],load(){return Z(()=>import("./turtle-B1tBg_DP.js"),[]).then(n=>se(n.turtle))}}),G.of({name:"Web IDL",extensions:["webidl"],load(){return Z(()=>import("./webidl-ZXfAyPTL.js"),[]).then(n=>se(n.webIDL))}}),G.of({name:"VB.NET",extensions:["vb"],load(){return Z(()=>import("./vb-CmGdzxic.js"),[]).then(n=>se(n.vb))}}),G.of({name:"VBScript",extensions:["vbs"],load(){return Z(()=>import("./vbscript-BuJXcnF6.js"),[]).then(n=>se(n.vbScript))}}),G.of({name:"Velocity",extensions:["vtl"],load(){return Z(()=>import("./velocity-D8B20fx6.js"),[]).then(n=>se(n.velocity))}}),G.of({name:"Verilog",extensions:["v"],load(){return Z(()=>import("./verilog-C6RDOZhf.js"),[]).then(n=>se(n.verilog))}}),G.of({name:"VHDL",extensions:["vhd","vhdl"],load(){return Z(()=>import("./vhdl-lSbBsy5d.js"),[]).then(n=>se(n.vhdl))}}),G.of({name:"XQuery",extensions:["xy","xquery","xq","xqm","xqy"],load(){return Z(()=>import("./xquery-CQfU5ijd.js"),[]).then(n=>se(n.xQuery))}}),G.of({name:"Yacas",extensions:["ys"],load(){return Z(()=>import("./yacas-BJ4BC0dw.js"),[]).then(n=>se(n.yacas))}}),G.of({name:"Z80",extensions:["z80"],load(){return Z(()=>import("./z80-Hz9HOZM7.js"),[]).then(n=>se(n.z80))}}),G.of({name:"MscGen",extensions:["mscgen","mscin","msc"],load(){return Z(()=>import("./mscgen-BA5vi2Kp.js"),[]).then(n=>se(n.mscgen))}}),G.of({name:"X",extensions:["xu"],load(){return Z(()=>import("./mscgen-BA5vi2Kp.js"),[]).then(n=>se(n.xu))}}),G.of({name:"MsGenny",extensions:["msgenny"],load(){return Z(()=>import("./mscgen-BA5vi2Kp.js"),[]).then(n=>se(n.msgenny))}}),G.of({name:"Vue",extensions:["vue"],load(){return Z(()=>import("./index-DFU_hC7c.js"),__vite__mapDeps([30,9,1,7,2,3,4,5,10])).then(n=>n.vue())}}),G.of({name:"Angular Template",load(){return Z(()=>import("./index-BlYPm64J.js"),__vite__mapDeps([31,9,1,7,2,3,4,5,10])).then(n=>n.angular())}})],WH="#e5c07b",eM="#e06c75",qH="#56b6c2",UH="#ffffff",Rm="#abb2bf",pw="#7d8799",KH="#61afef",GH="#98c379",tM="#d19a66",JH="#c678dd",ZH="#21252b",nM="#2c313a",rM="#282c34",f1="#353a42",YH="#3E4451",iM="#528bff",XH=Re.theme({"&":{color:Rm,backgroundColor:rM},".cm-content":{caretColor:iM},".cm-cursor, .cm-dropCursor":{borderLeftColor:iM},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:YH},".cm-panels":{backgroundColor:ZH,color:Rm},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:rM,color:pw,border:"none"},".cm-activeLineGutter":{backgroundColor:nM},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:f1},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:f1,borderBottomColor:f1},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:nM,color:Rm}}},{dark:!0}),QH=tp.define([{tag:ee.keyword,color:JH},{tag:[ee.name,ee.deleted,ee.character,ee.propertyName,ee.macroName],color:eM},{tag:[ee.function(ee.variableName),ee.labelName],color:KH},{tag:[ee.color,ee.constant(ee.name),ee.standard(ee.name)],color:tM},{tag:[ee.definition(ee.name),ee.separator],color:Rm},{tag:[ee.typeName,ee.className,ee.number,ee.changed,ee.annotation,ee.modifier,ee.self,ee.namespace],color:WH},{tag:[ee.operator,ee.operatorKeyword,ee.url,ee.escape,ee.regexp,ee.link,ee.special(ee.string)],color:qH},{tag:[ee.meta,ee.comment],color:pw},{tag:ee.strong,fontWeight:"bold"},{tag:ee.emphasis,fontStyle:"italic"},{tag:ee.strikethrough,textDecoration:"line-through"},{tag:ee.link,color:pw,textDecoration:"underline"},{tag:ee.heading,fontWeight:"bold",color:eM},{tag:[ee.atom,ee.bool,ee.special(ee.variableName)],color:tM},{tag:[ee.processingInstruction,ee.string,ee.inserted],color:GH},{tag:ee.invalid,color:UH}]),eV=[XH,jO(QH)];function Un(n){this.content=n}Un.prototype={constructor:Un,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),s=r.content.slice();return i==-1?s.push(t||n,e):(s[i+1]=e,t&&(s[i]=t)),new Un(s)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Un(t)},addToStart:function(n,e){return new Un([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Un(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),s=r.find(n);return i.splice(s==-1?i.length:s,0,e,t),new Un(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Un.from(n),n.size?new Un(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Un.from(n),n.size?new Un(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Un.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Un.from=function(n){if(n instanceof Un)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Un(e)};function YO(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=YO(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function XO(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),l=e.child(--s),a=o.nodeSize;if(o==l){t-=a,r-=a;continue}if(!o.sameMarkup(l))return{a:t,b:r};if(o.isText&&o.text!=l.text){let c=0,u=Math.min(o.text.length,l.text.length);for(;c<u&&o.text[o.text.length-c-1]==l.text[l.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||l.content.size){let c=XO(o.content,l.content,t-1,r-1);if(c)return c}t-=a,r-=a}}let we=class yr{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,l=0;l<t;o++){let a=this.content[o],c=l+a.nodeSize;if(c>e&&r(a,i+l,s||null,o)!==!1&&a.content.size){let u=l+1;a.nodesBetween(Math.max(0,e-u),Math.min(a.content.size,t-u),r,i+u)}l=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(l,a)=>{let c=l.isText?l.text.slice(Math.max(e,a)-a,t-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&c||l.isTextblock)&&r&&(o?o=!1:s+=r),s+=c},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new yr(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let l=this.content[s],a=o+l.nodeSize;a>e&&((o<e||a>t)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,t-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,t-o-1))),r.push(l),i+=l.nodeSize),o=a}return new yr(r,i)}cutByIndex(e,t){return e==t?yr.empty:e==0&&t==this.content.length?this:new yr(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new yr(i,s)}addToStart(e){return new yr([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new yr(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return YO(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return XO(this,e,t,r)}findIndex(e){if(e==0)return nm(0,e);if(e==this.size)return nm(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,r=0;;t++){let i=this.child(t),s=r+i.nodeSize;if(s>=e)return s==e?nm(t+1,s):nm(t,r);r=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return yr.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new yr(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return yr.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new yr(t||e,r)}static from(e){if(!e)return yr.empty;if(e instanceof yr)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new yr([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};we.empty=new we([],0);const h1={index:0,offset:0};function nm(n,e){return h1.index=n,h1.offset=e,h1}function $g(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!$g(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!$g(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}class ct{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&$g(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=r.create(t.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return ct.none;if(e instanceof ct)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}}ct.none=[];class zg extends Error{}let Le=class uc{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=eL(this.content,e+this.openStart,t);return r&&new uc(r,this.openStart,this.openEnd)}removeBetween(e,t){return new uc(QO(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return uc.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new uc(we.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new uc(e,r,i)}};Le.empty=new Le(we.empty,0,0);function QO(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:l}=n.findIndex(t);if(i==e||s.isText){if(l!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(QO(s.content,e-i-1,t-i-1)))}function eL(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let l=eL(o.content,e-s-1,t,o);return l&&n.replaceChild(i,o.copy(l))}function tV(n,e,t){if(t.openStart>n.depth)throw new zg("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new zg("Inconsistent open depths");return tL(n,e,t,0)}function tL(n,e,t,r){let i=n.index(r),s=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let o=tL(n,e,t,r+1);return s.copy(s.content.replaceChild(i,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,l=o.content;return Ca(o,l.cut(0,n.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=nV(t,n);return Ca(s,rL(n,o,l,e,r))}else return Ca(s,Wg(n,e,r))}function nL(n,e){if(!e.type.compatibleContent(n.type))throw new zg("Cannot join "+e.type.name+" onto "+n.type.name)}function mw(n,e,t){let r=n.node(t);return nL(r,e.node(t)),r}function ka(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function uh(n,e,t,r){let i=(e||n).node(t),s=0,o=e?e.index(t):i.childCount;n&&(s=n.index(t),n.depth>t?s++:n.textOffset&&(ka(n.nodeAfter,r),s++));for(let l=s;l<o;l++)ka(i.child(l),r);e&&e.depth==t&&e.textOffset&&ka(e.nodeBefore,r)}function Ca(n,e){return n.type.checkContent(e),n.copy(e)}function rL(n,e,t,r,i){let s=n.depth>i&&mw(n,e,i+1),o=r.depth>i&&mw(t,r,i+1),l=[];return uh(null,n,i,l),s&&o&&e.index(i)==t.index(i)?(nL(s,o),ka(Ca(s,rL(n,e,t,r,i+1)),l)):(s&&ka(Ca(s,Wg(n,e,i+1)),l),uh(e,t,i,l),o&&ka(Ca(o,Wg(t,r,i+1)),l)),uh(r,null,i,l),new we(l)}function Wg(n,e,t){let r=[];if(uh(null,n,t,r),n.depth>t){let i=mw(n,e,t+1);ka(Ca(i,Wg(n,e,t+1)),r)}return uh(e,null,t,r),new we(r)}function nV(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let s=t-1;s>=0;s--)i=e.node(s).copy(we.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class Xh{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return ct.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let l=r;r=i,i=l}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new iL(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,s=t;for(let o=e;;){let{index:l,offset:a}=o.content.findIndex(s),c=s-a;if(r.push(o,l,i+a),!c||(o=o.child(l),o.isText))break;s=c-1,i+=a+1}return new Xh(t,r,s)}static resolveCached(e,t){let r=sM.get(e);if(r)for(let s=0;s<r.elts.length;s++){let o=r.elts[s];if(o.pos==t)return o}else sM.set(e,r=new rV);let i=r.elts[r.i]=Xh.resolve(e,t);return r.i=(r.i+1)%iV,i}}class rV{constructor(){this.elts=[],this.i=0}}const iV=12,sM=new WeakMap;class iL{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const sV=Object.create(null);class Ci{constructor(e,t,r,i=ct.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||we.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&$g(this.attrs,t||e.defaultAttrs||sV)&&ct.sameSet(this.marks,r||ct.none)}copy(e=null){return e==this.content?this:new Ci(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Ci(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return Le.empty;let i=this.resolve(e),s=this.resolve(t),o=r?0:i.sharedDepth(t),l=i.start(o),c=i.node(o).content.cut(i.pos-l,s.pos-l);return new Le(c,i.depth-o,s.depth-o)}replace(e,t,r){return tV(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return Xh.resolveCached(this,e)}resolveNoCache(e){return Xh.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),sL(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=we.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),l=o&&o.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let a=i;a<s;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ct.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!ct.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=we.fromJSON(e,t.content),s=e.nodeType(t.type).create(t.attrs,i,r);return s.type.checkAttrs(s.attrs),s}}Ci.prototype.text=void 0;class qg extends Ci{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):sL(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new qg(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new qg(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function sL(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Fa{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new oV(e,t);if(r.next==null)return Fa.empty;let i=oL(r);r.next&&r.err("Unexpected trailing text");let s=dV(hV(i));return pV(s,r),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let s=t;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function s(o,l){let a=o.matchFragment(e,r);if(a&&(!t||a.validEnd))return we.from(l.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:f}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let p=s(f,l.concat(u));if(p)return p}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let l=i;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:a}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),t[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}Fa.empty=new Fa(!0);class oV{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function oL(n){let e=[];do e.push(lV(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function lV(n){let e=[];do e.push(aV(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function aV(n){let e=fV(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=cV(n,e);else break;return e}function oM(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function cV(n,e){let t=oM(n),r=t;return n.eat(",")&&(n.next!="}"?r=oM(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function uV(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let s in t){let o=t[s];o.isInGroup(e)&&i.push(o)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function fV(n){if(n.eat("(")){let e=oL(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=uV(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function hV(n){let e=[[]];return i(s(n,0),t()),e;function t(){return e.push([])-1}function r(o,l,a){let c={term:a,to:l};return e[o].push(c),c}function i(o,l){o.forEach(a=>a.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((a,c)=>a.concat(s(c,l)),[]);if(o.type=="seq")for(let a=0;;a++){let c=s(o.exprs[a],l);if(a==o.exprs.length-1)return c;i(c,l=t())}else if(o.type=="star"){let a=t();return r(l,a),i(s(o.expr,a),a),[r(a)]}else if(o.type=="plus"){let a=t();return i(s(o.expr,l),a),i(s(o.expr,a),a),[r(a)]}else{if(o.type=="opt")return[r(l)].concat(s(o.expr,l));if(o.type=="range"){let a=l;for(let c=0;c<o.min;c++){let u=t();i(s(o.expr,a),u),a=u}if(o.max==-1)i(s(o.expr,a),a);else for(let c=o.min;c<o.max;c++){let u=t();r(a,u),i(s(o.expr,a),u),a=u}return[r(a)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function lL(n,e){return e-n}function lM(n,e){let t=[];return r(e),t.sort(lL);function r(i){let s=n[i];if(s.length==1&&!s[0].term)return r(s[0].to);t.push(i);for(let o=0;o<s.length;o++){let{term:l,to:a}=s[o];!l&&t.indexOf(a)==-1&&r(a)}}}function dV(n){let e=Object.create(null);return t(lM(n,0));function t(r){let i=[];r.forEach(o=>{n[o].forEach(({term:l,to:a})=>{if(!l)return;let c;for(let u=0;u<i.length;u++)i[u][0]==l&&(c=i[u][1]);lM(n,a).forEach(u=>{c||i.push([l,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let s=e[r.join(",")]=new Fa(r.indexOf(n.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(lL);s.next.push({type:i[o][0],next:e[l.join(",")]||t(l)})}return s}}function pV(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:a,next:c}=i.next[l];o.push(a.name),s&&!(a.isText||a.hasRequiredAttrs())&&(s=!1),r.indexOf(c)==-1&&r.push(c)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function aL(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function cL(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function uL(n,e,t,r){for(let i in e)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in n){let s=n[i];s.validate&&s.validate(e[i])}}function fL(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new gV(n,r,e[r]);return t}let Ug=class hL{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=fL(e,r.attrs),this.defaultAttrs=aL(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Fa.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:cL(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ci(this,this.computeAttrs(e),we.from(t),ct.setFrom(r))}createChecked(e=null,t,r){return t=we.from(t),this.checkContent(t),new Ci(this,this.computeAttrs(e),t,ct.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=we.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let i=this.contentMatch.matchFragment(t),s=i&&i.fillBefore(we.empty,!0);return s?new Ci(this,e,t.append(s),ct.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){uL(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:ct.none:e}static compile(e,t){let r=Object.create(null);e.forEach((s,o)=>r[s]=new hL(s,t,o));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function mV(n,e,t){let r=t.split("|");return i=>{let s=i===null?"null":typeof i;if(r.indexOf(s)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${s}`)}}class gV{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?mV(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class B0{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=fL(e,i.attrs),this.excluded=null;let s=aL(this.attrs);this.instance=s?new ct(this,s):null}create(e=null){return!e&&this.instance?this.instance:new ct(this,cL(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new B0(s,i++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){uL(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class dL{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=Un.from(e.nodes),t.marks=Un.from(e.marks||{}),this.nodes=Ug.compile(this.spec.nodes,this),this.marks=B0.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=r[o]||(r[o]=Fa.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?aM(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:aM(this,o.split(" "))}this.nodeFromJSON=i=>Ci.fromJSON(this,i),this.markFromJSON=i=>ct.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Ug){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new qg(r,r.defaultAttrs,e,ct.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function aM(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],s=n.marks[i],o=s;if(s)t.push(s);else for(let l in n.marks){let a=n.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&t.push(o=a)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function yV(n){return n.tag!=null}function bV(n){return n.style!=null}let H0=class gw{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(i=>{if(yV(i))this.tags.push(i);else if(bV(i)){let s=/[^=]*/.exec(i.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=e.nodes[i.node];return s.contentMatch.matchType(s)})}parse(e,t={}){let r=new uM(this,t,!1);return r.addAll(e,ct.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new uM(this,t,!0);return r.addAll(e,ct.none,t.from,t.to),Le.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(kV(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(o.getAttrs){let a=o.getAttrs(t);if(a===!1)continue;o.attrs=a||void 0}return o}}}static schemaRules(e){let t=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<t.length;o++){let l=t[o];if((l.priority==null?50:l.priority)<s)break}t.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=fM(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=fM(o)),o.node||o.ignore||o.mark||(o.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new gw(e,gw.schemaRules(e)))}};const pL={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},wV={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},mL={ol:!0,ul:!0},Qh=1,yw=2,fh=4;function cM(n,e,t){return e!=null?(e?Qh:0)|(e==="full"?yw:0):n&&n.whitespace=="pre"?Qh|yw:t&~fh}class rm{constructor(e,t,r,i,s,o){this.type=e,this.attrs=t,this.marks=r,this.solid=i,this.options=o,this.content=[],this.activeMarks=ct.none,this.match=s||(o&fh?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(we.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Qh)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let t=we.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(we.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!pL.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class uM{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=t.topNode,s,o=cM(null,t.preserveWhitespace,0)|(r?fh:0);i?s=new rm(i.type,i.attrs,ct.none,!0,t.topMatch||i.type.contentMatch,o):r?s=new rm(null,null,ct.none,!0,null,o):s=new rm(e.schema.topNodeType,null,ct.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,i=this.top,s=i.options&yw?"full":this.localPreserveWS||(i.options&Qh)>0,{schema:o}=this.parser;if(s==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(s)if(s==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let l=r.split(/\r?\n|\r/);for(let a=0;a<l.length;a++)a&&this.insertNode(o.linebreakReplacement.create(),t,!0),l[a]&&this.insertNode(o.text(l[a]),t,!/\S/.test(l[a]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=i.content[i.content.length-1],a=e.previousSibling;(!l||a&&a.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let i=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),l;mL.hasOwnProperty(o)&&this.parser.normalizeLists&&vV(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(a?a.ignore:wV.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let c,u=this.needsBlock;if(pL.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),c=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let f=a&&a.skip?t:this.readStyles(e,t);f&&this.addAll(e,f),c&&this.sync(s),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,a,c,a.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],o=r.getPropertyValue(s);if(o)for(let l=void 0;;){let a=this.parser.matchStyle(s,o,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?t=t.filter(c=>!a.clearMark(c)):t=t.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return t}addElementByRule(e,t,r,i){let s,o;if(t.node)if(o=this.parser.schema.nodes[t.node],o.isLeaf)this.insertNode(o.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let a=this.enter(o,t.attrs||null,r,t.preserveWhitespace);a&&(s=!0,r=a)}else{let a=this.parser.schema.marks[t.mark];r=r.concat(a.create(t.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,r,!1));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a,r),this.findAround(e,a,!1)}s&&this.sync(l)&&this.open--}addAll(e,t,r,i){let s=r||0;for(let o=r?e.childNodes[r]:e.firstChild,l=i==null?null:e.childNodes[i];o!=l;o=o.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(o,t);this.findAtPoint(e,s)}findPlace(e,t,r){let i,s;for(let o=this.open,l=0;o>=0;o--){let a=this.nodes[o],c=a.findWrapping(e);if(c&&(!i||i.length>c.length+l)&&(i=c,s=a,!c.length))break;if(a.solid){if(r)break;l+=2}}if(!i)return null;this.sync(s);for(let o=0;o<i.length;o++)t=this.enterInner(i[o],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(t=this.enterInner(s,null,t))}let i=this.findPlace(e,t,r);if(i){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let o=ct.none;for(let l of i.concat(e.marks))(s.type?s.type.allowsMarkType(l.type):hM(l.type,e.type))&&(o=l.addToSet(o));return s.content.push(e.mark(o)),!0}return!1}enter(e,t,r,i){let s=this.findPlace(e.create(t),r,!1);return s&&(s=this.enterInner(e,t,r,!0,i)),s}enterInner(e,t,r,i=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let l=cM(e,s,o.options);o.options&fh&&o.content.length==0&&(l|=fh);let a=ct.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):hM(c.type,e))?(a=c.addToSet(a),!1):!0),this.nodes.push(new rm(e,t,a,i,null,l)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Qh)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(l,a)=>{for(;l>=0;l--){let c=t[l];if(c==""){if(l==t.length-1||l==0)continue;for(;a>=s;a--)if(o(l-1,a))return!0;return!1}else{let u=a>0||a==0&&i?this.nodes[a].type:r&&a>=s?r.node(a-s).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;a--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function vV(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&mL.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function kV(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function fM(n){let e={};for(let t in n)e[t]=n[t];return e}function hM(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let s=[],o=l=>{s.push(l);for(let a=0;a<l.edgeCount;a++){let{type:c,next:u}=l.edge(a);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}class Ja{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=d1(t).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let l=0,a=0;for(;l<s.length&&a<o.marks.length;){let c=o.marks[a];if(!this.marks[c.type.name]){a++;continue}if(!c.eq(s[l][0])||c.type.spec.spanning===!1)break;l++,a++}for(;l<s.length;)i=s.pop()[1];for(;a<o.marks.length;){let c=o.marks[a++],u=this.serializeMark(c,o.isInline,t);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Pm(d1(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Pm(d1(r),i(e,t),null,e.attrs)}static renderSpec(e,t,r=null,i){return Pm(e,t,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Ja(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=dM(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return dM(e.marks)}}function dM(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function d1(n){return n.document||window.document}const pM=new WeakMap;function CV(n){let e=pM.get(n);return e===void 0&&pM.set(n,e=SV(n)),e}function SV(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)t(r[i]);else for(let i in r)t(r[i])}return t(n),e}function Pm(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=CV(r))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(t=i.slice(0,o),i=i.slice(o+1));let l,a=t?n.createElementNS(t,i):n.createElement(i),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let f in c)if(c[f]!=null){let p=f.indexOf(" ");p>0?a.setAttributeNS(f.slice(0,p),f.slice(p+1),c[f]):f=="style"&&a.style?a.style.cssText=c[f]:a.setAttribute(f,c[f])}}for(let f=u;f<e.length;f++){let p=e[f];if(p===0){if(f<e.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:g,contentDOM:y}=Pm(n,p,t,r);if(a.appendChild(g),y){if(l)throw new RangeError("Multiple content holes");l=y}}}return{dom:a,contentDOM:l}}const gL=65535,yL=Math.pow(2,16);function xV(n,e){return n+e*yL}function mM(n){return n&gL}function _V(n){return(n-(n&gL))/yL}const bL=1,wL=2,Bm=4,vL=8;class bw{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&vL)>0}get deletedBefore(){return(this.delInfo&(bL|Bm))>0}get deletedAfter(){return(this.delInfo&(wL|Bm))>0}get deletedAcross(){return(this.delInfo&Bm)>0}}class ii{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&ii.empty)return ii.empty}recover(e){let t=0,r=mM(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+_V(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let c=this.ranges[l+s],u=this.ranges[l+o],f=a+c;if(e<=f){let p=c?e==a?-1:e==f?1:t:t,g=a+i+(p<0?0:u);if(r)return g;let y=e==(t<0?a:f)?null:xV(l/3,e-a),v=e==a?wL:e==f?bL:Bm;return(t<0?e!=a:e!=f)&&(v|=vL),new bw(g,v,y)}i+=u-c}return r?e+i:new bw(e+i,0,null)}touches(e,t){let r=0,i=mM(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let c=this.ranges[l+s],u=a+c;if(e<=u&&l==i*3)return!0;r+=this.ranges[l+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),a=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(l,l+c,a,a+u),s+=u-c}}invert(){return new ii(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?ii.empty:new ii(e<0?[0,-e,0]:[0,0,e])}}ii.empty=new ii([]);class ed{constructor(e,t,r=0,i=e?e.length:0){this.mirror=t,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new ed(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let i=e.getMirror(t);this.appendMap(e._maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e._maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new ed;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this._maps[s],l=o.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(s);if(a!=null&&a>s&&a<this.to){s=a,e=this._maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new bw(e,i,null)}}const p1=Object.create(null);class fr{getMap(){return ii.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=p1[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in p1)throw new RangeError("Duplicate use of step JSON ID "+e);return p1[e]=t,t.prototype.jsonID=e,t}}class Mn{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Mn(e,null)}static fail(e){return new Mn(null,e)}static fromReplace(e,t,r,i){try{return Mn.ok(e.replace(t,r,i))}catch(s){if(s instanceof zg)return Mn.fail(s.message);throw s}}}function rk(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(rk(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return we.fromArray(r)}class uo extends fr{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new Le(rk(t.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return Mn.fromReplace(e,this.from,this.to,s)}invert(){return new Ss(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new uo(t.pos,r.pos,this.mark)}merge(e){return e instanceof uo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new uo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new uo(t.from,t.to,e.markFromJSON(t.mark))}}fr.jsonID("addMark",uo);class Ss extends fr{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new Le(rk(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Mn.fromReplace(e,this.from,this.to,r)}invert(){return new uo(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ss(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ss&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ss(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ss(t.from,t.to,e.markFromJSON(t.mark))}}fr.jsonID("removeMark",Ss);class ol extends fr{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Mn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Mn.fromReplace(e,this.pos,this.pos+1,new Le(we.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new ol(this.pos,t.marks[i]);return new ol(this.pos,this.mark)}}return new ja(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ol(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ol(t.pos,e.markFromJSON(t.mark))}}fr.jsonID("addNodeMark",ol);class ja extends fr{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Mn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Mn.fromReplace(e,this.pos,this.pos+1,new Le(we.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new ol(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ja(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ja(t.pos,e.markFromJSON(t.mark))}}fr.jsonID("removeNodeMark",ja);class Pn extends fr{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&ww(e,this.from,this.to)?Mn.fail("Structure replace would overwrite content"):Mn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new ii([this.from,this.to-this.from,this.slice.size])}invert(e){return new Pn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Pn(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Pn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?Le.empty:new Le(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Pn(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?Le.empty:new Le(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Pn(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Pn(t.from,t.to,Le.fromJSON(e,t.slice),!!t.structure)}}fr.jsonID("replace",Pn);class cr extends fr{constructor(e,t,r,i,s,o,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(ww(e,this.from,this.gapFrom)||ww(e,this.gapTo,this.to)))return Mn.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Mn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Mn.fromReplace(e,this.from,this.to,r):Mn.fail("Content does not fit in gap")}getMap(){return new ii([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new cr(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new cr(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new cr(t.from,t.to,t.gapFrom,t.gapTo,Le.fromJSON(e,t.slice),t.insert,!!t.structure)}}fr.jsonID("replaceAround",cr);function ww(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function MV(n,e,t,r){let i=[],s=[],o,l;n.doc.nodesBetween(e,t,(a,c,u)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&u.type.allowsMarkType(r.type)){let p=Math.max(c,e),g=Math.min(c+a.nodeSize,t),y=r.addToSet(f);for(let v=0;v<f.length;v++)f[v].isInSet(y)||(o&&o.to==p&&o.mark.eq(f[v])?o.to=g:i.push(o=new Ss(p,g,f[v])));l&&l.to==p?l.to=g:s.push(l=new uo(p,g,r))}}),i.forEach(a=>n.step(a)),s.forEach(a=>n.step(a))}function TV(n,e,t,r){let i=[],s=0;n.doc.nodesBetween(e,t,(o,l)=>{if(!o.isInline)return;s++;let a=null;if(r instanceof B0){let c=o.marks,u;for(;u=r.isInSet(c);)(a||(a=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(a=[r]):a=o.marks;if(a&&a.length){let c=Math.min(l+o.nodeSize,t);for(let u=0;u<a.length;u++){let f=a[u],p;for(let g=0;g<i.length;g++){let y=i[g];y.step==s-1&&f.eq(i[g].style)&&(p=y)}p?(p.to=c,p.step=s):i.push({style:f,from:Math.max(l,e),to:c,step:s})}}}),i.forEach(o=>n.step(new Ss(o.from,o.to,o.style)))}function ik(n,e,t,r=t.contentMatch,i=!0){let s=n.doc.nodeAt(e),o=[],l=e+1;for(let a=0;a<s.childCount;a++){let c=s.child(a),u=l+c.nodeSize,f=r.matchType(c.type);if(!f)o.push(new Pn(l,u,Le.empty));else{r=f;for(let p=0;p<c.marks.length;p++)t.allowsMarkType(c.marks[p].type)||n.step(new Ss(l,u,c.marks[p]));if(i&&c.isText&&t.whitespace!="pre"){let p,g=/\r?\n|\r/g,y;for(;p=g.exec(c.text);)y||(y=new Le(we.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new Pn(l+p.index,l+p.index+p[0].length,y))}}l=u}if(!r.validEnd){let a=r.fillBefore(we.empty,!0);n.replace(l,l,new Le(a,0,0))}for(let a=o.length-1;a>=0;a--)n.step(o[a])}function EV(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function V0(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),s=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(s,o,t))return r;if(r==0||i.type.spec.isolating||!EV(i,s,o))break}return null}function AV(n,e,t){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),l=i.after(s+1),a=o,c=l,u=we.empty,f=0;for(let y=s,v=!1;y>t;y--)v||r.index(y)>0?(v=!0,u=we.from(r.node(y).copy(u)),f++):a--;let p=we.empty,g=0;for(let y=s,v=!1;y>t;y--)v||i.after(y+1)<i.end(y)?(v=!0,p=we.from(i.node(y).copy(p)),g++):c++;n.step(new cr(a,c,o,l,new Le(u.append(p),f,g),u.size-f,!0))}function sk(n,e,t=null,r=n){let i=OV(n,e),s=i&&LV(r,e);return s?i.map(gM).concat({type:e,attrs:t}).concat(s.map(gM)):null}function gM(n){return{type:n,attrs:null}}function OV(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(r,i,o)?s:null}function LV(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;a&&c<i;c++)a=a.matchType(t.child(c).type);return!a||!a.validEnd?null:o}function DV(n,e,t){let r=we.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let l=t[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=we.from(t[o].type.create(t[o].attrs,r))}let i=e.start,s=e.end;n.step(new cr(i,s,i,s,new Le(r,0,0),t.length,!0))}function IV(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(e,t,(o,l)=>{let a=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(r,a)&&NV(n.doc,n.mapping.slice(s).map(l),r)){let c=null;if(r.schema.linebreakReplacement){let g=r.whitespace=="pre",y=!!r.contentMatch.matchType(r.schema.linebreakReplacement);g&&!y?c=!1:!g&&y&&(c=!0)}c===!1&&CL(n,o,l,s),ik(n,n.mapping.slice(s).map(l,1),r,void 0,c===null);let u=n.mapping.slice(s),f=u.map(l,1),p=u.map(l+o.nodeSize,1);return n.step(new cr(f,p,f+1,p-1,new Le(we.from(r.create(a,null,o.marks)),0,0),1,!0)),c===!0&&kL(n,o,l,s),!1}})}function kL(n,e,t,r){e.forEach((i,s)=>{if(i.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(i.text);){let a=n.mapping.slice(r).map(t+1+s+o.index);n.replaceWith(a,a+1,e.type.schema.linebreakReplacement.create())}}})}function CL(n,e,t,r){e.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(t+1+s);n.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function NV(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function RV(n,e,t,r,i){let s=n.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");t||(t=s.type);let o=t.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(e,e+s.nodeSize,o);if(!t.validContent(s.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new cr(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new Le(we.from(o),0,0),1,!0))}function hh(n,e,t=1,r){let i=n.resolve(e),s=i.depth-t,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>s;c--,u--){let f=i.node(c),p=i.index(c);if(f.type.spec.isolating)return!1;let g=f.content.cutByIndex(p,f.childCount),y=r&&r[u+1];y&&(g=g.replaceChild(0,y.type.create(y.attrs)));let v=r&&r[u]||f;if(!f.canReplace(p+1,f.childCount)||!v.type.validContent(g))return!1}let l=i.indexAfter(s),a=r&&r[0];return i.node(s).canReplaceWith(l,l,a?a.type:i.node(s+1).type)}function PV(n,e,t=1,r){let i=n.doc.resolve(e),s=we.empty,o=we.empty;for(let l=i.depth,a=i.depth-t,c=t-1;l>a;l--,c--){s=we.from(i.node(l).copy(s));let u=r&&r[c];o=we.from(u?u.type.create(u.attrs,o):i.node(l).copy(o))}n.step(new Pn(e,e,new Le(s.append(o),t,t),!0))}function F0(n,e){let t=n.resolve(e),r=t.index();return HV(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function BV(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<e.childCount;i++){let s=e.child(i),o=s.type==r?n.type.schema.nodes.text:s.type;if(t=t.matchType(o),!t||!n.type.allowsMarks(s.marks))return!1}return t.validEnd}function HV(n,e){return!!(n&&e&&!n.isLeaf&&BV(n,e))}function VV(n,e,t){let r=null,{linebreakReplacement:i}=n.doc.type.schema,s=n.doc.resolve(e-t),o=s.node().type;if(i&&o.inlineContent){let u=o.whitespace=="pre",f=!!o.contentMatch.matchType(i);u&&!f?r=!1:!u&&f&&(r=!0)}let l=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);CL(n,u.node(),u.before(),l)}o.inlineContent&&ik(n,e+t-1,o,s.node().contentMatchAt(s.index()),r==null);let a=n.mapping.slice(l),c=a.map(e-t);if(n.step(new Pn(c,a.map(e+t,-1),Le.empty,!0)),r===!0){let u=n.doc.resolve(c);kL(n,u.node(),u.before(),n.steps.length)}return n}function FV(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,t))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,t))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function jV(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let s=0;s<t.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(t.openStart==0&&t.size?2:1);s++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,a=r.index(o)+(l>0?1:0),c=r.node(o),u=!1;if(s==1)u=c.canReplace(a,a,i);else{let f=c.contentMatchAt(a).findWrapping(i.firstChild.type);u=f&&c.canReplaceWith(a,a,f[0])}if(u)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function j0(n,e,t=e,r=Le.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),s=n.resolve(t);return SL(i,s,r)?new Pn(e,t,r):new $V(i,s,r).fit()}function SL(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class $V{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=we.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=we.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let a=new Le(s,o,l);return e>-1?new cr(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new Pn(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=t.firstChild;if(t.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}t=s.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=m1(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:c}=this.frontier[l],u,f=null;if(t==1&&(o?c.matchType(o.type)||(f=c.fillBefore(we.from(o),!1)):s&&a.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:l,parent:s,inject:f};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:s,wrap:u};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=m1(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new Le(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=m1(e,t);if(i.childCount<=1&&t>0){let s=e.size-t<=t+i.size;this.unplaced=new Le(xf(e,t-1,1),t-1,s?t-1:r)}else this.unplaced=new Le(xf(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let v=0;v<s.length;v++)this.openFrontierNode(s[v]);let o=this.unplaced,l=r?r.content:o.content,a=o.openStart-e,c=0,u=[],{match:f,type:p}=this.frontier[t];if(i){for(let v=0;v<i.childCount;v++)u.push(i.child(v));f=f.matchFragment(i)}let g=l.size+e-(o.content.size-o.openEnd);for(;c<l.childCount;){let v=l.child(c),k=f.matchType(v.type);if(!k)break;c++,(c>1||a==0||v.content.size)&&(f=k,u.push(xL(v.mark(p.allowedMarks(v.marks)),c==1?a:0,c==l.childCount?g:-1)))}let y=c==l.childCount;y||(g=-1),this.placed=_f(this.placed,t,we.from(u)),this.frontier[t].match=f,y&&g<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,k=l;v<g;v++){let x=k.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),k=x.content}this.unplaced=y?e==0?Le.empty:new Le(xf(o.content,e-1,1),e-1,g<0?o.openEnd:e-1):new Le(xf(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!g1(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=g1(e,t,i,r,s);if(o){for(let l=t-1;l>=0;l--){let{match:a,type:c}=this.frontier[l],u=g1(e,l,c,a,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=_f(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=_f(this.placed,this.depth,we.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(we.empty,!0);t.childCount&&(this.placed=_f(this.placed,this.frontier.length,t))}}function xf(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(xf(n.firstChild.content,e-1,t)))}function _f(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(_f(n.lastChild.content,e-1,t)))}function m1(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function xL(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,xL(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(we.empty,!0)))),n.copy(r)}function g1(n,e,t,r,i){let s=n.node(e),o=i?n.indexAfter(e):n.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let l=r.fillBefore(s.content,!0,o);return l&&!zV(t,s.content,o)?l:null}function zV(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function WV(n){return n.spec.defining||n.spec.definingForContent}function qV(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),s=n.doc.resolve(t);if(SL(i,s,r))return n.step(new Pn(e,t,r));let o=ML(i,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let l=-(i.depth+1);o.unshift(l);for(let p=i.depth,g=i.pos-1;p>0;p--,g--){let y=i.node(p).type.spec;if(y.defining||y.definingAsContext||y.isolating)break;o.indexOf(p)>-1?l=p:i.before(p)==g&&o.splice(1,0,-p)}let a=o.indexOf(l),c=[],u=r.openStart;for(let p=r.content,g=0;;g++){let y=p.firstChild;if(c.push(y),g==r.openStart)break;p=y.content}for(let p=u-1;p>=0;p--){let g=c[p],y=WV(g.type);if(y&&!g.sameMarkup(i.node(Math.abs(l)-1)))u=p;else if(y||!g.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let g=(p+u+1)%(r.openStart+1),y=c[g];if(y)for(let v=0;v<o.length;v++){let k=o[(v+a)%o.length],x=!0;k<0&&(x=!1,k=-k);let _=i.node(k-1),M=i.index(k-1);if(_.canReplaceWith(M,M,y.type,y.marks))return n.replace(i.before(k),x?s.after(k):t,new Le(_L(r.content,0,r.openStart,g),g,r.openEnd))}}let f=n.steps.length;for(let p=o.length-1;p>=0&&(n.replace(e,t,r),!(n.steps.length>f));p--){let g=o[p];g<0||(e=i.before(g),t=s.after(g))}}function _L(n,e,t,r,i){if(e<t){let s=n.firstChild;n=n.replaceChild(0,s.copy(_L(s.content,e+1,t,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(we.empty,!0))}return n}function UV(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=FV(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new Le(we.from(r),0,0))}function KV(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),s=ML(r,i);for(let o=0;o<s.length;o++){let l=s[o],a=o==s.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&i.end(o)-t!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return n.delete(r.before(o),t);n.delete(e,t)}function ML(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&t.push(i)}return t}class Ac extends fr{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Mn.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Mn.fromReplace(e,this.pos,this.pos+1,new Le(we.from(i),0,t.isLeaf?0:1))}getMap(){return ii.empty}invert(e){return new Ac(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ac(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ac(t.pos,t.attr,t.value)}}fr.jsonID("attr",Ac);class td extends fr{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return Mn.ok(r)}getMap(){return ii.empty}invert(e){return new td(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new td(t.attr,t.value)}}fr.jsonID("docAttr",td);let yu=class extends Error{};yu=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};yu.prototype=Object.create(Error.prototype);yu.prototype.constructor=yu;yu.prototype.name="TransformError";class TL{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ed}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new yu(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=Le.empty){let i=j0(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new Le(we.from(r),0,0))}delete(e,t){return this.replace(e,t,Le.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return qV(this,e,t,r),this}replaceRangeWith(e,t,r){return UV(this,e,t,r),this}deleteRange(e,t){return KV(this,e,t),this}lift(e,t){return AV(this,e,t),this}join(e,t=1){return VV(this,e,t),this}wrap(e,t){return DV(this,e,t),this}setBlockType(e,t=e,r,i=null){return IV(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return RV(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new Ac(e,t,r)),this}setDocAttribute(e,t){return this.step(new td(e,t)),this}addNodeMark(e,t){return this.step(new ol(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof ct)t.isInSet(r.marks)&&this.step(new ja(e,t));else{let i=r.marks,s,o=[];for(;s=t.isInSet(i);)o.push(new ja(e,s)),i=s.removeFromSet(i);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(e,t=1,r){return PV(this,e,t,r),this}addMark(e,t,r){return MV(this,e,t,r),this}removeMark(e,t,r){return TV(this,e,t,r),this}clearIncompatible(e,t,r){return ik(this,e,t,r),this}}const y1=Object.create(null);class tt{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new EL(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=Le.empty){let r=t.content.lastChild,i=null;for(let l=0;l<t.openEnd;l++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:a,$to:c}=o[l],u=e.mapping.slice(s);e.replaceRange(u.map(a.pos),u.map(c.pos),l?Le.empty:t),l==0&&wM(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],a=e.mapping.slice(r),c=a.map(o.pos),u=a.map(l.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),wM(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new ze(e):fc(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?fc(e.node(0),e.node(s),e.before(s+1),e.index(s),t,r):fc(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new zr(e.node(0))}static atStart(e){return fc(e,e,0,0,1)||new zr(e)}static atEnd(e){return fc(e,e,e.content.size,e.childCount,-1)||new zr(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=y1[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in y1)throw new RangeError("Duplicate use of selection JSON ID "+e);return y1[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ze.between(this.$anchor,this.$head).getBookmark()}}tt.prototype.visible=!0;class EL{constructor(e,t){this.$from=e,this.$to=t}}let yM=!1;function bM(n){!yM&&!n.parent.inlineContent&&(yM=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ze extends tt{constructor(e,t=e){bM(e),bM(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return tt.near(r);let i=e.resolve(t.map(this.anchor));return new ze(i.parent.inlineContent?i:r,r)}replace(e,t=Le.empty){if(super.replace(e,t),t==Le.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ze&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new $0(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ze(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let s=tt.findFrom(t,r,!0)||tt.findFrom(t,-r,!0);if(s)t=s.$head;else return tt.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(tt.findFrom(e,-r,!0)||tt.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new ze(e,t)}}tt.jsonID("text",ze);class $0{constructor(e,t){this.anchor=e,this.head=t}map(e){return new $0(e.map(this.anchor),e.map(this.head))}resolve(e){return ze.between(e.resolve(this.anchor),e.resolve(this.head))}}class Ke extends tt{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return r?tt.near(s):new Ke(s)}content(){return new Le(we.from(this.node),0,0)}eq(e){return e instanceof Ke&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ok(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ke(e.resolve(t.anchor))}static create(e,t){return new Ke(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Ke.prototype.visible=!1;tt.jsonID("node",Ke);class ok{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new $0(r,r):new ok(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&Ke.isSelectable(r)?new Ke(t):tt.near(t)}}class zr extends tt{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=Le.empty){if(t==Le.empty){e.delete(0,e.doc.content.size);let r=tt.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new zr(e)}map(e){return new zr(e)}eq(e){return e instanceof zr}getBookmark(){return GV}}tt.jsonID("all",zr);const GV={map(){return this},resolve(n){return new zr(n)}};function fc(n,e,t,r,i,s=!1){if(e.inlineContent)return ze.create(n,t);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let l=e.child(o);if(l.isAtom){if(!s&&Ke.isSelectable(l))return Ke.create(n,t-(i<0?l.nodeSize:0))}else{let a=fc(n,l,t+i,i<0?l.childCount:0,i,s);if(a)return a}t+=l.nodeSize*i}return null}function wM(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof Pn||i instanceof cr))return;let s=n.mapping.maps[r],o;s.forEach((l,a,c,u)=>{o==null&&(o=u)}),n.setSelection(tt.near(n.doc.resolve(o),t))}const vM=1,im=2,kM=4;class JV extends TL{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|vM)&~im,this.storedMarks=null,this}get selectionSet(){return(this.updated&vM)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=im,this}ensureMarks(e){return ct.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&im)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~im,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||ct.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),!e)return this.deleteRange(t,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(t);s=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,s)),!this.selection.empty&&this.selection.to==t+e.length&&this.setSelection(tt.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=kM,this}get scrolledIntoView(){return(this.updated&kM)>0}}function CM(n,e){return!e||!n?n:n.bind(e)}class Mf{constructor(e,t,r){this.name=e,this.init=CM(t.init,r),this.apply=CM(t.apply,r)}}const ZV=[new Mf("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Mf("selection",{init(n,e){return n.selection||tt.atStart(e.doc)},apply(n){return n.selection}}),new Mf("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Mf("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class b1{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ZV.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Mf(r.key,r.spec.state,r))})}}class na{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let a=i?i[o].n:0,c=i?i[o].state:this,u=a<t.length&&l.spec.appendTransaction.call(l,a?t.slice(a):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),s=!0}i&&(i[o]={state:r,n:t.length})}}if(!s)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new na(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];t[s.name]=s.apply(e,this[s.name],this,t)}return t}get tr(){return new JV(this)}static create(e){let t=new b1(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new na(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new b1(this.schema,e.plugins),r=t.fields,i=new na(t);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(t[r]=s.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new b1(e.schema,e.plugins),s=new na(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=Ci.fromJSON(e.schema,t.doc);else if(o.name=="selection")s.selection=tt.fromJSON(s.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(s.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],c=a.spec.state;if(a.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,l)){s[o.name]=c.fromJSON.call(a,e,t[l],s);return}}s[o.name]=o.init(e,s)}}),s}}function AL(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=AL(i,e,{})),t[r]=i}return t}class nn{constructor(e){this.spec=e,this.props={},e.props&&AL(e.props,this,this.props),this.key=e.key?e.key.key:OL("plugin")}getState(e){return e[this.key]}}const w1=Object.create(null);function OL(n){return n in w1?n+"$"+ ++w1[n]:(w1[n]=0,n+"$")}class rn{constructor(e="key"){this.key=OL(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}class qr{constructor(e,t,r={}){this.match=e,this.match=e,this.handler=typeof t=="string"?YV(t):t,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1,this.inCodeMark=r.inCodeMark!==!1}}function YV(n){return function(e,t,r,i){let s=n;if(t[1]){let o=t[0].lastIndexOf(t[1]);s+=t[0].slice(o+t[1].length),r+=o;let l=r-i;l>0&&(s=t[0].slice(o-l,o)+s,r=i)}return e.tr.insertText(s,r,i)}}const XV=(n,e)=>{let t=n.plugins;for(let r=0;r<t.length;r++){let i=t[r],s;if(i.spec.isInputRules&&(s=i.getState(n))){if(e){let o=n.tr,l=s.transform;for(let a=l.steps.length-1;a>=0;a--)o.step(l.steps[a].invert(l.docs[a]));if(s.text){let a=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,n.schema.text(s.text,a))}else o.delete(s.from,s.to);e(o)}return!0}}return!1};new qr(/--$/,"",{inCodeMark:!1});new qr(/\.\.\.$/,"",{inCodeMark:!1});new qr(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"",{inCodeMark:!1});new qr(/"$/,"",{inCodeMark:!1});new qr(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"",{inCodeMark:!1});new qr(/'$/,"",{inCodeMark:!1});function lk(n,e,t=null,r){return new qr(n,(i,s,o,l)=>{let a=t instanceof Function?t(s):t,c=i.tr.delete(o,l),u=c.doc.resolve(o),f=u.blockRange(),p=f&&sk(f,e,a);if(!p)return null;c.wrap(f,p);let g=c.doc.resolve(o-1).nodeBefore;return g&&g.type==e&&F0(c.doc,o-1)&&(!r||r(s,g))&&c.join(o-1),c})}function ak(n,e,t=null){return new qr(n,(r,i,s,o)=>{let l=r.doc.resolve(s),a=t instanceof Function?t(i):t;return l.node(-1).canReplaceWith(l.index(-1),l.indexAfter(-1),e)?r.tr.delete(s,o).setBlockType(s,s,e,a):null})}var Ur=(n=>(n.docTypeError="docTypeError",n.contextNotFound="contextNotFound",n.timerNotFound="timerNotFound",n.ctxCallOutOfScope="ctxCallOutOfScope",n.createNodeInParserFail="createNodeInParserFail",n.stackOverFlow="stackOverFlow",n.parserMatchError="parserMatchError",n.serializerMatchError="serializerMatchError",n.getAtomFromSchemaFail="getAtomFromSchemaFail",n.expectDomTypeError="expectDomTypeError",n.callCommandBeforeEditorView="callCommandBeforeEditorView",n.missingRootElement="missingRootElement",n.missingNodeInSchema="missingNodeInSchema",n.missingMarkInSchema="missingMarkInSchema",n.ctxNotBind="ctxNotBind",n.missingYjsDoc="missingYjsDoc",n))(Ur||{});class ci extends Error{constructor(e,t){super(t),this.name="MilkdownError",this.code=e}}const QV=(n,e)=>typeof e=="function"?"[Function]":e,z0=n=>JSON.stringify(n,QV);function eF(n){return new ci(Ur.docTypeError,`Doc type error, unsupported type: ${z0(n)}`)}function tF(n){return new ci(Ur.contextNotFound,`Context "${n}" not found, do you forget to inject it?`)}function nF(n){return new ci(Ur.timerNotFound,`Timer "${n}" not found, do you forget to record it?`)}function W0(){return new ci(Ur.ctxCallOutOfScope,"Should not call a context out of the plugin.")}function rF(n,e,t){const i=`Cannot create node for ${"name"in n?n.name:n}`,s=u=>{if(u==null)return"null";if(Array.isArray(u))return`[${u.map(s).join(", ")}]`;if(typeof u=="object")return"toJSON"in u&&typeof u.toJSON=="function"?JSON.stringify(u.toJSON()):"spec"in u?JSON.stringify(u.spec):JSON.stringify(u);if(typeof u=="string"||typeof u=="number"||typeof u=="boolean")return JSON.stringify(u);if(typeof u=="function")return`[Function: ${u.name||"anonymous"}]`;try{return String(u)}catch{return"[Unserializable]"}},o=["[Description]",i],l=["[Attributes]",e],a=["[Content]",(t??[]).map(u=>u?typeof u=="object"&&"type"in u?`${u}`:s(u):"null")],c=[o,l,a].reduce((u,[f,p])=>{const g=`${f}: ${s(p)}.`;return u.concat(g)},[]);return new ci(Ur.createNodeInParserFail,c.join(`
`))}function LL(){return new ci(Ur.stackOverFlow,"Stack over flow, cannot pop on an empty stack.")}function iF(n){return new ci(Ur.parserMatchError,`Cannot match target parser for node: ${z0(n)}.`)}function sF(n){return new ci(Ur.serializerMatchError,`Cannot match target serializer for node: ${z0(n)}.`)}function oF(n,e){return new ci(Ur.getAtomFromSchemaFail,`Cannot get ${n}: ${e} from schema.`)}function Zi(n){return new ci(Ur.expectDomTypeError,`Expect to be a dom, but get: ${z0(n)}.`)}function v1(){return new ci(Ur.callCommandBeforeEditorView,"You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}function lF(n){return new ci(Ur.missingNodeInSchema,`Missing node in schema, milkdown cannot find "${n}" in schema.`)}function aF(n){return new ci(Ur.missingMarkInSchema,`Missing mark in schema, milkdown cannot find "${n}" in schema.`)}const wl=typeof navigator<"u"?navigator:null,SM=typeof document<"u"?document:null,Sl=wl&&wl.userAgent||"",vw=/Edge\/(\d+)/.exec(Sl),DL=/MSIE \d/.exec(Sl),kw=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Sl),q0=!!(DL||kw||vw),cF=DL?document.documentMode:kw?+kw[1]:vw?+vw[1]:0,IL=!q0&&/gecko\/(\d+)/i.test(Sl),uF=IL&&+(/Firefox\/(\d+)/.exec(Sl)||[0,0])[1],Cw=!q0&&/Chrome\/(\d+)/.exec(Sl),fF=!!Cw,hF=Cw?+Cw[1]:0,NL=!q0&&!!wl&&/Apple Computer/.test(wl.vendor),RL=NL&&(/Mobile\/\w+/.test(Sl)||!!wl&&wl.maxTouchPoints>2),dF=RL||(wl?/Mac/.test(wl.platform):!1),pF=/Android \d/.test(Sl),PL=!!SM&&"webkitFontSmoothing"in SM.documentElement.style,mF=PL?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;var sm=Object.freeze({__proto__:null,android:pF,chrome:fF,chrome_version:hF,gecko:IL,gecko_version:uF,ie:q0,ie_version:cF,ios:RL,mac:dF,safari:NL,webkit:PL,webkit_version:mF});function k1(n,e,t,r,i,s){if(n.composing)return!1;const o=n.state,l=o.doc.resolve(e);if(l.parent.type.spec.code)return!1;const a=l.parent.textBetween(Math.max(0,l.parentOffset-500),l.parentOffset,void 0,"")+r;for(let c of i){const u=c,f=u.match.exec(a),p=f&&f[0]&&u.handler(o,f,e-(f[0].length-r.length),t);if(p)return u.undoable!==!1&&p.setMeta(s,{transform:p,from:e,to:t,text:r}),n.dispatch(p),!0}return!1}const gF=new rn("MILKDOWN_CUSTOM_INPUTRULES");function yF({rules:n}){const e=new nn({key:gF,isInputRules:!0,state:{init(){return null},apply(t,r){const i=t.getMeta(this);return i||(t.selectionSet||t.docChanged?null:r)}},props:{handleTextInput(t,r,i,s){return k1(t,r,i,s,n,e)},handleDOMEvents:{compositionend:t=>(setTimeout(()=>{const{$cursor:r}=t.state.selection;r&&k1(t,r.pos,r.pos,"",n,e)}),!1)},handleKeyDown(t,r){if(r.key!=="Enter")return!1;const{$cursor:i}=t.state.selection;return i?k1(t,i.pos,i.pos,`
`,n,e):!1}}});return e}function np(n,e,t={}){return new qr(n,(r,i,s,o)=>{var l,a,c,u;const{tr:f}=r,p=i.length;let g=i[p-1],y=i[0],v=[],k=o;const x={group:g,fullMatch:y,start:s,end:o},_=(l=t.updateCaptured)==null?void 0:l.call(t,x);if(Object.assign(x,_),{group:g,fullMatch:y,start:s,end:o}=x,y===null||(g==null?void 0:g.trim())==="")return null;if(g){const M=y.search(/\S/),T=s+y.indexOf(g),S=T+g.length;v=(a=f.storedMarks)!=null?a:[],S<o&&f.delete(S,o),T>s&&f.delete(s+M,T),k=s+M+g.length;const A=(c=t.getAttr)==null?void 0:c.call(t,i);f.addMark(s,k,e.create(A)),f.setStoredMarks(v),(u=t.beforeDispatch)==null||u.call(t,{match:i,start:s,end:o,tr:f})}return f})}function bF(n,e,t={}){return new qr(n,(r,i,s,o)=>{var l,a,c;const{tr:u}=r;let f=i[1],p=i[0];const g={group:f,fullMatch:p,start:s,end:o},y=(l=t.updateCaptured)==null?void 0:l.call(t,g);if(Object.assign(g,y),{group:f,fullMatch:p,start:s,end:o}=g,p===null||!f||f.trim()==="")return null;const v=(a=t.getAttr)==null?void 0:a.call(t,i),k=e.createAndFill(v);return k&&(u.replaceRangeWith(e.isBlock?u.doc.resolve(s).before():s,o,k),(c=t.beforeDispatch)==null||c.call(t,{match:[p,f??""],start:s,end:o,tr:u})),u})}var wF=Object.defineProperty,vF=Object.defineProperties,kF=Object.getOwnPropertyDescriptors,xM=Object.getOwnPropertySymbols,CF=Object.prototype.hasOwnProperty,SF=Object.prototype.propertyIsEnumerable,_M=(n,e,t)=>e in n?wF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xF=(n,e)=>{for(var t in e||(e={}))CF.call(e,t)&&_M(n,t,e[t]);if(xM)for(var t of xM(e))SF.call(e,t)&&_M(n,t,e[t]);return n},_F=(n,e)=>vF(n,kF(e));function MM(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function U0(n,e,t){const i=n.state.doc.content.size,s=MM(e,0,i),o=MM(t,0,i),l=n.coordsAtPos(s),a=n.coordsAtPos(o,-1),c=Math.min(l.top,a.top),u=Math.max(l.bottom,a.bottom),f=Math.min(l.left,a.left),p=Math.max(l.right,a.right),g=p-f,y=u-c,x={top:c,bottom:u,left:f,right:p,width:g,height:y,x:f,y:c};return _F(xF({},x),{toJSON:()=>x})}function BL(n){return Object.assign(Object.create(n),n).setTime(Date.now())}function MF(n,e){return Array.isArray(n)&&n.includes(e.type)||e.type===n}function TF(n){if(n.content.childCount===1){const e=n.content.firstChild;if((e==null?void 0:e.type.name)==="text"&&e.marks.length===0)return e;if((e==null?void 0:e.type.name)==="paragraph"&&e.childCount===1){const t=e.firstChild;if((t==null?void 0:t.type.name)==="text"&&t.marks.length===0)return t}}return!1}function Ms(n){return e=>{for(let t=e.depth;t>0;t-=1){const r=e.node(t);if(n(r)){const i=e.before(t),s=e.after(t);return{from:i,to:s,node:r}}}}}function EF(n,e){return Ms(t=>t.type===e)(n)}function AF(n,e){const t=e.nodes[n];if(!t)throw oF("node",n);return t}function HL(n){return e=>{for(let t=e.depth;t>0;t--){const r=e.node(t);if(n(r))return{pos:t>0?e.before(t):0,start:e.start(t),depth:t,node:r}}}}function OF(n){return e=>HL(n)(e.$from)}function LF(n,e){if(!(n instanceof Ke))return;const{node:t,$from:r}=n;if(MF(e,t))return{node:t,pos:r.pos,start:r.start(r.depth),depth:r.depth}}const VL=(n,e)=>{const{selection:t,doc:r}=n;if(t instanceof Ke)return{hasNode:t.node.type===e,pos:t.from,target:t.node};const{from:i,to:s}=t;let o=!1,l=-1,a=null;return r.nodesBetween(i,s,(c,u)=>a?!1:c.type===e?(o=!0,l=u,a=c,!1):!0),{hasNode:o,pos:l,target:a}};class FL{constructor(){this.sliceMap=new Map,this.get=e=>{const t=typeof e=="string"?[...this.sliceMap.values()].find(r=>r.type.name===e):this.sliceMap.get(e.id);if(!t){const r=typeof e=="string"?e:e.name;throw tF(r)}return t},this.remove=e=>{const t=typeof e=="string"?[...this.sliceMap.values()].find(r=>r.type.name===e):this.sliceMap.get(e.id);t&&this.sliceMap.delete(t.type.id)},this.has=e=>typeof e=="string"?[...this.sliceMap.values()].some(t=>t.type.name===e):this.sliceMap.has(e.id)}}var Hi,to,Bc;class DF{constructor(e,t,r){be(this,Hi);be(this,to);be(this,Bc);X(this,Hi,[]),X(this,Bc,()=>{V(this,Hi).forEach(i=>i(V(this,to)))}),this.set=i=>{X(this,to,i),V(this,Bc).call(this)},this.get=()=>V(this,to),this.update=i=>{X(this,to,i(V(this,to))),V(this,Bc).call(this)},this.type=r,X(this,to,t),e.set(r.id,this)}on(e){return V(this,Hi).push(e),()=>{X(this,Hi,V(this,Hi).filter(t=>t!==e))}}once(e){const t=this.on(r=>{e(r),t()});return t}off(e){X(this,Hi,V(this,Hi).filter(t=>t!==e))}offAll(){X(this,Hi,[])}}Hi=new WeakMap,to=new WeakMap,Bc=new WeakMap;class IF{constructor(e,t){this.id=Symbol(`Context-${t}`),this.name=t,this._defaultValue=e,this._typeInfo=()=>{throw W0()}}create(e,t=this._defaultValue){return new DF(e,t,this)}}const mt=(n,e)=>new IF(n,e);var Sd,xd,_d,aa,Hc,el,Vc,Fc,jc;class NF{constructor(e,t,r){be(this,Sd);be(this,xd);be(this,_d);be(this,aa);be(this,Hc);be(this,el);be(this,Vc);be(this,Fc);be(this,jc);X(this,aa,new Set),X(this,Hc,new Set),X(this,el,new Map),X(this,Vc,new Map),this.read=()=>({metadata:V(this,Sd),injectedSlices:[...V(this,aa)].map(i=>({name:typeof i=="string"?i:i.name,value:V(this,Fc).call(this,i)})),consumedSlices:[...V(this,Hc)].map(i=>({name:typeof i=="string"?i:i.name,value:V(this,Fc).call(this,i)})),recordedTimers:[...V(this,el)].map(([i,{duration:s}])=>({name:i.name,duration:s,status:V(this,jc).call(this,i)})),waitTimers:[...V(this,Vc)].map(([i,{duration:s}])=>({name:i.name,duration:s,status:V(this,jc).call(this,i)}))}),this.onRecord=i=>{V(this,el).set(i,{start:Date.now(),duration:0})},this.onClear=i=>{V(this,el).delete(i)},this.onDone=i=>{const s=V(this,el).get(i);s&&(s.duration=Date.now()-s.start)},this.onWait=(i,s)=>{const o=Date.now();s.finally(()=>{V(this,Vc).set(i,{duration:Date.now()-o})}).catch(console.error)},this.onInject=i=>{V(this,aa).add(i)},this.onRemove=i=>{V(this,aa).delete(i)},this.onUse=i=>{V(this,Hc).add(i)},X(this,Fc,i=>V(this,xd).get(i).get()),X(this,jc,i=>V(this,_d).get(i).status),X(this,xd,e),X(this,_d,t),X(this,Sd,r)}}Sd=new WeakMap,xd=new WeakMap,_d=new WeakMap,aa=new WeakMap,Hc=new WeakMap,el=new WeakMap,Vc=new WeakMap,Fc=new WeakMap,jc=new WeakMap;var no,ro,Md,hi;const VS=class VS{constructor(e,t,r){be(this,no);be(this,ro);be(this,Md);be(this,hi);this.produce=i=>i&&Object.keys(i).length?new VS(V(this,no),V(this,ro),{...i}):this,this.inject=(i,s)=>{var l;const o=i.create(V(this,no).sliceMap);return s!=null&&o.set(s),(l=V(this,hi))==null||l.onInject(i),this},this.remove=i=>{var s;return V(this,no).remove(i),(s=V(this,hi))==null||s.onRemove(i),this},this.record=i=>{var s;return i.create(V(this,ro).store),(s=V(this,hi))==null||s.onRecord(i),this},this.clearTimer=i=>{var s;return V(this,ro).remove(i),(s=V(this,hi))==null||s.onClear(i),this},this.isInjected=i=>V(this,no).has(i),this.isRecorded=i=>V(this,ro).has(i),this.use=i=>{var s;return(s=V(this,hi))==null||s.onUse(i),V(this,no).get(i)},this.get=i=>this.use(i).get(),this.set=(i,s)=>this.use(i).set(s),this.update=(i,s)=>this.use(i).update(s),this.timer=i=>V(this,ro).get(i),this.done=i=>{var s;this.timer(i).done(),(s=V(this,hi))==null||s.onDone(i)},this.wait=i=>{var o;const s=this.timer(i).start();return(o=V(this,hi))==null||o.onWait(i,s),s},this.waitTimers=async i=>{await Promise.all(this.get(i).map(s=>this.wait(s)))},X(this,no,e),X(this,ro,t),X(this,Md,r),r&&X(this,hi,new NF(e,t,r))}get meta(){return V(this,Md)}get inspector(){return V(this,hi)}};no=new WeakMap,ro=new WeakMap,Md=new WeakMap,hi=new WeakMap;let Sw=VS;class RF{constructor(){this.store=new Map,this.get=e=>{const t=this.store.get(e.id);if(!t)throw nF(e.name);return t},this.remove=e=>{this.store.delete(e.id)},this.has=e=>this.store.has(e.id)}}var $c,tl,zc,io,Wc,Td;class PF{constructor(e,t){be(this,$c);be(this,tl);be(this,zc);be(this,io);be(this,Wc);be(this,Td);X(this,$c,null),X(this,tl,null),X(this,io,"pending"),this.start=()=>(V(this,$c)??X(this,$c,new Promise((r,i)=>{X(this,tl,s=>{s instanceof CustomEvent&&s.detail.id===V(this,zc)&&(X(this,io,"resolved"),V(this,Wc).call(this),s.stopImmediatePropagation(),r())}),V(this,Td).call(this,()=>{V(this,io)==="pending"&&X(this,io,"rejected"),V(this,Wc).call(this),i(new Error(`Timing ${this.type.name} timeout.`))}),X(this,io,"pending"),addEventListener(this.type.name,V(this,tl))})),V(this,$c)),this.done=()=>{const r=new CustomEvent(this.type.name,{detail:{id:V(this,zc)}});dispatchEvent(r)},X(this,Wc,()=>{V(this,tl)&&removeEventListener(this.type.name,V(this,tl))}),X(this,Td,r=>{setTimeout(()=>{r()},this.type.timeout)}),X(this,zc,Symbol(t.name)),this.type=t,e.set(t.id,this)}get status(){return V(this,io)}}$c=new WeakMap,tl=new WeakMap,zc=new WeakMap,io=new WeakMap,Wc=new WeakMap,Td=new WeakMap;class BF{constructor(e,t=3e3){this.create=r=>new PF(r,this),this.id=Symbol(`Timer-${e}`),this.name=e,this.timeout=t}}const Ns=(n,e=3e3)=>new BF(n,e),HF={}.hasOwnProperty;function jL(n,e){let t=-1,r;if(e.extensions)for(;++t<e.extensions.length;)jL(n,e.extensions[t]);for(r in e)if(HF.call(e,r))switch(r){case"extensions":break;case"unsafe":{TM(n[r],e[r]);break}case"join":{TM(n[r],e[r]);break}case"handlers":{VF(n[r],e[r]);break}default:n.options[r]=e[r]}return n}function TM(n,e){e&&n.push(...e)}function VF(n,e){e&&Object.assign(n,e)}const FF=[jF];function jF(n,e,t,r){if(e.type==="code"&&px(e,r)&&(n.type==="list"||n.type===e.type&&px(n,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return n.type==="paragraph"&&(n.type===e.type||e.type==="definition"||e.type==="heading"&&E3(e,r))?void 0:t.spread?1:0}const Hl=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],$F=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Hl},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Hl},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Hl},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Hl},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Hl},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Hl},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Hl},{atBreak:!0,character:"~"}];function zF(n){return n.label||!n.identifier?n.label||"":A3(n.identifier)}function WF(n){if(!n._compiled){const e=(n.atBreak?"[\\r\\n][\\t ]*":"")+(n.before?"(?:"+n.before+")":"");n._compiled=new RegExp((e?"("+e+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(n.character)?"\\":"")+n.character+(n.after?"(?:"+n.after+")":""),"g")}return n._compiled}function qF(n,e,t){const r=e.indexStack,i=n.children||[],s=[];let o=-1,l=t.before,a;r.push(-1);let c=e.createTracker(t);for(;++o<i.length;){const u=i[o];let f;if(r[r.length-1]=o,o+1<i.length){let y=e.handle.handlers[i[o+1].type];y&&y.peek&&(y=y.peek),f=y?y(i[o+1],n,e,{before:"",after:"",...c.current()}).charAt(0):""}else f=t.after;s.length>0&&(l==="\r"||l===`
`)&&u.type==="html"&&(s[s.length-1]=s[s.length-1].replace(/(\r?\n|\r)$/," "),l=" ",c=e.createTracker(t),c.move(s.join("")));let p=e.handle(u,n,e,{...c.current(),after:f,before:l});a&&a===p.slice(0,1)&&(p=pb(a.charCodeAt(0))+p.slice(1));const g=e.attentionEncodeSurroundingInfo;e.attentionEncodeSurroundingInfo=void 0,a=void 0,g&&(s.length>0&&g.before&&l===s[s.length-1].slice(-1)&&(s[s.length-1]=s[s.length-1].slice(0,-1)+pb(l.charCodeAt(0))),g.after&&(a=f)),c.move(p),s.push(p),l=p.slice(-1)}return r.pop(),s.join("")}function UF(n,e,t){const r=e.indexStack,i=n.children||[],s=e.createTracker(t),o=[];let l=-1;for(r.push(-1);++l<i.length;){const a=i[l];r[r.length-1]=l,o.push(s.move(e.handle(a,n,e,{before:`
`,after:`
`,...s.current()}))),a.type!=="list"&&(e.bulletLastUsed=void 0),l<i.length-1&&o.push(s.move(KF(a,i[l+1],n,e)))}return r.pop(),o.join("")}function KF(n,e,t,r){let i=r.join.length;for(;i--;){const s=r.join[i](n,e,t,r);if(s===!0||s===1)break;if(typeof s=="number")return`
`.repeat(1+s);if(s===!1)return`

<!---->

`}return`

`}const GF=/\r?\n|\r/g;function JF(n,e){const t=[];let r=0,i=0,s;for(;s=GF.exec(n);)o(n.slice(r,s.index)),t.push(s[0]),r=s.index+s[0].length,i++;return o(n.slice(r)),t.join("");function o(l){t.push(e(l,i,!l))}}function ZF(n,e,t){const r=(t.before||"")+(e||"")+(t.after||""),i=[],s=[],o={};let l=-1;for(;++l<n.unsafe.length;){const u=n.unsafe[l];if(!O3(n.stack,u))continue;const f=n.compilePattern(u);let p;for(;p=f.exec(r);){const g="before"in u||!!u.atBreak,y="after"in u,v=p.index+(g?p[1].length:0);i.includes(v)?(o[v].before&&!g&&(o[v].before=!1),o[v].after&&!y&&(o[v].after=!1)):(i.push(v),o[v]={before:g,after:y})}}i.sort(YF);let a=t.before?t.before.length:0;const c=r.length-(t.after?t.after.length:0);for(l=-1;++l<i.length;){const u=i[l];u<a||u>=c||u+1<c&&i[l+1]===u+1&&o[u].after&&!o[u+1].before&&!o[u+1].after||i[l-1]===u-1&&o[u].before&&!o[u-1].before&&!o[u-1].after||(a!==u&&s.push(EM(r.slice(a,u),"\\")),a=u,/[!-/:-@[-`{-~]/.test(r.charAt(u))&&(!t.encode||!t.encode.includes(r.charAt(u)))?s.push("\\"):(s.push(pb(r.charCodeAt(u))),a++))}return s.push(EM(r.slice(a,c),t.after)),s.join("")}function YF(n,e){return n-e}function EM(n,e){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],i=[],s=n+e;let o=-1,l=0,a;for(;a=t.exec(s);)r.push(a.index);for(;++o<r.length;)l!==r[o]&&i.push(n.slice(l,r[o])),i.push("\\"),l=r[o];return i.push(n.slice(l)),i.join("")}function XF(n){const e=n||{},t=e.now||{};let r=e.lineShift||0,i=t.line||1,s=t.column||1;return{move:a,current:o,shift:l};function o(){return{now:{line:i,column:s},lineShift:r}}function l(c){r+=c}function a(c){const u=c||"",f=u.split(/\r?\n|\r/g),p=f[f.length-1];return i+=f.length-1,s=f.length===1?s+p.length:1+p.length+r,u}}function QF(n,e){const t=e||{},r={associationId:zF,containerPhrasing:rj,containerFlow:ij,createTracker:XF,compilePattern:WF,enter:s,handlers:{...D3},handle:void 0,indentLines:JF,indexStack:[],join:[...FF],options:{},safe:sj,stack:[],unsafe:[...$F]};jL(r,t),r.options.tightDefinitions&&r.join.push(nj),r.handle=L3("type",{invalid:ej,unknown:tj,handlers:r.handlers});let i=r.handle(n,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return i&&i.charCodeAt(i.length-1)!==10&&i.charCodeAt(i.length-1)!==13&&(i+=`
`),i;function s(o){return r.stack.push(o),l;function l(){r.stack.pop()}}}function ej(n){throw new Error("Cannot handle value `"+n+"`, expected node")}function tj(n){const e=n;throw new Error("Cannot handle unknown node `"+e.type+"`")}function nj(n,e){if(n.type==="definition"&&n.type===e.type)return 0}function rj(n,e){return qF(n,this,e)}function ij(n,e){return UF(n,this,e)}function sj(n,e){return ZF(this,n,e)}function xw(n){const e=this;e.compiler=t;function t(r){return QF(r,{...e.data("settings"),...n,extensions:e.data("toMarkdownExtensions")||[]})}}var $L=n=>{throw TypeError(n)},zL=(n,e,t)=>e.has(n)||$L("Cannot "+t),dt=(n,e,t)=>(zL(n,e,"read from private field"),t?t.call(n):e.get(n)),xn=(n,e,t)=>e.has(n)?$L("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Qt=(n,e,t,r)=>(zL(n,e,"write to private field"),e.set(n,t),t),ds,Tf,Hm,Vm,Fm,Ef,Af,Ks,Of,jm,$m,Lf,zm,Df,Wm,qm,hc,Ul,Um,If;class WL{}class qL{constructor(){this.elements=[],this.size=()=>this.elements.length,this.top=()=>this.elements.at(-1),this.push=e=>{var t;(t=this.top())==null||t.push(e)},this.open=e=>{this.elements.push(e)},this.close=()=>{const e=this.elements.pop();if(!e)throw LL();return e}}}class ck extends WL{constructor(e,t,r){super(),this.type=e,this.content=t,this.attrs=r}push(e,...t){this.content.push(e,...t)}pop(){return this.content.pop()}static create(e,t,r){return new ck(e,t,r)}}const _w=class extends qL{constructor(e){super(),xn(this,ds),xn(this,Tf),xn(this,Hm),xn(this,Vm),xn(this,Fm),xn(this,Ef),xn(this,Af),Qt(this,ds,ct.none),Qt(this,Tf,t=>t.isText),Qt(this,Hm,(t,r)=>{if(dt(this,Tf).call(this,t)&&dt(this,Tf).call(this,r)&&ct.sameSet(t.marks,r.marks))return this.schema.text(t.text+r.text,t.marks)}),Qt(this,Vm,t=>{const r=Object.values({...this.schema.nodes,...this.schema.marks}).find(i=>i.spec.parseMarkdown.match(t));if(!r)throw iF(t);return r}),Qt(this,Fm,t=>{const r=dt(this,Vm).call(this,t);r.spec.parseMarkdown.runner(this,t,r)}),this.injectRoot=(t,r,i)=>(this.openNode(r,i),this.next(t.children),this),this.openNode=(t,r)=>(this.open(ck.create(t,[],r)),this),Qt(this,Ef,()=>{Qt(this,ds,ct.none);const t=this.close();return dt(this,Af).call(this,t.type,t.attrs,t.content)}),this.closeNode=()=>{try{dt(this,Ef).call(this)}catch(t){console.error(t)}return this},Qt(this,Af,(t,r,i)=>{const s=t.createAndFill(r,i,dt(this,ds));if(!s)throw rF(t,r,i);return this.push(s),s}),this.addNode=(t,r,i)=>{try{dt(this,Af).call(this,t,r,i)}catch(s){console.error(s)}return this},this.openMark=(t,r)=>{const i=t.create(r);return Qt(this,ds,i.addToSet(dt(this,ds))),this},this.closeMark=t=>(Qt(this,ds,t.removeFromSet(dt(this,ds))),this),this.addText=t=>{try{const r=this.top();if(!r)throw LL();const i=r.pop(),s=this.schema.text(t,dt(this,ds));if(!i)return r.push(s),this;const o=dt(this,Hm).call(this,i,s);return o?(r.push(o),this):(r.push(i,s),this)}catch(r){return console.error(r),this}},this.build=()=>{let t;do t=dt(this,Ef).call(this);while(this.size());return t},this.next=(t=[])=>([t].flat().forEach(r=>dt(this,Fm).call(this,r)),this),this.toDoc=()=>this.build(),this.run=(t,r)=>{const i=t.runSync(t.parse(r),r);return this.next(i),this},this.schema=e}};ds=new WeakMap;Tf=new WeakMap;Hm=new WeakMap;Vm=new WeakMap;Fm=new WeakMap;Ef=new WeakMap;Af=new WeakMap;_w.create=(n,e)=>{const t=new _w(n);return r=>(t.run(e,r),t.toDoc())};let oj=_w;const Mw=class extends WL{constructor(e,t,r,i={}){super(),this.type=e,this.children=t,this.value=r,this.props=i,this.push=(s,...o)=>{this.children||(this.children=[]),this.children.push(s,...o)},this.pop=()=>{var s;return(s=this.children)==null?void 0:s.pop()}}};Mw.create=(n,e,t,r={})=>new Mw(n,e,t,r);let AM=Mw;const lj=n=>Object.prototype.hasOwnProperty.call(n,"size"),Tw=class extends qL{constructor(e){super(),xn(this,Ks),xn(this,Of),xn(this,jm),xn(this,$m),xn(this,Lf),xn(this,zm),xn(this,Df),xn(this,Wm),xn(this,qm),xn(this,hc),xn(this,Ul),xn(this,Um),xn(this,If),Qt(this,Ks,ct.none),Qt(this,Of,t=>{const r=Object.values({...this.schema.nodes,...this.schema.marks}).find(i=>i.spec.toMarkdown.match(t));if(!r)throw sF(t.type);return r}),Qt(this,jm,t=>dt(this,Of).call(this,t).spec.toMarkdown.runner(this,t)),Qt(this,$m,(t,r)=>dt(this,Of).call(this,t).spec.toMarkdown.runner(this,t,r)),Qt(this,Lf,t=>{const{marks:r}=t,i=l=>l.type.spec.priority??50;[...r].sort((l,a)=>i(l)-i(a)).every(l=>!dt(this,$m).call(this,l,t))&&dt(this,jm).call(this,t),r.forEach(l=>dt(this,If).call(this,l))}),Qt(this,zm,(t,r)=>{var a;if(t.type===r||((a=t.children)==null?void 0:a.length)!==1)return t;const i=c=>{var f;if(c.type===r)return c;if(((f=c.children)==null?void 0:f.length)!==1)return null;const[u]=c.children;return u?i(u):null},s=i(t);if(!s)return t;const o=s.children?[...s.children]:void 0,l={...t,children:o};return l.children=o,s.children=[l],s}),Qt(this,Df,t=>{const{children:r}=t;return r&&(t.children=r.reduce((i,s,o)=>{if(o===0)return[s];const l=i.at(-1);if(l&&l.isMark&&s.isMark){s=dt(this,zm).call(this,s,l.type);const{children:a,...c}=s,{children:u,...f}=l;if(s.type===l.type&&a&&u&&JSON.stringify(c)===JSON.stringify(f)){const p={...f,children:[...u,...a]};return i.slice(0,-1).concat(dt(this,Df).call(this,p))}}return i.concat(s)},[])),t}),Qt(this,Wm,t=>{const r={...t.props,type:t.type};return t.children&&(r.children=t.children),t.value&&(r.value=t.value),r}),this.openNode=(t,r,i)=>(this.open(AM.create(t,void 0,r,i)),this),Qt(this,qm,(t,r)=>{let i="",s="";const o=t.children;let l=-1,a=-1;const c=f=>{f&&f.forEach((p,g)=>{p.type==="text"&&p.value&&(l<0&&(l=g),a=g)})};if(o){c(o);const f=o==null?void 0:o[a],p=o==null?void 0:o[l];if(f&&f.value.endsWith(" ")){const g=f.value,y=g.trimEnd();s=g.slice(y.length),f.value=y}if(p&&p.value.startsWith(" ")){const g=p.value,y=g.trimStart();i=g.slice(0,g.length-y.length),p.value=y}}i.length&&dt(this,Ul).call(this,"text",void 0,i);const u=r();return s.length&&dt(this,Ul).call(this,"text",void 0,s),u}),Qt(this,hc,(t=!1)=>{const r=this.close(),i=()=>dt(this,Ul).call(this,r.type,r.children,r.value,r.props);return t?dt(this,qm).call(this,r,i):i()}),this.closeNode=()=>(dt(this,hc).call(this),this),Qt(this,Ul,(t,r,i,s)=>{const o=AM.create(t,r,i,s),l=dt(this,Df).call(this,dt(this,Wm).call(this,o));return this.push(l),l}),this.addNode=(t,r,i,s)=>(dt(this,Ul).call(this,t,r,i,s),this),Qt(this,Um,(t,r,i,s)=>t.isInSet(dt(this,Ks))?this:(Qt(this,Ks,t.addToSet(dt(this,Ks))),this.openNode(r,i,{...s,isMark:!0}))),Qt(this,If,t=>{t.isInSet(dt(this,Ks))&&(Qt(this,Ks,t.type.removeFromSet(dt(this,Ks))),dt(this,hc).call(this,!0))}),this.withMark=(t,r,i,s)=>(dt(this,Um).call(this,t,r,i,s),this),this.closeMark=t=>(dt(this,If).call(this,t),this),this.build=()=>{let t=null;do t=dt(this,hc).call(this);while(this.size());return t},this.next=t=>lj(t)?(t.forEach(r=>{dt(this,Lf).call(this,r)}),this):(dt(this,Lf).call(this,t),this),this.toString=t=>t.stringify(this.build()),this.run=t=>(this.next(t),this),this.schema=e}};Ks=new WeakMap;Of=new WeakMap;jm=new WeakMap;$m=new WeakMap;Lf=new WeakMap;zm=new WeakMap;Df=new WeakMap;Wm=new WeakMap;qm=new WeakMap;hc=new WeakMap;Ul=new WeakMap;Um=new WeakMap;If=new WeakMap;Tw.create=(n,e)=>{const t=new Tw(n);return r=>(t.run(r),t.toString(e))};let aj=Tw;const uk=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function UL(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const KL=(n,e,t)=>{let r=UL(n,t);if(!r)return!1;let i=fk(r);if(!i){let o=r.blockRange(),l=o&&V0(o);return l==null?!1:(e&&e(n.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(YL(n,i,e,-1))return!0;if(r.parent.content.size==0&&(bu(s,"end")||Ke.isSelectable(s)))for(let o=r.depth;;o--){let l=j0(n.doc,r.before(o),r.after(o),Le.empty);if(l&&l.slice.size<l.to-l.from){if(e){let a=n.tr.step(l);a.setSelection(bu(s,"end")?tt.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):Ke.create(a.doc,i.pos-s.nodeSize)),e(a.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},cj=(n,e,t)=>{let r=UL(n,t);if(!r)return!1;let i=fk(r);return i?uj(n,i,e):!1};function uj(n,e,t){let r=e.nodeBefore,i=r,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let o=e.nodeAfter,l=o,a=e.pos+1;for(;!l.isTextblock;a++){if(l.type.spec.isolating)return!1;let u=l.firstChild;if(!u)return!1;l=u}let c=j0(n.doc,s,a,Le.empty);if(!c||c.from!=s||c instanceof Pn&&c.slice.size>=a-s)return!1;if(t){let u=n.tr.step(c);u.setSelection(ze.create(u.doc,s)),t(u.scrollIntoView())}return!0}function bu(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const GL=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;s=fk(r)}let o=s&&s.nodeBefore;return!o||!Ke.isSelectable(o)?!1:(e&&e(n.tr.setSelection(Ke.create(n.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function fk(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function fj(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const hj=(n,e,t)=>{let r=fj(n,t);if(!r)return!1;let i=JL(r);if(!i)return!1;let s=i.nodeAfter;if(YL(n,i,e,1))return!0;if(r.parent.content.size==0&&(bu(s,"start")||Ke.isSelectable(s))){let o=j0(n.doc,r.before(),r.after(),Le.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=n.tr.step(o);l.setSelection(bu(s,"start")?tt.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):Ke.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},dj=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;s=JL(r)}let o=s&&s.nodeAfter;return!o||!Ke.isSelectable(o)?!1:(e&&e(n.tr.setSelection(Ke.create(n.doc,s.pos)).scrollIntoView()),!0)};function JL(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const pj=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function hk(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const ZL=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),s=t.indexAfter(-1),o=hk(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let l=t.after(),a=n.tr.replaceWith(l,l,o.createAndFill());a.setSelection(tt.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},mj=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof zr||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=hk(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=n.tr.insert(o,s.createAndFill());l.setSelection(ze.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},gj=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let s=t.before();if(hh(n.doc,s))return e&&e(n.tr.split(s).scrollIntoView()),!0}let r=t.blockRange(),i=r&&V0(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)};function yj(n){return(e,t)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof Ke&&e.selection.node.isBlock)return!r.parentOffset||!hh(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],o,l,a=!1,c=!1;for(let g=r.depth;;g--)if(r.node(g).isBlock){a=r.end(g)==r.pos+(r.depth-g),c=r.start(g)==r.pos-(r.depth-g),l=hk(r.node(g-1).contentMatchAt(r.indexAfter(g-1))),s.unshift(a&&l?{type:l}:null),o=g;break}else{if(g==1)return!1;s.unshift(null)}let u=e.tr;(e.selection instanceof ze||e.selection instanceof zr)&&u.deleteSelection();let f=u.mapping.map(r.pos),p=hh(u.doc,f,s.length,s);if(p||(s[0]=l?{type:l}:null,p=hh(u.doc,f,s.length,s)),!p)return!1;if(u.split(f,s.length,s),!a&&c&&r.node(o).type!=l){let g=u.mapping.map(r.before(o)),y=u.doc.resolve(g);l&&r.node(o-1).canReplaceWith(y.index(),y.index()+1,l)&&u.setNodeMarkup(u.mapping.map(r.before(o)),l)}return t&&t(u.scrollIntoView()),!0}}const bj=yj(),wj=(n,e)=>(e&&e(n.tr.setSelection(new zr(n.doc))),!0);function vj(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||F0(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function YL(n,e,t,r){let i=e.nodeBefore,s=e.nodeAfter,o,l,a=i.type.spec.isolating||s.type.spec.isolating;if(!a&&vj(n,e,t))return!0;let c=!a&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(l=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&l.matchType(o[0]||s.type).validEnd){if(t){let g=e.pos+s.nodeSize,y=we.empty;for(let x=o.length-1;x>=0;x--)y=we.from(o[x].create(null,y));y=we.from(i.copy(y));let v=n.tr.step(new cr(e.pos-1,g,e.pos,g,new Le(y,1,0),o.length,!0)),k=v.doc.resolve(g+2*o.length);k.nodeAfter&&k.nodeAfter.type==i.type&&F0(v.doc,k.pos)&&v.join(k.pos),t(v.scrollIntoView())}return!0}let u=s.type.spec.isolating||r>0&&a?null:tt.findFrom(e,1),f=u&&u.$from.blockRange(u.$to),p=f&&V0(f);if(p!=null&&p>=e.depth)return t&&t(n.tr.lift(f,p).scrollIntoView()),!0;if(c&&bu(s,"start",!0)&&bu(i,"end")){let g=i,y=[];for(;y.push(g),!g.isTextblock;)g=g.lastChild;let v=s,k=1;for(;!v.isTextblock;v=v.firstChild)k++;if(g.canReplace(g.childCount,g.childCount,v.content)){if(t){let x=we.empty;for(let M=y.length-1;M>=0;M--)x=we.from(y[M].copy(x));let _=n.tr.step(new cr(e.pos-y.length,e.pos+s.nodeSize,e.pos+k,e.pos+s.nodeSize-k,new Le(x,y.length,0),0,!0));t(_.scrollIntoView())}return!0}}return!1}function XL(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(t&&t(e.tr.setSelection(ze.create(e.doc,n<0?i.start(s):i.end(s)))),!0):!1}}const kj=XL(-1),Cj=XL(1);function dk(n,e=null){return function(t,r){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),l=o&&sk(o,n,e);return l?(r&&r(t.tr.wrap(o,l).scrollIntoView()),!0):!1}}function nd(n,e=null){return function(t,r){let i=!1;for(let s=0;s<t.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:l}}=t.selection.ranges[s];t.doc.nodesBetween(o,l,(a,c)=>{if(i)return!1;if(!(!a.isTextblock||a.hasMarkup(n,e)))if(a.type==n)i=!0;else{let u=t.doc.resolve(c),f=u.index();i=u.parent.canReplaceWith(f,f+1,n)}})}if(!i)return!1;if(r){let s=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:a}}=t.selection.ranges[o];s.setBlockType(l,a,n,e)}r(s.scrollIntoView())}return!0}}function Sj(n,e,t,r){for(let i=0;i<e.length;i++){let{$from:s,$to:o}=e[i],l=s.depth==0?n.inlineContent&&n.type.allowsMarkType(t):!1;if(n.nodesBetween(s.pos,o.pos,(a,c)=>{if(l||!r)return!1;l=a.inlineContent&&a.type.allowsMarkType(t)}),l)return!0}return!1}function K0(n,e=null,t){let r=t!==!1;return function(i,s){let{empty:o,$cursor:l,ranges:a}=i.selection;if(o&&!l||!Sj(i.doc,a,n,r))return!1;if(s)if(l)n.isInSet(i.storedMarks||l.marks())?s(i.tr.removeStoredMark(n)):s(i.tr.addStoredMark(n.create(e)));else{let c,u=i.tr;c=!a.some(f=>i.doc.rangeHasMark(f.$from.pos,f.$to.pos,n));for(let f=0;f<a.length;f++){let{$from:p,$to:g}=a[f];if(!c)u.removeMark(p.pos,g.pos,n);else{let y=p.pos,v=g.pos,k=p.nodeAfter,x=g.nodeBefore,_=k&&k.isText?/^\s*/.exec(k.text)[0].length:0,M=x&&x.isText?/\s*$/.exec(x.text)[0].length:0;y+_<v&&(y+=_,v-=M),u.addMark(y,v,n.create(e))}}s(u.scrollIntoView())}return!0}}function Nu(...n){return function(e,t,r){for(let i=0;i<n.length;i++)if(n[i](e,t,r))return!0;return!1}}let C1=Nu(uk,KL,GL),OM=Nu(uk,hj,dj);const eo={Enter:Nu(pj,mj,gj,bj),"Mod-Enter":ZL,Backspace:C1,"Mod-Backspace":C1,"Shift-Backspace":C1,Delete:OM,"Mod-Delete":OM,"Mod-a":wj},QL={"Ctrl-h":eo.Backspace,"Alt-Backspace":eo["Mod-Backspace"],"Ctrl-d":eo.Delete,"Ctrl-Alt-Backspace":eo["Mod-Delete"],"Alt-Delete":eo["Mod-Delete"],"Alt-d":eo["Mod-Delete"],"Ctrl-a":kj,"Ctrl-e":Cj};for(let n in eo)QL[n]=eo[n];const xj=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,_j=xj?QL:eo,Mj=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Tj=typeof navigator<"u"&&/Win/.test(navigator.platform);function Ej(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,s,o;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))Mj?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),o&&(t="Meta-"+t),s&&(t="Shift-"+t),t}function Aj(n){let e=Object.create(null);for(let t in n)e[Ej(t)]=n[t];return e}function S1(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function eD(n){return new nn({props:{handleKeyDown:pk(n)}})}function pk(n){let e=Aj(n);return function(t,r){let i=m2(r),s,o=e[S1(i,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[S1(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(Tj&&r.ctrlKey&&r.altKey)&&(s=wo[r.keyCode])&&s!=i){let l=e[S1(s,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const Jn=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},wu=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Ew=null;const Xs=function(n,e,t){let r=Ew||(Ew=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},Oj=function(){Ew=null},$a=function(n,e,t,r){return t&&(LM(n,e,t,r,-1)||LM(n,e,t,r,1))},Lj=/^(img|br|input|textarea|hr)$/i;function LM(n,e,t,r,i){for(var s;;){if(n==t&&e==r)return!0;if(e==(i<0?0:gi(n))){let o=n.parentNode;if(!o||o.nodeType!=1||rp(n)||Lj.test(n.nodeName)||n.contentEditable=="false")return!1;e=Jn(n)+(i<0?0:1),n=o}else if(n.nodeType==1){let o=n.childNodes[e+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=i;else return!1;else n=o,e=i<0?gi(n):0}else return!1}}function gi(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Dj(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=gi(n)}else if(n.parentNode&&!rp(n))e=Jn(n),n=n.parentNode;else return null}}function Ij(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!rp(n))e=Jn(n)+1,n=n.parentNode;else return null}}function Nj(n,e,t){for(let r=e==0,i=e==gi(n);r||i;){if(n==t)return!0;let s=Jn(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==gi(n)}}function rp(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const G0=function(n){return n.focusNode&&$a(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Ql(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function Rj(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Pj(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(gi(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(gi(r.startContainer),r.startOffset)}}}const As=typeof navigator<"u"?navigator:null,DM=typeof document<"u"?document:null,xl=As&&As.userAgent||"",Aw=/Edge\/(\d+)/.exec(xl),tD=/MSIE \d/.exec(xl),Ow=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(xl),Wr=!!(tD||Ow||Aw),cl=tD?document.documentMode:Ow?+Ow[1]:Aw?+Aw[1]:0,Si=!Wr&&/gecko\/(\d+)/i.test(xl);Si&&+(/Firefox\/(\d+)/.exec(xl)||[0,0])[1];const Lw=!Wr&&/Chrome\/(\d+)/.exec(xl),lr=!!Lw,nD=Lw?+Lw[1]:0,Tr=!Wr&&!!As&&/Apple Computer/.test(As.vendor),vu=Tr&&(/Mobile\/\w+/.test(xl)||!!As&&As.maxTouchPoints>2),pi=vu||(As?/Mac/.test(As.platform):!1),Bj=As?/Win/.test(As.platform):!1,fo=/Android \d/.test(xl),ip=!!DM&&"webkitFontSmoothing"in DM.documentElement.style,Hj=ip?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Vj(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Ws(n,e){return typeof n=="number"?n:n[e]}function Fj(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function IM(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,s=n.dom.ownerDocument;for(let o=t||n.dom;o;){if(o.nodeType!=1){o=wu(o);continue}let l=o,a=l==s.body,c=a?Vj(s):Fj(l),u=0,f=0;if(e.top<c.top+Ws(r,"top")?f=-(c.top-e.top+Ws(i,"top")):e.bottom>c.bottom-Ws(r,"bottom")&&(f=e.bottom-e.top>c.bottom-c.top?e.top+Ws(i,"top")-c.top:e.bottom-c.bottom+Ws(i,"bottom")),e.left<c.left+Ws(r,"left")?u=-(c.left-e.left+Ws(i,"left")):e.right>c.right-Ws(r,"right")&&(u=e.right-c.right+Ws(i,"right")),u||f)if(a)s.defaultView.scrollBy(u,f);else{let g=l.scrollLeft,y=l.scrollTop;f&&(l.scrollTop+=f),u&&(l.scrollLeft+=u);let v=l.scrollLeft-g,k=l.scrollTop-y;e={left:e.left-v,top:e.top-k,right:e.right-v,bottom:e.bottom-k}}let p=a?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(p))break;o=p=="absolute"?o.offsetParent:wu(o)}}function jj(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=n.root.elementFromPoint(s,o);if(!l||l==n.dom||!n.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=t-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:rD(n.dom)}}function rD(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=wu(r));return e}function $j({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;iD(t,r==0?0:r-e)}function iD(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:s}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let oc=null;function zj(n){if(n.setActive)return n.setActive();if(oc)return n.focus(oc);let e=rD(n);n.focus(oc==null?{get preventScroll(){return oc={preventScroll:!0},!0}}:void 0),oc||(oc=!1,iD(e,0))}function sD(n,e){let t,r=2e8,i,s=0,o=e.top,l=e.top,a,c;for(let u=n.firstChild,f=0;u;u=u.nextSibling,f++){let p;if(u.nodeType==1)p=u.getClientRects();else if(u.nodeType==3)p=Xs(u).getClientRects();else continue;for(let g=0;g<p.length;g++){let y=p[g];if(y.top<=o&&y.bottom>=l){o=Math.max(y.bottom,o),l=Math.min(y.top,l);let v=y.left>e.left?y.left-e.left:y.right<e.left?e.left-y.right:0;if(v<r){t=u,r=v,i=v&&t.nodeType==3?{left:y.right<e.left?y.right:y.left,top:e.top}:e,u.nodeType==1&&v&&(s=f+(e.left>=(y.left+y.right)/2?1:0));continue}}else y.top>e.top&&!a&&y.left<=e.left&&y.right>=e.left&&(a=u,c={left:Math.max(y.left,Math.min(y.right,e.left)),top:y.top});!t&&(e.left>=y.right&&e.top>=y.top||e.left>=y.left&&e.top>=y.bottom)&&(s=f+1)}}return!t&&a&&(t=a,i=c,r=0),t&&t.nodeType==3?Wj(t,i):!t||r&&t.nodeType==1?{node:n,offset:s}:sD(t,i)}function Wj(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let s=Vo(r,1);if(s.top!=s.bottom&&mk(e,s))return{node:n,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:n,offset:0}}function mk(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function qj(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function Uj(n,e,t){let{node:r,offset:i}=sD(e,t),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,i,s)}function Kj(n,e,t,r){let i=-1;for(let s=e,o=!1;s!=n.dom;){let l=n.docView.nearestDesc(s,!0),a;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((a=l.dom.getBoundingClientRect()).width||a.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!o&&a.left>r.left||a.top>r.top?i=l.posBefore:(!o&&a.right<r.left||a.bottom<r.top)&&(i=l.posAfter),o=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter;s=l.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function oD(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),s=i;;){let o=n.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let a=0;a<l.length;a++){let c=l[a];if(mk(e,c))return oD(o,e,c)}}if((s=(s+1)%r)==i)break}return n}function Gj(n,e){let t=n.dom.ownerDocument,r,i=0,s=Pj(t,e.left,e.top);s&&({node:r,offset:i}=s);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),l;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!mk(e,c)||(o=oD(n.dom,e,c),!o))return null}if(Tr)for(let c=o;r&&c;c=wu(c))c.draggable&&(r=void 0);if(o=qj(o,e),r){if(Si&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],f;u.nodeName=="IMG"&&(f=u.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let c;ip&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=Kj(n,r,i,e))}l==null&&(l=Uj(n,o,e));let a=n.docView.nearestDesc(o,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function NM(n){return n.top<n.bottom||n.left<n.right}function Vo(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(NM(r))return r}return Array.prototype.find.call(t,NM)||n.getBoundingClientRect()}const Jj=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function lD(n,e,t){let{node:r,offset:i,atom:s}=n.docView.domFromPos(e,t<0?-1:1),o=ip||Si;if(r.nodeType==3)if(o&&(Jj.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let a=Vo(Xs(r,i,i),t);if(Si&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=Vo(Xs(r,i-1,i-1),-1);if(c.top==a.top){let u=Vo(Xs(r,i,i+1),-1);if(u.top!=a.top)return lf(u,u.left<c.left)}}return a}else{let a=i,c=i,u=t<0?1:-1;return t<0&&!i?(c++,u=-1):t>=0&&i==r.nodeValue.length?(a--,u=1):t<0?a--:c++,lf(Vo(Xs(r,a,c),u),u<0)}if(!n.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(t<0||i==gi(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return x1(a.getBoundingClientRect(),!1)}if(s==null&&i<gi(r)){let a=r.childNodes[i];if(a.nodeType==1)return x1(a.getBoundingClientRect(),!0)}return x1(r.getBoundingClientRect(),t>=0)}if(s==null&&i&&(t<0||i==gi(r))){let a=r.childNodes[i-1],c=a.nodeType==3?Xs(a,gi(a)-(o?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(c)return lf(Vo(c,1),!1)}if(s==null&&i<gi(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let c=a?a.nodeType==3?Xs(a,0,o?0:1):a.nodeType==1?a:null:null;if(c)return lf(Vo(c,-1),!0)}return lf(Vo(r.nodeType==3?Xs(r):r,-t),t>=0)}function lf(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function x1(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function aD(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function Zj(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return aD(n,e,()=>{let{node:s}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let l=n.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=lD(n,i.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Xs(l,0,l.nodeValue.length).getClientRects();else continue;for(let c=0;c<a.length;c++){let u=a[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const Yj=/[\u0590-\u08ac]/;function Xj(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,l=n.domSelection();return l?!Yj.test(r.parent.textContent)||!l.modify?t=="left"||t=="backward"?s:o:aD(n,e,()=>{let{focusNode:a,focusOffset:c,anchorNode:u,anchorOffset:f}=n.domSelectionRange(),p=l.caretBidiLevel;l.modify("move",t,"character");let g=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:y,focusOffset:v}=n.domSelectionRange(),k=y&&!g.contains(y.nodeType==1?y:y.parentNode)||a==y&&c==v;try{l.collapse(u,f),a&&(a!=u||c!=f)&&l.extend&&l.extend(a,c)}catch{}return p!=null&&(l.caretBidiLevel=p),k}):r.pos==r.start()||r.pos==r.end()}let RM=null,PM=null,BM=!1;function Qj(n,e,t){return RM==e&&PM==t?BM:(RM=e,PM=t,BM=t=="up"||t=="down"?Zj(n,e,t):Xj(n,e,t))}const xi=0,HM=1,ra=2,Os=3;class sp{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=xi,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>Jn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!t||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)for(let o=0;o<i.children.length;o++){let l=i.children[o];if(l.size){i=l;break}}return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.size;if(l>e||o instanceof uD){i=e-s;break}s=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof cD&&s.side>=0;r--);if(t<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&t&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,t):{node:this.contentDOM,offset:s?Jn(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,t):{node:this.contentDOM,offset:s?Jn(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,l=0;;l++){let a=this.children[l],c=o+a.size;if(i==-1&&e<=c){let u=o+a.border;if(e>=u&&t<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,u);e=o;for(let f=l;f>0;f--){let p=this.children[f-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){i=Jn(p.dom)+1;break}e-=p.size}i==-1&&(i=0)}if(i>-1&&(c>t||l==this.children.length-1)){t=c;for(let u=l+1;u<this.children.length;u++){let f=this.children[u];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){s=Jn(f.dom);break}t+=f.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let s=Math.min(e,t),o=Math.max(e,t);for(let g=0,y=0;g<this.children.length;g++){let v=this.children[g],k=y+v.size;if(s>y&&o<k)return v.setSelection(e-y-v.border,t-y-v.border,r,i);y=k}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),f=!1;if((Si||Tr)&&e==t){let{node:g,offset:y}=l;if(g.nodeType==3){if(f=!!(y&&g.nodeValue[y-1]==`
`),f&&y==g.nodeValue.length)for(let v=g,k;v;v=v.parentNode){if(k=v.nextSibling){k.nodeName=="BR"&&(l=a={node:k.parentNode,offset:Jn(k)+1});break}let x=v.pmViewDesc;if(x&&x.node&&x.node.isBlock)break}}else{let v=g.childNodes[y-1];f=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(Si&&u.focusNode&&u.focusNode!=a.node&&u.focusNode.nodeType==1){let g=u.focusNode.childNodes[u.focusOffset];g&&g.contentEditable=="false"&&(i=!0)}if(!(i||f&&Tr)&&$a(l.node,l.offset,u.anchorNode,u.anchorOffset)&&$a(a.node,a.offset,u.focusNode,u.focusOffset))return;let p=!1;if((c.extend||e==t)&&!(f&&Si)){c.collapse(l.node,l.offset);try{e!=t&&c.extend(a.node,a.offset),p=!0}catch{}}if(!p){if(e>t){let y=l;l=a,a=y}let g=document.createRange();g.setEnd(a.node,a.offset),g.setStart(l.node,l.offset),c.removeAllRanges(),c.addRange(g)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let l=r+s.border,a=o-s.border;if(e>=l&&t<=a){this.dirty=e==r||t==o?ra:HM,e==l&&t==a&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Os:s.markDirty(e-l,t-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?ra:Os}r=o}this.dirty=ra}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?ra:HM;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class cD extends sp{constructor(e,t,r,i){let s,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!t.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,s=this}matchesWidget(e){return this.dirty==xi&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class e$ extends sp{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class za extends sp{constructor(e,t,r,i,s){super(e,[],r,i),this.mark=t,this.spec=s}static create(e,t,r,i){let s=i.nodeViews[t.type.name],o=s&&s(t,i,r);return(!o||!o.dom)&&(o=Ja.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new za(e,t,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Os||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Os&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=xi){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=xi}}slice(e,t,r){let i=za.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;t<o&&(s=Iw(s,t,o,r)),e>0&&(s=Iw(s,0,e,r));for(let l=0;l<s.length;l++)s[l].parent=i;return i.children=s,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class ul extends sp{constructor(e,t,r,i,s,o,l,a,c){super(e,[],s,o),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,t,r,i,s,o){let l=s.nodeViews[t.type.name],a,c=l&&l(t,s,()=>{if(!a)return o;if(a.parent)return a.parent.posBeforeChild(a)},r,i),u=c&&c.dom,f=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:f}=Ja.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!f&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let p=u;return u=dD(u,r,t),c?a=new t$(e,t,r,i,u,f||null,p,c,s,o+1):t.isText?new J0(e,t,r,i,u,p,s):new ul(e,t,r,i,u,f||null,p,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>we.empty)}return e}matchesNode(e,t,r){return this.dirty==xi&&e.eq(this.node)&&Kg(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,s=e.composing?this.localCompositionInfo(e,t):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,a=new r$(this,o&&o.node,e);o$(this.node,this.innerDeco,(c,u,f)=>{c.spec.marks?a.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!f&&a.syncToMarks(u==this.node.childCount?ct.none:this.node.child(u).marks,r,e),a.placeWidget(c,e,i)},(c,u,f,p)=>{a.syncToMarks(c.marks,r,e);let g;a.findNodeMatch(c,u,f,p)||l&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(g=a.findIndexWithChild(s.node))>-1&&a.updateNodeAt(c,u,f,g,e)||a.updateNextNode(c,u,f,e,p,i)||a.addNode(c,u,f,e,i),i+=c.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==ra)&&(o&&this.protectLocalComposition(e,o),fD(this.contentDOM,this.children,e),vu&&l$(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof ze)||r<t||i>t+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,l=a$(this.node.content,o,r-t,i-t);return l<0?null:{node:s,pos:l,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let s=t;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new e$(this,s,t,i);e.input.compositionNodes.push(o),this.children=Iw(this.children,r,r+i.length,e,o)}update(e,t,r,i){return this.dirty==Os||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=xi}updateOuterDeco(e){if(Kg(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=hD(this.dom,this.nodeDOM,Dw(this.outerDeco,this.node,t),Dw(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function VM(n,e,t,r,i){dD(r,e,n);let s=new ul(void 0,n,e,t,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class J0 extends ul{constructor(e,t,r,i,s,o,l){super(e,t,r,i,s,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==Os||this.dirty!=xi&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=xi||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=xi,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),s=document.createTextNode(i.text);return new J0(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Os)}get domAtom(){return!1}isText(e){return this.node.text==e}}class uD extends sp{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==xi&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class t$ extends ul{constructor(e,t,r,i,s,o,l,a,c,u){super(e,t,r,i,s,o,l,c,u),this.spec=a}update(e,t,r,i){if(this.dirty==Os)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,t,r);return s&&this.updateInner(e,t,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function fD(n,e,t){let r=n.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],l=o.dom;if(l.parentNode==n){for(;l!=r;)r=FM(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(l,r);if(o instanceof za){let a=r?r.previousSibling:n.lastChild;fD(o.contentDOM,o.children,t),r=a?a.nextSibling:n.firstChild}}for(;r;)r=FM(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const dh=function(n){n&&(this.nodeName=n)};dh.prototype=Object.create(null);const ia=[new dh];function Dw(n,e,t){if(n.length==0)return ia;let r=t?ia[0]:new dh,i=[r];for(let s=0;s<n.length;s++){let o=n[s].type.attrs;if(o){o.nodeName&&i.push(r=new dh(o.nodeName));for(let l in o){let a=o[l];a!=null&&(t&&i.length==1&&i.push(r=new dh(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function hD(n,e,t,r){if(t==ia&&r==ia)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],l=t[s];if(s){let a;l&&l.nodeName==o.nodeName&&i!=n&&(a=i.parentNode)&&a.nodeName.toLowerCase()==o.nodeName||(a=document.createElement(o.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=ia[0]),i=a}n$(i,l||ia[0],o)}return i}function n$(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&n.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&n.classList.add(i[s]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function dD(n,e,t){return hD(n,n,ia,Dw(e,t,n.nodeType!=1))}function Kg(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function FM(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class r${constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=i$(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=xi,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let c=this.top.children[a];if(c.matchesMark(e[s])&&!this.isLocked(c.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=za.create(this.top,e[s],t,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,s++}}findNodeMatch(e,t,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let c=this.top.children[l];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,r,i,s){let o=this.top.children[i];return o.dirty==Os&&o.dom==o.contentDOM&&(o.dirty=ra),o.update(e,t,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,s,o){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof ul){let c=this.preMatch.matched.get(a);if(c!=null&&c!=s)return!1;let u=a.dom,f,p=this.isLocked(u)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=Os&&Kg(t,a.outerDeco));if(!p&&a.update(e,t,r,i))return this.destroyBetween(this.index,l),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!p&&(f=this.recreateWrapper(a,e,t,r,i,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=ra,f.updateChildren(i,o+1),f.dirty=xi),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,s,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!Kg(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let l=ul.create(this.top,t,r,i,s,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,t,r,i,s){let o=ul.create(this.top,e,t,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new cD(this.top,e,t,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof za;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof J0)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Tr||lr)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new uD(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function i$(n,e){let t=e,r=t.children.length,i=n.childCount,s=new Map,o=[];e:for(;i>0;){let l;for(;;)if(r){let c=t.children[r-1];if(c instanceof za)t=c,r=c.children.length;else{l=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let a=l.node;if(a){if(a!=n.child(i-1))break;--i,s.set(l,i),o.push(l)}}return{index:i,matched:s,matches:o.reverse()}}function s$(n,e){return n.type.side-e.type.side}function o$(n,e,t,r){let i=e.locals(n),s=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,i,e.forChild(s,u),c),s+=u.nodeSize}return}let o=0,l=[],a=null;for(let c=0;;){let u,f;for(;o<i.length&&i[o].to==s;){let k=i[o++];k.widget&&(u?(f||(f=[u])).push(k):u=k)}if(u)if(f){f.sort(s$);for(let k=0;k<f.length;k++)t(f[k],c,!!a)}else t(u,c,!!a);let p,g;if(a)g=-1,p=a,a=null;else if(c<n.childCount)g=c,p=n.child(c++);else break;for(let k=0;k<l.length;k++)l[k].to<=s&&l.splice(k--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)l.push(i[o++]);let y=s+p.nodeSize;if(p.isText){let k=y;o<i.length&&i[o].from<k&&(k=i[o].from);for(let x=0;x<l.length;x++)l[x].to<k&&(k=l[x].to);k<y&&(a=p.cut(k-s),p=p.cut(0,k-s),y=k,g=-1)}else for(;o<i.length&&i[o].to<y;)o++;let v=p.isInline&&!p.isLeaf?l.filter(k=>!k.inline):l.slice();r(p,v,e.forChild(s,p),g),s=y}}function l$(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function a$(n,e,t,r){for(let i=0,s=0;i<n.childCount&&s<=r;){let o=n.child(i++),l=s;if(s+=o.nodeSize,!o.isText)continue;let a=o.text;for(;i<n.childCount;){let c=n.child(i++);if(s+=c.nodeSize,!c.isText)break;a+=c.text}if(s>=t){if(s>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let c=l<r?a.lastIndexOf(e,r-l-1):-1;if(c>=0&&c+e.length+l>=t)return l+c;if(t==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function Iw(n,e,t,r,i){let s=[];for(let o=0,l=0;o<n.length;o++){let a=n[o],c=l,u=l+=a.size;c>=t||u<=e?s.push(a):(c<e&&s.push(a.slice(0,e-c,r)),i&&(s.push(i),i=void 0),u>t&&s.push(a.slice(t-c,a.size,r)))}return s}function gk(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),s=i&&i.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let l=r.resolve(o),a,c;if(G0(t)){for(a=o;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&Ke.isSelectable(f)&&i.parent&&!(f.isInline&&Nj(t.focusNode,t.focusOffset,i.dom))){let p=i.posBefore;c=new Ke(o==p?l:r.resolve(p))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let f=o,p=o;for(let g=0;g<t.rangeCount;g++){let y=t.getRangeAt(g);f=Math.min(f,n.docView.posFromDOM(y.startContainer,y.startOffset,1)),p=Math.max(p,n.docView.posFromDOM(y.endContainer,y.endOffset,-1))}if(f<0)return null;[a,o]=p==n.state.selection.anchor?[p,f]:[f,p],l=r.resolve(o)}else a=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(a<0)return null}let u=r.resolve(a);if(!c){let f=e=="pointer"||n.state.selection.head<l.pos&&!s?1:-1;c=yk(n,u,l,f)}return c}function pD(n){return n.editable?n.hasFocus():gD(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function yo(n,e=!1){let t=n.state.selection;if(mD(n,t),!!pD(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&lr){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&$a(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)u$(n);else{let{anchor:r,head:i}=t,s,o;jM&&!(t instanceof ze)&&(t.$from.parent.inlineContent||(s=$M(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=$M(n,t.to))),n.docView.setSelection(r,i,n,e),jM&&(s&&zM(s),o&&zM(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&c$(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const jM=Tr||lr&&nD<63;function $M(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,s=r?t.childNodes[r-1]:null;if(Tr&&i&&i.contentEditable=="false")return _1(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return _1(i);if(s)return _1(s)}}function _1(n){return n.contentEditable="true",Tr&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function zM(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function c$(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!pD(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function u$(n){let e=n.domSelection();if(!e)return;let t=n.cursorWrapper.dom,r=t.nodeName=="IMG";r?e.collapse(t.parentNode,Jn(t)+1):e.collapse(t,0),!r&&!n.state.selection.visible&&Wr&&cl<=11&&(t.disabled=!0,t.disabled=!1)}function mD(n,e){if(e instanceof Ke){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(WM(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else WM(n)}function WM(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function yk(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||ze.between(e,t,r)}function qM(n){return n.editable&&!n.hasFocus()?!1:gD(n)}function gD(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function f$(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return $a(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Nw(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return s&&tt.findFrom(s,e)}function qo(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function UM(n,e,t){let r=n.state.selection;if(r instanceof ze)if(t.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=n.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return qo(n,new ze(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=Nw(n.state,e);return i&&i instanceof Ke?qo(n,i):!1}else if(!(pi&&t.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let l=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=n.docView.descAt(l))&&!o.contentDOM?Ke.isSelectable(s)?qo(n,new Ke(e<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):ip?qo(n,new ze(n.state.doc.resolve(e<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof Ke&&r.node.isInline)return qo(n,new ze(e>0?r.$to:r.$from));{let i=Nw(n.state,e);return i?qo(n,i):!1}}}function Gg(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ph(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function lc(n,e){return e<0?h$(n):d$(n)}function h$(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,s,o=!1;for(Si&&t.nodeType==1&&r<Gg(t)&&ph(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let l=t.childNodes[r-1];if(ph(l,-1))i=t,s=--r;else if(l.nodeType==3)t=l,r=t.nodeValue.length;else break}}else{if(yD(t))break;{let l=t.previousSibling;for(;l&&ph(l,-1);)i=t.parentNode,s=Jn(l),l=l.previousSibling;if(l)t=l,r=Gg(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?Rw(n,t,r):i&&Rw(n,i,s)}function d$(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=Gg(t),s,o;for(;;)if(r<i){if(t.nodeType!=1)break;let l=t.childNodes[r];if(ph(l,1))s=t,o=++r;else break}else{if(yD(t))break;{let l=t.nextSibling;for(;l&&ph(l,1);)s=l.parentNode,o=Jn(l)+1,l=l.nextSibling;if(l)t=l,r=0,i=Gg(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}s&&Rw(n,s,o)}function yD(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function p$(n,e){for(;n&&e==n.childNodes.length&&!rp(n);)e=Jn(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function m$(n,e){for(;n&&!e&&!rp(n);)e=Jn(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Rw(n,e,t){if(e.nodeType!=3){let s,o;(o=p$(e,t))?(e=o,t=0):(s=m$(e,t))&&(e=s,t=s.nodeValue.length)}let r=n.domSelection();if(!r)return;if(G0(r)){let s=document.createRange();s.setEnd(e,t),s.setStart(e,t),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&yo(n)},50)}function KM(n,e){let t=n.state.doc.resolve(e);if(!(lr||Bj)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let s=n.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<t.end()){let s=n.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function GM(n,e,t){let r=n.state.selection;if(r instanceof ze&&!r.empty||t.indexOf("s")>-1||pi&&t.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=Nw(n.state,e);if(o&&o instanceof Ke)return qo(n,o)}if(!i.parent.inlineContent){let o=e<0?i:s,l=r instanceof zr?tt.near(o,e):tt.findFrom(o,e);return l?qo(n,l):!1}return!1}function JM(n,e){if(!(n.state.selection instanceof ze))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(s&&!s.isText){let o=n.state.tr;return e<0?o.delete(t.pos-s.nodeSize,t.pos):o.delete(t.pos,t.pos+s.nodeSize),n.dispatch(o),!0}return!1}function ZM(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function g$(n){if(!Tr||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;ZM(n,r,"true"),setTimeout(()=>ZM(n,r,"false"),20)}return!1}function y$(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function b$(n,e){let t=e.keyCode,r=y$(e);if(t==8||pi&&t==72&&r=="c")return JM(n,-1)||lc(n,-1);if(t==46&&!e.shiftKey||pi&&t==68&&r=="c")return JM(n,1)||lc(n,1);if(t==13||t==27)return!0;if(t==37||pi&&t==66&&r=="c"){let i=t==37?KM(n,n.state.selection.from)=="ltr"?-1:1:-1;return UM(n,i,r)||lc(n,i)}else if(t==39||pi&&t==70&&r=="c"){let i=t==39?KM(n,n.state.selection.from)=="ltr"?1:-1:1;return UM(n,i,r)||lc(n,i)}else{if(t==38||pi&&t==80&&r=="c")return GM(n,-1,r)||lc(n,-1);if(t==40||pi&&t==78&&r=="c")return g$(n)||GM(n,1,r)||lc(n,1);if(r==(pi?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function bk(n,e){n.someProp("transformCopied",g=>{e=g(e,n)});let t=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let g=r.firstChild;t.push(g.type.name,g.attrs!=g.type.defaultAttrs?g.attrs:null),r=g.content}let o=n.someProp("clipboardSerializer")||Ja.fromSchema(n.state.schema),l=SD(),a=l.createElement("div");a.appendChild(o.serializeFragment(r,{document:l}));let c=a.firstChild,u,f=0;for(;c&&c.nodeType==1&&(u=CD[c.nodeName.toLowerCase()]);){for(let g=u.length-1;g>=0;g--){let y=l.createElement(u[g]);for(;a.firstChild;)y.appendChild(a.firstChild);a.appendChild(y),f++}c=a.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${s}${f?` -${f}`:""} ${JSON.stringify(t)}`);let p=n.someProp("clipboardTextSerializer",g=>g(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:p,slice:e}}function bD(n,e,t,r,i){let s=i.parent.type.spec.code,o,l;if(!t&&!e)return null;let a=!!e&&(r||s||!t);if(a){if(n.someProp("transformPastedText",p=>{e=p(e,s||r,n)}),s)return l=new Le(we.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",p=>{l=p(l,n,!0)}),l;let f=n.someProp("clipboardTextParser",p=>p(e,i,r,n));if(f)l=f;else{let p=i.marks(),{schema:g}=n.state,y=Ja.fromSchema(g);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let k=o.appendChild(document.createElement("p"));v&&k.appendChild(y.serializeNode(g.text(v,p)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),o=C$(t),ip&&S$(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let f=+u[3];f>0;f--){let p=o.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;o=p}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||H0.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(a||u),context:i,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!w$.test(p.parentNode.nodeName)?{ignore:!0}:null}})),u)l=x$(YM(l,+u[1],+u[2]),u[4]);else if(l=Le.maxOpen(v$(l.content,i),!0),l.openStart||l.openEnd){let f=0,p=0;for(let g=l.content.firstChild;f<l.openStart&&!g.type.spec.isolating;f++,g=g.firstChild);for(let g=l.content.lastChild;p<l.openEnd&&!g.type.spec.isolating;p++,g=g.lastChild);l=YM(l,f,p)}return n.someProp("transformPasted",f=>{l=f(l,n,a)}),l}const w$=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function v$(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),s,o=[];if(n.forEach(l=>{if(!o)return;let a=i.findWrapping(l.type),c;if(!a)return o=null;if(c=o.length&&s.length&&vD(a,s,l,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=kD(o[o.length-1],s.length));let u=wD(l,a);o.push(u),i=i.matchType(u.type),s=a}}),o)return we.from(o)}return n}function wD(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,we.from(n));return n}function vD(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let s=vD(n,e,t,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(we.from(wD(t,n,i+1))))}}function kD(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,kD(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(we.empty,!0);return n.copy(t.append(r))}function Pw(n,e,t,r,i,s){let o=e<0?n.firstChild:n.lastChild,l=o.content;return n.childCount>1&&(s=0),i<r-1&&(l=Pw(l,e,t,r,i+1,s)),i>=t&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(we.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(l))}function YM(n,e,t){return e<n.openStart&&(n=new Le(Pw(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new Le(Pw(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const CD={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let XM=null;function SD(){return XM||(XM=document.implementation.createHTMLDocument("title"))}let M1=null;function k$(n){let e=window.trustedTypes;return e?(M1||(M1=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),M1.createHTML(n)):n}function C$(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=SD().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&CD[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),t.innerHTML=k$(n),i)for(let s=0;s<i.length;s++)t=t.querySelector(i[s])||t;return t}function S$(n){let e=n.querySelectorAll(lr?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function x$(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:s,openEnd:o}=n;for(let l=r.length-2;l>=0;l-=2){let a=t.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=we.from(a.create(r[l+1],i)),s++,o++}return new Le(i,s,o)}const Er={},Ar={},_$={touchstart:!0,touchmove:!0};class M${constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function T$(n){for(let e in Er){let t=Er[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{A$(n,r)&&!wk(n,r)&&(n.editable||!(r.type in Ar))&&t(n,r)},_$[e]?{passive:!0}:void 0)}Tr&&n.dom.addEventListener("input",()=>null),Bw(n)}function ll(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function E$(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Bw(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>wk(n,r))})}function wk(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function A$(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function O$(n,e){!wk(n,e)&&Er[e.type]&&(n.editable||!(e.type in Ar))&&Er[e.type](n,e)}Ar.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!_D(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(fo&&lr&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),vu&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,Ql(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||b$(n,t)?t.preventDefault():ll(n,"key")};Ar.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Ar.keypress=(n,e)=>{let t=e;if(_D(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||pi&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ze)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode),s=()=>n.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i,s))&&n.dispatch(s()),t.preventDefault()}};function Z0(n){return{left:n.clientX,top:n.clientY}}function L$(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function vk(n,e,t,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(n.someProp(e,l=>o>s.depth?l(n,t,s.nodeAfter,s.before(o),i,!0):l(n,t,s.node(o),s.before(o),i,!1)))return!0;return!1}function Oc(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function D$(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&Ke.isSelectable(r)?(Oc(n,new Ke(t)),!0):!1}function I$(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof Ke&&(r=t.node);let s=n.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(Ke.isSelectable(l)){r&&t.$from.depth>0&&o>=t.$from.depth&&s.before(t.$from.depth+1)==t.$from.pos?i=s.before(t.$from.depth):i=s.before(o);break}}return i!=null?(Oc(n,Ke.create(n.state.doc,i)),!0):!1}function N$(n,e,t,r,i){return vk(n,"handleClickOn",e,t,r)||n.someProp("handleClick",s=>s(n,e,r))||(i?I$(n,t):D$(n,t))}function R$(n,e,t,r){return vk(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function P$(n,e,t,r){return vk(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||B$(n,t,r)}function B$(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Oc(n,ze.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)Oc(n,ze.create(r,l+1,l+1+o.content.size));else if(Ke.isSelectable(o))Oc(n,Ke.create(r,l));else continue;return!0}}function kk(n){return Jg(n)}const xD=pi?"metaKey":"ctrlKey";Er.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=kk(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&L$(t,n.input.lastClick)&&!t[xD]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:s,button:t.button};let o=n.posAtCoords(Z0(t));o&&(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new H$(n,o,t,!!r)):(s=="doubleClick"?R$:P$)(n,o.pos,o.inside,t)?t.preventDefault():ll(n,"pointer"))};class H${constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[xD],this.allowDefault=r.shiftKey;let s,o;if(t.inside>-1)s=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);s=u.parent,o=u.depth?u.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.nodeDOM.nodeType==1?a.nodeDOM:null;let{selection:c}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof Ke&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Si&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ll(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>yo(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Z0(e))),this.updateAllowDefault(e),this.allowDefault||!t?ll(this.view,"pointer"):N$(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Tr&&this.mightDrag&&!this.mightDrag.node.isAtom||lr&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Oc(this.view,tt.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):ll(this.view,"pointer")}move(e){this.updateAllowDefault(e),ll(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Er.touchstart=n=>{n.input.lastTouch=Date.now(),kk(n),ll(n,"pointer")};Er.touchmove=n=>{n.input.lastTouch=Date.now(),ll(n,"pointer")};Er.contextmenu=n=>kk(n);function _D(n,e){return n.composing?!0:Tr&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const V$=fo?5e3:-1;Ar.compositionstart=Ar.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof ze&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Jg(n,!0),n.markCursor=null;else if(Jg(n,!e.selection.empty),Si&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){let l=n.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else i=o,s=-1}}n.input.composing=!0}MD(n,V$)};Ar.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,MD(n,20))};function MD(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Jg(n),e))}function TD(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=j$());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function F$(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=Dj(e.focusNode,e.focusOffset),r=Ij(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let i=r.pmViewDesc,s=n.domObserver.lastChangedTextNode;if(t==s||r==s)return s;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=t.pmViewDesc;if(!(!o||!o.isText(t.nodeValue)))return r}}return t||r}function j$(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Jg(n,e=!1){if(!(fo&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),TD(n),e||n.docView&&n.docView.dirty){let t=gk(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function $$(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const rd=Wr&&cl<15||vu&&Hj<604;Er.copy=Ar.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let s=rd?null:t.clipboardData,o=r.content(),{dom:l,text:a}=bk(n,o);s?(t.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",a)):$$(n,l),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function z$(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function W$(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?id(n,r.value,null,i,e):id(n,r.textContent,r.innerHTML,i,e)},50)}function id(n,e,t,r,i){let s=bD(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,i,s||Le.empty)))return!0;if(!s)return!1;let o=z$(s),l=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(s);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function ED(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Ar.paste=(n,e)=>{let t=e;if(n.composing&&!fo)return;let r=rd?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&id(n,ED(r),r.getData("text/html"),i,t)?t.preventDefault():W$(n,t)};class AD{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const q$=pi?"altKey":"ctrlKey";function OD(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[q$]}Er.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords(Z0(t)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof Ke?i.to-1:i.to))){if(r&&r.mightDrag)o=Ke.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=n.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(o=Ke.create(n.state.doc,f.posBefore))}}let l=(o||n.state.selection).content(),{dom:a,text:c,slice:u}=bk(n,l);(!t.dataTransfer.files.length||!lr||nD>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(rd?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",rd||t.dataTransfer.setData("text/plain",c),n.dragging=new AD(u,OD(n,t),o)};Er.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Ar.dragover=Ar.dragenter=(n,e)=>e.preventDefault();Ar.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Z0(t));if(!i)return;let s=n.state.doc.resolve(i.pos),o=r&&r.slice;o?n.someProp("transformPasted",y=>{o=y(o,n,!1)}):o=bD(n,ED(t.dataTransfer),rd?null:t.dataTransfer.getData("text/html"),!1,s);let l=!!(r&&OD(n,t));if(n.someProp("handleDrop",y=>y(n,t,o||Le.empty,l))){t.preventDefault();return}if(!o)return;t.preventDefault();let a=o?jV(n.state.doc,s.pos,o):s.pos;a==null&&(a=s.pos);let c=n.state.tr;if(l){let{node:y}=r;y?y.replace(c):c.deleteSelection()}let u=c.mapping.map(a),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,p=c.doc;if(f?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(p))return;let g=c.doc.resolve(u);if(f&&Ke.isSelectable(o.content.firstChild)&&g.nodeAfter&&g.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new Ke(g));else{let y=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((v,k,x,_)=>y=_),c.setSelection(yk(n,g,c.doc.resolve(y)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Er.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&yo(n)},20))};Er.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Er.beforeinput=(n,e)=>{if(lr&&fo&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",s=>s(n,Ql(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Ar)Er[n]=Ar[n];function sd(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Zg{constructor(e,t){this.toDOM=e,this.spec=t||Sa,this.side=this.spec.side||0}map(e,t,r,i){let{pos:s,deleted:o}=e.mapResult(t.from+i,this.side<0?-1:1);return o?null:new Tn(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Zg&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&sd(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class fl{constructor(e,t){this.attrs=e,this.spec=t||Sa}map(e,t,r,i){let s=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new Tn(s,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof fl&&sd(this.attrs,e.attrs)&&sd(this.spec,e.spec)}static is(e){return e.type instanceof fl}destroy(){}}class Ck{constructor(e,t){this.attrs=e,this.spec=t||Sa}map(e,t,r,i){let s=e.mapResult(t.from+i,1);if(s.deleted)return null;let o=e.mapResult(t.to+i,-1);return o.deleted||o.pos<=s.pos?null:new Tn(s.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),s;return i==t.from&&!(s=e.child(r)).isText&&i+s.nodeSize==t.to}eq(e){return this==e||e instanceof Ck&&sd(this.attrs,e.attrs)&&sd(this.spec,e.spec)}destroy(){}}class Tn{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Tn(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Tn(e,e,new Zg(t,r))}static inline(e,t,r,i){return new Tn(e,t,new fl(r,i))}static node(e,t,r,i){return new Tn(e,t,new Ck(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof fl}get widget(){return this.type instanceof Zg}}const dc=[],Sa={};class Ft{constructor(e,t){this.local=e.length?e:dc,this.children=t.length?t:dc}static create(e,t){return t.length?Yg(t,e,0,Sa):rr}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=t&&l.to>=e&&(!s||s(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,t-l,r,i+l,s)}}map(e,t,r){return this==rr||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Sa)}mapInner(e,t,r,i,s){let o;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(t,a)?(o||(o=[])).push(a):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?U$(this.children,o||[],e,t,r,i,s):o?new Ft(o.sort(xa),dc):rr}add(e,t){return t.length?this==rr?Ft.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,s=0;e.forEach((l,a)=>{let c=a+r,u;if(u=DD(t,l,c)){for(i||(i=this.children.slice());s<i.length&&i[s]<a;)s+=3;i[s]==a?i[s+2]=i[s+2].addInner(l,u,c+1):i.splice(s,0,a,a+l.nodeSize,Yg(u,l,c+1,Sa)),s+=3}});let o=LD(s?ID(t):t,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new Ft(o.length?this.local.concat(o).sort(xa):this.local,i||this.children)}remove(e){return e.length==0||this==rr?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,l=r[s]+t,a=r[s+1]+t;for(let u=0,f;u<e.length;u++)(f=e[u])&&f.from>l&&f.to<a&&(e[u]=null,(o||(o=[])).push(f));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(o,l+1);c!=rr?r[s+2]=c:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<i.length;l++)i[l].eq(o,t)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Ft(i,r):rr}forChild(e,t){if(this==rr)return this;if(t.isLeaf)return Ft.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let s=e+1,o=s+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<o&&a.to>s&&a.type instanceof fl){let c=Math.max(s,a.from)-s,u=Math.min(o,a.to)-s;c<u&&(i||(i=[])).push(a.copy(c,u))}}if(i){let l=new Ft(i.sort(xa),dc);return r?new Yo([l,r]):l}return r||rr}eq(e){if(this==e)return!0;if(!(e instanceof Ft)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Sk(this.localsInner(e))}localsInner(e){if(this==rr)return dc;if(e.inlineContent||!this.local.some(fl.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof fl||t.push(this.local[r]);return t}forEachSet(e){e(this)}}Ft.empty=new Ft([],[]);Ft.removeOverlap=Sk;const rr=Ft.empty;class Yo{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Sa));return Yo.from(r)}forChild(e,t){if(t.isLeaf)return Ft.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,t);s!=rr&&(s instanceof Yo?r=r.concat(s.members):r.push(s))}return Yo.from(r)}eq(e){if(!(e instanceof Yo)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!t)t=s;else{r&&(t=t.slice(),r=!1);for(let o=0;o<s.length;o++)t.push(s[o])}}return t?Sk(r?t:t.sort(xa)):dc}static from(e){switch(e.length){case 0:return rr;case 1:return e[0];default:return new Yo(e.every(t=>t instanceof Ft)?e:e.reduce((t,r)=>t.concat(r instanceof Ft?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function U$(n,e,t,r,i,s,o){let l=n.slice();for(let c=0,u=s;c<t.maps.length;c++){let f=0;t.maps[c].forEach((p,g,y,v)=>{let k=v-y-(g-p);for(let x=0;x<l.length;x+=3){let _=l[x+1];if(_<0||p>_+u-f)continue;let M=l[x]+u-f;g>=M?l[x+1]=p<=M?-2:-1:p>=u&&k&&(l[x]+=k,l[x+1]+=k)}f+=k}),u=t.maps[c].map(u,-1)}let a=!1;for(let c=0;c<l.length;c+=3)if(l[c+1]<0){if(l[c+1]==-2){a=!0,l[c+1]=-1;continue}let u=t.map(n[c]+s),f=u-i;if(f<0||f>=r.content.size){a=!0;continue}let p=t.map(n[c+1]+s,-1),g=p-i,{index:y,offset:v}=r.content.findIndex(f),k=r.maybeChild(y);if(k&&v==f&&v+k.nodeSize==g){let x=l[c+2].mapInner(t,k,u+1,n[c]+s+1,o);x!=rr?(l[c]=f,l[c+1]=g,l[c+2]=x):(l[c+1]=-2,a=!0)}else a=!0}if(a){let c=K$(l,n,e,t,i,s,o),u=Yg(c,r,0,o);e=u.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,p=0;f<u.children.length;f+=3){let g=u.children[f];for(;p<l.length&&l[p]<g;)p+=3;l.splice(p,0,u.children[f],u.children[f+1],u.children[f+2])}}return new Ft(e.sort(xa),l)}function LD(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new Tn(i.from+e,i.to+e,i.type))}return t}function K$(n,e,t,r,i,s,o){function l(a,c){for(let u=0;u<a.local.length;u++){let f=a.local[u].map(r,i,c);f?t.push(f):o.onRemove&&o.onRemove(a.local[u].spec)}for(let u=0;u<a.children.length;u+=3)l(a.children[u+2],a.children[u]+c+1)}for(let a=0;a<n.length;a+=3)n[a+1]==-1&&l(n[a+2],e[a]+s+1);return t}function DD(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let s=0,o;s<n.length;s++)(o=n[s])&&o.from>t&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function ID(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Yg(n,e,t,r){let i=[],s=!1;e.forEach((l,a)=>{let c=DD(n,l,a+t);if(c){s=!0;let u=Yg(c,l,t+a+1,r);u!=rr&&i.push(a,a+l.nodeSize,u)}});let o=LD(s?ID(n):n,-t).sort(xa);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new Ft(o,i):rr}function xa(n,e){return n.from-e.from||n.to-e.to}function Sk(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==n&&(e=n.slice()),e[i]=s.copy(s.from,r.to),QM(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,s.from),QM(e,i,r.copy(s.from,r.to)));break}}}return e}function QM(n,e,t){for(;e<n.length&&xa(t,n[e])>0;)e++;n.splice(e,0,t)}function T1(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=rr&&e.push(r)}),n.cursorWrapper&&e.push(Ft.create(n.state.doc,[n.cursorWrapper.deco])),Yo.from(e)}const G$={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},J$=Wr&&cl<=11;class Z${constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Y${constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Z$,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Wr&&cl<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),J$&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,G$)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(qM(this.view)){if(this.suppressingSelectionUpdates)return yo(this.view);if(Wr&&cl<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&$a(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let s=e.focusNode;s;s=wu(s))t.add(s);for(let s=e.anchorNode;s;s=wu(s))if(t.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&qM(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,l=!1,a=[];if(e.editable)for(let u=0;u<t.length;u++){let f=this.registerMutation(t[u],a);f&&(s=s<0?f.from:Math.min(f.from,s),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(l=!0))}if(Si&&a.length){let u=a.filter(f=>f.nodeName=="BR");if(u.length==2){let[f,p]=u;f.parentNode&&f.parentNode.parentNode==p.parentNode?p.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let p of u){let g=p.parentNode;g&&g.nodeName=="LI"&&(!f||ez(e,f)!=g)&&p.remove()}}}let c=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&G0(r)&&(c=gk(e))&&c.eq(tt.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,yo(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),X$(e)),this.handleDOMChange(s,o,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||yo(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let f=e.addedNodes[u];t.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(Wr&&cl<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:f,nextSibling:p}=e.addedNodes[u];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(s=p)}let o=i&&i.parentNode==e.target?Jn(i)+1:0,l=r.localPosFromDOM(e.target,o,-1),a=s&&s.parentNode==e.target?Jn(s):e.target.childNodes.length,c=r.localPosFromDOM(e.target,a,1);return{from:l,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let eT=new WeakMap,tT=!1;function X$(n){if(!eT.has(n)&&(eT.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Si,tT)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),tT=!0}}function nT(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return $a(o.node,o.offset,i,s)&&([t,r,i,s]=[i,s,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}}function Q$(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return nT(n,i)}let t;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?nT(n,t):null}function ez(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function tz(n,e,t){let{node:r,fromOffset:i,toOffset:s,from:o,to:l}=n.docView.parseRange(e,t),a=n.domSelectionRange(),c,u=a.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:a.anchorOffset}],G0(a)||c.push({node:a.focusNode,offset:a.focusOffset})),lr&&n.input.lastKeyCode===8)for(let k=s;k>i;k--){let x=r.childNodes[k-1],_=x.pmViewDesc;if(x.nodeName=="BR"&&!_){s=k;break}if(!_||_.size)break}let f=n.state.doc,p=n.someProp("domParser")||H0.fromSchema(n.state.schema),g=f.resolve(o),y=null,v=p.parse(r,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:s,preserveWhitespace:g.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:nz,context:g});if(c&&c[0].pos!=null){let k=c[0].pos,x=c[1]&&c[1].pos;x==null&&(x=k),y={anchor:k+o,head:x+o}}return{doc:v,sel:y,from:o,to:l}}function nz(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Tr&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Tr&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const rz=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function iz(n,e,t,r,i){let s=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let I=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,B=gk(n,I);if(B&&!n.state.selection.eq(B)){if(lr&&fo&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",K=>K(n,Ql(13,"Enter"))))return;let R=n.state.tr.setSelection(B);I=="pointer"?R.setMeta("pointer",!0):I=="key"&&R.scrollIntoView(),s&&R.setMeta("composition",s),n.dispatch(R)}return}let o=n.state.doc.resolve(e),l=o.sharedDepth(t);e=o.before(l+1),t=n.state.doc.resolve(t).after(l+1);let a=n.state.selection,c=tz(n,e,t),u=n.state.doc,f=u.slice(c.from,c.to),p,g;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(p=n.state.selection.to,g="end"):(p=n.state.selection.from,g="start"),n.input.lastKeyCode=null;let y=lz(f.content,c.doc.content,c.from,p,g);if(y&&n.input.domChangeCount++,(vu&&n.input.lastIOSEnter>Date.now()-225||fo)&&i.some(I=>I.nodeType==1&&!rz.test(I.nodeName))&&(!y||y.endA>=y.endB)&&n.someProp("handleKeyDown",I=>I(n,Ql(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!y)if(r&&a instanceof ze&&!a.empty&&a.$head.sameParent(a.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))y={start:a.from,endA:a.to,endB:a.to};else{if(c.sel){let I=rT(n,n.state.doc,c.sel);if(I&&!I.eq(n.state.selection)){let B=n.state.tr.setSelection(I);s&&B.setMeta("composition",s),n.dispatch(B)}}return}n.state.selection.from<n.state.selection.to&&y.start==y.endB&&n.state.selection instanceof ze&&(y.start>n.state.selection.from&&y.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?y.start=n.state.selection.from:y.endA<n.state.selection.to&&y.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(y.endB+=n.state.selection.to-y.endA,y.endA=n.state.selection.to)),Wr&&cl<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>c.from&&c.doc.textBetween(y.start-c.from-1,y.start-c.from+1)==" "&&(y.start--,y.endA--,y.endB--);let v=c.doc.resolveNoCache(y.start-c.from),k=c.doc.resolveNoCache(y.endB-c.from),x=u.resolve(y.start),_=v.sameParent(k)&&v.parent.inlineContent&&x.end()>=y.endA;if((vu&&n.input.lastIOSEnter>Date.now()-225&&(!_||i.some(I=>I.nodeName=="DIV"||I.nodeName=="P"))||!_&&v.pos<c.doc.content.size&&(!v.sameParent(k)||!v.parent.inlineContent)&&v.pos<k.pos&&!/\S/.test(c.doc.textBetween(v.pos,k.pos,"","")))&&n.someProp("handleKeyDown",I=>I(n,Ql(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>y.start&&oz(u,y.start,y.endA,v,k)&&n.someProp("handleKeyDown",I=>I(n,Ql(8,"Backspace")))){fo&&lr&&n.domObserver.suppressSelectionUpdates();return}lr&&y.endB==y.start&&(n.input.lastChromeDelete=Date.now()),fo&&!_&&v.start()!=k.start()&&k.parentOffset==0&&v.depth==k.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==y.endA&&(y.endB-=2,k=c.doc.resolveNoCache(y.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(I){return I(n,Ql(13,"Enter"))})},20));let M=y.start,T=y.endA,S=I=>{let B=I||n.state.tr.replace(M,T,c.doc.slice(y.start-c.from,y.endB-c.from));if(c.sel){let R=rT(n,B.doc,c.sel);R&&!(lr&&n.composing&&R.empty&&(y.start!=y.endB||n.input.lastChromeDelete<Date.now()-100)&&(R.head==M||R.head==B.mapping.map(T)-1)||Wr&&R.empty&&R.head==M)&&B.setSelection(R)}return s&&B.setMeta("composition",s),B.scrollIntoView()},A;if(_)if(v.pos==k.pos){Wr&&cl<=11&&v.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>yo(n),20));let I=S(n.state.tr.delete(M,T)),B=u.resolve(y.start).marksAcross(u.resolve(y.endA));B&&I.ensureMarks(B),n.dispatch(I)}else if(y.endA==y.endB&&(A=sz(v.parent.content.cut(v.parentOffset,k.parentOffset),x.parent.content.cut(x.parentOffset,y.endA-x.start())))){let I=S(n.state.tr);A.type=="add"?I.addMark(M,T,A.mark):I.removeMark(M,T,A.mark),n.dispatch(I)}else if(v.parent.child(v.index()).isText&&v.index()==k.index()-(k.textOffset?0:1)){let I=v.parent.textBetween(v.parentOffset,k.parentOffset),B=()=>S(n.state.tr.insertText(I,M,T));n.someProp("handleTextInput",R=>R(n,M,T,I,B))||n.dispatch(B())}else n.dispatch(S());else n.dispatch(S())}function rT(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:yk(n,e.resolve(t.anchor),e.resolve(t.head))}function sz(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,s=r,o,l,a;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<t.length;u++)s=t[u].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",a=u=>u.mark(l.addToSet(u.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",a=u=>u.mark(l.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(a(e.child(u)));if(we.from(c).eq(n))return{mark:l,type:o}}function oz(n,e,t,r,i){if(t-e<=i.pos-r.pos||E1(r,!0,!1)<i.pos)return!1;let s=n.resolve(e);if(!r.parent.isTextblock){let l=s.nodeAfter;return l!=null&&t==e+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=n.resolve(E1(s,!0,!0));return!o.parent.isTextblock||o.pos>t||E1(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function E1(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let s=n.node(r).maybeChild(n.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function lz(n,e,t,r,i){let s=n.findDiffStart(e,t);if(s==null)return null;let{a:o,b:l}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let a=Math.max(0,s-Math.min(o,l));r-=o+a-s}if(o<s&&n.size<e.size){let a=r<=s&&r>=o?s-r:0;s-=a,s&&s<e.size&&iT(e.textBetween(s-1,s+1))&&(s+=a?1:-1),l=s+(l-o),o=s}else if(l<s){let a=r<=s&&r>=l?s-r:0;s-=a,s&&s<n.size&&iT(n.textBetween(s-1,s+1))&&(s+=a?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function iT(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class xk{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new M$,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(cT),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=lT(this),oT(this),this.nodeViews=aT(this),this.docView=VM(this.state.doc,sT(this),T1(this),this.dom,this),this.domObserver=new Y$(this,(r,i,s,o)=>iz(this,r,i,s,o)),this.domObserver.start(),T$(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Bw(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(cT),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(TD(this),o=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let g=aT(this);cz(g,this.nodeViews)&&(this.nodeViews=g,s=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&Bw(this),this.editable=lT(this),oT(this);let a=T1(this),c=sT(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=s||!this.docView.matchesNode(e.doc,c,a);(f||!e.selection.eq(i.selection))&&(o=!0);let p=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&jj(this);if(o){this.domObserver.stop();let g=f&&(Wr||lr)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&az(i.selection,e.selection);if(f){let y=lr?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=F$(this)),(s||!this.docView.update(e.doc,c,a,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=VM(e.doc,c,a,this.dom,this)),y&&!this.trackWrites&&(g=!0)}g||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&f$(this))?yo(this,g):(mD(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():p&&$j(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof Ke){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&IM(this,t.getBoundingClientRect(),e)}else IM(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-t.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new AD(e.slice,e.move,i<0?void 0:Ke.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(i=t?t(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(i=t?t(l):l))return i}}hasFocus(){if(Wr){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&zj(this.dom),yo(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return Gj(this,e)}coordsAtPos(e,t=1){return lD(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return Qj(this,t||this.state,e)}pasteHTML(e,t){return id(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return id(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return bk(this,e)}destroy(){this.docView&&(E$(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],T1(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Oj())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return O$(this,e)}domSelectionRange(){let e=this.domSelection();return e?Tr&&this.root.nodeType===11&&Rj(this.dom.ownerDocument)==this.dom&&Q$(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}xk.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function sT(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Tn.node(0,n.state.doc.content.size,e)]}function oT(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Tn.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function lT(n){return!n.someProp("editable",e=>e(n.state)===!1)}function az(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function aT(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function cz(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function cT(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}function Eo(n,e){return n.meta={package:"@milkdown/core",group:"System",...e},n}const ND={text:(n,e,t,r)=>{const i=n.value;return/^[^*_\\]*\s+$/.test(i)?i:t.safe(i,{...r,encode:[]})},strong:(n,e,t,r)=>{const i=n.marker||t.options.strong||"*",s=t.enter("strong"),o=t.createTracker(r);let l=o.move(i+i);return l+=o.move(t.containerPhrasing(n,{before:l,after:i,...o.current()})),l+=o.move(i+i),s(),l},emphasis:(n,e,t,r)=>{const i=n.marker||t.options.emphasis||"*",s=t.enter("emphasis"),o=t.createTracker(r);let l=o.move(i);return l+=o.move(t.containerPhrasing(n,{before:l,after:i,...o.current()})),l+=o.move(i),s(),l}},Gt=mt({},"editorView"),Nf=mt({},"editorState"),A1=mt([],"initTimer"),Hw=mt({},"editor"),od=mt([],"inputRules"),vl=mt([],"prosePlugins"),ld=mt([],"remarkPlugins"),ad=mt([],"nodeView"),cd=mt([],"markView"),_a=mt(mb().use(gb).use(xw),"remark"),mh=mt({handlers:ND,encode:[]},"remarkStringifyOptions"),Km=Ns("ConfigReady");function uz(n){const e=t=>(t.record(Km),async()=>(await n(t),t.done(Km),()=>{t.clearTimer(Km)}));return Eo(e,{displayName:"Config"}),e}const Ma=Ns("InitReady");function fz(n){const e=t=>(t.inject(Hw,n).inject(vl,[]).inject(ld,[]).inject(od,[]).inject(ad,[]).inject(cd,[]).inject(mh,{handlers:ND,encode:[]}).inject(_a,mb().use(gb).use(xw)).inject(A1,[Km]).record(Ma),async()=>{await t.waitTimers(A1);const r=t.get(mh);return t.set(_a,mb().use(gb).use(xw,r)),t.done(Ma),()=>{t.remove(Hw).remove(vl).remove(ld).remove(od).remove(ad).remove(cd).remove(mh).remove(_a).remove(A1).clearTimer(Ma)}});return Eo(e,{displayName:"Init"}),e}const Mr=Ns("SchemaReady"),O1=mt([],"schemaTimer"),Ts=mt({},"schema"),gh=mt([],"nodes"),yh=mt([],"marks");function uT(n){var e;return{...n,parseDOM:(e=n.parseDOM)==null?void 0:e.map(t=>({priority:n.priority,...t}))}}const RD=n=>(n.inject(Ts,{}).inject(gh,[]).inject(yh,[]).inject(O1,[Ma]).record(Mr),async()=>{await n.waitTimers(O1);const e=n.get(_a),r=n.get(ld).reduce((l,a)=>l.use(a.plugin,a.options),e);n.set(_a,r);const i=Object.fromEntries(n.get(gh).map(([l,a])=>[l,uT(a)])),s=Object.fromEntries(n.get(yh).map(([l,a])=>[l,uT(a)])),o=new dL({nodes:i,marks:s});return n.set(Ts,o),n.done(Mr),()=>{n.remove(Ts).remove(gh).remove(yh).remove(O1).clearTimer(Mr)}});Eo(RD,{displayName:"Schema"});var ca,di;class PD{constructor(){be(this,ca);be(this,di);X(this,ca,new FL),X(this,di,null),this.setCtx=e=>{X(this,di,e)},this.chain=()=>{if(V(this,di)==null)throw v1();const e=V(this,di),t=[],r=this.get.bind(this),i={run:()=>{const o=Nu(...t),l=e.get(Gt);return o(l.state,l.dispatch,l)},inline:o=>(t.push(o),i),pipe:s.bind(this)};function s(o,l){const a=r(o);return t.push(a(l)),i}return i}}get ctx(){return V(this,di)}create(e,t){const r=e.create(V(this,ca).sliceMap);return r.set(t),r}get(e){return V(this,ca).get(e).get()}remove(e){return V(this,ca).remove(e)}call(e,t){if(V(this,di)==null)throw v1();const i=this.get(e)(t),s=V(this,di).get(Gt);return i(s.state,s.dispatch,s)}inline(e){if(V(this,di)==null)throw v1();const t=V(this,di).get(Gt);return e(t.state,t.dispatch,t)}}ca=new WeakMap,di=new WeakMap;function hz(n="cmdKey"){return mt(()=>()=>!1,n)}const Be=mt(new PD,"commands"),L1=mt([Mr],"commandsTimer"),bh=Ns("CommandsReady"),BD=n=>{const e=new PD;return e.setCtx(n),n.inject(Be,e).inject(L1,[Mr]).record(bh),async()=>(await n.waitTimers(L1),n.done(bh),()=>{n.remove(Be).remove(L1).clearTimer(bh)})};Eo(BD,{displayName:"Commands"});function dz(n){const e=Nu(XV,uk,cj,GL);return n.Backspace=e,n}var ua,Rr;class HD{constructor(){be(this,ua);be(this,Rr);X(this,ua,null),X(this,Rr,[]),this.setCtx=e=>{X(this,ua,e)},this.add=e=>(V(this,Rr).push(e),()=>{X(this,Rr,V(this,Rr).filter(t=>t!==e))}),this.addObjectKeymap=e=>{const t=[];return Object.entries(e).forEach(([r,i])=>{if(typeof i=="function"){const s={key:r,onRun:()=>i};V(this,Rr).push(s),t.push(()=>{X(this,Rr,V(this,Rr).filter(o=>o!==s))})}else V(this,Rr).push(i),t.push(()=>{X(this,Rr,V(this,Rr).filter(s=>s!==i))})}),()=>{t.forEach(r=>r())}},this.addBaseKeymap=()=>{const e=dz(_j);return this.addObjectKeymap(e)},this.build=()=>{const e={};return V(this,Rr).forEach(r=>{e[r.key]=[...e[r.key]||[],r]}),Object.fromEntries(Object.entries(e).map(([r,i])=>{const s=i.sort((l,a)=>(a.priority??50)-(l.priority??50));return[r,(l,a,c)=>{const u=V(this,ua);if(u==null)throw W0();const f=s.map(g=>g.onRun(u));return Nu(...f)(l,a,c)}]}))}}get ctx(){return V(this,ua)}}ua=new WeakMap,Rr=new WeakMap;const Xg=mt(new HD,"keymap"),D1=mt([Mr],"keymapTimer"),wh=Ns("KeymapReady"),pz=n=>{const e=new HD;return e.setCtx(n),n.inject(Xg,e).inject(D1,[Mr]).record(wh),async()=>(await n.waitTimers(D1),n.done(wh),()=>{n.remove(Xg).remove(D1).clearTimer(wh)})},Gm=Ns("ParserReady"),VD=()=>{throw W0()},vh=mt(VD,"parser"),I1=mt([],"parserTimer"),FD=n=>(n.inject(vh,VD).inject(I1,[Mr]).record(Gm),async()=>{await n.waitTimers(I1);const e=n.get(_a),t=n.get(Ts);return n.set(vh,oj.create(t,e)),n.done(Gm),()=>{n.remove(vh).remove(I1).clearTimer(Gm)}});Eo(FD,{displayName:"Parser"});const kh=Ns("SerializerReady"),N1=mt([],"serializerTimer"),jD=()=>{throw W0()},Lc=mt(jD,"serializer"),$D=n=>(n.inject(Lc,jD).inject(N1,[Mr]).record(kh),async()=>{await n.waitTimers(N1);const e=n.get(_a),t=n.get(Ts);return n.set(Lc,aj.create(t,e)),n.done(kh),()=>{n.remove(Lc).remove(N1).clearTimer(kh)}});Eo($D,{displayName:"Serializer"});const Jm=mt("","defaultValue"),R1=mt(n=>n,"stateOptions"),P1=mt([],"editorStateTimer"),Zm=Ns("EditorStateReady");function mz(n,e,t){if(typeof n=="string")return e(n);if(n.type==="html")return H0.fromSchema(t).parse(n.dom);if(n.type==="json")return Ci.fromJSON(t,n.value);throw eF(n)}const gz=new rn("MILKDOWN_STATE_TRACKER"),zD=n=>(n.inject(Jm,"").inject(Nf,{}).inject(R1,e=>e).inject(P1,[Gm,kh,bh,wh]).record(Zm),async()=>{await n.waitTimers(P1);const e=n.get(Ts),t=n.get(vh),r=n.get(od),i=n.get(R1),s=n.get(vl),o=n.get(Jm),l=mz(o,t,e),a=n.get(Xg),c=a.addBaseKeymap(),u=[...s,new nn({key:gz,state:{init:()=>{},apply:(g,y,v,k)=>{n.set(Nf,k)}}}),yF({rules:r}),eD(a.build())];n.set(vl,u);const f=i({schema:e,doc:l,plugins:u}),p=na.create(f);return n.set(Nf,p),n.done(Zm),()=>{c(),n.remove(Jm).remove(Nf).remove(R1).remove(P1).clearTimer(Zm)}});Eo(zD,{displayName:"EditorState"});const ud=mt([],"pasteRule"),B1=mt([Mr],"pasteRuleTimer"),Ym=Ns("PasteRuleReady"),WD=n=>(n.inject(ud,[]).inject(B1,[Mr]).record(Ym),async()=>(await n.waitTimers(B1),n.done(Ym),()=>{n.remove(ud).remove(B1).clearTimer(Ym)}));Eo(WD,{displayName:"PasteRule"});const Xm=Ns("EditorViewReady"),H1=mt([],"editorViewTimer"),Ch=mt({},"editorViewOptions"),Qm=mt(null,"root"),Vw=mt(null,"rootDOM"),Fw=mt({},"rootAttrs");function yz(n,e){const t=document.createElement("div");t.className="milkdown",n.appendChild(t),e.set(Vw,t);const r=e.get(Fw);return Object.entries(r).forEach(([i,s])=>t.setAttribute(i,s)),t}function bz(n){n.classList.add("editor"),n.setAttribute("role","textbox")}const wz=new rn("MILKDOWN_VIEW_CLEAR"),qD=n=>(n.inject(Qm,document.body).inject(Gt,{}).inject(Ch,{}).inject(Vw,null).inject(Fw,{}).inject(H1,[Zm,Ym]).record(Xm),async()=>{await n.wait(Ma);const e=n.get(Qm)||document.body,t=typeof e=="string"?document.querySelector(e):e;n.update(vl,a=>[new nn({key:wz,view:c=>{const u=t?yz(t,n):void 0;return(()=>{if(u&&t){const p=c.dom;t.replaceChild(u,p),u.appendChild(p)}})(),{destroy:()=>{u!=null&&u.parentNode&&(u==null||u.parentNode.replaceChild(c.dom,u)),u==null||u.remove()}}}}),...a]),await n.waitTimers(H1);const r=n.get(Nf),i=n.get(Ch),s=Object.fromEntries(n.get(ad)),o=Object.fromEntries(n.get(cd)),l=new xk(t,{state:r,nodeViews:s,markViews:o,transformPasted:(a,c,u)=>(n.get(ud).sort((f,p)=>(p.priority??50)-(f.priority??50)).map(f=>f.run).forEach(f=>{a=f(a,c,u)}),a),...i});return bz(l.dom),n.set(Gt,l),n.done(Xm),()=>{l==null||l.destroy(),n.remove(Qm).remove(Gt).remove(Ch).remove(Vw).remove(Fw).remove(H1).clearTimer(Xm)}});Eo(qD,{displayName:"EditorView"});var Qg=(n=>(n.Idle="Idle",n.OnCreate="OnCreate",n.Created="Created",n.OnDestroy="OnDestroy",n.Destroyed="Destroyed",n))(Qg||{}),fa,ti,so,qc,Ed,Ad,Pr,oo,ha,Od,da,Uc,Ld,nl,Kc;const FS=class FS{constructor(){be(this,fa);be(this,ti);be(this,so);be(this,qc);be(this,Ed);be(this,Ad);be(this,Pr);be(this,oo);be(this,ha);be(this,Od);be(this,da);be(this,Uc);be(this,Ld);be(this,nl);be(this,Kc);X(this,fa,!1),X(this,ti,"Idle"),X(this,so,[]),X(this,qc,()=>{}),X(this,Ed,new FL),X(this,Ad,new RF),X(this,Pr,new Map),X(this,oo,new Map),X(this,ha,new Sw(V(this,Ed),V(this,Ad))),X(this,Od,()=>{const e=uz(async r=>{await Promise.all(V(this,so).map(i=>Promise.resolve(i(r))))}),t=[RD,FD,$D,BD,pz,WD,zD,qD,fz(this),e];V(this,da).call(this,t,V(this,oo))}),X(this,da,(e,t)=>{e.forEach(r=>{const i=V(this,ha).produce(V(this,fa)?r.meta:void 0),s=r(i);t.set(r,{ctx:i,handler:s,cleanup:void 0})})}),X(this,Uc,(e,t=!1)=>Promise.all([e].flat().map(async r=>{const i=V(this,Pr).get(r),s=i==null?void 0:i.cleanup;return t?V(this,Pr).delete(r):V(this,Pr).set(r,{ctx:void 0,handler:void 0,cleanup:void 0}),typeof s=="function"?s():s}))),X(this,Ld,async()=>{await Promise.all([...V(this,oo).entries()].map(async([e,{cleanup:t}])=>typeof t=="function"?t():t)),V(this,oo).clear()}),X(this,nl,e=>{X(this,ti,e),V(this,qc).call(this,e)}),X(this,Kc,e=>[...e.entries()].map(async([t,r])=>{const{ctx:i,handler:s}=r;if(!s)return;const o=await s();e.set(t,{ctx:i,handler:s,cleanup:o})})),this.enableInspector=(e=!0)=>(X(this,fa,e),this),this.onStatusChange=e=>(X(this,qc,e),this),this.config=e=>(V(this,so).push(e),this),this.removeConfig=e=>(X(this,so,V(this,so).filter(t=>t!==e)),this),this.use=e=>{const t=[e].flat();return t.flat().forEach(r=>{V(this,Pr).set(r,{ctx:void 0,handler:void 0,cleanup:void 0})}),V(this,ti)==="Created"&&V(this,da).call(this,t,V(this,Pr)),this},this.remove=async e=>V(this,ti)==="OnCreate"?(console.warn("[Milkdown]: You are trying to remove plugins when the editor is creating, this is not recommended, please check your code."),new Promise(t=>{setTimeout(()=>{t(this.remove(e))},50)})):(await V(this,Uc).call(this,[e].flat(),!0),this),this.create=async()=>V(this,ti)==="OnCreate"?this:(V(this,ti)==="Created"&&await this.destroy(),V(this,nl).call(this,"OnCreate"),V(this,Od).call(this),V(this,da).call(this,[...V(this,Pr).keys()],V(this,Pr)),await Promise.all([V(this,Kc).call(this,V(this,oo)),V(this,Kc).call(this,V(this,Pr))].flat()),V(this,nl).call(this,"Created"),this),this.destroy=async(e=!1)=>V(this,ti)==="Destroyed"||V(this,ti)==="OnDestroy"?this:V(this,ti)==="OnCreate"?new Promise(t=>{setTimeout(()=>{t(this.destroy(e))},50)}):(e&&X(this,so,[]),V(this,nl).call(this,"OnDestroy"),await V(this,Uc).call(this,[...V(this,Pr).keys()],e),await V(this,Ld).call(this),V(this,nl).call(this,"Destroyed"),this),this.action=e=>e(V(this,ha)),this.inspect=()=>V(this,fa)?[...V(this,oo).values(),...V(this,Pr).values()].map(({ctx:e})=>{var t;return(t=e==null?void 0:e.inspector)==null?void 0:t.read()}).filter(e=>!!e):(console.warn("[Milkdown]: You are trying to collect inspection when inspector is disabled, please enable inspector by `editor.enableInspector()` first."),[])}static make(){return new FS}get ctx(){return V(this,ha)}get status(){return V(this,ti)}};fa=new WeakMap,ti=new WeakMap,so=new WeakMap,qc=new WeakMap,Ed=new WeakMap,Ad=new WeakMap,Pr=new WeakMap,oo=new WeakMap,ha=new WeakMap,Od=new WeakMap,da=new WeakMap,Uc=new WeakMap,Ld=new WeakMap,nl=new WeakMap,Kc=new WeakMap;let jw=FS,vz=n=>crypto.getRandomValues(new Uint8Array(n)),kz=(n,e,t)=>{let r=(2<<Math.log2(n.length-1))-1,i=-~(1.6*r*e/n.length);return(s=e)=>{let o="";for(;;){let l=t(i),a=i|0;for(;a--;)if(o+=n[l[a]&r]||"",o.length>=s)return o}}},_k=(n,e=21)=>kz(n,e|0,vz);_k("abcedfghicklmn",10);function et(n,e){const t=hz(n),r=i=>async()=>{r.key=t,await i.wait(bh);const s=e(i);return i.get(Be).create(t,s),r.run=o=>i.get(Be).call(n,o),()=>{i.get(Be).remove(t)}};return r}function hr(n){const e=t=>async()=>{await t.wait(Mr);const r=n(t);return t.update(od,i=>[...i,r]),e.inputRule=r,()=>{t.update(od,i=>i.filter(s=>s!==r))}};return e}function Cz(n){const e=t=>async()=>{await t.wait(Mr);const r=n(t);return t.update(ud,i=>[...i,r]),e.pasteRule=r,()=>{t.update(ud,i=>i.filter(s=>s!==r))}};return e}function Sz(n,e){const t=r=>async()=>{const i=e(r);return r.update(yh,s=>[...s.filter(o=>o[0]!==n),[n,i]]),t.id=n,t.schema=i,()=>{r.update(yh,s=>s.filter(([o])=>o!==n))}};return t.type=r=>{const i=r.get(Ts).marks[n];if(!i)throw aF(n);return i},t}function Mk(n,e){const t=r=>async()=>{const i=e(r);return r.update(gh,s=>[...s.filter(o=>o[0]!==n),[n,i]]),t.id=n,t.schema=i,()=>{r.update(gh,s=>s.filter(([o])=>o!==n))}};return t.type=r=>{const i=r.get(Ts).nodes[n];if(!i)throw lF(n);return i},t}function An(n){let e;const t=r=>async()=>(await r.wait(Mr),e=n(r),r.update(vl,i=>[...i,e]),()=>{r.update(vl,i=>i.filter(s=>s!==e))});return t.plugin=()=>e,t.key=()=>e.spec.key,t}function UD(n){const e=t=>async()=>{await t.wait(wh);const r=t.get(Xg),i=n(t),s=r.addObjectKeymap(i);return e.keymap=i,()=>{s()}};return e}function op(n,e){const t=r=>async()=>{await r.wait(Mr);const i=e(r);return n.type(r)instanceof Ug?r.update(ad,s=>[...s,[n.id,i]]):r.update(cd,s=>[...s,[n.id,i]]),t.view=i,t.type=n,()=>{n.type(r)instanceof Ug?r.update(ad,s=>s.filter(o=>o[0]!==n.id)):r.update(cd,s=>s.filter(o=>o[0]!==n.id))}};return t}function It(n,e){const t=mt(n,e),r=i=>(i.inject(t),()=>()=>{i.remove(t)});return r.key=t,r}function vn(n,e){const t=It(e,n),r=Mk(n,s=>s.get(t.key)(s)),i=[t,r];return i.id=r.id,i.node=r,i.type=s=>r.type(s),i.ctx=t,i.key=t.key,i.extendSchema=s=>{const o=s(e);return vn(n,o)},i}function Ru(n,e){const t=It(e,n),r=Sz(n,s=>s.get(t.key)(s)),i=[t,r];return i.id=r.id,i.mark=r,i.type=s=>r.type(s),i.ctx=t,i.key=t.key,i.extendSchema=s=>{const o=s(e);return Ru(n,o)},i}function Kr(n,e){const t=Object.fromEntries(Object.entries(e).map(([o,{shortcuts:l,priority:a}])=>[o,{shortcuts:l,priority:a}])),r=It(t,`${n}Keymap`),i=UD(o=>{const l=o.get(r.key),a=Object.entries(e).flatMap(([c,{command:u}])=>{const f=l[c],p=[f.shortcuts].flat(),g=f.priority;return p.map(y=>[y,{key:y,onRun:u,priority:g}])});return Object.fromEntries(a)}),s=[r,i];return s.ctx=r,s.shortcuts=i,s.key=r.key,s.keymap=i.keymap,s}const Yi=(n,e=()=>({}))=>It(e,`${n}Attr`),lp=(n,e=()=>({}))=>It(e,`${n}Attr`);function Rs(n,e,t){const r=It({},n),i=o=>async()=>{await o.wait(Ma);const a={plugin:e(o),options:o.get(r.key)};return o.update(ld,c=>[...c,a]),()=>{o.update(ld,c=>c.filter(u=>u!==a))}},s=[r,i];return s.id=n,s.plugin=i,s.options=r,s}function xz(n){return e=>{const t=e.get(Gt);return e.get(Ts),e.get(Lc)(t.state.doc)}}function ap(n,e){return Object.assign(n,{meta:{package:"@milkdown/plugin-block",...e}}),n}const _z=n=>!Ms(t=>t.type.name==="table")(n),Y0=It({filterNodes:_z},"blockConfig");ap(Y0,{displayName:"Ctx<blockConfig>"});function Mz(n,e,t){var i;if(!n.dom.parentElement)return null;try{const s=(i=n.posAtCoords({left:e.x,top:e.y}))==null?void 0:i.inside;if(s==null||s<0)return null;let o=n.state.doc.resolve(s),l=n.state.doc.nodeAt(s),a=n.nodeDOM(s);const c=f=>{const p=o.depth>=1&&o.index(o.depth)===0;if(!(f||p))return;const y=o.before(o.depth);l=n.state.doc.nodeAt(y),a=n.nodeDOM(y),o=n.state.doc.resolve(y),t(o,l)||c(!0)},u=t(o,l);return c(!u),!a||!l?null:{node:l,$pos:o,el:a}}catch{return null}}const fT=sm.ie&&sm.ie_version<15||sm.ios&&sm.webkit_version<604,hT=20;var Gc,Dd,pa,Vi,Jc,Fi,po,KD,Rf,ma,ga,Id,Zc,Yc,Xc,Nd,ya;class Tz{constructor(){be(this,po);be(this,Gc);be(this,Dd);be(this,pa);be(this,Vi);be(this,Jc);be(this,Fi);be(this,ma);be(this,ga);be(this,Id);be(this,Zc);be(this,Yc);be(this,Xc);be(this,Nd);be(this,ya);X(this,Dd,()=>{if(!V(this,Vi))return null;const e=V(this,Vi),t=V(this,po,Rf);if(t&&Ke.isSelectable(e.node)){const r=Ke.create(t.state.doc,e.$pos.pos);return t.dispatch(t.state.tr.setSelection(r)),t.focus(),X(this,pa,r),r}return null}),X(this,pa,null),X(this,Vi,null),X(this,Jc,void 0),X(this,Fi,!1),X(this,ga,()=>{var e;(e=V(this,ma))==null||e.call(this,{type:"hide"}),X(this,Vi,null)}),X(this,Id,e=>{var t;X(this,Vi,e),(t=V(this,ma))==null||t.call(this,{type:"show",active:e})}),this.bind=(e,t)=>{X(this,Gc,e),X(this,ma,t)},this.addEvent=e=>{e.addEventListener("mousedown",V(this,Zc)),e.addEventListener("mouseup",V(this,Yc)),e.addEventListener("dragstart",V(this,Xc))},this.removeEvent=e=>{e.removeEventListener("mousedown",V(this,Zc)),e.removeEventListener("mouseup",V(this,Yc)),e.removeEventListener("dragstart",V(this,Xc))},this.unBind=()=>{X(this,ma,void 0)},X(this,Zc,()=>{var e;X(this,Jc,(e=V(this,Vi))==null?void 0:e.el.getBoundingClientRect()),V(this,Dd).call(this)}),X(this,Yc,()=>{if(!V(this,Fi)){requestAnimationFrame(()=>{var e;V(this,Jc)&&((e=V(this,po,Rf))==null||e.focus())});return}X(this,Fi,!1),X(this,pa,null)}),X(this,Xc,e=>{var i;X(this,Fi,!0);const t=V(this,po,Rf);if(!t)return;t.dom.dataset.dragging="true";const r=V(this,pa);if(e.dataTransfer&&r){const s=r.content();e.dataTransfer.effectAllowed="copyMove";const{dom:o,text:l}=t.serializeForClipboard(s);e.dataTransfer.clearData(),e.dataTransfer.setData(fT?"Text":"text/html",o.innerHTML),fT||e.dataTransfer.setData("text/plain",l);const a=(i=V(this,Vi))==null?void 0:i.el;a&&e.dataTransfer.setDragImage(a,0,0),t.dragging={slice:s,move:!0}}}),this.keydownCallback=e=>(V(this,ga).call(this),X(this,Fi,!1),e.dom.dataset.dragging="false",!1),X(this,Nd,A0((e,t)=>{if(!e.editable)return;const r=e.dom.getBoundingClientRect(),i=r.left+r.width/2;if(!(e.root.elementFromPoint(i,t.clientY)instanceof Element)){V(this,ga).call(this);return}const o=V(this,po,KD);if(!o)return;const l=Mz(e,{x:i,y:t.clientY},o);if(!l){V(this,ga).call(this);return}V(this,Id).call(this,l)},200)),this.mousemoveCallback=(e,t)=>(e.composing||!e.editable||V(this,Nd).call(this,e,t),!1),this.dragoverCallback=(e,t)=>{var r;if(V(this,Fi)){const i=(r=V(this,po,Rf))==null?void 0:r.dom.parentElement;if(!i)return!1;const s=i.scrollHeight>i.clientHeight,o=i.getBoundingClientRect();if(s){if(i.scrollTop>0&&Math.abs(t.y-o.y)<hT){const c=i.scrollTop>10?i.scrollTop-10:0;return i.scrollTop=c,!1}const l=Math.round(e.dom.getBoundingClientRect().height);if(Math.round(i.scrollTop+o.height)<l&&Math.abs(t.y-(o.height+o.y))<hT){const c=i.scrollTop+10;return i.scrollTop=c,!1}}}return!1},this.dragenterCallback=e=>{e.dragging&&(X(this,Fi,!0),e.dom.dataset.dragging="true")},this.dragleaveCallback=(e,t)=>{const r=t.clientX,i=t.clientY;(r<0||i<0||r>window.innerWidth||i>window.innerHeight)&&(X(this,Vi,null),V(this,ya).call(this,e))},this.dropCallback=e=>(V(this,ya).call(this,e),!1),this.dragendCallback=e=>{V(this,ya).call(this,e)},X(this,ya,e=>{X(this,Fi,!1),e.dom.dataset.dragging="false"})}}Gc=new WeakMap,Dd=new WeakMap,pa=new WeakMap,Vi=new WeakMap,Jc=new WeakMap,Fi=new WeakMap,po=new WeakSet,KD=function(){var e;try{return(e=V(this,Gc))==null?void 0:e.get(Y0.key).filterNodes}catch{return}},Rf=function(){var e;return(e=V(this,Gc))==null?void 0:e.get(Gt)},ma=new WeakMap,ga=new WeakMap,Id=new WeakMap,Zc=new WeakMap,Yc=new WeakMap,Xc=new WeakMap,Nd=new WeakMap,ya=new WeakMap;const Tk=It(()=>new Tz,"blockService"),X0=It({},"blockServiceInstance");ap(Tk,{displayName:"Ctx<blockService>"});ap(X0,{displayName:"Ctx<blockServiceInstance>"});const Q0=It({},"blockSpec");ap(Q0,{displayName:"Ctx<blockSpec>"});const Ek=An(n=>{const e=new rn("MILKDOWN_BLOCK"),r=n.get(Tk.key)();n.set(X0.key,r);const i=n.get(Q0.key);return new nn({key:e,...i,props:{...i.props,handleDOMEvents:{drop:s=>r.dropCallback(s),pointermove:(s,o)=>r.mousemoveCallback(s,o),keydown:s=>r.keydownCallback(s),dragover:(s,o)=>r.dragoverCallback(s,o),dragleave:(s,o)=>r.dragleaveCallback(s,o),dragenter:s=>r.dragenterCallback(s),dragend:s=>r.dragendCallback(s)}}})});ap(Ek,{displayName:"Prose<block>"});var Br,lo,ba,wa,Rd,Qc,Pd,Bd,eu,tu,nu,C0,GD;class Ez{constructor(e){be(this,C0);be(this,Br);be(this,lo);be(this,ba);be(this,wa);be(this,Rd);be(this,Qc);be(this,Pd);be(this,Bd);be(this,eu);be(this,tu);be(this,nu);X(this,wa,null),X(this,Qc,!1),this.update=()=>{requestAnimationFrame(()=>{if(!V(this,Qc))try{Pp(this,C0,GD).call(this),X(this,Qc,!0)}catch{}})},this.destroy=()=>{var t,r;(t=V(this,ba))==null||t.unBind(),(r=V(this,ba))==null||r.removeEvent(V(this,Br)),V(this,Br).remove()},this.show=t=>{const r=t.el,i=V(this,lo).get(Gt).dom,s={ctx:V(this,lo),active:t,editorDom:i,blockDom:V(this,Br)},o={contextElement:r,getBoundingClientRect:()=>V(this,tu)?V(this,tu).call(this,s):r.getBoundingClientRect()},l=[Tg()];if(V(this,eu)){const a=V(this,eu).call(this,s),c=pl(a);l.push(c)}Ki(o,V(this,Br),{placement:V(this,nu)?V(this,nu).call(this,s):"left",middleware:[...l,...V(this,Pd)],...V(this,Bd)}).then(({x:a,y:c})=>{Object.assign(V(this,Br).style,{left:`${a}px`,top:`${c}px`}),V(this,Br).dataset.show="true"}).catch(console.error)},this.hide=()=>{V(this,Br).dataset.show="false"},X(this,lo,e.ctx),X(this,Br,e.content),X(this,eu,e.getOffset),X(this,tu,e.getPosition),X(this,nu,e.getPlacement),X(this,Pd,e.middleware??[]),X(this,Bd,e.floatingUIOptions??{}),X(this,Rd,e.root),this.hide()}get active(){return V(this,wa)}}Br=new WeakMap,lo=new WeakMap,ba=new WeakMap,wa=new WeakMap,Rd=new WeakMap,Qc=new WeakMap,Pd=new WeakMap,Bd=new WeakMap,eu=new WeakMap,tu=new WeakMap,nu=new WeakMap,C0=new WeakSet,GD=function(){const e=V(this,lo).get(Gt);(V(this,Rd)??e.dom.parentElement??document.body).appendChild(V(this,Br));const r=V(this,lo).get(X0.key);r.bind(V(this,lo),i=>{i.type==="hide"?(this.hide(),X(this,wa,null)):i.type==="show"&&(this.show(i.active),X(this,wa,i.active))}),X(this,ba,r),V(this,ba).addEvent(V(this,Br)),V(this,Br).draggable=!0};const ey=[Q0,Y0,Tk,X0,Ek];ey.key=Q0.key;ey.pluginKey=Ek.key;function Az(n,e){return function(t,r){let{$from:i,$to:s,node:o}=t.selection;if(o&&o.isBlock||i.depth<2||!i.sameParent(s))return!1;let l=i.node(-1);if(l.type!=n)return!1;if(i.parent.content.size==0&&i.node(-1).childCount==i.indexAfter(-1)){if(i.depth==3||i.node(-3).type!=n||i.index(-2)!=i.node(-2).childCount-1)return!1;if(r){let f=we.empty,p=i.index(-1)?1:i.index(-2)?2:3;for(let x=i.depth-p;x>=i.depth-3;x--)f=we.from(i.node(x).copy(f));let g=i.indexAfter(-1)<i.node(-2).childCount?1:i.indexAfter(-2)<i.node(-3).childCount?2:3;f=f.append(we.from(n.createAndFill()));let y=i.before(i.depth-(p-1)),v=t.tr.replace(y,i.after(-g),new Le(f,4-p,0)),k=-1;v.doc.nodesBetween(y,v.doc.content.size,(x,_)=>{if(k>-1)return!1;x.isTextblock&&x.content.size==0&&(k=_+1)}),k>-1&&v.setSelection(tt.near(v.doc.resolve(k))),r(v.scrollIntoView())}return!0}let a=s.pos==i.end()?l.contentMatchAt(0).defaultType:null,c=t.tr.delete(i.pos,s.pos),u=a?[null,{type:a}]:void 0;return hh(c.doc,i.pos,2,u)?(r&&r(c.split(i.pos,2,u).scrollIntoView()),!0):!1}}function Oz(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==n);return s?t?r.node(s.depth-1).type==n?Lz(e,t,n,s):Dz(e,t,s):!0:!1}}function Lz(n,e,t,r){let i=n.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new cr(s-1,o,s,o,new Le(we.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new iL(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const l=V0(r);if(l==null)return!1;i.lift(r,l);let a=i.doc.resolve(i.mapping.map(s,-1)-1);return F0(i.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&i.join(a.pos),e(i.scrollIntoView()),!0}function Dz(n,e,t){let r=n.tr,i=t.parent;for(let g=t.end,y=t.endIndex-1,v=t.startIndex;y>v;y--)g-=i.child(y).nodeSize,r.delete(g-1,g+1);let s=r.doc.resolve(t.start),o=s.nodeAfter;if(r.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let l=t.startIndex==0,a=t.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(l?0:1),u+1,o.content.append(a?we.empty:we.from(i))))return!1;let f=s.pos,p=f+o.nodeSize;return r.step(new cr(f-(l?1:0),p+(a?1:0),f+1,p-1,new Le((l?we.empty:we.from(i.copy(we.empty))).append(a?we.empty:we.from(i.copy(we.empty))),l?0:1,a?0:1),l?0:1)),e(r.scrollIntoView()),!0}function Iz(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,a=l.child(o-1);if(a.type!=n)return!1;if(t){let c=a.lastChild&&a.lastChild.type==l.type,u=we.from(c?n.create():null),f=new Le(we.from(n.create(null,we.from(l.type.create(null,u)))),c?3:1,0),p=s.start,g=s.end;t(e.tr.step(new cr(p-(c?3:1),g,p,g,f,1,!0)).scrollIntoView())}return!0}}function Nz(n){const e=new Map;if(!n||!n.type)throw new Error("mdast-util-definitions expected node");return Ka(n,"definition",function(r){const i=dT(r.identifier);i&&!e.get(i)&&e.set(i,r)}),t;function t(r){const i=dT(r);return e.get(i)}}function dT(n){return String(n||"").toUpperCase()}function Rz(){return function(n){const e=Nz(n);Ka(n,function(t,r,i){if(t.type==="definition"&&i!==void 0&&typeof r=="number")return i.children.splice(r,1),[mx,r];if(t.type==="imageReference"||t.type==="linkReference"){const s=e(t.identifier);if(s&&i&&typeof r=="number")return i.children[r]=t.type==="imageReference"?{type:"image",url:s.url,title:s.title,alt:t.alt}:{type:"link",url:s.url,title:s.title,children:t.children},[mx,r]}})}}function JD(n,e){var i;if(!(e.childCount>=1&&((i=e.lastChild)==null?void 0:i.type.name)==="hardbreak")){n.next(e.content);return}const r=[];e.content.forEach((s,o,l)=>{l!==e.childCount-1&&r.push(s)}),n.next(we.fromArray(r))}function te(n,e){return Object.assign(n,{meta:{package:"@milkdown/preset-commonmark",...e}}),n}const Ak=lp("emphasis");te(Ak,{displayName:"Attr<emphasis>",group:"Emphasis"});const Za=Ru("emphasis",n=>({attrs:{marker:{default:n.get(mh).emphasis||"*",validate:"string"}},parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"}],toDOM:e=>["em",n.get(Ak.key)(e)],parseMarkdown:{match:e=>e.type==="emphasis",runner:(e,t,r)=>{e.openMark(r,{marker:t.marker}),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="emphasis",runner:(e,t)=>{e.withMark(t,"emphasis",void 0,{marker:t.attrs.marker})}}}));te(Za.mark,{displayName:"MarkSchema<emphasis>",group:"Emphasis"});te(Za.ctx,{displayName:"MarkSchemaCtx<emphasis>",group:"Emphasis"});const ty=et("ToggleEmphasis",n=>()=>K0(Za.type(n)));te(ty,{displayName:"Command<toggleEmphasisCommand>",group:"Emphasis"});const ZD=hr(n=>np(/(?:^|[^*])\*([^*]+)\*$/,Za.type(n),{getAttr:()=>({marker:"*"}),updateCaptured:({fullMatch:e,start:t})=>e.startsWith("*")?{}:{fullMatch:e.slice(1),start:t+1}}));te(ZD,{displayName:"InputRule<emphasis>|Star",group:"Emphasis"});const YD=hr(n=>np(/\b_(?![_\s])(.*?[^_\s])_\b/,Za.type(n),{getAttr:()=>({marker:"_"}),updateCaptured:({fullMatch:e,start:t})=>e.startsWith("_")?{}:{fullMatch:e.slice(1),start:t+1}}));te(YD,{displayName:"InputRule<emphasis>|Underscore",group:"Emphasis"});const Ok=Kr("emphasisKeymap",{ToggleEmphasis:{shortcuts:"Mod-i",command:n=>{const e=n.get(Be);return()=>e.call(ty.key)}}});te(Ok.ctx,{displayName:"KeymapCtx<emphasis>",group:"Emphasis"});te(Ok.shortcuts,{displayName:"Keymap<emphasis>",group:"Emphasis"});const Lk=lp("strong");te(Lk,{displayName:"Attr<strong>",group:"Strong"});const Pu=Ru("strong",n=>({attrs:{marker:{default:n.get(mh).strong||"*",validate:"string"}},parseDOM:[{tag:"b",getAttrs:e=>e.style.fontWeight!="normal"&&null},{tag:"strong"},{style:"font-style",getAttrs:e=>e==="bold"},{style:"font-weight=400",clearMark:e=>e.type.name=="strong"},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:e=>["strong",n.get(Lk.key)(e)],parseMarkdown:{match:e=>e.type==="strong",runner:(e,t,r)=>{e.openMark(r,{marker:t.marker}),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="strong",runner:(e,t)=>{e.withMark(t,"strong",void 0,{marker:t.attrs.marker})}}}));te(Pu.mark,{displayName:"MarkSchema<strong>",group:"Strong"});te(Pu.ctx,{displayName:"MarkSchemaCtx<strong>",group:"Strong"});const ny=et("ToggleStrong",n=>()=>K0(Pu.type(n)));te(ny,{displayName:"Command<toggleStrongCommand>",group:"Strong"});const XD=hr(n=>np(new RegExp("(?<![\\w:/])(?:\\*\\*|__)([^*_]+?)(?:\\*\\*|__)(?![\\w/])$"),Pu.type(n),{getAttr:e=>({marker:e[0].startsWith("*")?"*":"_"})}));te(XD,{displayName:"InputRule<strong>",group:"Strong"});const Dk=Kr("strongKeymap",{ToggleBold:{shortcuts:["Mod-b"],command:n=>{const e=n.get(Be);return()=>e.call(ny.key)}}});te(Dk.ctx,{displayName:"KeymapCtx<strong>",group:"Strong"});te(Dk.shortcuts,{displayName:"Keymap<strong>",group:"Strong"});const Ik=lp("inlineCode");te(Ik,{displayName:"Attr<inlineCode>",group:"InlineCode"});const ho=Ru("inlineCode",n=>({priority:100,code:!0,parseDOM:[{tag:"code"}],toDOM:e=>["code",n.get(Ik.key)(e)],parseMarkdown:{match:e=>e.type==="inlineCode",runner:(e,t,r)=>{e.openMark(r),e.addText(t.value),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="inlineCode",runner:(e,t,r)=>{e.withMark(t,"inlineCode",r.text||"")}}}));te(ho.mark,{displayName:"MarkSchema<inlineCode>",group:"InlineCode"});te(ho.ctx,{displayName:"MarkSchemaCtx<inlineCode>",group:"InlineCode"});const ry=et("ToggleInlineCode",n=>()=>(e,t)=>{const{selection:r,tr:i}=e;if(r.empty)return!1;const{from:s,to:o}=r;return e.doc.rangeHasMark(s,o,ho.type(n))?(t==null||t(i.removeMark(s,o,ho.type(n))),!0):(Object.keys(e.schema.marks).filter(c=>c!==ho.type.name).map(c=>e.schema.marks[c]).forEach(c=>{i.removeMark(s,o,c)}),t==null||t(i.addMark(s,o,ho.type(n).create())),!0)});te(ry,{displayName:"Command<toggleInlineCodeCommand>",group:"InlineCode"});const QD=hr(n=>np(/(?:`)([^`]+)(?:`)$/,ho.type(n)));te(QD,{displayName:"InputRule<inlineCodeInputRule>",group:"InlineCode"});const Nk=Kr("inlineCodeKeymap",{ToggleInlineCode:{shortcuts:"Mod-e",command:n=>{const e=n.get(Be);return()=>e.call(ry.key)}}});te(Nk.ctx,{displayName:"KeymapCtx<inlineCode>",group:"InlineCode"});te(Nk.shortcuts,{displayName:"Keymap<inlineCode>",group:"InlineCode"});const Rk=lp("link");te(Rk,{displayName:"Attr<link>",group:"Link"});const zi=Ru("link",n=>({attrs:{href:{validate:"string"},title:{default:null,validate:"string|null"}},parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Zi(e);return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:e=>["a",{...n.get(Rk.key)(e),...e.attrs}],parseMarkdown:{match:e=>e.type==="link",runner:(e,t,r)=>{const i=t.url,s=t.title;e.openMark(r,{href:i,title:s}),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="link",runner:(e,t)=>{e.withMark(t,"link",void 0,{title:t.attrs.title,url:t.attrs.href})}}}));te(zi.mark,{displayName:"MarkSchema<link>",group:"Link"});const e5=et("ToggleLink",n=>(e={})=>K0(zi.type(n),e));te(e5,{displayName:"Command<toggleLinkCommand>",group:"Link"});const t5=et("UpdateLink",n=>(e={})=>(t,r)=>{if(!r)return!1;let i,s=-1;const{selection:o}=t,{from:l,to:a}=o;if(t.doc.nodesBetween(l,l===a?a+1:a,(y,v)=>{if(zi.type(n).isInSet(y.marks))return i=y,s=v,!1}),!i)return!1;const c=i.marks.find(({type:y})=>y===zi.type(n));if(!c)return!1;const u=s,f=s+i.nodeSize,{tr:p}=t,g=zi.type(n).create({...c.attrs,...e});return g?(r(p.removeMark(u,f,c).addMark(u,f,g).setSelection(new ze(p.selection.$anchor)).scrollIntoView()),!0):!1});te(t5,{displayName:"Command<updateLinkCommand>",group:"Link"});const n5=Mk("doc",()=>({content:"block+",parseMarkdown:{match:({type:n})=>n==="root",runner:(n,e,t)=>{n.injectRoot(e,t)}},toMarkdown:{match:n=>n.type.name==="doc",runner:(n,e)=>{n.openNode("root"),n.next(e.content)}}}));te(n5,{displayName:"NodeSchema<doc>",group:"Doc"});function Pz(n){return I3(n,e=>{var t;return e.type==="html"&&["<br />","<br>","<br >","<br/>"].includes((t=e.value)==null?void 0:t.trim())},(e,t)=>{if(!t.length)return;const r=t[t.length-1];if(!r)return;const i=r.children.indexOf(e);i!==-1&&r.children.splice(i,1)},!0)}const iy=Rs("remark-preserve-empty-line",()=>()=>Pz);te(iy.plugin,{displayName:"Remark<remarkPreserveEmptyLine>",group:"Remark"});te(iy.options,{displayName:"RemarkConfig<remarkPreserveEmptyLine>",group:"Remark"});const Pk=Yi("paragraph");te(Pk,{displayName:"Attr<paragraph>",group:"Paragraph"});const Xi=vn("paragraph",n=>({content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:e=>["p",n.get(Pk.key)(e),0],parseMarkdown:{match:e=>e.type==="paragraph",runner:(e,t,r)=>{e.openNode(r),t.children?e.next(t.children):e.addText(t.value||""),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="paragraph",runner:(e,t)=>{var s;const i=(s=n.get(Gt).state)==null?void 0:s.doc.lastChild;e.openNode("paragraph"),(!t.content||t.content.size===0)&&t!==i&&Bz(n)?e.addNode("html",void 0,"<br />"):JD(e,t),e.closeNode()}}}));function Bz(n){let e=!1;try{n.get(iy.id),e=!0}catch{e=!1}return e}te(Xi.node,{displayName:"NodeSchema<paragraph>",group:"Paragraph"});te(Xi.ctx,{displayName:"NodeSchemaCtx<paragraph>",group:"Paragraph"});const Bk=et("TurnIntoText",n=>()=>nd(Xi.type(n)));te(Bk,{displayName:"Command<turnIntoTextCommand>",group:"Paragraph"});const Hk=Kr("paragraphKeymap",{TurnIntoText:{shortcuts:"Mod-Alt-0",command:n=>{const e=n.get(Be);return()=>e.call(Bk.key)}}});te(Hk.ctx,{displayName:"KeymapCtx<paragraph>",group:"Paragraph"});te(Hk.shortcuts,{displayName:"Keymap<paragraph>",group:"Paragraph"});const Hz=Array(6).fill(0).map((n,e)=>e+1);function Vz(n){return n.textContent.toLowerCase().trim().replace(/\s+/g,"-")}const sy=It(Vz,"headingIdGenerator");te(sy,{displayName:"Ctx<HeadingIdGenerator>",group:"Heading"});const Vk=Yi("heading");te(Vk,{displayName:"Attr<heading>",group:"Heading"});const ri=vn("heading",n=>{const e=n.get(sy.key);return{content:"inline*",group:"block",defining:!0,attrs:{id:{default:"",validate:"string"},level:{default:1,validate:"number"}},parseDOM:Hz.map(t=>({tag:`h${t}`,getAttrs:r=>{if(!(r instanceof HTMLElement))throw Zi(r);return{level:t,id:r.id}}})),toDOM:t=>[`h${t.attrs.level}`,{...n.get(Vk.key)(t),id:t.attrs.id||e(t)},0],parseMarkdown:{match:({type:t})=>t==="heading",runner:(t,r,i)=>{const s=r.depth;t.openNode(i,{level:s}),t.next(r.children),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="heading",runner:(t,r)=>{t.openNode("heading",void 0,{depth:r.attrs.level}),JD(t,r),t.closeNode()}}}});te(ri.node,{displayName:"NodeSchema<heading>",group:"Heading"});te(ri.ctx,{displayName:"NodeSchemaCtx<heading>",group:"Heading"});const r5=hr(n=>ak(/^(?<hashes>#+)\s$/,ri.type(n),e=>{var o,l;const t=((l=(o=e.groups)==null?void 0:o.hashes)==null?void 0:l.length)||0,r=n.get(Gt),{$from:i}=r.state.selection,s=i.node();if(s.type.name==="heading"){let a=Number(s.attrs.level)+Number(t);return a>6&&(a=6),{level:a}}return{level:t}}));te(r5,{displayName:"InputRule<wrapInHeadingInputRule>",group:"Heading"});const Uo=et("WrapInHeading",n=>e=>(e??(e=1),e<1?nd(Xi.type(n)):nd(ri.type(n),{level:e})));te(Uo,{displayName:"Command<wrapInHeadingCommand>",group:"Heading"});const Fk=et("DowngradeHeading",n=>()=>(e,t,r)=>{const{$from:i}=e.selection,s=i.node();if(s.type!==ri.type(n)||!e.selection.empty||i.parentOffset!==0)return!1;const o=s.attrs.level-1;return o?(t==null||t(e.tr.setNodeMarkup(e.selection.$from.before(),void 0,{...s.attrs,level:o})),!0):nd(Xi.type(n))(e,t,r)});te(Fk,{displayName:"Command<downgradeHeadingCommand>",group:"Heading"});const jk=Kr("headingKeymap",{TurnIntoH1:{shortcuts:"Mod-Alt-1",command:n=>{const e=n.get(Be);return()=>e.call(Uo.key,1)}},TurnIntoH2:{shortcuts:"Mod-Alt-2",command:n=>{const e=n.get(Be);return()=>e.call(Uo.key,2)}},TurnIntoH3:{shortcuts:"Mod-Alt-3",command:n=>{const e=n.get(Be);return()=>e.call(Uo.key,3)}},TurnIntoH4:{shortcuts:"Mod-Alt-4",command:n=>{const e=n.get(Be);return()=>e.call(Uo.key,4)}},TurnIntoH5:{shortcuts:"Mod-Alt-5",command:n=>{const e=n.get(Be);return()=>e.call(Uo.key,5)}},TurnIntoH6:{shortcuts:"Mod-Alt-6",command:n=>{const e=n.get(Be);return()=>e.call(Uo.key,6)}},DowngradeHeading:{shortcuts:["Delete","Backspace"],command:n=>{const e=n.get(Be);return()=>e.call(Fk.key)}}});te(jk.ctx,{displayName:"KeymapCtx<heading>",group:"Heading"});te(jk.shortcuts,{displayName:"Keymap<heading>",group:"Heading"});const $k=Yi("blockquote");te($k,{displayName:"Attr<blockquote>",group:"Blockquote"});const Bu=vn("blockquote",n=>({content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:e=>["blockquote",n.get($k.key)(e),0],parseMarkdown:{match:({type:e})=>e==="blockquote",runner:(e,t,r)=>{e.openNode(r).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="blockquote",runner:(e,t)=>{e.openNode("blockquote").next(t.content).closeNode()}}}));te(Bu.node,{displayName:"NodeSchema<blockquote>",group:"Blockquote"});te(Bu.ctx,{displayName:"NodeSchemaCtx<blockquote>",group:"Blockquote"});const i5=hr(n=>lk(/^\s*>\s$/,Bu.type(n)));te(i5,{displayName:"InputRule<wrapInBlockquoteInputRule>",group:"Blockquote"});const zk=et("WrapInBlockquote",n=>()=>dk(Bu.type(n)));te(zk,{displayName:"Command<wrapInBlockquoteCommand>",group:"Blockquote"});const Wk=Kr("blockquoteKeymap",{WrapInBlockquote:{shortcuts:"Mod-Shift-b",command:n=>{const e=n.get(Be);return()=>e.call(zk.key)}}});te(Wk.ctx,{displayName:"KeymapCtx<blockquote>",group:"Blockquote"});te(Wk.shortcuts,{displayName:"Keymap<blockquote>",group:"Blockquote"});const qk=Yi("codeBlock",()=>({pre:{},code:{}}));te(qk,{displayName:"Attr<codeBlock>",group:"CodeBlock"});const Ls=vn("code_block",n=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:"",validate:"string"}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Zi(e);return{language:e.dataset.language}}}],toDOM:e=>{const t=n.get(qk.key)(e),r=e.attrs.language,i=r&&r.length>0?{"data-language":r}:void 0;return["pre",{...t.pre,...i},["code",t.code,0]]},parseMarkdown:{match:({type:e})=>e==="code",runner:(e,t,r)=>{const i=t.lang??"",s=t.value;e.openNode(r,{language:i}),s&&e.addText(s),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="code_block",runner:(e,t)=>{var r;e.addNode("code",void 0,((r=t.content.firstChild)==null?void 0:r.text)||"",{lang:t.attrs.language})}}}));te(Ls.node,{displayName:"NodeSchema<codeBlock>",group:"CodeBlock"});te(Ls.ctx,{displayName:"NodeSchemaCtx<codeBlock>",group:"CodeBlock"});const s5=hr(n=>ak(/^```(?<language>[a-z]*)?[\s\n]$/,Ls.type(n),e=>{var t;return{language:((t=e.groups)==null?void 0:t.language)??""}}));te(s5,{displayName:"InputRule<createCodeBlockInputRule>",group:"CodeBlock"});const Uk=et("CreateCodeBlock",n=>(e="")=>nd(Ls.type(n),{language:e}));te(Uk,{displayName:"Command<createCodeBlockCommand>",group:"CodeBlock"});const Fz=et("UpdateCodeBlockLanguage",()=>({pos:n,language:e}={pos:-1,language:""})=>(t,r)=>n>=0?(r==null||r(t.tr.setNodeAttribute(n,"language",e)),!0):!1);te(Fz,{displayName:"Command<updateCodeBlockLanguageCommand>",group:"CodeBlock"});const Kk=Kr("codeBlockKeymap",{CreateCodeBlock:{shortcuts:"Mod-Alt-c",command:n=>{const e=n.get(Be);return()=>e.call(Uk.key)}}});te(Kk.ctx,{displayName:"KeymapCtx<codeBlock>",group:"CodeBlock"});te(Kk.shortcuts,{displayName:"Keymap<codeBlock>",group:"CodeBlock"});const Gk=Yi("image");te(Gk,{displayName:"Attr<image>",group:"Image"});const Ya=vn("image",n=>({inline:!0,group:"inline",selectable:!0,draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:"",validate:"string"},alt:{default:"",validate:"string"},title:{default:"",validate:"string"}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Zi(e);return{src:e.getAttribute("src")||"",alt:e.getAttribute("alt")||"",title:e.getAttribute("title")||e.getAttribute("alt")||""}}}],toDOM:e=>["img",{...n.get(Gk.key)(e),...e.attrs}],parseMarkdown:{match:({type:e})=>e==="image",runner:(e,t,r)=>{const i=t.url,s=t.alt,o=t.title;e.addNode(r,{src:i,alt:s,title:o})}},toMarkdown:{match:e=>e.type.name==="image",runner:(e,t)=>{e.addNode("image",void 0,void 0,{title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}}}));te(Ya.node,{displayName:"NodeSchema<image>",group:"Image"});te(Ya.ctx,{displayName:"NodeSchemaCtx<image>",group:"Image"});const o5=et("InsertImage",n=>(e={})=>(t,r)=>{if(!r)return!0;const{src:i="",alt:s="",title:o=""}=e,l=Ya.type(n).create({src:i,alt:s,title:o});return l&&r(t.tr.replaceSelectionWith(l).scrollIntoView()),!0});te(o5,{displayName:"Command<insertImageCommand>",group:"Image"});const l5=et("UpdateImage",n=>(e={})=>(t,r)=>{const i=LF(t.selection,Ya.type(n));if(!i)return!1;const{node:s,pos:o}=i,l={...s.attrs},{src:a,alt:c,title:u}=e;return a!==void 0&&(l.src=a),c!==void 0&&(l.alt=c),u!==void 0&&(l.title=u),r==null||r(t.tr.setNodeMarkup(o,void 0,l).scrollIntoView()),!0});te(l5,{displayName:"Command<updateImageCommand>",group:"Image"});const jz=hr(n=>new qr(/!\[(?<alt>.*?)]\((?<filename>.*?)\s*(?="|\))"?(?<title>[^"]+)?"?\)/,(e,t,r,i)=>{const[s,o,l="",a]=t;return s?e.tr.replaceWith(r,i,Ya.type(n).create({src:l,alt:o,title:a})):null}));te(jz,{displayName:"InputRule<insertImageInputRule>",group:"Image"});const e0=Yi("hardbreak",n=>({"data-type":"hardbreak","data-is-inline":n.attrs.isInline}));te(e0,{displayName:"Attr<hardbreak>",group:"Hardbreak"});const Ta=vn("hardbreak",n=>({inline:!0,group:"inline",attrs:{isInline:{default:!1,validate:"boolean"}},selectable:!1,parseDOM:[{tag:"br"},{tag:'span[data-type="hardbreak"]',getAttrs:()=>({isInline:!0})}],toDOM:e=>e.attrs.isInline?["span",n.get(e0.key)(e)," "]:["br",n.get(e0.key)(e)],parseMarkdown:{match:({type:e})=>e==="break",runner:(e,t,r)=>{var i;e.addNode(r,{isInline:!!((i=t.data)!=null&&i.isInline)})}},leafText:()=>`
`,toMarkdown:{match:e=>e.type.name==="hardbreak",runner:(e,t)=>{t.attrs.isInline?e.addNode("text",void 0,`
`):e.addNode("break")}}}));te(Ta.node,{displayName:"NodeSchema<hardbreak>",group:"Hardbreak"});te(Ta.ctx,{displayName:"NodeSchemaCtx<hardbreak>",group:"Hardbreak"});const Jk=et("InsertHardbreak",n=>()=>(e,t)=>{var s;const{selection:r,tr:i}=e;if(!(r instanceof ze))return!1;if(r.empty){const o=r.$from.node();if(o.childCount>0&&((s=o.lastChild)==null?void 0:s.type.name)==="hardbreak")return t==null||t(i.replaceRangeWith(r.to-1,r.to,e.schema.node("paragraph")).setSelection(tt.near(i.doc.resolve(r.to))).scrollIntoView()),!0}return t==null||t(i.setMeta("hardbreak",!0).replaceSelectionWith(Ta.type(n).create()).scrollIntoView()),!0});te(Jk,{displayName:"Command<insertHardbreakCommand>",group:"Hardbreak"});const Zk=Kr("hardbreakKeymap",{InsertHardbreak:{shortcuts:"Shift-Enter",command:n=>{const e=n.get(Be);return()=>e.call(Jk.key)}}});te(Zk.ctx,{displayName:"KeymapCtx<hardbreak>",group:"Hardbreak"});te(Zk.shortcuts,{displayName:"Keymap<hardbreak>",group:"Hardbreak"});const Yk=Yi("hr");te(Yk,{displayName:"Attr<hr>",group:"Hr"});const Hu=vn("hr",n=>({group:"block",parseDOM:[{tag:"hr"}],toDOM:e=>["hr",n.get(Yk.key)(e)],parseMarkdown:{match:({type:e})=>e==="thematicBreak",runner:(e,t,r)=>{e.addNode(r)}},toMarkdown:{match:e=>e.type.name==="hr",runner:e=>{e.addNode("thematicBreak")}}}));te(Hu.node,{displayName:"NodeSchema<hr>",group:"Hr"});te(Hu.ctx,{displayName:"NodeSchemaCtx<hr>",group:"Hr"});const a5=hr(n=>new qr(/^(?:---|___\s|\*\*\*\s)$/,(e,t,r,i)=>{const{tr:s}=e;return t[0]&&s.replaceWith(r-1,i,Hu.type(n).create()),s}));te(a5,{displayName:"InputRule<insertHrInputRule>",group:"Hr"});const c5=et("InsertHr",n=>()=>(e,t)=>{if(!t)return!0;const r=Xi.node.type(n).create(),{tr:i,selection:s}=e,{from:o}=s,l=Hu.type(n).create();if(!l)return!0;const a=i.replaceSelectionWith(l).insert(o,r),c=tt.findFrom(a.doc.resolve(o),1,!0);return c&&t(a.setSelection(c).scrollIntoView()),!0});te(c5,{displayName:"Command<insertHrCommand>",group:"Hr"});const Xk=Yi("bulletList");te(Xk,{displayName:"Attr<bulletList>",group:"BulletList"});const Xa=vn("bullet_list",n=>({content:"listItem+",group:"block",attrs:{spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ul",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Zi(e);return{spread:e.dataset.spread==="true"}}}],toDOM:e=>["ul",{...n.get(Xk.key)(e),"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:t})=>e==="list"&&!t,runner:(e,t,r)=>{const i=t.spread!=null?`${t.spread}`:"false";e.openNode(r,{spread:i}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="bullet_list",runner:(e,t)=>{e.openNode("list",void 0,{ordered:!1,spread:t.attrs.spread}).next(t.content).closeNode()}}}));te(Xa.node,{displayName:"NodeSchema<bulletList>",group:"BulletList"});te(Xa.ctx,{displayName:"NodeSchemaCtx<bulletList>",group:"BulletList"});const u5=hr(n=>lk(/^\s*([-+*])\s$/,Xa.type(n)));te(u5,{displayName:"InputRule<wrapInBulletListInputRule>",group:"BulletList"});const Qk=et("WrapInBulletList",n=>()=>dk(Xa.type(n)));te(Qk,{displayName:"Command<wrapInBulletListCommand>",group:"BulletList"});const eC=Kr("bulletListKeymap",{WrapInBulletList:{shortcuts:"Mod-Alt-8",command:n=>{const e=n.get(Be);return()=>e.call(Qk.key)}}});te(eC.ctx,{displayName:"KeymapCtx<bulletListKeymap>",group:"BulletList"});te(eC.shortcuts,{displayName:"Keymap<bulletListKeymap>",group:"BulletList"});const tC=Yi("orderedList");te(tC,{displayName:"Attr<orderedList>",group:"OrderedList"});const Qa=vn("ordered_list",n=>({content:"listItem+",group:"block",attrs:{order:{default:1,validate:"number"},spread:{default:!1,validate:"boolean"}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Zi(e);return{spread:e.dataset.spread,order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:e=>["ol",{...n.get(tC.key)(e),...e.attrs.order===1?{}:e.attrs.order,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:t})=>e==="list"&&!!t,runner:(e,t,r)=>{const i=t.spread!=null?`${t.spread}`:"true";e.openNode(r,{spread:i}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="ordered_list",runner:(e,t)=>{e.openNode("list",void 0,{ordered:!0,start:1,spread:t.attrs.spread==="true"}),e.next(t.content),e.closeNode()}}}));te(Qa.node,{displayName:"NodeSchema<orderedList>",group:"OrderedList"});te(Qa.ctx,{displayName:"NodeSchemaCtx<orderedList>",group:"OrderedList"});const f5=hr(n=>lk(/^\s*(\d+)\.\s$/,Qa.type(n),e=>({order:Number(e[1])}),(e,t)=>t.childCount+t.attrs.order===Number(e[1])));te(f5,{displayName:"InputRule<wrapInOrderedListInputRule>",group:"OrderedList"});const nC=et("WrapInOrderedList",n=>()=>dk(Qa.type(n)));te(nC,{displayName:"Command<wrapInOrderedListCommand>",group:"OrderedList"});const rC=Kr("orderedListKeymap",{WrapInOrderedList:{shortcuts:"Mod-Alt-7",command:n=>{const e=n.get(Be);return()=>e.call(nC.key)}}});te(rC.ctx,{displayName:"KeymapCtx<orderedList>",group:"OrderedList"});te(rC.shortcuts,{displayName:"Keymap<orderedList>",group:"OrderedList"});const iC=Yi("listItem");te(iC,{displayName:"Attr<listItem>",group:"ListItem"});const Qi=vn("list_item",n=>({group:"listItem",content:"paragraph block*",attrs:{label:{default:"",validate:"string"},listType:{default:"bullet",validate:"string"},spread:{default:!0,validate:"boolean"}},defining:!0,parseDOM:[{tag:"li",getAttrs:e=>{if(!(e instanceof HTMLElement))throw Zi(e);return{label:e.dataset.label,listType:e.dataset.listType,spread:e.dataset.spread==="true"}}}],toDOM:e=>["li",{...n.get(iC.key)(e),"data-label":e.attrs.label,"data-list-type":e.attrs.listType,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e})=>e==="listItem",runner:(e,t,r)=>{const i=t.label!=null?`${t.label}.`:"",s=t.label!=null?"ordered":"bullet",o=t.spread!=null?`${t.spread}`:"true";e.openNode(r,{label:i,listType:s,spread:o}),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="list_item",runner:(e,t)=>{e.openNode("listItem",void 0,{spread:t.attrs.spread}),e.next(t.content),e.closeNode()}}}));te(Qi.node,{displayName:"NodeSchema<listItem>",group:"ListItem"});te(Qi.ctx,{displayName:"NodeSchemaCtx<listItem>",group:"ListItem"});const sC=et("SinkListItem",n=>()=>Iz(Qi.type(n)));te(sC,{displayName:"Command<sinkListItemCommand>",group:"ListItem"});const oC=et("LiftListItem",n=>()=>Oz(Qi.type(n)));te(oC,{displayName:"Command<liftListItemCommand>",group:"ListItem"});const lC=et("SplitListItem",n=>()=>Az(Qi.type(n)));te(lC,{displayName:"Command<splitListItemCommand>",group:"ListItem"});function $z(n){return(e,t,r)=>{const{selection:i}=e;if(!(i instanceof ze))return!1;const{empty:s,$from:o}=i;return!s||o.parentOffset!==0||o.node(-1).type!==Qi.type(n)?!1:KL(e,t,r)}}const aC=et("LiftFirstListItem",n=>()=>$z(n));te(aC,{displayName:"Command<liftFirstListItemCommand>",group:"ListItem"});const cC=Kr("listItemKeymap",{NextListItem:{shortcuts:"Enter",command:n=>{const e=n.get(Be);return()=>e.call(lC.key)}},SinkListItem:{shortcuts:["Tab","Mod-]"],command:n=>{const e=n.get(Be);return()=>e.call(sC.key)}},LiftListItem:{shortcuts:["Shift-Tab","Mod-["],command:n=>{const e=n.get(Be);return()=>e.call(oC.key)}},LiftFirstListItem:{shortcuts:["Backspace","Delete"],command:n=>{const e=n.get(Be);return()=>e.call(aC.key)}}});te(cC.ctx,{displayName:"KeymapCtx<listItem>",group:"ListItem"});te(cC.shortcuts,{displayName:"Keymap<listItem>",group:"ListItem"});const h5=Mk("text",()=>({group:"inline",parseMarkdown:{match:({type:n})=>n==="text",runner:(n,e)=>{n.addText(e.value)}},toMarkdown:{match:n=>n.type.name==="text",runner:(n,e)=>{n.addNode("text",void 0,e.text)}}}));te(h5,{displayName:"NodeSchema<text>",group:"Text"});const uC=Yi("html");te(uC,{displayName:"Attr<html>",group:"Html"});const fC=vn("html",n=>({atom:!0,group:"inline",inline:!0,attrs:{value:{default:"",validate:"string"}},toDOM:e=>{const t=document.createElement("span"),r={...n.get(uC.key)(e),"data-value":e.attrs.value,"data-type":"html"};return t.textContent=e.attrs.value,["span",r,e.attrs.value]},parseDOM:[{tag:'span[data-type="html"]',getAttrs:e=>({value:e.dataset.value??""})}],parseMarkdown:{match:({type:e})=>e==="html",runner:(e,t,r)=>{e.addNode(r,{value:t.value})}},toMarkdown:{match:e=>e.type.name==="html",runner:(e,t)=>{e.addNode("html",void 0,t.attrs.value)}}}));te(fC.node,{displayName:"NodeSchema<html>",group:"Html"});te(fC.ctx,{displayName:"NodeSchemaCtx<html>",group:"Html"});const zz=[n5,Pk,Xi,sy,Vk,ri,e0,Ta,$k,Bu,qk,Ls,Yk,Hu,Gk,Ya,Xk,Xa,tC,Qa,iC,Qi,Ak,Za,Lk,Pu,Ik,ho,Rk,zi,uC,fC,h5].flat(),Wz=[i5,u5,f5,s5,a5,r5].flat(),qz=[ZD,YD,QD,XD],pc=et("IsMarkSelected",()=>n=>e=>{if(!n)return!1;const{doc:t,selection:r}=e;return t.rangeHasMark(r.from,r.to,n)}),d5=et("IsNoteSelected",()=>n=>e=>n?VL(e,n).hasNode:!1),qn=et("ClearTextInCurrentBlock",()=>()=>(n,e)=>{let t=n.tr;const{$from:r,$to:i}=t.selection,{pos:s}=r,{pos:o}=i,l=s-r.node().content.size;return l<0?!1:(t=t.deleteRange(l,o),e==null||e(t),!0)}),Gs=et("SetBlockType",()=>n=>(e,t)=>{const{nodeType:r,attrs:i=null}=n??{};if(!r)return!1;const s=e.tr,{from:o,to:l}=s.selection;try{s.setBlockType(o,l,r,i)}catch{return!1}return t==null||t(s),!0}),Pf=et("WrapInBlockType",()=>n=>(e,t)=>{const{nodeType:r,attrs:i=null}=n??{};if(!r)return!1;let s=e.tr;try{const{$from:o,$to:l}=s.selection,a=o.blockRange(l),c=a&&sk(a,r,i);if(!c)return!1;s=s.wrap(a,c)}catch{return!1}return t==null||t(s),!0}),Bf=et("AddBlockType",()=>n=>(e,t)=>{const{nodeType:r,attrs:i=null}=n??{};if(!r)return!1;const s=e.tr;try{const o=r instanceof Ci?r:r.createAndFill(i);if(!o)return!1;s.replaceSelectionWith(o)}catch{return!1}return t==null||t(s),!0}),p5=et("SelectTextNearPos",()=>n=>(e,t)=>{const{pos:r}=n??{};if(r==null)return!1;const i=(o,l,a)=>Math.min(Math.max(o,l),a),s=e.tr;try{const o=e.doc.resolve(i(r,0,e.doc.content.size));s.setSelection(ze.near(o))}catch{return!1}return t==null||t(s.scrollIntoView()),!0}),Uz=[Bk,zk,Uo,Fk,Uk,Jk,c5,o5,l5,nC,Qk,sC,lC,oC,aC,ty,ry,ny,e5,t5,pc,d5,qn,Gs,Pf,Bf,p5],Kz=[Wk,Kk,Zk,jk,cC,rC,eC,Hk,Ok,Nk,Dk].flat(),hC=Rs("remarkAddOrderInList",()=>()=>n=>{Ka(n,"list",e=>{if(e.ordered){const t=e.start??1;e.children.forEach((r,i)=>{r.label=i+t})}})});te(hC.plugin,{displayName:"Remark<remarkAddOrderInListPlugin>",group:"Remark"});te(hC.options,{displayName:"RemarkConfig<remarkAddOrderInListPlugin>",group:"Remark"});const dC=Rs("remarkLineBreak",()=>()=>n=>{const e=/[\t ]*(?:\r?\n|\r)/g;Ka(n,"text",(t,r,i)=>{if(!t.value||typeof t.value!="string")return;const s=[];let o=0;e.lastIndex=0;let l=e.exec(t.value);for(;l;){const c=l.index;o!==c&&s.push({type:"text",value:t.value.slice(o,c)}),s.push({type:"break",data:{isInline:!0}}),o=c+l[0].length,l=e.exec(t.value)}if(s.length>0&&i&&typeof r=="number")return o<t.value.length&&s.push({type:"text",value:t.value.slice(o)}),i.children.splice(r,1,...s),r+s.length})});te(dC.plugin,{displayName:"Remark<remarkLineBreak>",group:"Remark"});te(dC.options,{displayName:"RemarkConfig<remarkLineBreak>",group:"Remark"});const pC=Rs("remarkInlineLink",()=>Rz);te(pC.plugin,{displayName:"Remark<remarkInlineLinkPlugin>",group:"Remark"});te(pC.options,{displayName:"RemarkConfig<remarkInlineLinkPlugin>",group:"Remark"});const Gz=n=>!!n.children,Jz=n=>n.type==="html";function Zz(n,e){return t(n,0,null)[0];function t(r,i,s){if(Gz(r)){const o=[];for(let l=0,a=r.children.length;l<a;l++){const c=r.children[l];if(c){const u=t(c,l,r);if(u)for(let f=0,p=u.length;f<p;f++){const g=u[f];g&&o.push(g)}}}r.children=o}return e(r,i,s)}}const Yz=["root","blockquote","listItem"],mC=Rs("remarkHTMLTransformer",()=>()=>n=>{Zz(n,(e,t,r)=>Jz(e)?(r&&Yz.includes(r.type)&&(e.children=[{...e}],delete e.value,e.type="paragraph"),[e]):[e])});te(mC.plugin,{displayName:"Remark<remarkHtmlTransformer>",group:"Remark"});te(mC.options,{displayName:"RemarkConfig<remarkHtmlTransformer>",group:"Remark"});const gC=Rs("remarkMarker",()=>()=>(n,e)=>{const t=r=>e.value.charAt(r.position.start.offset);Ka(n,r=>["strong","emphasis"].includes(r.type),r=>{r.marker=t(r)})});te(gC.plugin,{displayName:"Remark<remarkMarker>",group:"Remark"});te(gC.options,{displayName:"RemarkConfig<remarkMarker>",group:"Remark"});const m5=An(()=>{let n=!1;const e=new rn("MILKDOWN_INLINE_NODES_CURSOR"),t=new nn({key:e,state:{init(){return!1},apply(r){if(!r.selection.empty)return!1;const i=r.selection.$from,s=i.nodeBefore,o=i.nodeAfter;return!!(s&&o&&s.isInline&&!s.isText&&o.isInline&&!o.isText)}},props:{handleDOMEvents:{compositionend:(r,i)=>n?(n=!1,requestAnimationFrame(()=>{if(t.getState(r.state)){const o=r.state.selection.from;i.preventDefault(),r.dispatch(r.state.tr.insertText(i.data||"",o))}}),!0):!1,compositionstart:r=>(t.getState(r.state)&&(n=!0),!1),beforeinput:(r,i)=>{if(t.getState(r.state)&&i instanceof InputEvent&&i.data&&!n){const o=r.state.selection.from;return i.preventDefault(),r.dispatch(r.state.tr.insertText(i.data||"",o)),!0}return!1}},decorations(r){if(t.getState(r)){const o=r.selection.$from.pos,l=document.createElement("span"),a=Tn.widget(o,l,{side:-1}),c=document.createElement("span"),u=Tn.widget(o,c);return setTimeout(()=>{l.contentEditable="true",c.contentEditable="true"}),Ft.create(r.doc,[a,u])}return Ft.empty}}});return t});te(m5,{displayName:"Prose<inlineNodesCursorPlugin>",group:"Prose"});const g5=An(n=>new nn({key:new rn("MILKDOWN_HARDBREAK_MARKS"),appendTransaction:(e,t,r)=>{if(!e.length)return;const[i]=e;if(!i)return;const[s]=i.steps;if(i.getMeta("hardbreak")){if(!(s instanceof Pn))return;const{from:a}=s;return r.tr.setNodeMarkup(a,Ta.type(n),void 0,[])}if(s instanceof uo){let a=r.tr;const{from:c,to:u}=s;return r.doc.nodesBetween(c,u,(f,p)=>{f.type===Ta.type(n)&&(a=a.setNodeMarkup(p,Ta.type(n),void 0,[]))}),a}}}));te(g5,{displayName:"Prose<hardbreakClearMarkPlugin>",group:"Prose"});const yC=It(["table","code_block"],"hardbreakFilterNodes");te(yC,{displayName:"Ctx<hardbreakFilterNodes>",group:"Prose"});const y5=An(n=>{const e=n.get(yC.key);return new nn({key:new rn("MILKDOWN_HARDBREAK_FILTER"),filterTransaction:(t,r)=>{const i=t.getMeta("hardbreak"),[s]=t.steps;if(i&&s){const{from:o}=s,l=r.doc.resolve(o);let a=l.depth,c=!0;for(;a>0;)e.includes(l.node(a).type.name)&&(c=!1),a--;return c}return!0}})});te(y5,{displayName:"Prose<hardbreakFilterPlugin>",group:"Prose"});const b5=An(n=>{const e=new rn("MILKDOWN_HEADING_ID"),t=r=>{if(r.composing)return;const i=n.get(sy.key),s=r.state.tr.setMeta("addToHistory",!1);let o=!1;const l={};r.state.doc.descendants((a,c)=>{if(a.type===ri.type(n)){if(a.textContent.trim().length===0)return;const u=a.attrs;let f=i(a);l[f]?(l[f]+=1,f+=`-#${l[f]}`):l[f]=1,u.id!==f&&(o=!0,s.setMeta(e,!0).setNodeMarkup(c,void 0,{...u,id:f}))}}),o&&r.dispatch(s)};return new nn({key:e,view:r=>(t(r),{update:(i,s)=>{i.state.doc.eq(s.doc)||t(i)}})})});te(b5,{displayName:"Prose<syncHeadingIdPlugin>",group:"Prose"});const w5=An(n=>{const e=(t,r,i)=>{if(!i.selection||t.some(f=>f.getMeta("addToHistory")===!1||!f.isGeneric))return null;const s=Qa.type(n),o=Xa.type(n),l=Qi.type(n),a=(f,p)=>{let g=!1;const y=`${p+1}.`;return f.label!==y&&(f.label=y,g=!0),g};let c=i.tr,u=!1;return i.doc.descendants((f,p,g,y)=>{if(f.type===o){const v=f.maybeChild(0);(v==null?void 0:v.type)===l&&v.attrs.listType==="ordered"&&(u=!0,c.setNodeMarkup(p,s,{spread:"true"}),f.descendants((k,x,_,M)=>{if(k.type===l){const T={...k.attrs};a(T,M)&&(c=c.setNodeMarkup(x,void 0,T))}return!1}))}else if(f.type===l&&(g==null?void 0:g.type)===s){const v={...f.attrs};let k=!1;v.listType!=="ordered"&&(v.listType="ordered",k=!0),(g==null?void 0:g.maybeChild(0))&&(k=a(v,y)),k&&(c=c.setNodeMarkup(p,void 0,v),u=!0)}}),u?c.setMeta("addToHistory",!1):null};return new nn({key:new rn("MILKDOWN_KEEP_LIST_ORDER"),appendTransaction:e})});te(w5,{displayName:"Prose<syncListOrderPlugin>",group:"Prose"});const Xz=[g5,yC,y5,m5,hC,pC,dC,mC,gC,iy,b5,w5].flat(),Qz=[zz,Wz,qz,Uz,Kz,Xz].flat();/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function bC(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Kt={},Sh=[],Wi=()=>{},v5=()=>!1,oy=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),wC=n=>n.startsWith("onUpdate:"),Vn=Object.assign,vC=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},eW=Object.prototype.hasOwnProperty,At=(n,e)=>eW.call(n,e),lt=Array.isArray,xh=n=>ly(n)==="[object Map]",tW=n=>ly(n)==="[object Set]",at=n=>typeof n=="function",Fn=n=>typeof n=="string",Vu=n=>typeof n=="symbol",mn=n=>n!==null&&typeof n=="object",k5=n=>(mn(n)||at(n))&&at(n.then)&&at(n.catch),nW=Object.prototype.toString,ly=n=>nW.call(n),rW=n=>ly(n).slice(8,-1),iW=n=>ly(n)==="[object Object]",kC=n=>Fn(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,_h=bC(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ay=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},sW=/-\w/g,kl=ay(n=>n.replace(sW,e=>e.slice(1).toUpperCase())),oW=/\B([A-Z])/g,ec=ay(n=>n.replace(oW,"-$1").toLowerCase()),C5=ay(n=>n.charAt(0).toUpperCase()+n.slice(1)),V1=ay(n=>n?`on${C5(n)}`:""),hl=(n,e)=>!Object.is(n,e),F1=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},t0=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},lW=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let pT;const Ea=()=>pT||(pT=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function CC(n){if(lt(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],i=Fn(r)?fW(r):CC(r);if(i)for(const s in i)e[s]=i[s]}return e}else if(Fn(n)||mn(n))return n}const aW=/;(?![^(]*\))/g,cW=/:([^]+)/,uW=/\/\*[^]*?\*\//g;function fW(n){const e={};return n.replace(uW,"").split(aW).forEach(t=>{if(t){const r=t.split(cW);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function SC(n){let e="";if(Fn(n))e=n;else if(lt(n))for(let t=0;t<n.length;t++){const r=SC(n[t]);r&&(e+=r+" ")}else if(mn(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const hW="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",dW=bC(hW);function S5(n){return!!n||n===""}/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Hr;class pW{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Hr,!e&&Hr&&(this.index=(Hr.scopes||(Hr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Hr;try{return Hr=this,e()}finally{Hr=t}}}on(){++this._on===1&&(this.prevScope=Hr,Hr=this)}off(){this._on>0&&--this._on===0&&(Hr=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function mW(){return Hr}let Ut;const j1=new WeakSet;class x5{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Hr&&Hr.active&&Hr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,j1.has(this)&&(j1.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||M5(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,mT(this),T5(this);const e=Ut,t=qi;Ut=this,qi=!0;try{return this.fn()}finally{E5(this),Ut=e,qi=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)MC(e);this.deps=this.depsTail=void 0,mT(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?j1.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){$w(this)&&this.run()}get dirty(){return $w(this)}}let _5=0,Mh,Th;function M5(n,e=!1){if(n.flags|=8,e){n.next=Th,Th=n;return}n.next=Mh,Mh=n}function xC(){_5++}function _C(){if(--_5>0)return;if(Th){let e=Th;for(Th=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;Mh;){let e=Mh;for(Mh=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function T5(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function E5(n){let e,t=n.depsTail,r=t;for(;r;){const i=r.prevDep;r.version===-1?(r===t&&(t=i),MC(r),gW(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}n.deps=e,n.depsTail=t}function $w(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(A5(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function A5(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===fd)||(n.globalVersion=fd,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!$w(n))))return;n.flags|=2;const e=n.dep,t=Ut,r=qi;Ut=n,qi=!0;try{T5(n);const i=n.fn(n._value);(e.version===0||hl(i,n._value))&&(n.flags|=128,n._value=i,e.version++)}catch(i){throw e.version++,i}finally{Ut=t,qi=r,E5(n),n.flags&=-3}}function MC(n,e=!1){const{dep:t,prevSub:r,nextSub:i}=n;if(r&&(r.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)MC(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function gW(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let qi=!0;const O5=[];function Co(){O5.push(qi),qi=!1}function So(){const n=O5.pop();qi=n===void 0?!0:n}function mT(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Ut;Ut=void 0;try{e()}finally{Ut=t}}}let fd=0;class yW{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class TC{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Ut||!qi||Ut===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Ut)t=this.activeLink=new yW(Ut,this),Ut.deps?(t.prevDep=Ut.depsTail,Ut.depsTail.nextDep=t,Ut.depsTail=t):Ut.deps=Ut.depsTail=t,L5(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=Ut.depsTail,t.nextDep=void 0,Ut.depsTail.nextDep=t,Ut.depsTail=t,Ut.deps===t&&(Ut.deps=r)}return t}trigger(e){this.version++,fd++,this.notify(e)}notify(e){xC();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{_C()}}}function L5(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)L5(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const zw=new WeakMap,Aa=Symbol(""),Ww=Symbol(""),hd=Symbol("");function sr(n,e,t){if(qi&&Ut){let r=zw.get(n);r||zw.set(n,r=new Map);let i=r.get(t);i||(r.set(t,i=new TC),i.map=r,i.key=t),i.track()}}function co(n,e,t,r,i,s){const o=zw.get(n);if(!o){fd++;return}const l=a=>{a&&a.trigger()};if(xC(),e==="clear")o.forEach(l);else{const a=lt(n),c=a&&kC(t);if(a&&t==="length"){const u=Number(r);o.forEach((f,p)=>{(p==="length"||p===hd||!Vu(p)&&p>=u)&&l(f)})}else switch((t!==void 0||o.has(void 0))&&l(o.get(t)),c&&l(o.get(hd)),e){case"add":a?c&&l(o.get("length")):(l(o.get(Aa)),xh(n)&&l(o.get(Ww)));break;case"delete":a||(l(o.get(Aa)),xh(n)&&l(o.get(Ww)));break;case"set":xh(n)&&l(o.get(Aa));break}}_C()}function ac(n){const e=Et(n);return e===n?e:(sr(e,"iterate",hd),Ui(n)?e:e.map(vr))}function EC(n){return sr(n=Et(n),"iterate",hd),n}const bW={__proto__:null,[Symbol.iterator](){return $1(this,Symbol.iterator,vr)},concat(...n){return ac(this).concat(...n.map(e=>lt(e)?ac(e):e))},entries(){return $1(this,"entries",n=>(n[1]=vr(n[1]),n))},every(n,e){return qs(this,"every",n,e,void 0,arguments)},filter(n,e){return qs(this,"filter",n,e,t=>t.map(vr),arguments)},find(n,e){return qs(this,"find",n,e,vr,arguments)},findIndex(n,e){return qs(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return qs(this,"findLast",n,e,vr,arguments)},findLastIndex(n,e){return qs(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return qs(this,"forEach",n,e,void 0,arguments)},includes(...n){return z1(this,"includes",n)},indexOf(...n){return z1(this,"indexOf",n)},join(n){return ac(this).join(n)},lastIndexOf(...n){return z1(this,"lastIndexOf",n)},map(n,e){return qs(this,"map",n,e,void 0,arguments)},pop(){return af(this,"pop")},push(...n){return af(this,"push",n)},reduce(n,...e){return gT(this,"reduce",n,e)},reduceRight(n,...e){return gT(this,"reduceRight",n,e)},shift(){return af(this,"shift")},some(n,e){return qs(this,"some",n,e,void 0,arguments)},splice(...n){return af(this,"splice",n)},toReversed(){return ac(this).toReversed()},toSorted(n){return ac(this).toSorted(n)},toSpliced(...n){return ac(this).toSpliced(...n)},unshift(...n){return af(this,"unshift",n)},values(){return $1(this,"values",vr)}};function $1(n,e,t){const r=EC(n),i=r[e]();return r!==n&&!Ui(n)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.done||(s.value=t(s.value)),s}),i}const wW=Array.prototype;function qs(n,e,t,r,i,s){const o=EC(n),l=o!==n&&!Ui(n),a=o[e];if(a!==wW[e]){const f=a.apply(n,s);return l?vr(f):f}let c=t;o!==n&&(l?c=function(f,p){return t.call(this,vr(f),p,n)}:t.length>2&&(c=function(f,p){return t.call(this,f,p,n)}));const u=a.call(o,c,r);return l&&i?i(u):u}function gT(n,e,t,r){const i=EC(n);let s=t;return i!==n&&(Ui(n)?t.length>3&&(s=function(o,l,a){return t.call(this,o,l,a,n)}):s=function(o,l,a){return t.call(this,o,vr(l),a,n)}),i[e](s,...r)}function z1(n,e,t){const r=Et(n);sr(r,"iterate",hd);const i=r[e](...t);return(i===-1||i===!1)&&DC(t[0])?(t[0]=Et(t[0]),r[e](...t)):i}function af(n,e,t=[]){Co(),xC();const r=Et(n)[e].apply(n,t);return _C(),So(),r}const vW=bC("__proto__,__v_isRef,__isVue"),D5=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Vu));function kW(n){Vu(n)||(n=String(n));const e=Et(this);return sr(e,"has",n),e.hasOwnProperty(n)}class I5{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return r===(i?s?LW:B5:s?P5:R5).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=lt(e);if(!i){let a;if(o&&(a=bW[t]))return a;if(t==="hasOwnProperty")return kW}const l=Reflect.get(e,t,ur(e)?e:r);if((Vu(t)?D5.has(t):vW(t))||(i||sr(e,"get",t),s))return l;if(ur(l)){const a=o&&kC(t)?l:l.value;return i&&mn(a)?Uw(a):a}return mn(l)?i?Uw(l):OC(l):l}}class N5 extends I5{constructor(e=!1){super(!1,e)}set(e,t,r,i){let s=e[t];if(!this._isShallow){const a=Wa(s);if(!Ui(r)&&!Wa(r)&&(s=Et(s),r=Et(r)),!lt(e)&&ur(s)&&!ur(r))return a||(s.value=r),!0}const o=lt(e)&&kC(t)?Number(t)<e.length:At(e,t),l=Reflect.set(e,t,r,ur(e)?e:i);return e===Et(i)&&(o?hl(r,s)&&co(e,"set",t,r):co(e,"add",t,r)),l}deleteProperty(e,t){const r=At(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&r&&co(e,"delete",t,void 0),i}has(e,t){const r=Reflect.has(e,t);return(!Vu(t)||!D5.has(t))&&sr(e,"has",t),r}ownKeys(e){return sr(e,"iterate",lt(e)?"length":Aa),Reflect.ownKeys(e)}}class CW extends I5{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const SW=new N5,xW=new CW,_W=new N5(!0);const qw=n=>n,om=n=>Reflect.getPrototypeOf(n);function MW(n,e,t){return function(...r){const i=this.__v_raw,s=Et(i),o=xh(s),l=n==="entries"||n===Symbol.iterator&&o,a=n==="keys"&&o,c=i[n](...r),u=t?qw:e?Kw:vr;return!e&&sr(s,"iterate",a?Ww:Aa),{next(){const{value:f,done:p}=c.next();return p?{value:f,done:p}:{value:l?[u(f[0]),u(f[1])]:u(f),done:p}},[Symbol.iterator](){return this}}}}function lm(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function TW(n,e){const t={get(i){const s=this.__v_raw,o=Et(s),l=Et(i);n||(hl(i,l)&&sr(o,"get",i),sr(o,"get",l));const{has:a}=om(o),c=e?qw:n?Kw:vr;if(a.call(o,i))return c(s.get(i));if(a.call(o,l))return c(s.get(l));s!==o&&s.get(i)},get size(){const i=this.__v_raw;return!n&&sr(Et(i),"iterate",Aa),i.size},has(i){const s=this.__v_raw,o=Et(s),l=Et(i);return n||(hl(i,l)&&sr(o,"has",i),sr(o,"has",l)),i===l?s.has(i):s.has(i)||s.has(l)},forEach(i,s){const o=this,l=o.__v_raw,a=Et(l),c=e?qw:n?Kw:vr;return!n&&sr(a,"iterate",Aa),l.forEach((u,f)=>i.call(s,c(u),c(f),o))}};return Vn(t,n?{add:lm("add"),set:lm("set"),delete:lm("delete"),clear:lm("clear")}:{add(i){!e&&!Ui(i)&&!Wa(i)&&(i=Et(i));const s=Et(this);return om(s).has.call(s,i)||(s.add(i),co(s,"add",i,i)),this},set(i,s){!e&&!Ui(s)&&!Wa(s)&&(s=Et(s));const o=Et(this),{has:l,get:a}=om(o);let c=l.call(o,i);c||(i=Et(i),c=l.call(o,i));const u=a.call(o,i);return o.set(i,s),c?hl(s,u)&&co(o,"set",i,s):co(o,"add",i,s),this},delete(i){const s=Et(this),{has:o,get:l}=om(s);let a=o.call(s,i);a||(i=Et(i),a=o.call(s,i)),l&&l.call(s,i);const c=s.delete(i);return a&&co(s,"delete",i,void 0),c},clear(){const i=Et(this),s=i.size!==0,o=i.clear();return s&&co(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=MW(i,n,e)}),t}function AC(n,e){const t=TW(n,e);return(r,i,s)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(At(t,i)&&i in r?t:r,i,s)}const EW={get:AC(!1,!1)},AW={get:AC(!1,!0)},OW={get:AC(!0,!1)};const R5=new WeakMap,P5=new WeakMap,B5=new WeakMap,LW=new WeakMap;function DW(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function IW(n){return n.__v_skip||!Object.isExtensible(n)?0:DW(rW(n))}function OC(n){return Wa(n)?n:LC(n,!1,SW,EW,R5)}function NW(n){return LC(n,!1,_W,AW,P5)}function Uw(n){return LC(n,!0,xW,OW,B5)}function LC(n,e,t,r,i){if(!mn(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=IW(n);if(s===0)return n;const o=i.get(n);if(o)return o;const l=new Proxy(n,s===2?r:t);return i.set(n,l),l}function Eh(n){return Wa(n)?Eh(n.__v_raw):!!(n&&n.__v_isReactive)}function Wa(n){return!!(n&&n.__v_isReadonly)}function Ui(n){return!!(n&&n.__v_isShallow)}function DC(n){return n?!!n.__v_raw:!1}function Et(n){const e=n&&n.__v_raw;return e?Et(e):n}function RW(n){return!At(n,"__v_skip")&&Object.isExtensible(n)&&t0(n,"__v_skip",!0),n}const vr=n=>mn(n)?OC(n):n,Kw=n=>mn(n)?Uw(n):n;function ur(n){return n?n.__v_isRef===!0:!1}function Ve(n){return H5(n,!1)}function n0(n){return H5(n,!0)}function H5(n,e){return ur(n)?n:new PW(n,e)}class PW{constructor(e,t){this.dep=new TC,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Et(e),this._value=t?e:vr(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||Ui(e)||Wa(e);e=r?e:Et(e),hl(e,t)&&(this._rawValue=e,this._value=r?e:vr(e),this.dep.trigger())}}function BW(n){return ur(n)?n.value:n}const HW={get:(n,e,t)=>e==="__v_raw"?n:BW(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const i=n[e];return ur(i)&&!ur(t)?(i.value=t,!0):Reflect.set(n,e,t,r)}};function V5(n){return Eh(n)?n:new Proxy(n,HW)}class VW{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new TC(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=fd-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Ut!==this)return M5(this,!0),!0}get value(){const e=this.dep.track();return A5(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function FW(n,e,t=!1){let r,i;return at(n)?r=n:(r=n.get,i=n.set),new VW(r,i,t)}const am={},r0=new WeakMap;let Kl;function jW(n,e=!1,t=Kl){if(t){let r=r0.get(t);r||r0.set(t,r=[]),r.push(n)}}function $W(n,e,t=Kt){const{immediate:r,deep:i,once:s,scheduler:o,augmentJob:l,call:a}=t,c=T=>i?T:Ui(T)||i===!1||i===0?Xo(T,1):Xo(T);let u,f,p,g,y=!1,v=!1;if(ur(n)?(f=()=>n.value,y=Ui(n)):Eh(n)?(f=()=>c(n),y=!0):lt(n)?(v=!0,y=n.some(T=>Eh(T)||Ui(T)),f=()=>n.map(T=>{if(ur(T))return T.value;if(Eh(T))return c(T);if(at(T))return a?a(T,2):T()})):at(n)?e?f=a?()=>a(n,2):n:f=()=>{if(p){Co();try{p()}finally{So()}}const T=Kl;Kl=u;try{return a?a(n,3,[g]):n(g)}finally{Kl=T}}:f=Wi,e&&i){const T=f,S=i===!0?1/0:i;f=()=>Xo(T(),S)}const k=mW(),x=()=>{u.stop(),k&&k.active&&vC(k.effects,u)};if(s&&e){const T=e;e=(...S)=>{T(...S),x()}}let _=v?new Array(n.length).fill(am):am;const M=T=>{if(!(!(u.flags&1)||!u.dirty&&!T))if(e){const S=u.run();if(i||y||(v?S.some((A,I)=>hl(A,_[I])):hl(S,_))){p&&p();const A=Kl;Kl=u;try{const I=[S,_===am?void 0:v&&_[0]===am?[]:_,g];_=S,a?a(e,3,I):e(...I)}finally{Kl=A}}}else u.run()};return l&&l(M),u=new x5(f),u.scheduler=o?()=>o(M,!1):M,g=T=>jW(T,!1,u),p=u.onStop=()=>{const T=r0.get(u);if(T){if(a)a(T,4);else for(const S of T)S();r0.delete(u)}},e?r?M(!0):_=u.run():o?o(M.bind(null,!0),!0):u.run(),x.pause=u.pause.bind(u),x.resume=u.resume.bind(u),x.stop=x,x}function Xo(n,e=1/0,t){if(e<=0||!mn(n)||n.__v_skip||(t=t||new Map,(t.get(n)||0)>=e))return n;if(t.set(n,e),e--,ur(n))Xo(n.value,e,t);else if(lt(n))for(let r=0;r<n.length;r++)Xo(n[r],e,t);else if(tW(n)||xh(n))n.forEach(r=>{Xo(r,e,t)});else if(iW(n)){for(const r in n)Xo(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&Xo(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function cp(n,e,t,r){try{return r?n(...r):n()}catch(i){cy(i,e,t)}}function Ds(n,e,t,r){if(at(n)){const i=cp(n,e,t,r);return i&&k5(i)&&i.catch(s=>{cy(s,e,t)}),i}if(lt(n)){const i=[];for(let s=0;s<n.length;s++)i.push(Ds(n[s],e,t,r));return i}}function cy(n,e,t,r=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Kt;if(e){let l=e.parent;const a=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;l;){const u=l.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](n,a,c)===!1)return}l=l.parent}if(s){Co(),cp(s,null,10,[n,a,c]),So();return}}zW(n,t,i,r,o)}function zW(n,e,t,r=!0,i=!1){if(i)throw n;console.error(n)}const kr=[];let ms=-1;const Dc=[];let Ko=null,mc=0;const F5=Promise.resolve();let i0=null;function WW(n){const e=i0||F5;return n?e.then(this?n.bind(this):n):e}function qW(n){let e=ms+1,t=kr.length;for(;e<t;){const r=e+t>>>1,i=kr[r],s=dd(i);s<n||s===n&&i.flags&2?e=r+1:t=r}return e}function IC(n){if(!(n.flags&1)){const e=dd(n),t=kr[kr.length-1];!t||!(n.flags&2)&&e>=dd(t)?kr.push(n):kr.splice(qW(e),0,n),n.flags|=1,j5()}}function j5(){i0||(i0=F5.then(z5))}function UW(n){lt(n)?Dc.push(...n):Ko&&n.id===-1?Ko.splice(mc+1,0,n):n.flags&1||(Dc.push(n),n.flags|=1),j5()}function yT(n,e,t=ms+1){for(;t<kr.length;t++){const r=kr[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;kr.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function $5(n){if(Dc.length){const e=[...new Set(Dc)].sort((t,r)=>dd(t)-dd(r));if(Dc.length=0,Ko){Ko.push(...e);return}for(Ko=e,mc=0;mc<Ko.length;mc++){const t=Ko[mc];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Ko=null,mc=0}}const dd=n=>n.id==null?n.flags&2?-1:1/0:n.id;function z5(n){try{for(ms=0;ms<kr.length;ms++){const e=kr[ms];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),cp(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ms<kr.length;ms++){const e=kr[ms];e&&(e.flags&=-2)}ms=-1,kr.length=0,$5(),i0=null,(kr.length||Dc.length)&&z5()}}let vs,Hf=[],Gw=!1;function uy(n,...e){vs?vs.emit(n,...e):Gw||Hf.push({event:n,args:e})}function W5(n,e){var t,r;vs=n,vs?(vs.enabled=!0,Hf.forEach(({event:i,args:s})=>vs.emit(i,...s)),Hf=[]):typeof window<"u"&&window.HTMLElement&&!((r=(t=window.navigator)==null?void 0:t.userAgent)!=null&&r.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(s=>{W5(s,e)}),setTimeout(()=>{vs||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Gw=!0,Hf=[])},3e3)):(Gw=!0,Hf=[])}function KW(n,e){uy("app:init",n,e,{Fragment:Zn,Text:hp,Comment:qa,Static:tg})}function GW(n){uy("app:unmount",n)}const JW=NC("component:added"),q5=NC("component:updated"),ZW=NC("component:removed"),YW=n=>{vs&&typeof vs.cleanupBuffer=="function"&&!vs.cleanupBuffer(n)&&ZW(n)};function NC(n){return e=>{uy(n,e.appContext.app,e.uid,e.parent?e.parent.uid:void 0,e)}}function XW(n,e,t){uy("component:emit",n.appContext.app,n,e,t)}let xs=null,U5=null;function s0(n){const e=xs;return xs=n,U5=n&&n.type.__scopeId||null,e}function QW(n,e=xs,t){if(!e||n._n)return n;const r=(...i)=>{r._d&&a0(-1);const s=s0(e);let o;try{o=n(...i)}finally{s0(s),r._d&&a0(1)}return __VUE_PROD_DEVTOOLS__&&q5(e),o};return r._n=!0,r._c=!0,r._d=!0,r}function Vl(n,e,t,r){const i=n.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const l=i[o];s&&(l.oldValue=s[o].value);let a=l.dir[r];a&&(Co(),Ds(a,t,8,[n.el,l,n,e]),So())}}const eq=Symbol("_vte"),tq=n=>n.__isTeleport,nq=Symbol("_leaveCb");function RC(n,e){n.shapeFlag&6&&n.component?(n.transition=e,RC(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function tr(n,e){return at(n)?Vn({name:n.name},e,{setup:n}):n}function K5(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}const o0=new WeakMap;function Ah(n,e,t,r,i=!1){if(lt(n)){n.forEach((y,v)=>Ah(y,e&&(lt(e)?e[v]:e),t,r,i));return}if(Oh(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Ah(n,e,t,r.component.subTree);return}const s=r.shapeFlag&4?$C(r.component):r.el,o=i?null:s,{i:l,r:a}=n,c=e&&e.r,u=l.refs===Kt?l.refs={}:l.refs,f=l.setupState,p=Et(f),g=f===Kt?v5:y=>At(p,y);if(c!=null&&c!==a){if(bT(e),Fn(c))u[c]=null,g(c)&&(f[c]=null);else if(ur(c)){c.value=null;const y=e;y.k&&(u[y.k]=null)}}if(at(a))cp(a,l,12,[o,u]);else{const y=Fn(a),v=ur(a);if(y||v){const k=()=>{if(n.f){const x=y?g(a)?f[a]:u[a]:a.value;if(i)lt(x)&&vC(x,s);else if(lt(x))x.includes(s)||x.push(s);else if(y)u[a]=[s],g(a)&&(f[a]=u[a]);else{const _=[s];a.value=_,n.k&&(u[n.k]=_)}}else y?(u[a]=o,g(a)&&(f[a]=o)):v&&(a.value=o,n.k&&(u[n.k]=o))};if(o){const x=()=>{k(),o0.delete(n)};x.id=-1,o0.set(n,x),ei(x,t)}else bT(n),k()}}}function bT(n){const e=o0.get(n);e&&(e.flags|=8,o0.delete(n))}Ea().requestIdleCallback;Ea().cancelIdleCallback;const Oh=n=>!!n.type.__asyncLoader,G5=n=>n.type.__isKeepAlive;function rq(n,e){J5(n,"a",e)}function iq(n,e){J5(n,"da",e)}function J5(n,e,t=Cr){const r=n.__wdc||(n.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(fy(e,r,t),t){let i=t.parent;for(;i&&i.parent;)G5(i.parent.vnode)&&sq(r,e,t,i),i=i.parent}}function sq(n,e,t,r){const i=fy(e,n,r,!0);fp(()=>{vC(r[e],i)},t)}function fy(n,e,t=Cr,r=!1){if(t){const i=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{Co();const l=dp(t),a=Ds(e,t,n,o);return l(),So(),a});return r?i.unshift(s):i.push(s),s}}const Ao=n=>(e,t=Cr)=>{(!pd||n==="sp")&&fy(n,(...r)=>e(...r),t)},oq=Ao("bm"),up=Ao("m"),lq=Ao("bu"),aq=Ao("u"),cq=Ao("bum"),fp=Ao("um"),uq=Ao("sp"),fq=Ao("rtg"),hq=Ao("rtc");function dq(n,e=Cr){fy("ec",n,e)}const pq=Symbol.for("v-ndc"),Jw=n=>n?hI(n)?$C(n):Jw(n.parent):null,Lh=Vn(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Jw(n.parent),$root:n=>Jw(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>__VUE_OPTIONS_API__?PC(n):n.type,$forceUpdate:n=>n.f||(n.f=()=>{IC(n.update)}),$nextTick:n=>n.n||(n.n=WW.bind(n.proxy)),$watch:n=>__VUE_OPTIONS_API__?Bq.bind(n):Wi}),W1=(n,e)=>n!==Kt&&!n.__isScriptSetup&&At(n,e),mq={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:i,props:s,accessCache:o,type:l,appContext:a}=n;let c;if(e[0]!=="$"){const g=o[e];if(g!==void 0)switch(g){case 1:return r[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(W1(r,e))return o[e]=1,r[e];if(i!==Kt&&At(i,e))return o[e]=2,i[e];if((c=n.propsOptions[0])&&At(c,e))return o[e]=3,s[e];if(t!==Kt&&At(t,e))return o[e]=4,t[e];(!__VUE_OPTIONS_API__||Zw)&&(o[e]=0)}}const u=Lh[e];let f,p;if(u)return e==="$attrs"&&sr(n.attrs,"get",""),u(n);if((f=l.__cssModules)&&(f=f[e]))return f;if(t!==Kt&&At(t,e))return o[e]=4,t[e];if(p=a.config.globalProperties,At(p,e))return p[e]},set({_:n},e,t){const{data:r,setupState:i,ctx:s}=n;return W1(i,e)?(i[e]=t,!0):r!==Kt&&At(r,e)?(r[e]=t,!0):At(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:i,propsOptions:s,type:o}},l){let a,c;return!!(t[l]||n!==Kt&&l[0]!=="$"&&At(n,l)||W1(e,l)||(a=s[0])&&At(a,l)||At(r,l)||At(Lh,l)||At(i.config.globalProperties,l)||(c=o.__cssModules)&&c[l])},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:At(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function wT(n){return lt(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Zw=!0;function gq(n){const e=PC(n),t=n.proxy,r=n.ctx;Zw=!1,e.beforeCreate&&vT(e.beforeCreate,n,"bc");const{data:i,computed:s,methods:o,watch:l,provide:a,inject:c,created:u,beforeMount:f,mounted:p,beforeUpdate:g,updated:y,activated:v,deactivated:k,beforeDestroy:x,beforeUnmount:_,destroyed:M,unmounted:T,render:S,renderTracked:A,renderTriggered:I,errorCaptured:B,serverPrefetch:R,expose:K,inheritAttrs:U,components:z,directives:oe,filters:ne}=e;if(c&&yq(c,r,null),o)for(const Se in o){const Te=o[Se];at(Te)&&(r[Se]=Te.bind(t))}if(i){const Se=i.call(t,t);mn(Se)&&(n.data=OC(Se))}if(Zw=!0,s)for(const Se in s){const Te=s[Se],Ge=at(Te)?Te.bind(t,t):at(Te.get)?Te.get.bind(t,t):Wi,Xe=!at(Te)&&at(Te.set)?Te.set.bind(t):Wi,He=Cu({get:Ge,set:Xe});Object.defineProperty(r,Se,{enumerable:!0,configurable:!0,get:()=>He.value,set:j=>He.value=j})}if(l)for(const Se in l)Z5(l[Se],r,t,Se);if(a){const Se=at(a)?a.call(t):a;Reflect.ownKeys(Se).forEach(Te=>{Sq(Te,Se[Te])})}u&&vT(u,n,"c");function ke(Se,Te){lt(Te)?Te.forEach(Ge=>Se(Ge.bind(t))):Te&&Se(Te.bind(t))}if(ke(oq,f),ke(up,p),ke(lq,g),ke(aq,y),ke(rq,v),ke(iq,k),ke(dq,B),ke(hq,A),ke(fq,I),ke(cq,_),ke(fp,T),ke(uq,R),lt(K))if(K.length){const Se=n.exposed||(n.exposed={});K.forEach(Te=>{Object.defineProperty(Se,Te,{get:()=>t[Te],set:Ge=>t[Te]=Ge,enumerable:!0})})}else n.exposed||(n.exposed={});S&&n.render===Wi&&(n.render=S),U!=null&&(n.inheritAttrs=U),z&&(n.components=z),oe&&(n.directives=oe),R&&K5(n)}function yq(n,e,t=Wi){lt(n)&&(n=Yw(n));for(const r in n){const i=n[r];let s;mn(i)?"default"in i?s=eg(i.from||r,i.default,!0):s=eg(i.from||r):s=eg(i),ur(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[r]=s}}function vT(n,e,t){Ds(lt(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function Z5(n,e,t,r){let i=r.includes(".")?aI(t,r):()=>t[r];if(Fn(n)){const s=e[n];at(s)&&Oa(i,s)}else if(at(n))Oa(i,n.bind(t));else if(mn(n))if(lt(n))n.forEach(s=>Z5(s,e,t,r));else{const s=at(n.handler)?n.handler.bind(t):e[n.handler];at(s)&&Oa(i,s,n)}}function PC(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,l=s.get(e);let a;return l?a=l:!i.length&&!t&&!r?a=e:(a={},i.length&&i.forEach(c=>l0(a,c,o,!0)),l0(a,e,o)),mn(e)&&s.set(e,a),a}function l0(n,e,t,r=!1){const{mixins:i,extends:s}=e;s&&l0(n,s,t,!0),i&&i.forEach(o=>l0(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const l=bq[o]||t&&t[o];n[o]=l?l(n[o],e[o]):e[o]}return n}const bq={data:kT,props:CT,emits:CT,methods:Vf,computed:Vf,beforeCreate:br,created:br,beforeMount:br,mounted:br,beforeUpdate:br,updated:br,beforeDestroy:br,beforeUnmount:br,destroyed:br,unmounted:br,activated:br,deactivated:br,errorCaptured:br,serverPrefetch:br,components:Vf,directives:Vf,watch:vq,provide:kT,inject:wq};function kT(n,e){return e?n?function(){return Vn(at(n)?n.call(this,this):n,at(e)?e.call(this,this):e)}:e:n}function wq(n,e){return Vf(Yw(n),Yw(e))}function Yw(n){if(lt(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function br(n,e){return n?[...new Set([].concat(n,e))]:e}function Vf(n,e){return n?Vn(Object.create(null),n,e):e}function CT(n,e){return n?lt(n)&&lt(e)?[...new Set([...n,...e])]:Vn(Object.create(null),wT(n),wT(e??{})):e}function vq(n,e){if(!n)return e;if(!e)return n;const t=Vn(Object.create(null),n);for(const r in e)t[r]=br(n[r],e[r]);return t}function Y5(){return{app:null,config:{isNativeTag:v5,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let kq=0;function Cq(n,e){return function(r,i=null){at(r)||(r=Vn({},r)),i!=null&&!mn(i)&&(i=null);const s=Y5(),o=new WeakSet,l=[];let a=!1;const c=s.app={_uid:kq++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:AT,get config(){return s.config},set config(u){},use(u,...f){return o.has(u)||(u&&at(u.install)?(o.add(u),u.install(c,...f)):at(u)&&(o.add(u),u(c,...f))),c},mixin(u){return __VUE_OPTIONS_API__&&(s.mixins.includes(u)||s.mixins.push(u)),c},component(u,f){return f?(s.components[u]=f,c):s.components[u]},directive(u,f){return f?(s.directives[u]=f,c):s.directives[u]},mount(u,f,p){if(!a){const g=c._ceVNode||$i(r,i);return g.appContext=s,p===!0?p="svg":p===!1&&(p=void 0),f&&e?e(g,u):n(g,u,p),a=!0,c._container=u,u.__vue_app__=c,__VUE_PROD_DEVTOOLS__&&(c._instance=g.component,KW(c,AT)),$C(g.component)}},onUnmount(u){l.push(u)},unmount(){a&&(Ds(l,c._instance,16),n(null,c._container),__VUE_PROD_DEVTOOLS__&&(c._instance=null,GW(c)),delete c._container.__vue_app__)},provide(u,f){return s.provides[u]=f,c},runWithContext(u){const f=Ic;Ic=c;try{return u()}finally{Ic=f}}};return c}}let Ic=null;function Sq(n,e){if(Cr){let t=Cr.provides;const r=Cr.parent&&Cr.parent.provides;r===t&&(t=Cr.provides=Object.create(r)),t[n]=e}}function eg(n,e,t=!1){const r=eU();if(r||Ic){let i=Ic?Ic._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return t&&at(e)?e.call(r&&r.proxy):e}}const X5={},Q5=()=>Object.create(X5),eI=n=>Object.getPrototypeOf(n)===X5;function xq(n,e,t,r=!1){const i={},s=Q5();n.propsDefaults=Object.create(null),tI(n,e,i,s);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);t?n.props=r?i:NW(i):n.type.props?n.props=i:n.props=s,n.attrs=s}function _q(n,e,t,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=n,l=Et(i),[a]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let f=0;f<u.length;f++){let p=u[f];if(hy(n.emitsOptions,p))continue;const g=e[p];if(a)if(At(s,p))g!==s[p]&&(s[p]=g,c=!0);else{const y=kl(p);i[y]=Xw(a,l,y,g,n,!1)}else g!==s[p]&&(s[p]=g,c=!0)}}}else{tI(n,e,i,s)&&(c=!0);let u;for(const f in l)(!e||!At(e,f)&&((u=ec(f))===f||!At(e,u)))&&(a?t&&(t[f]!==void 0||t[u]!==void 0)&&(i[f]=Xw(a,l,f,void 0,n,!0)):delete i[f]);if(s!==l)for(const f in s)(!e||!At(e,f))&&(delete s[f],c=!0)}c&&co(n.attrs,"set","")}function tI(n,e,t,r){const[i,s]=n.propsOptions;let o=!1,l;if(e)for(let a in e){if(_h(a))continue;const c=e[a];let u;i&&At(i,u=kl(a))?!s||!s.includes(u)?t[u]=c:(l||(l={}))[u]=c:hy(n.emitsOptions,a)||(!(a in r)||c!==r[a])&&(r[a]=c,o=!0)}if(s){const a=Et(t),c=l||Kt;for(let u=0;u<s.length;u++){const f=s[u];t[f]=Xw(i,a,f,c[f],n,!At(c,f))}}return o}function Xw(n,e,t,r,i,s){const o=n[t];if(o!=null){const l=At(o,"default");if(l&&r===void 0){const a=o.default;if(o.type!==Function&&!o.skipFactory&&at(a)){const{propsDefaults:c}=i;if(t in c)r=c[t];else{const u=dp(i);r=c[t]=a.call(null,e),u()}}else r=a;i.ce&&i.ce._setProp(t,r)}o[0]&&(s&&!l?r=!1:o[1]&&(r===""||r===ec(t))&&(r=!0))}return r}const Mq=new WeakMap;function nI(n,e,t=!1){const r=__VUE_OPTIONS_API__&&t?Mq:e.propsCache,i=r.get(n);if(i)return i;const s=n.props,o={},l=[];let a=!1;if(__VUE_OPTIONS_API__&&!at(n)){const u=f=>{a=!0;const[p,g]=nI(f,e,!0);Vn(o,p),g&&l.push(...g)};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!s&&!a)return mn(n)&&r.set(n,Sh),Sh;if(lt(s))for(let u=0;u<s.length;u++){const f=kl(s[u]);ST(f)&&(o[f]=Kt)}else if(s)for(const u in s){const f=kl(u);if(ST(f)){const p=s[u],g=o[f]=lt(p)||at(p)?{type:p}:Vn({},p),y=g.type;let v=!1,k=!0;if(lt(y))for(let x=0;x<y.length;++x){const _=y[x],M=at(_)&&_.name;if(M==="Boolean"){v=!0;break}else M==="String"&&(k=!1)}else v=at(y)&&y.name==="Boolean";g[0]=v,g[1]=k,(v||At(g,"default"))&&l.push(f)}}const c=[o,l];return mn(n)&&r.set(n,c),c}function ST(n){return n[0]!=="$"&&!_h(n)}const BC=n=>n==="_"||n==="_ctx"||n==="$stable",HC=n=>lt(n)?n.map(ys):[ys(n)],Tq=(n,e,t)=>{if(e._n)return e;const r=QW((...i)=>HC(e(...i)),t);return r._c=!1,r},rI=(n,e,t)=>{const r=n._ctx;for(const i in n){if(BC(i))continue;const s=n[i];if(at(s))e[i]=Tq(i,s,r);else if(s!=null){const o=HC(s);e[i]=()=>o}}},iI=(n,e)=>{const t=HC(e);n.slots.default=()=>t},sI=(n,e,t)=>{for(const r in e)(t||!BC(r))&&(n[r]=e[r])},Eq=(n,e,t)=>{const r=n.slots=Q5();if(n.vnode.shapeFlag&32){const i=e._;i?(sI(r,e,t),t&&t0(r,"_",i,!0)):rI(e,r)}else e&&iI(n,e)},Aq=(n,e,t)=>{const{vnode:r,slots:i}=n;let s=!0,o=Kt;if(r.shapeFlag&32){const l=e._;l?t&&l===1?s=!1:sI(i,e,t):(s=!e.$stable,rI(e,i)),o=e}else e&&(iI(n,e),o={default:1});if(s)for(const l in i)!BC(l)&&o[l]==null&&delete i[l]};function Oq(){typeof __VUE_OPTIONS_API__!="boolean"&&(Ea().__VUE_OPTIONS_API__=!0),typeof __VUE_PROD_DEVTOOLS__!="boolean"&&(Ea().__VUE_PROD_DEVTOOLS__=!1),typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__!="boolean"&&(Ea().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1)}const ei=qq;function Lq(n){return Dq(n)}function Dq(n,e){Oq();const t=Ea();t.__VUE__=!0,__VUE_PROD_DEVTOOLS__&&W5(t.__VUE_DEVTOOLS_GLOBAL_HOOK__,t);const{insert:r,remove:i,patchProp:s,createElement:o,createText:l,createComment:a,setText:c,setElementText:u,parentNode:f,nextSibling:p,setScopeId:g=Wi,insertStaticContent:y}=n,v=(N,H,W,q=null,Y=null,Q=null,pe=void 0,me=null,ge=!!H.dynamicChildren)=>{if(N===H)return;N&&!cf(N,H)&&(q=ie(N),j(N,Y,Q,!0),N=null),H.patchFlag===-2&&(ge=!1,H.dynamicChildren=null);const{type:ce,ref:qe,shapeFlag:_e}=H;switch(ce){case hp:k(N,H,W,q);break;case qa:x(N,H,W,q);break;case tg:N==null&&_(H,W,q,pe);break;case Zn:z(N,H,W,q,Y,Q,pe,me,ge);break;default:_e&1?S(N,H,W,q,Y,Q,pe,me,ge):_e&6?oe(N,H,W,q,Y,Q,pe,me,ge):(_e&64||_e&128)&&ce.process(N,H,W,q,Y,Q,pe,me,ge,he)}qe!=null&&Y?Ah(qe,N&&N.ref,Q,H||N,!H):qe==null&&N&&N.ref!=null&&Ah(N.ref,null,Q,N,!0)},k=(N,H,W,q)=>{if(N==null)r(H.el=l(H.children),W,q);else{const Y=H.el=N.el;H.children!==N.children&&c(Y,H.children)}},x=(N,H,W,q)=>{N==null?r(H.el=a(H.children||""),W,q):H.el=N.el},_=(N,H,W,q)=>{[N.el,N.anchor]=y(N.children,H,W,q,N.el,N.anchor)},M=({el:N,anchor:H},W,q)=>{let Y;for(;N&&N!==H;)Y=p(N),r(N,W,q),N=Y;r(H,W,q)},T=({el:N,anchor:H})=>{let W;for(;N&&N!==H;)W=p(N),i(N),N=W;i(H)},S=(N,H,W,q,Y,Q,pe,me,ge)=>{H.type==="svg"?pe="svg":H.type==="math"&&(pe="mathml"),N==null?A(H,W,q,Y,Q,pe,me,ge):R(N,H,Y,Q,pe,me,ge)},A=(N,H,W,q,Y,Q,pe,me)=>{let ge,ce;const{props:qe,shapeFlag:_e,transition:ye,dirs:Ue}=N;if(ge=N.el=o(N.type,Q,qe&&qe.is,qe),_e&8?u(ge,N.children):_e&16&&B(N.children,ge,null,q,Y,q1(N,Q),pe,me),Ue&&Vl(N,null,q,"created"),I(ge,N,N.scopeId,pe,q),qe){for(const vt in qe)vt!=="value"&&!_h(vt)&&s(ge,vt,null,qe[vt],Q,q);"value"in qe&&s(ge,"value",null,qe.value,Q),(ce=qe.onVnodeBeforeMount)&&fs(ce,q,N)}__VUE_PROD_DEVTOOLS__&&(t0(ge,"__vnode",N,!0),t0(ge,"__vueParentComponent",q,!0)),Ue&&Vl(N,null,q,"beforeMount");const nt=Iq(Y,ye);nt&&ye.beforeEnter(ge),r(ge,H,W),((ce=qe&&qe.onVnodeMounted)||nt||Ue)&&ei(()=>{ce&&fs(ce,q,N),nt&&ye.enter(ge),Ue&&Vl(N,null,q,"mounted")},Y)},I=(N,H,W,q,Y)=>{if(W&&g(N,W),q)for(let Q=0;Q<q.length;Q++)g(N,q[Q]);if(Y){let Q=Y.subTree;if(H===Q||uI(Q.type)&&(Q.ssContent===H||Q.ssFallback===H)){const pe=Y.vnode;I(N,pe,pe.scopeId,pe.slotScopeIds,Y.parent)}}},B=(N,H,W,q,Y,Q,pe,me,ge=0)=>{for(let ce=ge;ce<N.length;ce++){const qe=N[ce]=me?Go(N[ce]):ys(N[ce]);v(null,qe,H,W,q,Y,Q,pe,me)}},R=(N,H,W,q,Y,Q,pe)=>{const me=H.el=N.el;__VUE_PROD_DEVTOOLS__&&(me.__vnode=H);let{patchFlag:ge,dynamicChildren:ce,dirs:qe}=H;ge|=N.patchFlag&16;const _e=N.props||Kt,ye=H.props||Kt;let Ue;if(W&&Fl(W,!1),(Ue=ye.onVnodeBeforeUpdate)&&fs(Ue,W,H,N),qe&&Vl(H,N,W,"beforeUpdate"),W&&Fl(W,!0),(_e.innerHTML&&ye.innerHTML==null||_e.textContent&&ye.textContent==null)&&u(me,""),ce?K(N.dynamicChildren,ce,me,W,q,q1(H,Y),Q):pe||Te(N,H,me,null,W,q,q1(H,Y),Q,!1),ge>0){if(ge&16)U(me,_e,ye,W,Y);else if(ge&2&&_e.class!==ye.class&&s(me,"class",null,ye.class,Y),ge&4&&s(me,"style",_e.style,ye.style,Y),ge&8){const nt=H.dynamicProps;for(let vt=0;vt<nt.length;vt++){const ft=nt[vt],hn=_e[ft],Zt=ye[ft];(Zt!==hn||ft==="value")&&s(me,ft,hn,Zt,Y,W)}}ge&1&&N.children!==H.children&&u(me,H.children)}else!pe&&ce==null&&U(me,_e,ye,W,Y);((Ue=ye.onVnodeUpdated)||qe)&&ei(()=>{Ue&&fs(Ue,W,H,N),qe&&Vl(H,N,W,"updated")},q)},K=(N,H,W,q,Y,Q,pe)=>{for(let me=0;me<H.length;me++){const ge=N[me],ce=H[me],qe=ge.el&&(ge.type===Zn||!cf(ge,ce)||ge.shapeFlag&198)?f(ge.el):W;v(ge,ce,qe,null,q,Y,Q,pe,!0)}},U=(N,H,W,q,Y)=>{if(H!==W){if(H!==Kt)for(const Q in H)!_h(Q)&&!(Q in W)&&s(N,Q,H[Q],null,Y,q);for(const Q in W){if(_h(Q))continue;const pe=W[Q],me=H[Q];pe!==me&&Q!=="value"&&s(N,Q,me,pe,Y,q)}"value"in W&&s(N,"value",H.value,W.value,Y)}},z=(N,H,W,q,Y,Q,pe,me,ge)=>{const ce=H.el=N?N.el:l(""),qe=H.anchor=N?N.anchor:l("");let{patchFlag:_e,dynamicChildren:ye,slotScopeIds:Ue}=H;Ue&&(me=me?me.concat(Ue):Ue),N==null?(r(ce,W,q),r(qe,W,q),B(H.children||[],W,qe,Y,Q,pe,me,ge)):_e>0&&_e&64&&ye&&N.dynamicChildren?(K(N.dynamicChildren,ye,W,Y,Q,pe,me),(H.key!=null||Y&&H===Y.subTree)&&oI(N,H,!0)):Te(N,H,W,qe,Y,Q,pe,me,ge)},oe=(N,H,W,q,Y,Q,pe,me,ge)=>{H.slotScopeIds=me,N==null?H.shapeFlag&512?Y.ctx.activate(H,W,q,pe,ge):ne(H,W,q,Y,Q,pe,ge):ve(N,H,ge)},ne=(N,H,W,q,Y,Q,pe)=>{const me=N.component=Qq(N,q,Y);if(G5(N)&&(me.ctx.renderer=he),tU(me,!1,pe),me.asyncDep){if(Y&&Y.registerDep(me,ke,pe),!N.el){const ge=me.subTree=$i(qa);x(null,ge,H,W),N.placeholder=ge.el}}else ke(me,N,H,W,Y,Q,pe)},ve=(N,H,W)=>{const q=H.component=N.component;if(zq(N,H,W))if(q.asyncDep&&!q.asyncResolved){Se(q,H,W);return}else q.next=H,q.update();else H.el=N.el,q.vnode=H},ke=(N,H,W,q,Y,Q,pe)=>{const me=()=>{if(N.isMounted){let{next:_e,bu:ye,u:Ue,parent:nt,vnode:vt}=N;{const $t=lI(N);if($t){_e&&(_e.el=vt.el,Se(N,_e,pe)),$t.asyncDep.then(()=>{N.isUnmounted||me()});return}}let ft=_e,hn;Fl(N,!1),_e?(_e.el=vt.el,Se(N,_e,pe)):_e=vt,ye&&F1(ye),(hn=_e.props&&_e.props.onVnodeBeforeUpdate)&&fs(hn,nt,_e,vt),Fl(N,!0);const Zt=U1(N),gn=N.subTree;N.subTree=Zt,v(gn,Zt,f(gn.el),ie(gn),N,Y,Q),_e.el=Zt.el,ft===null&&Wq(N,Zt.el),Ue&&ei(Ue,Y),(hn=_e.props&&_e.props.onVnodeUpdated)&&ei(()=>fs(hn,nt,_e,vt),Y),__VUE_PROD_DEVTOOLS__&&q5(N)}else{let _e;const{el:ye,props:Ue}=H,{bm:nt,m:vt,parent:ft,root:hn,type:Zt}=N,gn=Oh(H);if(Fl(N,!1),nt&&F1(nt),!gn&&(_e=Ue&&Ue.onVnodeBeforeMount)&&fs(_e,ft,H),Fl(N,!0),ye&&De){const $t=()=>{N.subTree=U1(N),De(ye,N.subTree,N,Y,null)};gn&&Zt.__asyncHydrate?Zt.__asyncHydrate(ye,N,$t):$t()}else{hn.ce&&hn.ce._def.shadowRoot!==!1&&hn.ce._injectChildStyle(Zt);const $t=N.subTree=U1(N);v(null,$t,W,q,N,Y,Q),H.el=$t.el}if(vt&&ei(vt,Y),!gn&&(_e=Ue&&Ue.onVnodeMounted)){const $t=H;ei(()=>fs(_e,ft,$t),Y)}(H.shapeFlag&256||ft&&Oh(ft.vnode)&&ft.vnode.shapeFlag&256)&&N.a&&ei(N.a,Y),N.isMounted=!0,__VUE_PROD_DEVTOOLS__&&JW(N),H=W=q=null}};N.scope.on();const ge=N.effect=new x5(me);N.scope.off();const ce=N.update=ge.run.bind(ge),qe=N.job=ge.runIfDirty.bind(ge);qe.i=N,qe.id=N.uid,ge.scheduler=()=>IC(qe),Fl(N,!0),ce()},Se=(N,H,W)=>{H.component=N;const q=N.vnode.props;N.vnode=H,N.next=null,_q(N,H.props,q,W),Aq(N,H.children,W),Co(),yT(N),So()},Te=(N,H,W,q,Y,Q,pe,me,ge=!1)=>{const ce=N&&N.children,qe=N?N.shapeFlag:0,_e=H.children,{patchFlag:ye,shapeFlag:Ue}=H;if(ye>0){if(ye&128){Xe(ce,_e,W,q,Y,Q,pe,me,ge);return}else if(ye&256){Ge(ce,_e,W,q,Y,Q,pe,me,ge);return}}Ue&8?(qe&16&&Nt(ce,Y,Q),_e!==ce&&u(W,_e)):qe&16?Ue&16?Xe(ce,_e,W,q,Y,Q,pe,me,ge):Nt(ce,Y,Q,!0):(qe&8&&u(W,""),Ue&16&&B(_e,W,q,Y,Q,pe,me,ge))},Ge=(N,H,W,q,Y,Q,pe,me,ge)=>{N=N||Sh,H=H||Sh;const ce=N.length,qe=H.length,_e=Math.min(ce,qe);let ye;for(ye=0;ye<_e;ye++){const Ue=H[ye]=ge?Go(H[ye]):ys(H[ye]);v(N[ye],Ue,W,null,Y,Q,pe,me,ge)}ce>qe?Nt(N,Y,Q,!0,!1,_e):B(H,W,q,Y,Q,pe,me,ge,_e)},Xe=(N,H,W,q,Y,Q,pe,me,ge)=>{let ce=0;const qe=H.length;let _e=N.length-1,ye=qe-1;for(;ce<=_e&&ce<=ye;){const Ue=N[ce],nt=H[ce]=ge?Go(H[ce]):ys(H[ce]);if(cf(Ue,nt))v(Ue,nt,W,null,Y,Q,pe,me,ge);else break;ce++}for(;ce<=_e&&ce<=ye;){const Ue=N[_e],nt=H[ye]=ge?Go(H[ye]):ys(H[ye]);if(cf(Ue,nt))v(Ue,nt,W,null,Y,Q,pe,me,ge);else break;_e--,ye--}if(ce>_e){if(ce<=ye){const Ue=ye+1,nt=Ue<qe?H[Ue].el:q;for(;ce<=ye;)v(null,H[ce]=ge?Go(H[ce]):ys(H[ce]),W,nt,Y,Q,pe,me,ge),ce++}}else if(ce>ye)for(;ce<=_e;)j(N[ce],Y,Q,!0),ce++;else{const Ue=ce,nt=ce,vt=new Map;for(ce=nt;ce<=ye;ce++){const Yt=H[ce]=ge?Go(H[ce]):ys(H[ce]);Yt.key!=null&&vt.set(Yt.key,ce)}let ft,hn=0;const Zt=ye-nt+1;let gn=!1,$t=0;const $n=new Array(Zt);for(ce=0;ce<Zt;ce++)$n[ce]=0;for(ce=Ue;ce<=_e;ce++){const Yt=N[ce];if(hn>=Zt){j(Yt,Y,Q,!0);continue}let Mt;if(Yt.key!=null)Mt=vt.get(Yt.key);else for(ft=nt;ft<=ye;ft++)if($n[ft-nt]===0&&cf(Yt,H[ft])){Mt=ft;break}Mt===void 0?j(Yt,Y,Q,!0):($n[Mt-nt]=ce+1,Mt>=$t?$t=Mt:gn=!0,v(Yt,H[Mt],W,null,Y,Q,pe,me,ge),hn++)}const yn=gn?Nq($n):Sh;for(ft=yn.length-1,ce=Zt-1;ce>=0;ce--){const Yt=nt+ce,Mt=H[Yt],zn=H[Yt+1],kn=Yt+1<qe?zn.el||zn.placeholder:q;$n[ce]===0?v(null,Mt,W,kn,Y,Q,pe,me,ge):gn&&(ft<0||ce!==yn[ft]?He(Mt,W,kn,2):ft--)}}},He=(N,H,W,q,Y=null)=>{const{el:Q,type:pe,transition:me,children:ge,shapeFlag:ce}=N;if(ce&6){He(N.component.subTree,H,W,q);return}if(ce&128){N.suspense.move(H,W,q);return}if(ce&64){pe.move(N,H,W,he);return}if(pe===Zn){r(Q,H,W);for(let _e=0;_e<ge.length;_e++)He(ge[_e],H,W,q);r(N.anchor,H,W);return}if(pe===tg){M(N,H,W);return}if(q!==2&&ce&1&&me)if(q===0)me.beforeEnter(Q),r(Q,H,W),ei(()=>me.enter(Q),Y);else{const{leave:_e,delayLeave:ye,afterLeave:Ue}=me,nt=()=>{N.ctx.isUnmounted?i(Q):r(Q,H,W)},vt=()=>{Q._isLeaving&&Q[nq](!0),_e(Q,()=>{nt(),Ue&&Ue()})};ye?ye(Q,nt,vt):vt()}else r(Q,H,W)},j=(N,H,W,q=!1,Y=!1)=>{const{type:Q,props:pe,ref:me,children:ge,dynamicChildren:ce,shapeFlag:qe,patchFlag:_e,dirs:ye,cacheIndex:Ue}=N;if(_e===-2&&(Y=!1),me!=null&&(Co(),Ah(me,null,W,N,!0),So()),Ue!=null&&(H.renderCache[Ue]=void 0),qe&256){H.ctx.deactivate(N);return}const nt=qe&1&&ye,vt=!Oh(N);let ft;if(vt&&(ft=pe&&pe.onVnodeBeforeUnmount)&&fs(ft,H,N),qe&6)st(N.component,W,q);else{if(qe&128){N.suspense.unmount(W,q);return}nt&&Vl(N,null,H,"beforeUnmount"),qe&64?N.type.remove(N,H,W,he,q):ce&&!ce.hasOnce&&(Q!==Zn||_e>0&&_e&64)?Nt(ce,H,W,!1,!0):(Q===Zn&&_e&384||!Y&&qe&16)&&Nt(ge,H,W),q&&Ze(N)}(vt&&(ft=pe&&pe.onVnodeUnmounted)||nt)&&ei(()=>{ft&&fs(ft,H,N),nt&&Vl(N,null,H,"unmounted")},W)},Ze=N=>{const{type:H,el:W,anchor:q,transition:Y}=N;if(H===Zn){sn(W,q);return}if(H===tg){T(N);return}const Q=()=>{i(W),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(N.shapeFlag&1&&Y&&!Y.persisted){const{leave:pe,delayLeave:me}=Y,ge=()=>pe(W,Q);me?me(N.el,Q,ge):ge()}else Q()},sn=(N,H)=>{let W;for(;N!==H;)W=p(N),i(N),N=W;i(H)},st=(N,H,W)=>{const{bum:q,scope:Y,job:Q,subTree:pe,um:me,m:ge,a:ce}=N;xT(ge),xT(ce),q&&F1(q),Y.stop(),Q&&(Q.flags|=8,j(pe,N,H,W)),me&&ei(me,H),ei(()=>{N.isUnmounted=!0},H),__VUE_PROD_DEVTOOLS__&&YW(N)},Nt=(N,H,W,q=!1,Y=!1,Q=0)=>{for(let pe=Q;pe<N.length;pe++)j(N[pe],H,W,q,Y)},ie=N=>{if(N.shapeFlag&6)return ie(N.component.subTree);if(N.shapeFlag&128)return N.suspense.next();const H=p(N.anchor||N.el),W=H&&H[eq];return W?p(W):H};let rt=!1;const xe=(N,H,W)=>{N==null?H._vnode&&j(H._vnode,null,null,!0):v(H._vnode||null,N,H,null,null,null,W),H._vnode=N,rt||(rt=!0,yT(),$5(),rt=!1)},he={p:v,um:j,m:He,r:Ze,mt:ne,mc:B,pc:Te,pbc:K,n:ie,o:n};let _t,De;return{render:xe,hydrate:_t,createApp:Cq(xe,_t)}}function q1({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Fl({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function Iq(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function oI(n,e,t=!1){const r=n.children,i=e.children;if(lt(r)&&lt(i))for(let s=0;s<r.length;s++){const o=r[s];let l=i[s];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=i[s]=Go(i[s]),l.el=o.el),!t&&l.patchFlag!==-2&&oI(o,l)),l.type===hp&&l.patchFlag!==-1&&(l.el=o.el),l.type===qa&&!l.el&&(l.el=o.el)}}function Nq(n){const e=n.slice(),t=[0];let r,i,s,o,l;const a=n.length;for(r=0;r<a;r++){const c=n[r];if(c!==0){if(i=t[t.length-1],n[i]<c){e[r]=i,t.push(r);continue}for(s=0,o=t.length-1;s<o;)l=s+o>>1,n[t[l]]<c?s=l+1:o=l;c<n[t[s]]&&(s>0&&(e[r]=t[s-1]),t[s]=r)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function lI(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:lI(e)}function xT(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const Rq=Symbol.for("v-scx"),Pq=()=>eg(Rq);function Fu(n,e){return VC(n,null,e)}function Oa(n,e,t){return VC(n,e,t)}function VC(n,e,t=Kt){const{immediate:r,deep:i,flush:s,once:o}=t,l=Vn({},t),a=e&&r||!e&&s!=="post";let c;if(pd){if(s==="sync"){const g=Pq();c=g.__watcherHandles||(g.__watcherHandles=[])}else if(!a){const g=()=>{};return g.stop=Wi,g.resume=Wi,g.pause=Wi,g}}const u=Cr;l.call=(g,y,v)=>Ds(g,u,y,v);let f=!1;s==="post"?l.scheduler=g=>{ei(g,u&&u.suspense)}:s!=="sync"&&(f=!0,l.scheduler=(g,y)=>{y?g():IC(g)}),l.augmentJob=g=>{e&&(g.flags|=4),f&&(g.flags|=2,u&&(g.id=u.uid,g.i=u))};const p=$W(n,e,l);return pd&&(c?c.push(p):a&&p()),p}function Bq(n,e,t){const r=this.proxy,i=Fn(n)?n.includes(".")?aI(r,n):()=>r[n]:n.bind(r,r);let s;at(e)?s=e:(s=e.handler,t=e);const o=dp(this),l=VC(i,s.bind(r),t);return o(),l}function aI(n,e){const t=e.split(".");return()=>{let r=n;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}const Hq=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${kl(e)}Modifiers`]||n[`${ec(e)}Modifiers`];function Vq(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Kt;let i=t;const s=e.startsWith("update:"),o=s&&Hq(r,e.slice(7));o&&(o.trim&&(i=t.map(u=>Fn(u)?u.trim():u)),o.number&&(i=t.map(lW))),__VUE_PROD_DEVTOOLS__&&XW(n,e,i);let l,a=r[l=V1(e)]||r[l=V1(kl(e))];!a&&s&&(a=r[l=V1(ec(e))]),a&&Ds(a,n,6,i);const c=r[l+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[l])return;n.emitted[l]=!0,Ds(c,n,6,i)}}const Fq=new WeakMap;function cI(n,e,t=!1){const r=__VUE_OPTIONS_API__&&t?Fq:e.emitsCache,i=r.get(n);if(i!==void 0)return i;const s=n.emits;let o={},l=!1;if(__VUE_OPTIONS_API__&&!at(n)){const a=c=>{const u=cI(c,e,!0);u&&(l=!0,Vn(o,u))};!t&&e.mixins.length&&e.mixins.forEach(a),n.extends&&a(n.extends),n.mixins&&n.mixins.forEach(a)}return!s&&!l?(mn(n)&&r.set(n,null),null):(lt(s)?s.forEach(a=>o[a]=null):Vn(o,s),mn(n)&&r.set(n,o),o)}function hy(n,e){return!n||!oy(e)?!1:(e=e.slice(2).replace(/Once$/,""),At(n,e[0].toLowerCase()+e.slice(1))||At(n,ec(e))||At(n,e))}function U1(n){const{type:e,vnode:t,proxy:r,withProxy:i,propsOptions:[s],slots:o,attrs:l,emit:a,render:c,renderCache:u,props:f,data:p,setupState:g,ctx:y,inheritAttrs:v}=n,k=s0(n);let x,_;try{if(t.shapeFlag&4){const T=i||r,S=T;x=ys(c.call(S,T,u,f,g,p,y)),_=l}else{const T=e;x=ys(T.length>1?T(f,{attrs:l,slots:o,emit:a}):T(f,null)),_=e.props?l:jq(l)}}catch(T){cy(T,n,1),x=$i(qa)}let M=x;if(_&&v!==!1){const T=Object.keys(_),{shapeFlag:S}=M;T.length&&S&7&&(s&&T.some(wC)&&(_=$q(_,s)),M=ku(M,_,!1,!0))}return t.dirs&&(M=ku(M,null,!1,!0),M.dirs=M.dirs?M.dirs.concat(t.dirs):t.dirs),t.transition&&RC(M,t.transition),x=M,s0(k),x}const jq=n=>{let e;for(const t in n)(t==="class"||t==="style"||oy(t))&&((e||(e={}))[t]=n[t]);return e},$q=(n,e)=>{const t={};for(const r in n)(!wC(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function zq(n,e,t){const{props:r,children:i,component:s}=n,{props:o,children:l,patchFlag:a}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&a>=0){if(a&1024)return!0;if(a&16)return r?_T(r,o,c):!!o;if(a&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const p=u[f];if(o[p]!==r[p]&&!hy(c,p))return!0}}}else return(i||l)&&(!l||!l.$stable)?!0:r===o?!1:r?o?_T(r,o,c):!0:!!o;return!1}function _T(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==n[s]&&!hy(t,s))return!0}return!1}function Wq({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const uI=n=>n.__isSuspense;function qq(n,e){e&&e.pendingBranch?lt(n)?e.effects.push(...n):e.effects.push(n):UW(n)}const Zn=Symbol.for("v-fgt"),hp=Symbol.for("v-txt"),qa=Symbol.for("v-cmt"),tg=Symbol.for("v-stc");let al=null,FC=1;function a0(n,e=!1){FC+=n,n<0&&al&&e&&(al.hasOnce=!0)}function c0(n){return n?n.__v_isVNode===!0:!1}function cf(n,e){return n.type===e.type&&n.key===e.key}const fI=({key:n})=>n??null,ng=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Fn(n)||ur(n)||at(n)?{i:xs,r:n,k:e,f:!!t}:n:null);function Uq(n,e=null,t=null,r=0,i=null,s=n===Zn?0:1,o=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&fI(e),ref:e&&ng(e),scopeId:U5,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:xs};return l?(jC(a,t),s&128&&n.normalize(a)):t&&(a.shapeFlag|=Fn(t)?8:16),FC>0&&!o&&al&&(a.patchFlag>0||s&6)&&a.patchFlag!==32&&al.push(a),a}const $i=Kq;function Kq(n,e=null,t=null,r=0,i=null,s=!1){if((!n||n===pq)&&(n=qa),c0(n)){const l=ku(n,e,!0);return t&&jC(l,t),FC>0&&!s&&al&&(l.shapeFlag&6?al[al.indexOf(n)]=l:al.push(l)),l.patchFlag=-2,l}if(sU(n)&&(n=n.__vccOpts),e){e=Gq(e);let{class:l,style:a}=e;l&&!Fn(l)&&(e.class=SC(l)),mn(a)&&(DC(a)&&!lt(a)&&(a=Vn({},a)),e.style=CC(a))}const o=Fn(n)?1:uI(n)?128:tq(n)?64:mn(n)?4:at(n)?2:0;return Uq(n,e,t,r,i,o,s,!0)}function Gq(n){return n?DC(n)||eI(n)?Vn({},n):n:null}function ku(n,e,t=!1,r=!1){const{props:i,ref:s,patchFlag:o,children:l,transition:a}=n,c=e?Zq(i||{},e):i,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&fI(c),ref:e&&e.ref?t&&s?lt(s)?s.concat(ng(e)):[s,ng(e)]:ng(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:l,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Zn?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:a,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&ku(n.ssContent),ssFallback:n.ssFallback&&ku(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return a&&r&&RC(u,a.clone(u)),u}function Jq(n=" ",e=0){return $i(hp,null,n,e)}function ys(n){return n==null||typeof n=="boolean"?$i(qa):lt(n)?$i(Zn,null,n.slice()):c0(n)?Go(n):$i(hp,null,String(n))}function Go(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:ku(n)}function jC(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(lt(e))t=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),jC(n,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!eI(e)?e._ctx=xs:i===3&&xs&&(xs.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else at(e)?(e={default:e,_ctx:xs},t=32):(e=String(e),r&64?(t=16,e=[Jq(e)]):t=8);n.children=e,n.shapeFlag|=t}function Zq(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=SC([e.class,r.class]));else if(i==="style")e.style=CC([e.style,r.style]);else if(oy(i)){const s=e[i],o=r[i];o&&s!==o&&!(lt(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function fs(n,e,t,r=null){Ds(n,e,7,[t,r])}const Yq=Y5();let Xq=0;function Qq(n,e,t){const r=n.type,i=(e?e.appContext:n.appContext)||Yq,s={uid:Xq++,vnode:n,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new pW(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:nI(r,i),emitsOptions:cI(r,i),emit:null,emitted:null,propsDefaults:Kt,inheritAttrs:r.inheritAttrs,ctx:Kt,data:Kt,props:Kt,attrs:Kt,slots:Kt,refs:Kt,setupState:Kt,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=Vq.bind(null,s),n.ce&&n.ce(s),s}let Cr=null;const eU=()=>Cr||xs;let u0,Qw;{const n=Ea(),e=(t,r)=>{let i;return(i=n[t])||(i=n[t]=[]),i.push(r),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};u0=e("__VUE_INSTANCE_SETTERS__",t=>Cr=t),Qw=e("__VUE_SSR_SETTERS__",t=>pd=t)}const dp=n=>{const e=Cr;return u0(n),n.scope.on(),()=>{n.scope.off(),u0(e)}},MT=()=>{Cr&&Cr.scope.off(),u0(null)};function hI(n){return n.vnode.shapeFlag&4}let pd=!1;function tU(n,e=!1,t=!1){e&&Qw(e);const{props:r,children:i}=n.vnode,s=hI(n);xq(n,r,s,e),Eq(n,i,t||e);const o=s?nU(n,e):void 0;return e&&Qw(!1),o}function nU(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,mq);const{setup:r}=t;if(r){Co();const i=n.setupContext=r.length>1?iU(n):null,s=dp(n),o=cp(r,n,0,[n.props,i]),l=k5(o);if(So(),s(),(l||n.sp)&&!Oh(n)&&K5(n),l){if(o.then(MT,MT),e)return o.then(a=>{TT(n,a,e)}).catch(a=>{cy(a,n,0)});n.asyncDep=o}else TT(n,o,e)}else dI(n,e)}function TT(n,e,t){at(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:mn(e)&&(__VUE_PROD_DEVTOOLS__&&(n.devtoolsRawSetupState=e),n.setupState=V5(e)),dI(n,t)}let ET;function dI(n,e,t){const r=n.type;if(!n.render){if(!e&&ET&&!r.render){const i=r.template||__VUE_OPTIONS_API__&&PC(n).template;if(i){const{isCustomElement:s,compilerOptions:o}=n.appContext.config,{delimiters:l,compilerOptions:a}=r,c=Vn(Vn({isCustomElement:s,delimiters:l},o),a);r.render=ET(i,c)}}n.render=r.render||Wi}if(__VUE_OPTIONS_API__){const i=dp(n);Co();try{gq(n)}finally{So(),i()}}}const rU={get(n,e){return sr(n,"get",""),n[e]}};function iU(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,rU),slots:n.slots,emit:n.emit,expose:e}}function $C(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(V5(RW(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Lh)return Lh[t](n)},has(e,t){return t in e||t in Lh}})):n.proxy}function sU(n){return at(n)&&"__vccOpts"in n}const Cu=(n,e)=>FW(n,e,pd);function J(n,e,t){try{a0(-1);const r=arguments.length;return r===2?mn(e)&&!lt(e)?c0(e)?$i(n,null,[e]):$i(n,e):$i(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&c0(t)&&(t=[t]),$i(n,e,t))}finally{a0(1)}}const AT="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ev;const OT=typeof window<"u"&&window.trustedTypes;if(OT)try{ev=OT.createPolicy("vue",{createHTML:n=>n})}catch{}const pI=ev?n=>ev.createHTML(n):n=>n,oU="http://www.w3.org/2000/svg",lU="http://www.w3.org/1998/Math/MathML",Qs=typeof document<"u"?document:null,LT=Qs&&Qs.createElement("template"),aU={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const i=e==="svg"?Qs.createElementNS(oU,n):e==="mathml"?Qs.createElementNS(lU,n):t?Qs.createElement(n,{is:t}):Qs.createElement(n);return n==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:n=>Qs.createTextNode(n),createComment:n=>Qs.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Qs.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,i,s){const o=t?t.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{LT.innerHTML=pI(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const l=LT.content;if(r==="svg"||r==="mathml"){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}e.insertBefore(l,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},cU=Symbol("_vtc");function uU(n,e,t){const r=n[cU];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const DT=Symbol("_vod"),fU=Symbol("_vsh"),hU=Symbol(""),dU=/(?:^|;)\s*display\s*:/;function pU(n,e,t){const r=n.style,i=Fn(t);let s=!1;if(t&&!i){if(e)if(Fn(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();t[l]==null&&rg(r,l,"")}else for(const o in e)t[o]==null&&rg(r,o,"");for(const o in t)o==="display"&&(s=!0),rg(r,o,t[o])}else if(i){if(e!==t){const o=r[hU];o&&(t+=";"+o),r.cssText=t,s=dU.test(t)}}else e&&n.removeAttribute("style");DT in n&&(n[DT]=s?r.display:"",n[fU]&&(r.display="none"))}const IT=/\s*!important$/;function rg(n,e,t){if(lt(t))t.forEach(r=>rg(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=mU(n,e);IT.test(t)?n.setProperty(ec(r),t.replace(IT,""),"important"):n[r]=t}}const NT=["Webkit","Moz","ms"],K1={};function mU(n,e){const t=K1[e];if(t)return t;let r=kl(e);if(r!=="filter"&&r in n)return K1[e]=r;r=C5(r);for(let i=0;i<NT.length;i++){const s=NT[i]+r;if(s in n)return K1[e]=s}return e}const RT="http://www.w3.org/1999/xlink";function PT(n,e,t,r,i,s=dW(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(RT,e.slice(6,e.length)):n.setAttributeNS(RT,e,t):t==null||s&&!S5(t)?n.removeAttribute(e):n.setAttribute(e,s?"":Vu(t)?String(t):t)}function BT(n,e,t,r,i){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?pI(t):t);return}const s=n.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const l=s==="OPTION"?n.getAttribute("value")||"":n.value,a=t==null?n.type==="checkbox"?"on":"":String(t);(l!==a||!("_value"in n))&&(n.value=a),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const l=typeof n[e];l==="boolean"?t=S5(t):t==null&&l==="string"?(t="",o=!0):l==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(i||e)}function gU(n,e,t,r){n.addEventListener(e,t,r)}function yU(n,e,t,r){n.removeEventListener(e,t,r)}const HT=Symbol("_vei");function bU(n,e,t,r,i=null){const s=n[HT]||(n[HT]={}),o=s[e];if(r&&o)o.value=r;else{const[l,a]=wU(e);if(r){const c=s[e]=CU(r,i);gU(n,l,c,a)}else o&&(yU(n,l,o,a),s[e]=void 0)}}const VT=/(?:Once|Passive|Capture)$/;function wU(n){let e;if(VT.test(n)){e={};let r;for(;r=n.match(VT);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):ec(n.slice(2)),e]}let G1=0;const vU=Promise.resolve(),kU=()=>G1||(vU.then(()=>G1=0),G1=Date.now());function CU(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;Ds(SU(r,t.value),e,5,[r])};return t.value=n,t.attached=kU(),t}function SU(n,e){if(lt(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const FT=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,xU=(n,e,t,r,i,s)=>{const o=i==="svg";e==="class"?uU(n,r,o):e==="style"?pU(n,t,r):oy(e)?wC(e)||bU(n,e,t,r,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):_U(n,e,r,o))?(BT(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&PT(n,e,r,o,s,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!Fn(r))?BT(n,kl(e),r,s,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),PT(n,e,r,o))};function _U(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&FT(e)&&at(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return FT(e)&&Fn(t)?!1:e in n}const MU=Vn({patchProp:xU},aU);let jT;function TU(){return jT||(jT=Lq(MU))}const es=(...n)=>{const e=TU().createApp(...n),{mount:t}=e;return e.mount=r=>{const i=AU(r);if(!i)return;const s=e._component;!at(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=t(i,!1,EU(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function EU(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function AU(n){return Fn(n)?document.querySelector(n):n}function OU(n){const e=It({},`${n}_SLASH_SPEC`),t=An(i=>{const s=i.get(e.key);return new nn({key:new rn(`${n}_SLASH`),...s})}),r=[e,t];return r.key=e.key,r.pluginKey=t.key,e.meta={package:"@milkdown/plugin-slash",displayName:`Ctx<slashSpec>|${n}`},t.meta={package:"@milkdown/plugin-slash",displayName:`Prose<slash>|${n}`},r}var ru,Hd,Vd,Fd,jd,va,$d,iu,zd,Wd,S0,mI;class LU{constructor(e){be(this,S0);be(this,ru);be(this,Hd);be(this,Vd);be(this,Fd);be(this,jd);be(this,va);be(this,$d);be(this,iu);be(this,zd);be(this,Wd);X(this,ru,!1),this.onShow=()=>{},this.onHide=()=>{},X(this,Wd,(t,r)=>{const{state:i,composing:s}=t,{selection:o,doc:l}=i,{ranges:a}=o,c=Math.min(...a.map(g=>g.$from.pos)),u=Math.max(...a.map(g=>g.$to.pos)),f=r&&r.doc.eq(l)&&r.selection.eq(o);if(V(this,ru)||((V(this,Fd)??t.dom.parentElement??document.body).appendChild(this.element),X(this,ru,!0)),s||f)return;if(!V(this,$d).call(this,t,r)){this.hide();return}Ki({getBoundingClientRect:()=>U0(t,c,u)},this.element,{placement:"bottom-start",middleware:[Tg(),pl(V(this,zd)),...V(this,Hd)],...V(this,Vd)}).then(({x:g,y})=>{Object.assign(this.element.style,{left:`${g}px`,top:`${y}px`})}).catch(console.error),this.show()}),this.update=(t,r)=>{V(this,iu).call(this,t,r)},this.getContent=(t,r=i=>i.type.name==="paragraph")=>{const{selection:i}=t.state,{empty:s,$from:o}=i,l=t.state.selection instanceof ze;if(typeof document>"u")return;const a=this.element.contains(document.activeElement),c=!t.hasFocus()&&!a,u=!t.editable,p=!OF(r)(t.state.selection);if(!(c||u||!s||!l||p))return o.parent.textBetween(Math.max(0,o.parentOffset-500),o.parentOffset,void 0,"")},this.destroy=()=>{V(this,iu).cancel()},this.show=()=>{this.element.dataset.show="true",this.onShow()},this.hide=()=>{this.element.dataset.show="false",this.onHide()},this.element=e.content,X(this,jd,e.debounce??200),X(this,$d,e.shouldShow??Pp(this,S0,mI)),X(this,va,e.trigger??"/"),X(this,zd,e.offset),X(this,Hd,e.middleware??[]),X(this,Vd,e.floatingUIOptions??{}),X(this,Fd,e.root),X(this,iu,E0(V(this,Wd),V(this,jd)))}}ru=new WeakMap,Hd=new WeakMap,Vd=new WeakMap,Fd=new WeakMap,jd=new WeakMap,va=new WeakMap,$d=new WeakMap,iu=new WeakMap,zd=new WeakMap,Wd=new WeakMap,S0=new WeakSet,mI=function(e){const t=this.getContent(e);if(!t)return!1;const r=t.at(-1);return r?Array.isArray(V(this,va))?V(this,va).includes(r):V(this,va)===r:!1};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:gI,setPrototypeOf:$T,isFrozen:DU,getPrototypeOf:IU,getOwnPropertyDescriptor:NU}=Object;let{freeze:Or,seal:Mi,create:tv}=Object,{apply:nv,construct:rv}=typeof Reflect<"u"&&Reflect;Or||(Or=function(e){return e});Mi||(Mi=function(e){return e});nv||(nv=function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return e.apply(t,i)});rv||(rv=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return new e(...r)});const cm=Lr(Array.prototype.forEach),RU=Lr(Array.prototype.lastIndexOf),zT=Lr(Array.prototype.pop),uf=Lr(Array.prototype.push),PU=Lr(Array.prototype.splice),ig=Lr(String.prototype.toLowerCase),J1=Lr(String.prototype.toString),Z1=Lr(String.prototype.match),ff=Lr(String.prototype.replace),BU=Lr(String.prototype.indexOf),HU=Lr(String.prototype.trim),Bi=Lr(Object.prototype.hasOwnProperty),gr=Lr(RegExp.prototype.test),hf=VU(TypeError);function Lr(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return nv(n,e,r)}}function VU(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return rv(n,t)}}function yt(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ig;$T&&$T(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=t(i);s!==i&&(DU(e)||(e[r]=s),i=s)}n[i]=!0}return n}function FU(n){for(let e=0;e<n.length;e++)Bi(n,e)||(n[e]=null);return n}function Js(n){const e=tv(null);for(const[t,r]of gI(n))Bi(n,t)&&(Array.isArray(r)?e[t]=FU(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=Js(r):e[t]=r);return e}function df(n,e){for(;n!==null;){const r=NU(n,e);if(r){if(r.get)return Lr(r.get);if(typeof r.value=="function")return Lr(r.value)}n=IU(n)}function t(){return null}return t}const WT=Or(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Y1=Or(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),X1=Or(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),jU=Or(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Q1=Or(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),$U=Or(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),qT=Or(["#text"]),UT=Or(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),eb=Or(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),KT=Or(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),um=Or(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),zU=Mi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),WU=Mi(/<%[\w\W]*|[\w\W]*%>/gm),qU=Mi(/\$\{[\w\W]*/gm),UU=Mi(/^data-[\-\w.\u00B7-\uFFFF]+$/),KU=Mi(/^aria-[\-\w]+$/),yI=Mi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),GU=Mi(/^(?:\w+script|data):/i),JU=Mi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),bI=Mi(/^html$/i),ZU=Mi(/^[a-z][.\w]*(-[.\w]+)+$/i);var GT=Object.freeze({__proto__:null,ARIA_ATTR:KU,ATTR_WHITESPACE:JU,CUSTOM_ELEMENT:ZU,DATA_ATTR:UU,DOCTYPE_NAME:bI,ERB_EXPR:WU,IS_ALLOWED_URI:yI,IS_SCRIPT_OR_DATA:GU,MUSTACHE_EXPR:zU,TMPLIT_EXPR:qU});const pf={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},YU=function(){return typeof window>"u"?null:window},XU=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},JT=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function wI(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:YU();const e=Fe=>wI(Fe);if(e.version="3.3.0",e.removed=[],!n||!n.document||n.document.nodeType!==pf.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:l,Element:a,NodeFilter:c,NamedNodeMap:u=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:f,DOMParser:p,trustedTypes:g}=n,y=a.prototype,v=df(y,"cloneNode"),k=df(y,"remove"),x=df(y,"nextSibling"),_=df(y,"childNodes"),M=df(y,"parentNode");if(typeof o=="function"){const Fe=t.createElement("template");Fe.content&&Fe.content.ownerDocument&&(t=Fe.content.ownerDocument)}let T,S="";const{implementation:A,createNodeIterator:I,createDocumentFragment:B,getElementsByTagName:R}=t,{importNode:K}=r;let U=JT();e.isSupported=typeof gI=="function"&&typeof M=="function"&&A&&A.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:z,ERB_EXPR:oe,TMPLIT_EXPR:ne,DATA_ATTR:ve,ARIA_ATTR:ke,IS_SCRIPT_OR_DATA:Se,ATTR_WHITESPACE:Te,CUSTOM_ELEMENT:Ge}=GT;let{IS_ALLOWED_URI:Xe}=GT,He=null;const j=yt({},[...WT,...Y1,...X1,...Q1,...qT]);let Ze=null;const sn=yt({},[...UT,...eb,...KT,...um]);let st=Object.seal(tv(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Nt=null,ie=null;const rt=Object.seal(tv(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let xe=!0,he=!0,_t=!1,De=!0,N=!1,H=!0,W=!1,q=!1,Y=!1,Q=!1,pe=!1,me=!1,ge=!0,ce=!1;const qe="user-content-";let _e=!0,ye=!1,Ue={},nt=null;const vt=yt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ft=null;const hn=yt({},["audio","video","img","source","image","track"]);let Zt=null;const gn=yt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$t="http://www.w3.org/1998/Math/MathML",$n="http://www.w3.org/2000/svg",yn="http://www.w3.org/1999/xhtml";let Yt=yn,Mt=!1,zn=null;const kn=yt({},[$t,$n,yn],J1);let rs=yt({},["mi","mo","mn","ms","mtext"]),Dr=yt({},["annotation-xml"]);const Li=yt({},["title","style","font","a","script"]);let bn=null;const is=["application/xhtml+xml","text/html"],Oo="text/html";let an=null,Cn=null;const Dn=t.createElement("form"),ui=function(F){return F instanceof RegExp||F instanceof Function},Bs=function(){let F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Cn&&Cn===F)){if((!F||typeof F!="object")&&(F={}),F=Js(F),bn=is.indexOf(F.PARSER_MEDIA_TYPE)===-1?Oo:F.PARSER_MEDIA_TYPE,an=bn==="application/xhtml+xml"?J1:ig,He=Bi(F,"ALLOWED_TAGS")?yt({},F.ALLOWED_TAGS,an):j,Ze=Bi(F,"ALLOWED_ATTR")?yt({},F.ALLOWED_ATTR,an):sn,zn=Bi(F,"ALLOWED_NAMESPACES")?yt({},F.ALLOWED_NAMESPACES,J1):kn,Zt=Bi(F,"ADD_URI_SAFE_ATTR")?yt(Js(gn),F.ADD_URI_SAFE_ATTR,an):gn,ft=Bi(F,"ADD_DATA_URI_TAGS")?yt(Js(hn),F.ADD_DATA_URI_TAGS,an):hn,nt=Bi(F,"FORBID_CONTENTS")?yt({},F.FORBID_CONTENTS,an):vt,Nt=Bi(F,"FORBID_TAGS")?yt({},F.FORBID_TAGS,an):Js({}),ie=Bi(F,"FORBID_ATTR")?yt({},F.FORBID_ATTR,an):Js({}),Ue=Bi(F,"USE_PROFILES")?F.USE_PROFILES:!1,xe=F.ALLOW_ARIA_ATTR!==!1,he=F.ALLOW_DATA_ATTR!==!1,_t=F.ALLOW_UNKNOWN_PROTOCOLS||!1,De=F.ALLOW_SELF_CLOSE_IN_ATTR!==!1,N=F.SAFE_FOR_TEMPLATES||!1,H=F.SAFE_FOR_XML!==!1,W=F.WHOLE_DOCUMENT||!1,Q=F.RETURN_DOM||!1,pe=F.RETURN_DOM_FRAGMENT||!1,me=F.RETURN_TRUSTED_TYPE||!1,Y=F.FORCE_BODY||!1,ge=F.SANITIZE_DOM!==!1,ce=F.SANITIZE_NAMED_PROPS||!1,_e=F.KEEP_CONTENT!==!1,ye=F.IN_PLACE||!1,Xe=F.ALLOWED_URI_REGEXP||yI,Yt=F.NAMESPACE||yn,rs=F.MATHML_TEXT_INTEGRATION_POINTS||rs,Dr=F.HTML_INTEGRATION_POINTS||Dr,st=F.CUSTOM_ELEMENT_HANDLING||{},F.CUSTOM_ELEMENT_HANDLING&&ui(F.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(st.tagNameCheck=F.CUSTOM_ELEMENT_HANDLING.tagNameCheck),F.CUSTOM_ELEMENT_HANDLING&&ui(F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(st.attributeNameCheck=F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),F.CUSTOM_ELEMENT_HANDLING&&typeof F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(st.allowCustomizedBuiltInElements=F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),N&&(he=!1),pe&&(Q=!0),Ue&&(He=yt({},qT),Ze=[],Ue.html===!0&&(yt(He,WT),yt(Ze,UT)),Ue.svg===!0&&(yt(He,Y1),yt(Ze,eb),yt(Ze,um)),Ue.svgFilters===!0&&(yt(He,X1),yt(Ze,eb),yt(Ze,um)),Ue.mathMl===!0&&(yt(He,Q1),yt(Ze,KT),yt(Ze,um))),F.ADD_TAGS&&(typeof F.ADD_TAGS=="function"?rt.tagCheck=F.ADD_TAGS:(He===j&&(He=Js(He)),yt(He,F.ADD_TAGS,an))),F.ADD_ATTR&&(typeof F.ADD_ATTR=="function"?rt.attributeCheck=F.ADD_ATTR:(Ze===sn&&(Ze=Js(Ze)),yt(Ze,F.ADD_ATTR,an))),F.ADD_URI_SAFE_ATTR&&yt(Zt,F.ADD_URI_SAFE_ATTR,an),F.FORBID_CONTENTS&&(nt===vt&&(nt=Js(nt)),yt(nt,F.FORBID_CONTENTS,an)),_e&&(He["#text"]=!0),W&&yt(He,["html","head","body"]),He.table&&(yt(He,["tbody"]),delete Nt.tbody),F.TRUSTED_TYPES_POLICY){if(typeof F.TRUSTED_TYPES_POLICY.createHTML!="function")throw hf('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof F.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw hf('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');T=F.TRUSTED_TYPES_POLICY,S=T.createHTML("")}else T===void 0&&(T=XU(g,i)),T!==null&&typeof S=="string"&&(S=T.createHTML(""));Or&&Or(F),Cn=F}},El=yt({},[...Y1,...X1,...jU]),Al=yt({},[...Q1,...$U]),Rt=function(F){let ue=M(F);(!ue||!ue.tagName)&&(ue={namespaceURI:Yt,tagName:"template"});const Pe=ig(F.tagName),Lt=ig(ue.tagName);return zn[F.namespaceURI]?F.namespaceURI===$n?ue.namespaceURI===yn?Pe==="svg":ue.namespaceURI===$t?Pe==="svg"&&(Lt==="annotation-xml"||rs[Lt]):!!El[Pe]:F.namespaceURI===$t?ue.namespaceURI===yn?Pe==="math":ue.namespaceURI===$n?Pe==="math"&&Dr[Lt]:!!Al[Pe]:F.namespaceURI===yn?ue.namespaceURI===$n&&!Dr[Lt]||ue.namespaceURI===$t&&!rs[Lt]?!1:!Al[Pe]&&(Li[Pe]||!El[Pe]):!!(bn==="application/xhtml+xml"&&zn[F.namespaceURI]):!1},pr=function(F){uf(e.removed,{element:F});try{M(F).removeChild(F)}catch{k(F)}},In=function(F,ue){try{uf(e.removed,{attribute:ue.getAttributeNode(F),from:ue})}catch{uf(e.removed,{attribute:null,from:ue})}if(ue.removeAttribute(F),F==="is")if(Q||pe)try{pr(ue)}catch{}else try{ue.setAttribute(F,"")}catch{}},Ol=function(F){let ue=null,Pe=null;if(Y)F="<remove></remove>"+F;else{const Wt=Z1(F,/^[\r\n\t ]+/);Pe=Wt&&Wt[0]}bn==="application/xhtml+xml"&&Yt===yn&&(F='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+F+"</body></html>");const Lt=T?T.createHTML(F):F;if(Yt===yn)try{ue=new p().parseFromString(Lt,bn)}catch{}if(!ue||!ue.documentElement){ue=A.createDocument(Yt,"template",null);try{ue.documentElement.innerHTML=Mt?S:Lt}catch{}}const ut=ue.body||ue.documentElement;return F&&Pe&&ut.insertBefore(t.createTextNode(Pe),ut.childNodes[0]||null),Yt===yn?R.call(ue,W?"html":"body")[0]:W?ue.documentElement:ut},Di=function(F){return I.call(F.ownerDocument||F,F,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},ss=function(F){return F instanceof f&&(typeof F.nodeName!="string"||typeof F.textContent!="string"||typeof F.removeChild!="function"||!(F.attributes instanceof u)||typeof F.removeAttribute!="function"||typeof F.setAttribute!="function"||typeof F.namespaceURI!="string"||typeof F.insertBefore!="function"||typeof F.hasChildNodes!="function")},Lo=function(F){return typeof l=="function"&&F instanceof l};function nr(Fe,F,ue){cm(Fe,Pe=>{Pe.call(e,F,ue,Cn)})}const Hs=function(F){let ue=null;if(nr(U.beforeSanitizeElements,F,null),ss(F))return pr(F),!0;const Pe=an(F.nodeName);if(nr(U.uponSanitizeElement,F,{tagName:Pe,allowedTags:He}),H&&F.hasChildNodes()&&!Lo(F.firstElementChild)&&gr(/<[/\w!]/g,F.innerHTML)&&gr(/<[/\w!]/g,F.textContent)||F.nodeType===pf.progressingInstruction||H&&F.nodeType===pf.comment&&gr(/<[/\w]/g,F.data))return pr(F),!0;if(!(rt.tagCheck instanceof Function&&rt.tagCheck(Pe))&&(!He[Pe]||Nt[Pe])){if(!Nt[Pe]&&Fs(Pe)&&(st.tagNameCheck instanceof RegExp&&gr(st.tagNameCheck,Pe)||st.tagNameCheck instanceof Function&&st.tagNameCheck(Pe)))return!1;if(_e&&!nt[Pe]){const Lt=M(F)||F.parentNode,ut=_(F)||F.childNodes;if(ut&&Lt){const Wt=ut.length;for(let On=Wt-1;On>=0;--On){const mr=v(ut[On],!0);mr.__removalCount=(F.__removalCount||0)+1,Lt.insertBefore(mr,x(F))}}}return pr(F),!0}return F instanceof a&&!Rt(F)||(Pe==="noscript"||Pe==="noembed"||Pe==="noframes")&&gr(/<\/no(script|embed|frames)/i,F.innerHTML)?(pr(F),!0):(N&&F.nodeType===pf.text&&(ue=F.textContent,cm([z,oe,ne],Lt=>{ue=ff(ue,Lt," ")}),F.textContent!==ue&&(uf(e.removed,{element:F.cloneNode()}),F.textContent=ue)),nr(U.afterSanitizeElements,F,null),!1)},Vs=function(F,ue,Pe){if(ge&&(ue==="id"||ue==="name")&&(Pe in t||Pe in Dn))return!1;if(!(he&&!ie[ue]&&gr(ve,ue))){if(!(xe&&gr(ke,ue))){if(!(rt.attributeCheck instanceof Function&&rt.attributeCheck(ue,F))){if(!Ze[ue]||ie[ue]){if(!(Fs(F)&&(st.tagNameCheck instanceof RegExp&&gr(st.tagNameCheck,F)||st.tagNameCheck instanceof Function&&st.tagNameCheck(F))&&(st.attributeNameCheck instanceof RegExp&&gr(st.attributeNameCheck,ue)||st.attributeNameCheck instanceof Function&&st.attributeNameCheck(ue,F))||ue==="is"&&st.allowCustomizedBuiltInElements&&(st.tagNameCheck instanceof RegExp&&gr(st.tagNameCheck,Pe)||st.tagNameCheck instanceof Function&&st.tagNameCheck(Pe))))return!1}else if(!Zt[ue]){if(!gr(Xe,ff(Pe,Te,""))){if(!((ue==="src"||ue==="xlink:href"||ue==="href")&&F!=="script"&&BU(Pe,"data:")===0&&ft[F])){if(!(_t&&!gr(Se,ff(Pe,Te,"")))){if(Pe)return!1}}}}}}}return!0},Fs=function(F){return F!=="annotation-xml"&&Z1(F,Ge)},zt=function(F){nr(U.beforeSanitizeAttributes,F,null);const{attributes:ue}=F;if(!ue||ss(F))return;const Pe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ze,forceKeepAttr:void 0};let Lt=ue.length;for(;Lt--;){const ut=ue[Lt],{name:Wt,namespaceURI:On,value:mr}=ut,fi=an(Wt),Io=mr;let dn=Wt==="value"?Io:HU(Io);if(Pe.attrName=fi,Pe.attrValue=dn,Pe.keepAttr=!0,Pe.forceKeepAttr=void 0,nr(U.uponSanitizeAttribute,F,Pe),dn=Pe.attrValue,ce&&(fi==="id"||fi==="name")&&(In(Wt,F),dn=qe+dn),H&&gr(/((--!?|])>)|<\/(style|title|textarea)/i,dn)){In(Wt,F);continue}if(fi==="attributename"&&Z1(dn,"href")){In(Wt,F);continue}if(Pe.forceKeepAttr)continue;if(!Pe.keepAttr){In(Wt,F);continue}if(!De&&gr(/\/>/i,dn)){In(Wt,F);continue}N&&cm([z,oe,ne],Dl=>{dn=ff(dn,Dl," ")});const Ll=an(F.nodeName);if(!Vs(Ll,fi,dn)){In(Wt,F);continue}if(T&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!On)switch(g.getAttributeType(Ll,fi)){case"TrustedHTML":{dn=T.createHTML(dn);break}case"TrustedScriptURL":{dn=T.createScriptURL(dn);break}}if(dn!==Io)try{On?F.setAttributeNS(On,Wt,dn):F.setAttribute(Wt,dn),ss(F)?pr(F):zT(e.removed)}catch{In(Wt,F)}}nr(U.afterSanitizeAttributes,F,null)},Do=function Fe(F){let ue=null;const Pe=Di(F);for(nr(U.beforeSanitizeShadowDOM,F,null);ue=Pe.nextNode();)nr(U.uponSanitizeShadowNode,ue,null),Hs(ue),zt(ue),ue.content instanceof s&&Fe(ue.content);nr(U.afterSanitizeShadowDOM,F,null)};return e.sanitize=function(Fe){let F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ue=null,Pe=null,Lt=null,ut=null;if(Mt=!Fe,Mt&&(Fe="<!-->"),typeof Fe!="string"&&!Lo(Fe))if(typeof Fe.toString=="function"){if(Fe=Fe.toString(),typeof Fe!="string")throw hf("dirty is not a string, aborting")}else throw hf("toString is not a function");if(!e.isSupported)return Fe;if(q||Bs(F),e.removed=[],typeof Fe=="string"&&(ye=!1),ye){if(Fe.nodeName){const mr=an(Fe.nodeName);if(!He[mr]||Nt[mr])throw hf("root node is forbidden and cannot be sanitized in-place")}}else if(Fe instanceof l)ue=Ol("<!---->"),Pe=ue.ownerDocument.importNode(Fe,!0),Pe.nodeType===pf.element&&Pe.nodeName==="BODY"||Pe.nodeName==="HTML"?ue=Pe:ue.appendChild(Pe);else{if(!Q&&!N&&!W&&Fe.indexOf("<")===-1)return T&&me?T.createHTML(Fe):Fe;if(ue=Ol(Fe),!ue)return Q?null:me?S:""}ue&&Y&&pr(ue.firstChild);const Wt=Di(ye?Fe:ue);for(;Lt=Wt.nextNode();)Hs(Lt),zt(Lt),Lt.content instanceof s&&Do(Lt.content);if(ye)return Fe;if(Q){if(pe)for(ut=B.call(ue.ownerDocument);ue.firstChild;)ut.appendChild(ue.firstChild);else ut=ue;return(Ze.shadowroot||Ze.shadowrootmode)&&(ut=K.call(r,ut,!0)),ut}let On=W?ue.outerHTML:ue.innerHTML;return W&&He["!doctype"]&&ue.ownerDocument&&ue.ownerDocument.doctype&&ue.ownerDocument.doctype.name&&gr(bI,ue.ownerDocument.doctype.name)&&(On="<!DOCTYPE "+ue.ownerDocument.doctype.name+`>
`+On),N&&cm([z,oe,ne],mr=>{On=ff(On,mr," ")}),T&&me?T.createHTML(On):On},e.setConfig=function(){let Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Bs(Fe),q=!0},e.clearConfig=function(){Cn=null,q=!1},e.isValidAttribute=function(Fe,F,ue){Cn||Bs({});const Pe=an(Fe),Lt=an(F);return Vs(Pe,Lt,ue)},e.addHook=function(Fe,F){typeof F=="function"&&uf(U[Fe],F)},e.removeHook=function(Fe,F){if(F!==void 0){const ue=RU(U[Fe],F);return ue===-1?void 0:PU(U[Fe],ue,1)[0]}return zT(U[Fe])},e.removeHooks=function(Fe){U[Fe]=[]},e.removeAllHooks=function(){U=JT()},e}var Ei=wI();function Su({icon:n,class:e,onClick:t}){return J("span",{class:Qn("milkdown-icon",e),onPointerdown:t,ref:r=>{r&&n&&(r.innerHTML=Ei.sanitize(n.trim()))}})}Su.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};var QU=Object.defineProperty,ZT=Object.getOwnPropertySymbols,eK=Object.prototype.hasOwnProperty,tK=Object.prototype.propertyIsEnumerable,YT=(n,e,t)=>e in n?QU(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,nK=(n,e)=>{for(var t in e||(e={}))eK.call(e,t)&&YT(n,t,e[t]);if(ZT)for(var t of ZT(e))tK.call(e,t)&&YT(n,t,e[t]);return n};function pp(n,e){return Object.assign(n,{meta:nK({package:"@milkdown/components"},e)}),n}const rK={imageIcon:"",captionIcon:"",uploadButton:"Upload file",confirmButton:"Confirm ",uploadPlaceholderText:"or paste the image link ...",captionPlaceholderText:"Image caption",onUpload:n=>Promise.resolve(URL.createObjectURL(n))},dy=It(rK,"imageBlockConfigCtx");pp(dy,{displayName:"Config<image-block>",group:"ImageBlock"});function iK(n){return Ka(n,"paragraph",(e,t,r)=>{var i,s;if(((i=e.children)==null?void 0:i.length)!==1)return;const o=(s=e.children)==null?void 0:s[0];if(!o||o.type!=="image")return;const{url:l,alt:a,title:c}=o,u={type:"image-block",url:l,alt:a,title:c};r.children.splice(t,1,u)})}const zC=Rs("remark-image-block",()=>()=>iK);pp(zC.plugin,{displayName:"Remark<remarkImageBlock>",group:"ImageBlock"});pp(zC.options,{displayName:"RemarkConfig<remarkImageBlock>",group:"ImageBlock"});var sK=Object.defineProperty,XT=Object.getOwnPropertySymbols,oK=Object.prototype.hasOwnProperty,lK=Object.prototype.propertyIsEnumerable,QT=(n,e,t)=>e in n?sK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,aK=(n,e)=>{for(var t in e||(e={}))oK.call(e,t)&&QT(n,t,e[t]);if(XT)for(var t of XT(e))lK.call(e,t)&&QT(n,t,e[t]);return n};const iv="image-block",py=vn("image-block",()=>({inline:!1,group:"block",selectable:!0,draggable:!0,isolating:!0,marks:"",atom:!0,priority:100,attrs:{src:{default:"",validate:"string"},caption:{default:"",validate:"string"},ratio:{default:1,validate:"number"}},parseDOM:[{tag:`img[data-type="${iv}"]`,getAttrs:n=>{var e;if(!(n instanceof HTMLElement))throw Zi(n);return{src:n.getAttribute("src")||"",caption:n.getAttribute("caption")||"",ratio:Number((e=n.getAttribute("ratio"))!=null?e:1)}}}],toDOM:n=>["img",aK({"data-type":iv},n.attrs)],parseMarkdown:{match:({type:n})=>n==="image-block",runner:(n,e,t)=>{const r=e.url,i=e.title;let s=Number(e.alt||1);(Number.isNaN(s)||s===0)&&(s=1),n.addNode(t,{src:r,caption:i,ratio:s})}},toMarkdown:{match:n=>n.type.name==="image-block",runner:(n,e)=>{n.openNode("paragraph"),n.addNode("image",void 0,void 0,{title:e.attrs.caption,url:e.attrs.src,alt:`${Number.parseFloat(e.attrs.ratio).toFixed(2)}`}),n.closeNode()}}}));pp(py.node,{displayName:"NodeSchema<image-block>",group:"ImageBlock"});function Dh({icon:n,class:e,onClick:t}){return J("span",{class:Qn("milkdown-icon",e),onPointerdown:t,ref:r=>{r&&n&&(r.innerHTML=Ei.sanitize(n.trim()))}})}Dh.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const cK=_k("abcdefg",8),uK=tr({props:{src:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setLink:{type:Function,required:!0},imageIcon:{type:String,required:!1},uploadButton:{type:String,required:!1},confirmButton:{type:String,required:!1},uploadPlaceholderText:{type:String,required:!1},onUpload:{type:Function,required:!0}},setup({readonly:n,src:e,setLink:t,onUpload:r,imageIcon:i,uploadButton:s,confirmButton:o,uploadPlaceholderText:l,className:a}){var c,u;const f=Ve(!1),p=Ve(),g=Ve((c=e.value)!=null?c:""),y=Ve(cK()),v=Ve(((u=e.value)==null?void 0:u.length)!==0),k=T=>{const A=T.target.value;v.value=A.length!==0,g.value=A},x=T=>{var S,A;T.key==="Enter"&&t((A=(S=p.value)==null?void 0:S.value)!=null?A:"")},_=()=>{var T,S;t((S=(T=p.value)==null?void 0:T.value)!=null?S:"")},M=T=>{var S;const A=(S=T.target.files)==null?void 0:S[0];A&&r(A).then(I=>{I&&(t(I),v.value=!0)}).catch(I=>{console.error("An error occurred while uploading image"),console.error(I)})};return()=>J("div",{class:Qn("image-edit",a)},J(Dh,{icon:i,class:"image-icon"}),J("div",{class:Qn("link-importer",f.value&&"focus")},J("input",{ref:p,draggable:"true",onDragstart:T=>{T.preventDefault(),T.stopPropagation()},disabled:n.value,class:"link-input-area",value:g.value,onInput:k,onKeydown:x,onFocus:()=>f.value=!0,onBlur:()=>f.value=!1}),!v.value&&J("div",{class:"placeholder"},J("input",{disabled:n.value,class:"hidden",id:y.value,type:"file",accept:"image/*",onChange:M}),J("label",{class:"uploader",for:y.value},J(Dh,{icon:s})),J("span",{class:"text",onClick:()=>{var T;return(T=p.value)==null?void 0:T.focus()}},l))),g.value&&J("div",{class:"confirm",onClick:()=>_()},J(Dh,{icon:o})))}}),fK=tr({props:{src:{type:Object,required:!0},caption:{type:Object,required:!0},ratio:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setAttr:{type:Function,required:!0},config:{type:Object,required:!0}},setup({src:n,caption:e,ratio:t,readonly:r,setAttr:i,config:s}){var o;const l=Ve(),a=Ve(),c=Ve(!!((o=e.value)!=null&&o.length)),u=Ve(0),f=()=>{var _;const M=l.value;if(!M)return;const T=M.closest(".milkdown-image-block");if(!T)return;const S=T.getBoundingClientRect().width;if(!S)return;const A=M.height,I=M.width,B=I<S?A:S*(A/I),R=(B*((_=t.value)!=null?_:1)).toFixed(2);M.dataset.origin=B.toFixed(2),M.dataset.height=R,M.style.height=`${R}px`},p=_=>{_.preventDefault(),_.stopPropagation(),!r.value&&(c.value=!c.value)},g=_=>{const T=_.target.value;u.value&&window.clearTimeout(u.value),u.value=window.setTimeout(()=>{i("caption",T)},1e3)},y=_=>{const T=_.target.value;u.value&&(window.clearTimeout(u.value),u.value=0),i("caption",T)},v=_=>{_.preventDefault();const M=l.value;if(!M)return;const T=M.getBoundingClientRect().top,S=_.clientY-T,A=Number(S<100?100:S).toFixed(2);M.dataset.height=A,M.style.height=`${A}px`},k=()=>{window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",k);const _=l.value;if(!_)return;const M=Number(_.dataset.origin),T=Number(_.dataset.height),S=Number.parseFloat(Number(T/M).toFixed(2));Number.isNaN(S)||i("ratio",S)},x=_=>{r.value||(_.preventDefault(),_.stopPropagation(),window.addEventListener("pointermove",v),window.addEventListener("pointerup",k))};return()=>J(Zn,null,J("div",{class:"image-wrapper"},J("div",{class:"operation"},J("div",{class:"operation-item",onPointerdown:p},J(Dh,{icon:s.captionIcon}))),J("img",{ref:l,"data-type":iv,onLoad:f,src:n.value,alt:e.value}),J("div",{ref:a,class:"image-resize-handle",onPointerdown:x})),c.value&&J("input",{draggable:"true",onDragstart:_=>{_.preventDefault(),_.stopPropagation()},class:"caption-input",placeholder:s==null?void 0:s.captionPlaceholderText,onInput:g,onBlur:y,value:e.value}))}});var hK=Object.defineProperty,eE=Object.getOwnPropertySymbols,dK=Object.prototype.hasOwnProperty,pK=Object.prototype.propertyIsEnumerable,tE=(n,e,t)=>e in n?hK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,mK=(n,e)=>{for(var t in e||(e={}))dK.call(e,t)&&tE(n,t,e[t]);if(eE)for(var t of eE(e))pK.call(e,t)&&tE(n,t,e[t]);return n};const gK=tr({props:{src:{type:Object,required:!0},caption:{type:Object,required:!0},ratio:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setAttr:{type:Function,required:!0},config:{type:Object,required:!0}},setup(n){const{src:e}=n;return()=>{var t;return(t=e.value)!=null&&t.length?J(fK,mK({},n)):J(uK,{src:n.src,selected:n.selected,readonly:n.readonly,setLink:r=>n.setAttr("src",r),imageIcon:n.config.imageIcon,uploadButton:n.config.uploadButton,confirmButton:n.config.confirmButton,uploadPlaceholderText:n.config.uploadPlaceholderText,onUpload:n.config.onUpload})}}}),vI=op(py.node,n=>(e,t,r)=>{const i=Ve(e.attrs.src),s=Ve(e.attrs.caption),o=Ve(e.attrs.ratio),l=Ve(!1),a=Ve(!t.editable),c=(k,x)=>{if(!t.editable)return;const _=r();_!=null&&t.dispatch(t.state.tr.setNodeAttribute(_,k,k==="src"?Ei.sanitize(x):x))},u=n.get(dy.key),f=es(gK,{src:i,caption:s,ratio:o,selected:l,readonly:a,setAttr:c,config:u}),p=document.createElement("div");p.className="milkdown-image-block";const g=Fu(()=>{l.value?p.classList.add("selected"):p.classList.remove("selected")}),y=u.proxyDomURL,v=k=>{if(!y)i.value=k.attrs.src;else{const x=y(k.attrs.src);typeof x=="string"?i.value=x:x.then(_=>{i.value=_}).catch(console.error)}o.value=k.attrs.ratio,s.value=k.attrs.caption,a.value=!t.editable};return v(e),f.mount(p),{dom:p,update:k=>k.type!==e.type?!1:(v(k),!0),stopEvent:k=>k.target instanceof HTMLInputElement,selectNode:()=>{l.value=!0},deselectNode:()=>{l.value=!1},destroy:()=>{g(),f.unmount(),p.remove()}}});pp(vI,{displayName:"NodeView<image-block>",group:"ImageBlock"});const yK=[zC,py,vI,dy].flat();var sv,ov;if(typeof WeakMap<"u"){let n=new WeakMap;sv=e=>n.get(e),ov=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;sv=r=>{for(let i=0;i<n.length;i+=2)if(n[i]==r)return n[i+1]},ov=(r,i)=>(t==10&&(t=0),n[t++]=r,n[t++]=i)}var Ot=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,i=e/this.width|0;let s=r+1,o=i+1;for(let l=1;s<this.width&&this.map[e+l]==t;l++)s++;for(let l=1;o<this.height&&this.map[e+this.width*l]==t;l++)o++;return{left:r,top:i,right:s,bottom:o}}throw new RangeError(`No cell with offset ${n} found`)}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError(`No cell with offset ${n} found`)}nextCell(n,e,t){const{left:r,right:i,top:s,bottom:o}=this.findCell(n);return e=="horiz"?(t<0?r==0:i==this.width)?null:this.map[s*this.width+(t<0?r-1:i)]:(t<0?s==0:o==this.height)?null:this.map[r+this.width*(t<0?s-1:o)]}rectBetween(n,e){const{left:t,right:r,top:i,bottom:s}=this.findCell(n),{left:o,right:l,top:a,bottom:c}=this.findCell(e);return{left:Math.min(t,o),top:Math.min(i,a),right:Math.max(r,l),bottom:Math.max(s,c)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let i=n.left;i<n.right;i++){const s=r*this.width+i,o=this.map[s];t[o]||(t[o]=!0,!(i==n.left&&i&&this.map[s-1]==o||r==n.top&&r&&this.map[s-this.width]==o)&&e.push(o))}return e}positionAt(n,e,t){for(let r=0,i=0;;r++){const s=i+t.child(r).nodeSize;if(r==n){let o=e+n*this.width;const l=(n+1)*this.width;for(;o<l&&this.map[o]<i;)o++;return o==l?s-1:this.map[o]}i=s}}static get(n){return sv(n)||ov(n,bK(n))}};function bK(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=wK(n),t=n.childCount,r=[];let i=0,s=null;const o=[];for(let c=0,u=e*t;c<u;c++)r[c]=0;for(let c=0,u=0;c<t;c++){const f=n.child(c);u++;for(let y=0;;y++){for(;i<r.length&&r[i]!=0;)i++;if(y==f.childCount)break;const v=f.child(y),{colspan:k,rowspan:x,colwidth:_}=v.attrs;for(let M=0;M<x;M++){if(M+c>=t){(s||(s=[])).push({type:"overlong_rowspan",pos:u,n:x-M});break}const T=i+M*e;for(let S=0;S<k;S++){r[T+S]==0?r[T+S]=u:(s||(s=[])).push({type:"collision",row:c,pos:u,n:k-S});const A=_&&_[S];if(A){const I=(T+S)%e*2,B=o[I];B==null||B!=A&&o[I+1]==1?(o[I]=A,o[I+1]=1):B==A&&o[I+1]++}}}i+=k,u+=v.nodeSize}const p=(c+1)*e;let g=0;for(;i<p;)r[i++]==0&&g++;g&&(s||(s=[])).push({type:"missing",row:c,n:g}),u++}(e===0||t===0)&&(s||(s=[])).push({type:"zero_sized"});const l=new Ot(e,t,r,s);let a=!1;for(let c=0;!a&&c<o.length;c+=2)o[c]!=null&&o[c+1]<t&&(a=!0);return a&&vK(l,o,n),l}function wK(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const i=n.child(r);let s=0;if(t)for(let o=0;o<r;o++){const l=n.child(o);for(let a=0;a<l.childCount;a++){const c=l.child(a);o+c.attrs.rowspan>r&&(s+=c.attrs.colspan)}}for(let o=0;o<i.childCount;o++){const l=i.child(o);s+=l.attrs.colspan,l.attrs.rowspan>1&&(t=!0)}e==-1?e=s:e!=s&&(e=Math.max(e,s))}return e}function vK(n,e,t){n.problems||(n.problems=[]);const r={};for(let i=0;i<n.map.length;i++){const s=n.map[i];if(r[s])continue;r[s]=!0;const o=t.nodeAt(s);if(!o)throw new RangeError(`No cell with offset ${s} found`);let l=null;const a=o.attrs;for(let c=0;c<a.colspan;c++){const u=(i+c)%n.width,f=e[u*2];f!=null&&(!a.colwidth||a.colwidth[c]!=f)&&((l||(l=kK(a)))[c]=f)}l&&n.problems.unshift({type:"colwidth mismatch",pos:s,colwidth:l})}}function kK(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function nE(n,e){if(typeof n=="string")return{};const t=n.getAttribute("data-colwidth"),r=t&&/^\d+(,\d+)*$/.test(t)?t.split(",").map(o=>Number(o)):null,i=Number(n.getAttribute("colspan")||1),s={colspan:i,rowspan:Number(n.getAttribute("rowspan")||1),colwidth:r&&r.length==i?r:null};for(const o in e){const l=e[o].getFromDOM,a=l&&l(n);a!=null&&(s[o]=a)}return s}function rE(n,e){const t={};n.attrs.colspan!=1&&(t.colspan=n.attrs.colspan),n.attrs.rowspan!=1&&(t.rowspan=n.attrs.rowspan),n.attrs.colwidth&&(t["data-colwidth"]=n.attrs.colwidth.join(","));for(const r in e){const i=e[r].setDOMAttr;i&&i(n.attrs[r],t)}return t}function CK(n){if(n!==null){if(!Array.isArray(n))throw new TypeError("colwidth must be null or an array");for(const e of n)if(typeof e!="number")throw new TypeError("colwidth must be null or an array of numbers")}}function SK(n){const e=n.cellAttributes||{},t={colspan:{default:1,validate:"number"},rowspan:{default:1,validate:"number"},colwidth:{default:null,validate:CK}};for(const r in e)t[r]={default:e[r].default,validate:e[r].validate};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:n.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:n.cellContent,attrs:t,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:r=>nE(r,e)}],toDOM(r){return["td",rE(r,e),0]}},table_header:{content:n.cellContent,attrs:t,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:r=>nE(r,e)}],toDOM(r){return["th",rE(r,e),0]}}}}function Ti(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],i=r.spec.tableRole;i&&(e[i]=r)}}return e}var Qo=new rn("selectingCells");function mp(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function Ai(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function my(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=mp(e.$head)||xK(e.$head);if(t)return t;throw new RangeError(`No cell found around position ${e.head}`)}function xK(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function lv(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function _K(n){return n.node(0).resolve(n.pos+n.nodeAfter.nodeSize)}function WC(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function kI(n,e,t){const r=n.node(-1),i=Ot.get(r),s=n.start(-1),o=i.nextCell(n.pos-s,e,t);return o==null?null:n.node(0).resolve(s+o)}function Ua(n,e,t=1){const r={...n,colspan:n.colspan-t};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}function MK(n,e,t=1){const r={...n,colspan:n.colspan+t};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let i=0;i<t;i++)r.colwidth.splice(e,0,0)}return r}function TK(n,e,t){const r=Ti(e.type.schema).header_cell;for(let i=0;i<n.height;i++)if(e.nodeAt(n.map[t+i*n.width]).type!=r)return!1;return!0}var jt=class Zs extends tt{constructor(e,t=e){const r=e.node(-1),i=Ot.get(r),s=e.start(-1),o=i.rectBetween(e.pos-s,t.pos-s),l=e.node(0),a=i.cellsInRect(o).filter(u=>u!=t.pos-s);a.unshift(t.pos-s);const c=a.map(u=>{const f=r.nodeAt(u);if(!f)throw RangeError(`No cell with offset ${u} found`);const p=s+u+1;return new EL(l.resolve(p),l.resolve(p+f.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),i=e.resolve(t.map(this.$headCell.pos));if(lv(r)&&lv(i)&&WC(r,i)){const s=this.$anchorCell.node(-1)!=r.node(-1);return s&&this.isRowSelection()?Zs.rowSelection(r,i):s&&this.isColSelection()?Zs.colSelection(r,i):new Zs(r,i)}return ze.between(r,i)}content(){const e=this.$anchorCell.node(-1),t=Ot.get(e),r=this.$anchorCell.start(-1),i=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),s={},o=[];for(let a=i.top;a<i.bottom;a++){const c=[];for(let u=a*t.width+i.left,f=i.left;f<i.right;f++,u++){const p=t.map[u];if(s[p])continue;s[p]=!0;const g=t.findCell(p);let y=e.nodeAt(p);if(!y)throw RangeError(`No cell with offset ${p} found`);const v=i.left-g.left,k=g.right-i.right;if(v>0||k>0){let x=y.attrs;if(v>0&&(x=Ua(x,0,v)),k>0&&(x=Ua(x,x.colspan-k,k)),g.left<i.left){if(y=y.type.createAndFill(x),!y)throw RangeError(`Could not create cell with attrs ${JSON.stringify(x)}`)}else y=y.type.create(x,y.content)}if(g.top<i.top||g.bottom>i.bottom){const x={...y.attrs,rowspan:Math.min(g.bottom,i.bottom)-Math.max(g.top,i.top)};g.top<i.top?y=y.type.createAndFill(x):y=y.type.create(x,y.content)}c.push(y)}o.push(e.child(a).copy(we.from(c)))}const l=this.isColSelection()&&this.isRowSelection()?e:o;return new Le(we.from(l),1,1)}replace(e,t=Le.empty){const r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){const{$from:l,$to:a}=i[o],c=e.mapping.slice(r);e.replace(c.map(l.pos),c.map(a.pos),o?Le.empty:t)}const s=tt.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);s&&e.setSelection(s)}replaceWith(e,t){this.replace(e,new Le(we.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=Ot.get(t),i=this.$anchorCell.start(-1),s=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let o=0;o<s.length;o++)e(t.nodeAt(s[o]),i+s[o])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),i=Ot.get(r),s=e.start(-1),o=i.findCell(e.pos-s),l=i.findCell(t.pos-s),a=e.node(0);return o.top<=l.top?(o.top>0&&(e=a.resolve(s+i.map[o.left])),l.bottom<i.height&&(t=a.resolve(s+i.map[i.width*(i.height-1)+l.right-1]))):(l.top>0&&(t=a.resolve(s+i.map[l.left])),o.bottom<i.height&&(e=a.resolve(s+i.map[i.width*(i.height-1)+o.right-1]))),new Zs(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=Ot.get(e),r=this.$anchorCell.start(-1),i=t.colCount(this.$anchorCell.pos-r),s=t.colCount(this.$headCell.pos-r);if(Math.min(i,s)>0)return!1;const o=i+this.$anchorCell.nodeAfter.attrs.colspan,l=s+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,l)==t.width}eq(e){return e instanceof Zs&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),i=Ot.get(r),s=e.start(-1),o=i.findCell(e.pos-s),l=i.findCell(t.pos-s),a=e.node(0);return o.left<=l.left?(o.left>0&&(e=a.resolve(s+i.map[o.top*i.width])),l.right<i.width&&(t=a.resolve(s+i.map[i.width*(l.top+1)-1]))):(l.left>0&&(t=a.resolve(s+i.map[l.top*i.width])),o.right<i.width&&(e=a.resolve(s+i.map[i.width*(o.top+1)-1]))),new Zs(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new Zs(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new Zs(e.resolve(t),e.resolve(r))}getBookmark(){return new EK(this.$anchorCell.pos,this.$headCell.pos)}};jt.prototype.visible=!1;tt.jsonID("cell",jt);var EK=class CI{constructor(e,t){this.anchor=e,this.head=t}map(e){return new CI(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&WC(t,r)?new jt(t,r):tt.near(r,1)}};function AK(n){if(!(n.selection instanceof jt))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(Tn.node(r,r+t.nodeSize,{class:"selectedCell"}))}),Ft.create(n.doc,e)}function OK({$from:n,$to:e}){if(n.pos==e.pos||n.pos<e.pos-6)return!1;let t=n.pos,r=e.pos,i=n.depth;for(;i>=0&&!(n.after(i+1)<n.end(i));i--,t++);for(let s=e.depth;s>=0&&!(e.before(s+1)>e.start(s));s--,r--);return t==r&&/row|table/.test(n.node(i).type.spec.tableRole)}function LK({$from:n,$to:e}){let t,r;for(let i=n.depth;i>0;i--){const s=n.node(i);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){t=s;break}}for(let i=e.depth;i>0;i--){const s=e.node(i);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){r=s;break}}return t!==r&&e.parentOffset===0}function DK(n,e,t){const r=(e||n).selection,i=(e||n).doc;let s,o;if(r instanceof Ke&&(o=r.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")s=jt.create(i,r.from);else if(o=="row"){const l=i.resolve(r.from+1);s=jt.rowSelection(l,l)}else if(!t){const l=Ot.get(r.node),a=r.from+1,c=a+l.map[l.width*l.height-1];s=jt.create(i,a+1,c)}}else r instanceof ze&&OK(r)?s=ze.create(i,r.from):r instanceof ze&&LK(r)&&(s=ze.create(i,r.$from.start(),r.$from.end()));return s&&(e||(e=n.tr)).setSelection(s),e}var IK=new rn("fix-tables");function SI(n,e,t,r){const i=n.childCount,s=e.childCount;e:for(let o=0,l=0;o<s;o++){const a=e.child(o);for(let c=l,u=Math.min(i,o+3);c<u;c++)if(n.child(c)==a){l=c+1,t+=a.nodeSize;continue e}r(a,t),l<i&&n.child(l).sameMarkup(a)?SI(n.child(l),a,t+1,r):a.nodesBetween(0,a.content.size,r,t+1),t+=a.nodeSize}}function NK(n,e){let t;const r=(i,s)=>{i.type.spec.tableRole=="table"&&(t=RK(n,i,s,t))};return e?e.doc!=n.doc&&SI(e.doc,n.doc,0,r):n.doc.descendants(r),t}function RK(n,e,t,r){const i=Ot.get(e);if(!i.problems)return r;r||(r=n.tr);const s=[];for(let a=0;a<i.height;a++)s.push(0);for(let a=0;a<i.problems.length;a++){const c=i.problems[a];if(c.type=="collision"){const u=e.nodeAt(c.pos);if(!u)continue;const f=u.attrs;for(let p=0;p<f.rowspan;p++)s[c.row+p]+=c.n;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,Ua(f,f.colspan-c.n,c.n))}else if(c.type=="missing")s[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,rowspan:u.attrs.rowspan-c.n})}else if(c.type=="colwidth mismatch"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,colwidth:c.colwidth})}else if(c.type=="zero_sized"){const u=r.mapping.map(t);r.delete(u,u+e.nodeSize)}}let o,l;for(let a=0;a<s.length;a++)s[a]&&(o==null&&(o=a),l=a);for(let a=0,c=t+1;a<i.height;a++){const u=e.child(a),f=c+u.nodeSize,p=s[a];if(p>0){let g="cell";u.firstChild&&(g=u.firstChild.type.spec.tableRole);const y=[];for(let k=0;k<p;k++){const x=Ti(n.schema)[g].createAndFill();x&&y.push(x)}const v=(a==0||o==a-1)&&l==a?c+1:f-1;r.insert(r.mapping.map(v),y)}c=f}return r.setMeta(IK,{fixTables:!0})}function xI(n){const e=Ot.get(n),t=[],r=e.height,i=e.width;for(let s=0;s<r;s++){const o=[];for(let l=0;l<i;l++){const a=s*i+l,c=e.map[a];if(s>0){const u=a-i,f=e.map[u];if(c===f){o.push(null);continue}}if(l>0){const u=a-1,f=e.map[u];if(c===f){o.push(null);continue}}o.push(n.nodeAt(c))}t.push(o)}return t}function _I(n,e){const t=[],r=Ot.get(n),i=r.height,s=r.width;for(let l=0;l<i;l++){const a=n.child(l),c=[];for(let f=0;f<s;f++){const p=e[l][f];if(!p)continue;const g=r.map[l*r.width+f],y=n.nodeAt(g);if(!y)continue;const v=y.type.createChecked(p.attrs,p.content,p.marks);c.push(v)}const u=a.type.createChecked(a.attrs,c,a.marks);t.push(u)}return n.type.createChecked(n.attrs,t,n.marks)}function ju(n){return PK(e=>e.type.spec.tableRole==="table",n)}function PK(n,e){for(let t=e.depth;t>=0;t-=1){const r=e.node(t);if(n(r)){const i=t===0?0:e.before(t),s=e.start(t);return{node:r,pos:i,start:s,depth:t}}}return null}function gc(n,e){const t=ju(e.$from);if(!t)return;const r=Ot.get(t.node);return n<0||n>r.width-1?void 0:r.cellsInRect({left:n,right:n+1,top:0,bottom:r.height}).map(s=>{const o=t.node.nodeAt(s),l=s+t.start;return{pos:l,start:l+1,node:o,depth:t.depth+2}})}function yc(n,e){const t=ju(e.$from);if(!t)return;const r=Ot.get(t.node);return n<0||n>r.height-1?void 0:r.cellsInRect({left:0,right:r.width,top:n,bottom:n+1}).map(s=>{const o=t.node.nodeAt(s),l=s+t.start;return{pos:l,start:l+1,node:o,depth:t.depth+2}})}function iE(n,e,t=e){let r=e,i=t;for(let f=e;f>=0;f--){const p=gc(f,n.selection);p&&p.forEach(g=>{const y=g.node.attrs.colspan+f-1;y>=r&&(r=f),y>i&&(i=y)})}for(let f=e;f<=i;f++){const p=gc(f,n.selection);p&&p.forEach(g=>{const y=g.node.attrs.colspan+f-1;g.node.attrs.colspan>1&&y>i&&(i=y)})}const s=[];for(let f=r;f<=i;f++){const p=gc(f,n.selection);p&&p.length>0&&s.push(f)}r=s[0],i=s[s.length-1];const o=gc(r,n.selection),l=yc(0,n.selection);if(!o||!l)return;const a=n.doc.resolve(o[o.length-1].pos);let c;for(let f=i;f>=r;f--){const p=gc(f,n.selection);if(p&&p.length>0){for(let g=l.length-1;g>=0;g--)if(l[g].pos===p[0].pos){c=p[0];break}if(c)break}}if(!c)return;const u=n.doc.resolve(c.pos);return{$anchor:a,$head:u,indexes:s}}function sE(n,e,t=e){let r=e,i=t;for(let f=e;f>=0;f--){const p=yc(f,n.selection);p&&p.forEach(g=>{const y=g.node.attrs.rowspan+f-1;y>=r&&(r=f),y>i&&(i=y)})}for(let f=e;f<=i;f++){const p=yc(f,n.selection);p&&p.forEach(g=>{const y=g.node.attrs.rowspan+f-1;g.node.attrs.rowspan>1&&y>i&&(i=y)})}const s=[];for(let f=r;f<=i;f++){const p=yc(f,n.selection);p&&p.length>0&&s.push(f)}r=s[0],i=s[s.length-1];const o=yc(r,n.selection),l=gc(0,n.selection);if(!o||!l)return;const a=n.doc.resolve(o[o.length-1].pos);let c;for(let f=i;f>=r;f--){const p=yc(f,n.selection);if(p&&p.length>0){for(let g=l.length-1;g>=0;g--)if(l[g].pos===p[0].pos){c=p[0];break}if(c)break}}if(!c)return;const u=n.doc.resolve(c.pos);return{$anchor:a,$head:u,indexes:s}}function MI(n,e,t,r){const i=e[0]>t[0]?-1:1,s=n.splice(e[0],e.length),o=s.length%2===0?1:0;let l;return l=i===-1?t[0]:t[t.length-1]-o,n.splice(l,0,...s),n}function oE(n){return n[0].map((e,t)=>n.map(r=>r[t]))}function BK(n){var e,t;const{tr:r,originIndex:i,targetIndex:s,select:o,pos:l}=n,a=r.doc.resolve(l),c=ju(a);if(!c)return!1;const u=(e=iE(r,i))==null?void 0:e.indexes,f=(t=iE(r,s))==null?void 0:t.indexes;if(!u||!f||u.includes(s))return!1;const p=HK(c.node,u,f);if(r.replaceWith(c.pos,c.pos+c.node.nodeSize,p),!o)return!0;const g=Ot.get(p),y=c.start,v=s,k=g.positionAt(g.height-1,v,p),x=r.doc.resolve(y+k),_=g.positionAt(0,v,p),M=r.doc.resolve(y+_);return r.setSelection(jt.colSelection(x,M)),!0}function HK(n,e,t,r){let i=oE(xI(n));return i=MI(i,e,t),i=oE(i),_I(n,i)}function VK(n){var e,t;const{tr:r,originIndex:i,targetIndex:s,select:o,pos:l}=n,a=r.doc.resolve(l),c=ju(a);if(!c)return!1;const u=(e=sE(r,i))==null?void 0:e.indexes,f=(t=sE(r,s))==null?void 0:t.indexes;if(!u||!f||u.includes(s))return!1;const p=FK(c.node,u,f);if(r.replaceWith(c.pos,c.pos+c.node.nodeSize,p),!o)return!0;const g=Ot.get(p),y=c.start,v=s,k=g.positionAt(v,g.width-1,p),x=r.doc.resolve(y+k),_=g.positionAt(v,0,p),M=r.doc.resolve(y+_);return r.setSelection(jt.rowSelection(x,M)),!0}function FK(n,e,t,r){let i=xI(n);return i=MI(i,e,t),_I(n,i)}function _l(n){const e=n.selection,t=my(n),r=t.node(-1),i=t.start(-1),s=Ot.get(r);return{...e instanceof jt?s.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):s.findCell(t.pos-i),tableStart:i,map:s,table:r}}function TI(n,{map:e,tableStart:t,table:r},i){let s=i>0?-1:0;TK(e,r,i+s)&&(s=i==0||i==e.width?null:0);for(let o=0;o<e.height;o++){const l=o*e.width+i;if(i>0&&i<e.width&&e.map[l-1]==e.map[l]){const a=e.map[l],c=r.nodeAt(a);n.setNodeMarkup(n.mapping.map(t+a),null,MK(c.attrs,i-e.colCount(a))),o+=c.attrs.rowspan-1}else{const a=s==null?Ti(r.type.schema).cell:r.nodeAt(e.map[l+s]).type,c=e.positionAt(o,i,r);n.insert(n.mapping.map(t+c),a.createAndFill())}}return n}function jK(n,e){if(!Ai(n))return!1;if(e){const t=_l(n);e(TI(n.tr,t,t.left))}return!0}function $K(n,e){if(!Ai(n))return!1;if(e){const t=_l(n);e(TI(n.tr,t,t.right))}return!0}function zK(n,{map:e,table:t,tableStart:r},i){const s=n.mapping.maps.length;for(let o=0;o<e.height;){const l=o*e.width+i,a=e.map[l],c=t.nodeAt(a),u=c.attrs;if(i>0&&e.map[l-1]==a||i<e.width-1&&e.map[l+1]==a)n.setNodeMarkup(n.mapping.slice(s).map(r+a),null,Ua(u,i-e.colCount(a)));else{const f=n.mapping.slice(s).map(r+a);n.delete(f,f+c.nodeSize)}o+=u.rowspan}}function WK(n,e){if(!Ai(n))return!1;if(e){const t=_l(n),r=n.tr;if(t.left==0&&t.right==t.map.width)return!1;for(let i=t.right-1;zK(r,t,i),i!=t.left;i--){const s=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!s)throw RangeError("No table found");t.table=s,t.map=Ot.get(s)}e(r)}return!0}function qK(n,{map:e,table:t,tableStart:r},i){let s=0;for(let c=0;c<i;c++)s+=t.child(c).nodeSize;const o=s+t.child(i).nodeSize,l=n.mapping.maps.length;n.delete(s+r,o+r);const a=new Set;for(let c=0,u=i*e.width;c<e.width;c++,u++){const f=e.map[u];if(!a.has(f)){if(a.add(f),i>0&&f==e.map[u-e.width]){const p=t.nodeAt(f).attrs;n.setNodeMarkup(n.mapping.slice(l).map(f+r),null,{...p,rowspan:p.rowspan-1}),c+=p.colspan-1}else if(i<e.height&&f==e.map[u+e.width]){const p=t.nodeAt(f),g=p.attrs,y=p.type.create({...g,rowspan:p.attrs.rowspan-1},p.content),v=e.positionAt(i+1,c,t);n.insert(n.mapping.slice(l).map(r+v),y),c+=g.colspan-1}}}}function UK(n,e){if(!Ai(n))return!1;if(e){const t=_l(n),r=n.tr;if(t.top==0&&t.bottom==t.map.height)return!1;for(let i=t.bottom-1;qK(r,t,i),i!=t.top;i--){const s=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!s)throw RangeError("No table found");t.table=s,t.map=Ot.get(t.table)}e(r)}return!0}function KK(n,e){return function(t,r){if(!Ai(t))return!1;const i=my(t);if(i.nodeAfter.attrs[n]===e)return!1;if(r){const s=t.tr;t.selection instanceof jt?t.selection.forEachCell((o,l)=>{o.attrs[n]!==e&&s.setNodeMarkup(l,null,{...o.attrs,[n]:e})}):s.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[n]:e}),r(s)}return!0}}function GK(n){return function(e,t){if(!Ai(e))return!1;if(t){const r=Ti(e.schema),i=_l(e),s=e.tr,o=i.map.cellsInRect(n=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:n=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),l=o.map(a=>i.table.nodeAt(a));for(let a=0;a<o.length;a++)l[a].type==r.header_cell&&s.setNodeMarkup(i.tableStart+o[a],r.cell,l[a].attrs);if(s.steps.length==0)for(let a=0;a<o.length;a++)s.setNodeMarkup(i.tableStart+o[a],r.header_cell,l[a].attrs);t(s)}return!0}}function lE(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const s=e.table.nodeAt(r[i]);if(s&&s.type!==t.header_cell)return!1}return!0}function qC(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?GK(n):function(t,r){if(!Ai(t))return!1;if(r){const i=Ti(t.schema),s=_l(t),o=t.tr,l=lE("row",s,i),a=lE("column",s,i),u=(n==="column"?l:n==="row"?a:!1)?1:0,f=n=="column"?{left:0,top:u,right:1,bottom:s.map.height}:n=="row"?{left:u,top:0,right:s.map.width,bottom:1}:s,p=n=="column"?a?i.cell:i.header_cell:n=="row"?l?i.cell:i.header_cell:i.cell;s.map.cellsInRect(f).forEach(g=>{const y=g+s.tableStart,v=o.doc.nodeAt(y);v&&o.setNodeMarkup(y,p,v.attrs)}),r(o)}return!0}}qC("row",{useDeprecatedLogic:!0});qC("column",{useDeprecatedLogic:!0});qC("cell",{useDeprecatedLogic:!0});function JK(n,e){if(e<0){const t=n.nodeBefore;if(t)return n.pos-t.nodeSize;for(let r=n.index(-1)-1,i=n.before();r>=0;r--){const s=n.node(-1).child(r),o=s.lastChild;if(o)return i-1-o.nodeSize;i-=s.nodeSize}}else{if(n.index()<n.parent.childCount-1)return n.pos+n.nodeAfter.nodeSize;const t=n.node(-1);for(let r=n.indexAfter(-1),i=n.after();r<t.childCount;r++){const s=t.child(r);if(s.childCount)return i+1;i+=s.nodeSize}}return null}function EI(n){return function(e,t){if(!Ai(e))return!1;const r=JK(my(e),n);if(r==null)return!1;if(t){const i=e.doc.resolve(r);t(e.tr.setSelection(ze.between(i,_K(i))).scrollIntoView())}return!0}}function ZK(n,e){const t=n.selection.$anchor;for(let r=t.depth;r>0;r--)if(t.node(r).type.spec.tableRole=="table")return e&&e(n.tr.delete(t.before(r),t.after(r)).scrollIntoView()),!0;return!1}function fm(n,e){const t=n.selection;if(!(t instanceof jt))return!1;if(e){const r=n.tr,i=Ti(n.schema).cell.createAndFill().content;t.forEachCell((s,o)=>{s.content.eq(i)||r.replace(r.mapping.map(o+1),r.mapping.map(o+s.nodeSize-1),new Le(i,0,0))}),r.docChanged&&e(r)}return!0}function YK(n){return(e,t)=>{const{from:r,to:i,select:s=!0,pos:o=e.selection.from}=n,l=e.tr;return VK({tr:l,originIndex:r,targetIndex:i,select:s,pos:o})?(t==null||t(l),!0):!1}}function XK(n){return(e,t)=>{const{from:r,to:i,select:s=!0,pos:o=e.selection.from}=n,l=e.tr;return BK({tr:l,originIndex:r,targetIndex:i,select:s,pos:o})?(t==null||t(l),!0):!1}}function QK(n){if(!n.size)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const i=e.child(0),s=i.type.spec.tableRole,o=i.type.schema,l=[];if(s=="row")for(let a=0;a<e.childCount;a++){let c=e.child(a).content;const u=a?0:Math.max(0,t-1),f=a<e.childCount-1?0:Math.max(0,r-1);(u||f)&&(c=av(Ti(o).row,new Le(c,u,f)).content),l.push(c)}else if(s=="cell"||s=="header_cell")l.push(t||r?av(Ti(o).row,new Le(e,t,r)).content:e);else return null;return eG(o,l)}function eG(n,e){const t=[];for(let i=0;i<e.length;i++){const s=e[i];for(let o=s.childCount-1;o>=0;o--){const{rowspan:l,colspan:a}=s.child(o).attrs;for(let c=i;c<i+l;c++)t[c]=(t[c]||0)+a}}let r=0;for(let i=0;i<t.length;i++)r=Math.max(r,t[i]);for(let i=0;i<t.length;i++)if(i>=e.length&&e.push(we.empty),t[i]<r){const s=Ti(n).cell.createAndFill(),o=[];for(let l=t[i];l<r;l++)o.push(s);e[i]=e[i].append(we.from(o))}return{height:e.length,width:r,rows:e}}function av(n,e){const t=n.createAndFill();return new TL(t).replace(0,t.content.size,e).doc}function tG({width:n,height:e,rows:t},r,i){if(n!=r){const s=[],o=[];for(let l=0;l<t.length;l++){const a=t[l],c=[];for(let u=s[l]||0,f=0;u<r;f++){let p=a.child(f%a.childCount);u+p.attrs.colspan>r&&(p=p.type.createChecked(Ua(p.attrs,p.attrs.colspan,u+p.attrs.colspan-r),p.content)),c.push(p),u+=p.attrs.colspan;for(let g=1;g<p.attrs.rowspan;g++)s[l+g]=(s[l+g]||0)+p.attrs.colspan}o.push(we.from(c))}t=o,n=r}if(e!=i){const s=[];for(let o=0,l=0;o<i;o++,l++){const a=[],c=t[l%e];for(let u=0;u<c.childCount;u++){let f=c.child(u);o+f.attrs.rowspan>i&&(f=f.type.create({...f.attrs,rowspan:Math.max(1,i-f.attrs.rowspan)},f.content)),a.push(f)}s.push(we.from(a))}t=s,e=i}return{width:n,height:e,rows:t}}function nG(n,e,t,r,i,s,o){const l=n.doc.type.schema,a=Ti(l);let c,u;if(i>e.width)for(let f=0,p=0;f<e.height;f++){const g=t.child(f);p+=g.nodeSize;const y=[];let v;g.lastChild==null||g.lastChild.type==a.cell?v=c||(c=a.cell.createAndFill()):v=u||(u=a.header_cell.createAndFill());for(let k=e.width;k<i;k++)y.push(v);n.insert(n.mapping.slice(o).map(p-1+r),y)}if(s>e.height){const f=[];for(let y=0,v=(e.height-1)*e.width;y<Math.max(e.width,i);y++){const k=y>=e.width?!1:t.nodeAt(e.map[v+y]).type==a.header_cell;f.push(k?u||(u=a.header_cell.createAndFill()):c||(c=a.cell.createAndFill()))}const p=a.row.create(null,we.from(f)),g=[];for(let y=e.height;y<s;y++)g.push(p);n.insert(n.mapping.slice(o).map(r+t.nodeSize-2),g)}return!!(c||u)}function aE(n,e,t,r,i,s,o,l){if(o==0||o==e.height)return!1;let a=!1;for(let c=i;c<s;c++){const u=o*e.width+c,f=e.map[u];if(e.map[u-e.width]==f){a=!0;const p=t.nodeAt(f),{top:g,left:y}=e.findCell(f);n.setNodeMarkup(n.mapping.slice(l).map(f+r),null,{...p.attrs,rowspan:o-g}),n.insert(n.mapping.slice(l).map(e.positionAt(o,y,t)),p.type.createAndFill({...p.attrs,rowspan:g+p.attrs.rowspan-o})),c+=p.attrs.colspan-1}}return a}function cE(n,e,t,r,i,s,o,l){if(o==0||o==e.width)return!1;let a=!1;for(let c=i;c<s;c++){const u=c*e.width+o,f=e.map[u];if(e.map[u-1]==f){a=!0;const p=t.nodeAt(f),g=e.colCount(f),y=n.mapping.slice(l).map(f+r);n.setNodeMarkup(y,null,Ua(p.attrs,o-g,p.attrs.colspan-(o-g))),n.insert(y+p.nodeSize,p.type.createAndFill(Ua(p.attrs,0,o-g))),c+=p.attrs.rowspan-1}}return a}function uE(n,e,t,r,i){let s=t?n.doc.nodeAt(t-1):n.doc;if(!s)throw new Error("No table found");let o=Ot.get(s);const{top:l,left:a}=r,c=a+i.width,u=l+i.height,f=n.tr;let p=0;function g(){if(s=t?f.doc.nodeAt(t-1):f.doc,!s)throw new Error("No table found");o=Ot.get(s),p=f.mapping.maps.length}nG(f,o,s,t,c,u,p)&&g(),aE(f,o,s,t,a,c,l,p)&&g(),aE(f,o,s,t,a,c,u,p)&&g(),cE(f,o,s,t,l,u,a,p)&&g(),cE(f,o,s,t,l,u,c,p)&&g();for(let y=l;y<u;y++){const v=o.positionAt(y,a,s),k=o.positionAt(y,c,s);f.replace(f.mapping.slice(p).map(v+t),f.mapping.slice(p).map(k+t),new Le(i.rows[y-l],0,0))}g(),f.setSelection(new jt(f.doc.resolve(t+o.positionAt(l,a,s)),f.doc.resolve(t+o.positionAt(u-1,c-1,s)))),e(f)}var rG=pk({ArrowLeft:hm("horiz",-1),ArrowRight:hm("horiz",1),ArrowUp:hm("vert",-1),ArrowDown:hm("vert",1),"Shift-ArrowLeft":dm("horiz",-1),"Shift-ArrowRight":dm("horiz",1),"Shift-ArrowUp":dm("vert",-1),"Shift-ArrowDown":dm("vert",1),Backspace:fm,"Mod-Backspace":fm,Delete:fm,"Mod-Delete":fm});function sg(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function hm(n,e){return(t,r,i)=>{if(!i)return!1;const s=t.selection;if(s instanceof jt)return sg(t,r,tt.near(s.$headCell,e));if(n!="horiz"&&!s.empty)return!1;const o=AI(i,n,e);if(o==null)return!1;if(n=="horiz")return sg(t,r,tt.near(t.doc.resolve(s.head+e),e));{const l=t.doc.resolve(o),a=kI(l,n,e);let c;return a?c=tt.near(a,1):e<0?c=tt.near(t.doc.resolve(l.before(-1)),-1):c=tt.near(t.doc.resolve(l.after(-1)),1),sg(t,r,c)}}}function dm(n,e){return(t,r,i)=>{if(!i)return!1;const s=t.selection;let o;if(s instanceof jt)o=s;else{const a=AI(i,n,e);if(a==null)return!1;o=new jt(t.doc.resolve(a))}const l=kI(o.$headCell,n,e);return l?sg(t,r,new jt(o.$anchorCell,l)):!1}}function iG(n,e){const t=n.state.doc,r=mp(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new jt(r))),!0):!1}function sG(n,e,t){if(!Ai(n.state))return!1;let r=QK(t);const i=n.state.selection;if(i instanceof jt){r||(r={width:1,height:1,rows:[we.from(av(Ti(n.state.schema).cell,t))]});const s=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),l=Ot.get(s).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return r=tG(r,l.right-l.left,l.bottom-l.top),uE(n.state,n.dispatch,o,l,r),!0}else if(r){const s=my(n.state),o=s.start(-1);return uE(n.state,n.dispatch,o,Ot.get(s.node(-1)).findCell(s.pos-o),r),!0}else return!1}function oG(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=fE(n,e.target);let i;if(e.shiftKey&&n.state.selection instanceof jt)s(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(i=mp(n.state.selection.$anchor))!=null&&((t=tb(n,e))==null?void 0:t.pos)!=i.pos)s(i,e),e.preventDefault();else if(!r)return;function s(a,c){let u=tb(n,c);const f=Qo.getState(n.state)==null;if(!u||!WC(a,u))if(f)u=a;else return;const p=new jt(a,u);if(f||!n.state.selection.eq(p)){const g=n.state.tr.setSelection(p);f&&g.setMeta(Qo,a.pos),n.dispatch(g)}}function o(){n.root.removeEventListener("mouseup",o),n.root.removeEventListener("dragstart",o),n.root.removeEventListener("mousemove",l),Qo.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(Qo,-1))}function l(a){const c=a,u=Qo.getState(n.state);let f;if(u!=null)f=n.state.doc.resolve(u);else if(fE(n,c.target)!=r&&(f=tb(n,e),!f))return o();f&&s(f,c)}n.root.addEventListener("mouseup",o),n.root.addEventListener("dragstart",o),n.root.addEventListener("mousemove",l)}function AI(n,e,t){if(!(n.state.selection instanceof ze))return null;const{$head:r}=n.state.selection;for(let i=r.depth-1;i>=0;i--){const s=r.node(i);if((t<0?r.index(i):r.indexAfter(i))!=(t<0?0:s.childCount))return null;if(s.type.spec.tableRole=="cell"||s.type.spec.tableRole=="header_cell"){const l=r.before(i),a=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(a)?l:null}}return null}function fE(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function tb(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});return t&&t?mp(n.state.doc.resolve(t.pos)):null}var lG=class{constructor(n,e){this.node=n,this.defaultCellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${e}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),cv(n,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(n){return n.type!=this.node.type?!1:(this.node=n,cv(n,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(n){return n.type=="attributes"&&(n.target==this.table||this.colgroup.contains(n.target))}};function cv(n,e,t,r,i,s){var o;let l=0,a=!0,c=e.firstChild;const u=n.firstChild;if(u){for(let f=0,p=0;f<u.childCount;f++){const{colspan:g,colwidth:y}=u.child(f).attrs;for(let v=0;v<g;v++,p++){const k=i==p?s:y&&y[v],x=k?k+"px":"";if(l+=k||r,k||(a=!1),c)c.style.width!=x&&(c.style.width=x),c=c.nextSibling;else{const _=document.createElement("col");_.style.width=x,e.appendChild(_)}}}for(;c;){const f=c.nextSibling;(o=c.parentNode)==null||o.removeChild(c),c=f}a?(t.style.width=l+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=l+"px")}}var si=new rn("tableColumnResizing");function aG({handleWidth:n=5,cellMinWidth:e=25,defaultCellMinWidth:t=100,View:r=lG,lastColumnResizable:i=!0}={}){const s=new nn({key:si,state:{init(o,l){var a,c;const u=(c=(a=s.spec)==null?void 0:a.props)==null?void 0:c.nodeViews,f=Ti(l.schema).table.name;return r&&u&&(u[f]=(p,g)=>new r(p,t,g)),new cG(-1,!1)},apply(o,l){return l.apply(o)}},props:{attributes:o=>{const l=si.getState(o);return l&&l.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,l)=>{uG(o,l,n,i)},mouseleave:o=>{fG(o)},mousedown:(o,l)=>{hG(o,l,e,t)}},decorations:o=>{const l=si.getState(o);if(l&&l.activeHandle>-1)return yG(o,l.activeHandle)},nodeViews:{}}});return s}var cG=class og{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(si);if(r&&r.setHandle!=null)return new og(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new og(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let i=e.mapping.map(t.activeHandle,-1);return lv(e.doc.resolve(i))||(i=-1),new og(i,t.dragging)}return t}};function uG(n,e,t,r){if(!n.editable)return;const i=si.getState(n.state);if(i&&!i.dragging){const s=pG(e.target);let o=-1;if(s){const{left:l,right:a}=s.getBoundingClientRect();e.clientX-l<=t?o=hE(n,e,"left",t):a-e.clientX<=t&&(o=hE(n,e,"right",t))}if(o!=i.activeHandle){if(!r&&o!==-1){const l=n.state.doc.resolve(o),a=l.node(-1),c=Ot.get(a),u=l.start(-1);if(c.colCount(l.pos-u)+l.nodeAfter.attrs.colspan-1==c.width-1)return}OI(n,o)}}}function fG(n){if(!n.editable)return;const e=si.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&OI(n,-1)}function hG(n,e,t,r){var i;if(!n.editable)return!1;const s=(i=n.dom.ownerDocument.defaultView)!=null?i:window,o=si.getState(n.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const l=n.state.doc.nodeAt(o.activeHandle),a=dG(n,o.activeHandle,l.attrs);n.dispatch(n.state.tr.setMeta(si,{setDragging:{startX:e.clientX,startWidth:a}}));function c(f){s.removeEventListener("mouseup",c),s.removeEventListener("mousemove",u);const p=si.getState(n.state);p!=null&&p.dragging&&(mG(n,p.activeHandle,dE(p.dragging,f,t)),n.dispatch(n.state.tr.setMeta(si,{setDragging:null})))}function u(f){if(!f.which)return c(f);const p=si.getState(n.state);if(p&&p.dragging){const g=dE(p.dragging,f,t);pE(n,p.activeHandle,g,r)}}return pE(n,o.activeHandle,a,r),s.addEventListener("mouseup",c),s.addEventListener("mousemove",u),e.preventDefault(),!0}function dG(n,e,{colspan:t,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const s=n.domAtPos(e);let l=s.node.childNodes[s.offset].offsetWidth,a=t;if(r)for(let c=0;c<t;c++)r[c]&&(l-=r[c],a--);return l/a}function pG(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function hE(n,e,t,r){const i=t=="right"?-r:r,s=n.posAtCoords({left:e.clientX+i,top:e.clientY});if(!s)return-1;const{pos:o}=s,l=mp(n.state.doc.resolve(o));if(!l)return-1;if(t=="right")return l.pos;const a=Ot.get(l.node(-1)),c=l.start(-1),u=a.map.indexOf(l.pos-c);return u%a.width==0?-1:c+a.map[u-1]}function dE(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function OI(n,e){n.dispatch(n.state.tr.setMeta(si,{setHandle:e}))}function mG(n,e,t){const r=n.state.doc.resolve(e),i=r.node(-1),s=Ot.get(i),o=r.start(-1),l=s.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,a=n.state.tr;for(let c=0;c<s.height;c++){const u=c*s.width+l;if(c&&s.map[u]==s.map[u-s.width])continue;const f=s.map[u],p=i.nodeAt(f).attrs,g=p.colspan==1?0:l-s.colCount(f);if(p.colwidth&&p.colwidth[g]==t)continue;const y=p.colwidth?p.colwidth.slice():gG(p.colspan);y[g]=t,a.setNodeMarkup(o+f,null,{...p,colwidth:y})}a.docChanged&&n.dispatch(a)}function pE(n,e,t,r){const i=n.state.doc.resolve(e),s=i.node(-1),o=i.start(-1),l=Ot.get(s).colCount(i.pos-o)+i.nodeAfter.attrs.colspan-1;let a=n.domAtPos(i.start(-1)).node;for(;a&&a.nodeName!="TABLE";)a=a.parentNode;a&&cv(s,a.firstChild,a,r,l,t)}function gG(n){return Array(n).fill(0)}function yG(n,e){var t;const r=[],i=n.doc.resolve(e),s=i.node(-1);if(!s)return Ft.empty;const o=Ot.get(s),l=i.start(-1),a=o.colCount(i.pos-l)+i.nodeAfter.attrs.colspan-1;for(let c=0;c<o.height;c++){const u=a+c*o.width;if((a==o.width-1||o.map[u]!=o.map[u+1])&&(c==0||o.map[u]!=o.map[u-o.width])){const f=o.map[u],p=l+f+s.nodeAt(f).nodeSize-1,g=document.createElement("div");g.className="column-resize-handle",(t=si.getState(n))!=null&&t.dragging&&r.push(Tn.node(l+f,l+f+s.nodeAt(f).nodeSize,{class:"column-resize-dragging"})),r.push(Tn.widget(p,g))}}return Ft.create(n.doc,r)}function bG({allowTableNodeSelection:n=!1}={}){return new nn({key:Qo,state:{init(){return null},apply(e,t){const r=e.getMeta(Qo);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:i,pos:s}=e.mapping.mapResult(t);return i?null:s}},props:{decorations:AK,handleDOMEvents:{mousedown:oG},createSelectionBetween(e){return Qo.getState(e.state)!=null?e.state.selection:null},handleTripleClick:iG,handleKeyDown:rG,handlePaste:sG},appendTransaction(e,t,r){return DK(r,NK(r,t),n)}})}var f0=typeof navigator<"u"?navigator:null,UC=f0&&f0.userAgent||"",wG=/Edge\/(\d+)/.exec(UC),vG=/MSIE \d/.exec(UC),kG=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(UC),CG=!!(vG||kG||wG),SG=!CG&&!!f0&&/Apple Computer/.test(f0.vendor),LI=new rn("safari-ime-span"),uv=!1,xG={key:LI,props:{decorations:_G,handleDOMEvents:{compositionstart:()=>{uv=!0},compositionend:()=>{uv=!1}}}};function _G(n){const{$from:e,$to:t,to:r}=n.selection;if(uv&&e.sameParent(t)){const i=Tn.widget(r,MG,{ignoreSelection:!0,key:"safari-ime-span"});return Ft.create(n.doc,[i])}}function MG(n){const e=n.dom.ownerDocument.createElement("span");return e.className="ProseMirror-safari-ime-span",e}var TG=new nn(SG?xG:{key:LI});DI.peek=PG;function EG(){this.buffer()}function AG(n){this.enter({type:"footnoteReference",identifier:"",label:""},n)}function OG(){this.buffer()}function LG(n){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},n)}function DG(n){const e=this.resume(),t=this.stack[this.stack.length-1];vA(t.type==="footnoteReference"),t.identifier=kA(this.sliceSerialize(n)).toLowerCase(),t.label=e}function IG(n){this.exit(n)}function NG(n){const e=this.resume(),t=this.stack[this.stack.length-1];vA(t.type==="footnoteDefinition"),t.identifier=kA(this.sliceSerialize(n)).toLowerCase(),t.label=e}function RG(n){this.exit(n)}function PG(){return"["}function DI(n,e,t,r){const i=t.createTracker(r);let s=i.move("[^");const o=t.enter("footnoteReference"),l=t.enter("reference");return s+=i.move(t.safe(t.associationId(n),{after:"]",before:s})),l(),o(),s+=i.move("]"),s}function BG(){return{enter:{gfmFootnoteCallString:EG,gfmFootnoteCall:AG,gfmFootnoteDefinitionLabelString:OG,gfmFootnoteDefinition:LG},exit:{gfmFootnoteCallString:DG,gfmFootnoteCall:IG,gfmFootnoteDefinitionLabelString:NG,gfmFootnoteDefinition:RG}}}function HG(n){let e=!1;return n&&n.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:t,footnoteReference:DI},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,i,s,o){const l=s.createTracker(o);let a=l.move("[^");const c=s.enter("footnoteDefinition"),u=s.enter("label");return a+=l.move(s.safe(s.associationId(r),{before:a,after:"]"})),u(),a+=l.move("]:"),r.children&&r.children.length>0&&(l.shift(4),a+=l.move((e?`
`:" ")+s.indentLines(s.containerFlow(r,l.current()),e?II:VG))),c(),a}}function VG(n,e,t){return e===0?n:II(n,e,t)}function II(n,e,t){return(t?"":"    ")+n}function FG(){return[N3(),BG(),R3(),P3(),B3()]}function jG(n){return{extensions:[H3(),HG(n),V3(),F3(n),j3()]}}const $G={};function zG(n){const e=this,t=n||$G,r=e.data(),i=r.micromarkExtensions||(r.micromarkExtensions=[]),s=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);i.push($3(t)),s.push(FG()),o.push(jG(t))}function Qe(n,e){return Object.assign(n,{meta:{package:"@milkdown/preset-gfm",...e}}),n}const KC=lp("strike_through");Qe(KC,{displayName:"Attr<strikethrough>",group:"Strikethrough"});const $u=Ru("strike_through",n=>({parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>e==="line-through"}],toDOM:e=>["del",n.get(KC.key)(e)],parseMarkdown:{match:e=>e.type==="delete",runner:(e,t,r)=>{e.openMark(r),e.next(t.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name==="strike_through",runner:(e,t)=>{e.withMark(t,"delete")}}}));Qe($u.mark,{displayName:"MarkSchema<strikethrough>",group:"Strikethrough"});Qe($u.ctx,{displayName:"MarkSchemaCtx<strikethrough>",group:"Strikethrough"});const gy=et("ToggleStrikeThrough",n=>()=>K0($u.type(n)));Qe(gy,{displayName:"Command<ToggleStrikethrough>",group:"Strikethrough"});const NI=hr(n=>np(new RegExp("(?<![\\w:/])(~{1,2})(.+?)\\1(?!\\w|\\/)"),$u.type(n)));Qe(NI,{displayName:"InputRule<strikethrough>",group:"Strikethrough"});const GC=Kr("strikeThroughKeymap",{ToggleStrikethrough:{shortcuts:"Mod-Alt-x",command:n=>{const e=n.get(Be);return()=>e.call(gy.key)}}});Qe(GC.ctx,{displayName:"KeymapCtx<strikethrough>",group:"Strikethrough"});Qe(GC.shortcuts,{displayName:"Keymap<strikethrough>",group:"Strikethrough"});const gp=SK({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:n=>n.style.textAlign||"left",setDOMAttr:(n,e)=>{e.style=`text-align: ${n||"left"}`}}}}),Ml=vn("table",()=>({...gp.table,content:"table_header_row table_row+",disableDropCursor:!0,parseMarkdown:{match:n=>n.type==="table",runner:(n,e,t)=>{const r=e.align,i=e.children.map((s,o)=>({...s,align:r,isHeader:o===0}));n.openNode(t),n.next(i),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table",runner:(n,e)=>{var i;const t=(i=e.content.firstChild)==null?void 0:i.content;if(!t)return;const r=[];t.forEach(s=>{r.push(s.attrs.alignment)}),n.openNode("table",void 0,{align:r}),n.next(e.content),n.closeNode()}}}));Qe(Ml.node,{displayName:"NodeSchema<table>",group:"Table"});Qe(Ml.ctx,{displayName:"NodeSchemaCtx<table>",group:"Table"});const yy=vn("table_header_row",()=>({...gp.table_row,disableDropCursor:!0,content:"(table_header)*",parseDOM:[{tag:"tr[data-is-header]"}],toDOM(){return["tr",{"data-is-header":!0},0]},parseMarkdown:{match:n=>!!(n.type==="tableRow"&&n.isHeader),runner:(n,e,t)=>{const r=e.align,i=e.children.map((s,o)=>({...s,align:r[o],isHeader:e.isHeader}));n.openNode(t),n.next(i),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table_header_row",runner:(n,e)=>{n.openNode("tableRow",void 0,{isHeader:!0}),n.next(e.content),n.closeNode()}}}));Qe(yy.node,{displayName:"NodeSchema<tableHeaderRow>",group:"Table"});Qe(yy.ctx,{displayName:"NodeSchemaCtx<tableHeaderRow>",group:"Table"});const yp=vn("table_row",()=>({...gp.table_row,disableDropCursor:!0,content:"(table_cell)*",parseMarkdown:{match:n=>n.type==="tableRow",runner:(n,e,t)=>{const r=e.align,i=e.children.map((s,o)=>({...s,align:r[o]}));n.openNode(t),n.next(i),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table_row",runner:(n,e)=>{e.content.size!==0&&(n.openNode("tableRow"),n.next(e.content),n.closeNode())}}}));Qe(yp.node,{displayName:"NodeSchema<tableRow>",group:"Table"});Qe(yp.ctx,{displayName:"NodeSchemaCtx<tableRow>",group:"Table"});const bp=vn("table_cell",()=>({...gp.table_cell,disableDropCursor:!0,parseMarkdown:{match:n=>n.type==="tableCell"&&!n.isHeader,runner:(n,e,t)=>{const r=e.align;n.openNode(t,{alignment:r}).openNode(n.schema.nodes.paragraph).next(e.children).closeNode().closeNode()}},toMarkdown:{match:n=>n.type.name==="table_cell",runner:(n,e)=>{n.openNode("tableCell").next(e.content).closeNode()}}}));Qe(bp.node,{displayName:"NodeSchema<tableCell>",group:"Table"});Qe(bp.ctx,{displayName:"NodeSchemaCtx<tableCell>",group:"Table"});const wp=vn("table_header",()=>({...gp.table_header,disableDropCursor:!0,parseMarkdown:{match:n=>n.type==="tableCell"&&!!n.isHeader,runner:(n,e,t)=>{const r=e.align;n.openNode(t,{alignment:r}),n.openNode(n.schema.nodes.paragraph),n.next(e.children),n.closeNode(),n.closeNode()}},toMarkdown:{match:n=>n.type.name==="table_header",runner:(n,e)=>{n.openNode("tableCell"),n.next(e.content),n.closeNode()}}}));Qe(wp.node,{displayName:"NodeSchema<tableHeader>",group:"Table"});Qe(wp.ctx,{displayName:"NodeSchemaCtx<tableHeader>",group:"Table"});function JC(n,e=3,t=3){const r=Array(t).fill(0).map(()=>bp.type(n).createAndFill()),i=Array(t).fill(0).map(()=>wp.type(n).createAndFill()),s=Array(e).fill(0).map((o,l)=>l===0?yy.type(n).create(null,i):yp.type(n).create(null,r));return Ml.type(n).create(null,s)}function RI(n){return(e,t)=>r=>{t=t??r.selection.from;const i=r.doc.resolve(t),s=HL(a=>a.type.name==="table")(i),o=s?{node:s.node,from:s.start}:void 0,l=n==="row";if(o){const a=Ot.get(o.node);if(e>=0&&e<(l?a.height:a.width)){const c=a.positionAt(l?e:a.height-1,l?a.width-1:e,o.node),u=r.doc.resolve(o.from+c),f=l?jt.rowSelection:jt.colSelection,p=a.positionAt(l?e:0,l?0:e,o.node),g=r.doc.resolve(o.from+p);return BL(r.setSelection(f(u,g)))}}return r}}const WG=RI("row"),qG=RI("col");function PI(n,e,{map:t,tableStart:r,table:i},s){const o=Array(s).fill(0).reduce((a,c,u)=>a+i.child(u).nodeSize,r),l=Array(t.width).fill(0).map((a,c)=>{const u=i.nodeAt(t.map[c]);return bp.type(n).createAndFill({alignment:u==null?void 0:u.attrs.alignment})});return e.insert(o,yp.type(n).create(null,l)),e}function UG(n){const e=ju(n.$from);if(!e)return;const t=Ot.get(e.node);return t.cellsInRect({left:0,right:t.width,top:0,bottom:t.height}).map(i=>{const s=e.node.nodeAt(i),o=i+e.start;return{pos:o,start:o+1,node:s}})}function KG(n){const e=UG(n.selection);if(e&&e[0]){const t=n.doc.resolve(e[0].pos),r=e[e.length-1];if(r){const i=n.doc.resolve(r.pos);return BL(n.setSelection(new jt(i,t)))}}return n}const ZC=et("GoToPrevTableCell",()=>()=>EI(-1));Qe(ZC,{displayName:"Command<goToPrevTableCellCommand>",group:"Table"});const YC=et("GoToNextTableCell",()=>()=>EI(1));Qe(YC,{displayName:"Command<goToNextTableCellCommand>",group:"Table"});const XC=et("ExitTable",n=>()=>(e,t)=>{if(!Ai(e))return!1;const{$head:r}=e.selection,i=EF(r,Ml.type(n));if(!i)return!1;const{to:s}=i,o=e.tr.replaceWith(s,s,Xi.type(n).createAndFill());return o.setSelection(tt.near(o.doc.resolve(s),1)).scrollIntoView(),t==null||t(o),!0});Qe(XC,{displayName:"Command<breakTableCommand>",group:"Table"});const BI=et("InsertTable",n=>({row:e,col:t}={})=>(r,i)=>{const{selection:s,tr:o}=r,{from:l}=s,a=JC(n,e,t),c=o.replaceSelectionWith(a),u=tt.findFrom(c.doc.resolve(l),1,!0);return u&&c.setSelection(u),i==null||i(c),!0});Qe(BI,{displayName:"Command<insertTableCommand>",group:"Table"});const QC=et("MoveRow",()=>({from:n,to:e,pos:t}={})=>YK({from:n??0,to:e??0,pos:t}));Qe(QC,{displayName:"Command<moveRowCommand>",group:"Table"});const eS=et("MoveCol",()=>({from:n,to:e,pos:t}={})=>XK({from:n??0,to:e??0,pos:t}));Qe(eS,{displayName:"Command<moveColCommand>",group:"Table"});const sa=et("SelectRow",()=>(n={index:0})=>(e,t)=>{const{tr:r}=e;return!!(t==null?void 0:t(WG(n.index,n.pos)(r)))});Qe(sa,{displayName:"Command<selectRowCommand>",group:"Table"});const oa=et("SelectCol",()=>(n={index:0})=>(e,t)=>{const{tr:r}=e;return!!(t==null?void 0:t(qG(n.index,n.pos)(r)))});Qe(oa,{displayName:"Command<selectColCommand>",group:"Table"});const HI=et("SelectTable",()=>()=>(n,e)=>{const{tr:t}=n;return!!(e==null?void 0:e(KG(t)))});Qe(HI,{displayName:"Command<selectTableCommand>",group:"Table"});const tS=et("DeleteSelectedCells",()=>()=>(n,e)=>{const{selection:t}=n;if(!(t instanceof jt))return!1;const r=t.isRowSelection(),i=t.isColSelection();return r&&i?ZK(n,e):i?WK(n,e):UK(n,e)});Qe(tS,{displayName:"Command<deleteSelectedCellsCommand>",group:"Table"});const nS=et("AddColBefore",()=>()=>jK);Qe(nS,{displayName:"Command<addColBeforeCommand>",group:"Table"});const rS=et("AddColAfter",()=>()=>$K);Qe(rS,{displayName:"Command<addColAfterCommand>",group:"Table"});const iS=et("AddRowBefore",n=>()=>(e,t)=>{if(!Ai(e))return!1;if(t){const r=_l(e);t(PI(n,e.tr,r,r.top))}return!0});Qe(iS,{displayName:"Command<addRowBeforeCommand>",group:"Table"});const sS=et("AddRowAfter",n=>()=>(e,t)=>{if(!Ai(e))return!1;if(t){const r=_l(e);t(PI(n,e.tr,r,r.bottom))}return!0});Qe(sS,{displayName:"Command<addRowAfterCommand>",group:"Table"});const oS=et("SetAlign",()=>(n="left")=>KK("alignment",n));Qe(oS,{displayName:"Command<setAlignCommand>",group:"Table"});const VI=hr(n=>new qr(/^\|(?<col>\d+)[xX](?<row>\d+)\|\s$/,(e,t,r,i)=>{var c,u;const s=e.doc.resolve(r);if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),Ml.type(n)))return null;const o=Math.max(Number(((c=t.groups)==null?void 0:c.row)??0),2),l=JC(n,o,Number((u=t.groups)==null?void 0:u.col)),a=e.tr.replaceRangeWith(r,i,l);return a.setSelection(ze.create(a.doc,r+3)).scrollIntoView()}));Qe(VI,{displayName:"InputRule<insertTableInputRule>",group:"Table"});const FI=Cz(n=>({run:(e,t,r)=>{if(r)return e;let i=e.content;return e.content.forEach((s,o,l)=>{var k;if((s==null?void 0:s.type)!==Ml.type(n))return;const a=s.childCount,c=((k=s.lastChild)==null?void 0:k.childCount)??0;if(a===0||c===0){i=i.replaceChild(l,Xi.type(n).create());return}const u=s.firstChild;if(!(c>0&&u&&u.childCount===0))return;const p=Array(c).fill(0).map(()=>wp.type(n).createAndFill()),g=new Le(we.from(p),0,0),y=u.replace(0,0,g),v=s.replace(0,u.nodeSize,new Le(we.from(y),0,0));i=i.replaceChild(l,v)}),new Le(we.from(i),e.openStart,e.openEnd)}}));Qe(FI,{displayName:"PasteRule<table>",group:"Table"});const lS=Kr("tableKeymap",{NextCell:{priority:100,shortcuts:["Mod-]","Tab"],command:n=>{const e=n.get(Be);return()=>e.call(YC.key)}},PrevCell:{shortcuts:["Mod-[","Shift-Tab"],command:n=>{const e=n.get(Be);return()=>e.call(ZC.key)}},ExitTable:{shortcuts:["Mod-Enter","Enter"],command:n=>{const e=n.get(Be);return()=>e.call(XC.key)}}});Qe(lS.ctx,{displayName:"KeymapCtx<table>",group:"Table"});Qe(lS.shortcuts,{displayName:"Keymap<table>",group:"Table"});const nb="footnote_definition",mE="footnoteDefinition",aS=vn("footnote_definition",()=>({group:"block",content:"block+",defining:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:`dl[data-type="${nb}"]`,getAttrs:n=>{if(!(n instanceof HTMLElement))throw Zi(n);return{label:n.dataset.label}},contentElement:"dd"}],toDOM:n=>{const e=n.attrs.label;return["dl",{"data-label":e,"data-type":nb},["dt",e],["dd",0]]},parseMarkdown:{match:({type:n})=>n===mE,runner:(n,e,t)=>{n.openNode(t,{label:e.label}).next(e.children).closeNode()}},toMarkdown:{match:n=>n.type.name===nb,runner:(n,e)=>{n.openNode(mE,void 0,{label:e.attrs.label,identifier:e.attrs.label}).next(e.content).closeNode()}}}));Qe(aS.ctx,{displayName:"NodeSchemaCtx<footnodeDef>",group:"footnote"});Qe(aS.node,{displayName:"NodeSchema<footnodeDef>",group:"footnote"});const rb="footnote_reference",cS=vn("footnote_reference",()=>({group:"inline",inline:!0,atom:!0,attrs:{label:{default:"",validate:"string"}},parseDOM:[{tag:`sup[data-type="${rb}"]`,getAttrs:n=>{if(!(n instanceof HTMLElement))throw Zi(n);return{label:n.dataset.label}}}],toDOM:n=>{const e=n.attrs.label;return["sup",{"data-label":e,"data-type":rb},e]},parseMarkdown:{match:({type:n})=>n==="footnoteReference",runner:(n,e,t)=>{n.addNode(t,{label:e.label})}},toMarkdown:{match:n=>n.type.name===rb,runner:(n,e)=>{n.addNode("footnoteReference",void 0,void 0,{label:e.attrs.label,identifier:e.attrs.label})}}}));Qe(cS.ctx,{displayName:"NodeSchemaCtx<footnodeRef>",group:"footnote"});Qe(cS.node,{displayName:"NodeSchema<footnodeRef>",group:"footnote"});const uS=Qi.extendSchema(n=>e=>{const t=n(e);return{...t,attrs:{...t.attrs,checked:{default:null,validate:"boolean|null"}},parseDOM:[{tag:'li[data-item-type="task"]',getAttrs:r=>{if(!(r instanceof HTMLElement))throw Zi(r);return{label:r.dataset.label,listType:r.dataset.listType,spread:r.dataset.spread,checked:r.dataset.checked?r.dataset.checked==="true":null}}},...(t==null?void 0:t.parseDOM)||[]],toDOM:r=>t.toDOM&&r.attrs.checked==null?t.toDOM(r):["li",{"data-item-type":"task","data-label":r.attrs.label,"data-list-type":r.attrs.listType,"data-spread":r.attrs.spread,"data-checked":r.attrs.checked},0],parseMarkdown:{match:({type:r})=>r==="listItem",runner:(r,i,s)=>{if(i.checked==null){t.parseMarkdown.runner(r,i,s);return}const o=i.label!=null?`${i.label}.`:"",l=i.checked!=null?!!i.checked:null,a=i.label!=null?"ordered":"bullet",c=i.spread!=null?`${i.spread}`:"true";r.openNode(s,{label:o,listType:a,spread:c,checked:l}),r.next(i.children),r.closeNode()}},toMarkdown:{match:r=>r.type.name==="list_item",runner:(r,i)=>{if(i.attrs.checked==null){t.toMarkdown.runner(r,i);return}const s=i.attrs.label,o=i.attrs.listType,l=i.attrs.spread==="true",a=i.attrs.checked;r.openNode("listItem",void 0,{label:s,listType:o,spread:l,checked:a}),r.next(i.content),r.closeNode()}}}});Qe(uS.node,{displayName:"NodeSchema<taskListItem>",group:"ListItem"});Qe(uS.ctx,{displayName:"NodeSchemaCtx<taskListItem>",group:"ListItem"});const jI=hr(()=>new qr(/^\[(?<checked>\s|x)\]\s$/,(n,e,t,r)=>{var u;const i=n.doc.resolve(t);let s=0,o=i.node(s);for(;o&&o.type.name!=="list_item";)s--,o=i.node(s);if(!o||o.attrs.checked!=null)return null;const l=((u=e.groups)==null?void 0:u.checked)==="x",a=i.before(s),c=n.tr;return c.deleteRange(t,r).setNodeMarkup(a,void 0,{...o.attrs,checked:l}),c}));Qe(jI,{displayName:"InputRule<wrapInTaskListInputRule>",group:"ListItem"});const GG=[GC,lS].flat(),JG=[VI,jI],ZG=[NI],YG=[FI],$I=An(()=>TG);Qe($I,{displayName:"Prose<autoInsertSpanPlugin>",group:"Prose"});const XG=An(()=>aG({}));Qe(XG,{displayName:"Prose<columnResizingPlugin>",group:"Prose"});const zI=An(()=>bG({allowTableNodeSelection:!0}));Qe(zI,{displayName:"Prose<tableEditingPlugin>",group:"Prose"});const fS=Rs("remarkGFM",()=>zG);Qe(fS.plugin,{displayName:"Remark<remarkGFMPlugin>",group:"Remark"});Qe(fS.options,{displayName:"RemarkConfig<remarkGFMPlugin>",group:"Remark"});const QG=new rn("MILKDOWN_KEEP_TABLE_ALIGN_PLUGIN");function eJ(n,e){let t=0;return e.forEach((r,i,s)=>{r===n&&(t=s)}),t}const WI=An(()=>new nn({key:QG,appendTransaction:(n,e,t)=>{let r;const i=(s,o)=>{if(r||(r=t.tr),s.type.name!=="table_cell")return;const l=t.doc.resolve(o),a=l.node(l.depth),u=l.node(l.depth-1).firstChild;if(!u)return;const f=eJ(s,a),p=u.maybeChild(f);if(!p)return;const g=p.attrs.alignment,y=s.attrs.alignment;g!==y&&r.setNodeMarkup(o,void 0,{...s.attrs,alignment:g})};return e.doc!==t.doc&&t.doc.descendants(i),r}}));Qe(WI,{displayName:"Prose<keepTableAlignPlugin>",group:"Prose"});const tJ=[WI,$I,fS,zI].flat(),nJ=[uS,Ml,yy,yp,wp,bp,aS,cS,KC,$u].flat(),rJ=[YC,ZC,XC,BI,QC,eS,sa,oa,HI,tS,iS,sS,nS,rS,oS,gy],iJ=[nJ,JG,YG,ZG,GG,rJ,tJ].flat(),sJ=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),r=dS(n.state,t.from);return r.line?oJ(n):r.block?aJ(n):!1};function hS(n,e){return({state:t,dispatch:r})=>{if(t.readOnly)return!1;let i=n(e,t);return i?(r(t.update(i)),!0):!1}}const oJ=hS(fJ,0),lJ=hS(qI,0),aJ=hS((n,e)=>qI(n,e,uJ(e)),0);function dS(n,e){let t=n.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const mf=50;function cJ(n,{open:e,close:t},r,i){let s=n.sliceDoc(r-mf,r),o=n.sliceDoc(i,i+mf),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(o)[0].length,c=s.length-l;if(s.slice(c-e.length,c)==e&&o.slice(a,a+t.length)==t)return{open:{pos:r-l,margin:l&&1},close:{pos:i+a,margin:a&&1}};let u,f;i-r<=2*mf?u=f=n.sliceDoc(r,i):(u=n.sliceDoc(r,r+mf),f=n.sliceDoc(i-mf,i));let p=/^\s*/.exec(u)[0].length,g=/\s*$/.exec(f)[0].length,y=f.length-g-t.length;return u.slice(p,p+e.length)==e&&f.slice(y,y+t.length)==t?{open:{pos:r+p+e.length,margin:/\s/.test(u.charAt(p+e.length))?1:0},close:{pos:i-g-t.length,margin:/\s/.test(f.charAt(y-1))?1:0}}:null}function uJ(n){let e=[];for(let t of n.selection.ranges){let r=n.doc.lineAt(t.from),i=t.to<=r.to?r:n.doc.lineAt(t.to);i.from>r.from&&i.from==t.to&&(i=t.to==r.to+1?r:n.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>r.from?e[s].to=i.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:i.to})}return e}function qI(n,e,t=e.selection.ranges){let r=t.map(s=>dS(e,s.from).block);if(!r.every(s=>s))return null;let i=t.map((s,o)=>cJ(e,r[o],s.from,s.to));if(n!=2&&!i.every(s=>s))return{changes:e.changes(t.map((s,o)=>i[o]?[]:[{from:s.from,insert:r[o].open+" "},{from:s.to,insert:" "+r[o].close}]))};if(n!=1&&i.some(s=>s)){let s=[];for(let o=0,l;o<i.length;o++)if(l=i[o]){let a=r[o],{open:c,close:u}=l;s.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+a.close.length})}return{changes:s}}return null}function fJ(n,e,t=e.selection.ranges){let r=[],i=-1;for(let{from:s,to:o}of t){let l=r.length,a=1e9,c=dS(e,s).line;if(c){for(let u=s;u<=o;){let f=e.doc.lineAt(u);if(f.from>i&&(s==o||o>f.from)){i=f.from;let p=/^\s*/.exec(f.text)[0].length,g=p==f.length,y=f.text.slice(p,p+c.length)==c?p:-1;p<f.text.length&&p<a&&(a=p),r.push({line:f,comment:y,token:c,indent:p,empty:g,single:!1})}u=f.to+1}if(a<1e9)for(let u=l;u<r.length;u++)r[u].indent<r[u].line.text.length&&(r[u].indent=a);r.length==l+1&&(r[l].single=!0)}}if(n!=2&&r.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:c,empty:u,single:f}of r)(f||!u)&&s.push({from:l.from+c,insert:a+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&r.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:a}of r)if(l>=0){let c=o.from+l,u=c+a.length;o.text[u-o.from]==" "&&u++,s.push({from:c,to:u})}return{changes:s}}return null}const fv=Mo.define(),hJ=Mo.define(),dJ=Ie.define(),UI=Ie.define({combine(n){return Is(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,i)=>e(r,i)||t(r,i)})}}),KI=jn.define({create(){return Ih.empty},update(n,e){let t=e.state.facet(UI),r=e.annotation(fv);if(r){let a=$r.fromTransaction(e,r.selection),c=r.side,u=c==0?n.undone:n.done;return a?u=h0(u,u.length,t.minDepth,a):u=ZI(u,e.startState.selection),new Ih(c==0?r.rest:u,c==0?u:r.rest)}let i=e.annotation(hJ);if((i=="full"||i=="before")&&(n=n.isolate()),e.annotation(Sr.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=$r.fromTransaction(e),o=e.annotation(Sr.time),l=e.annotation(Sr.userEvent);return s?n=n.addChanges(s,o,l,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,l,t.newGroupDelay)),(i=="full"||i=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Ih(n.done.map($r.fromJSON),n.undone.map($r.fromJSON))}});function pJ(n={}){return[KI,UI.of(n),Re.domEventHandlers({beforeinput(e,t){let r=e.inputType=="historyUndo"?GI:e.inputType=="historyRedo"?hv:null;return r?(e.preventDefault(),r(t)):!1}})]}function by(n,e){return function({state:t,dispatch:r}){if(!e&&t.readOnly)return!1;let i=t.field(KI,!1);if(!i)return!1;let s=i.pop(n,t,e);return s?(r(s),!0):!1}}const GI=by(0,!1),hv=by(1,!1),mJ=by(0,!0),gJ=by(1,!0);class $r{constructor(e,t,r,i,s){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new $r(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new $r(e.changes&&Ln.fromJSON(e.changes),[],e.mapped&&_s.fromJSON(e.mapped),e.startSelection&&re.fromJSON(e.startSelection),e.selectionsAfter.map(re.fromJSON))}static fromTransaction(e,t){let r=wi;for(let i of e.startState.facet(dJ)){let s=i(e);s.length&&(r=r.concat(s))}return!r.length&&e.changes.empty?null:new $r(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,wi)}static selection(e){return new $r(void 0,wi,void 0,void 0,e)}}function h0(n,e,t,r){let i=e+1>t+20?e-t-1:0,s=n.slice(i,e);return s.push(r),s}function yJ(n,e){let t=[],r=!1;return n.iterChangedRanges((i,s)=>t.push(i,s)),e.iterChangedRanges((i,s,o,l)=>{for(let a=0;a<t.length;){let c=t[a++],u=t[a++];l>=c&&o<=u&&(r=!0)}}),r}function bJ(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length===0}function JI(n,e){return n.length?e.length?n.concat(e):n:e}const wi=[],wJ=200;function ZI(n,e){if(n.length){let t=n[n.length-1],r=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-wJ));return r.length&&r[r.length-1].eq(e)?n:(r.push(e),h0(n,n.length-1,1e9,t.setSelAfter(r)))}else return[$r.selection([e])]}function vJ(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function ib(n,e){if(!n.length)return n;let t=n.length,r=wi;for(;t;){let i=kJ(n[t-1],e,r);if(i.changes&&!i.changes.empty||i.effects.length){let s=n.slice(0,t);return s[t-1]=i,s}else e=i.mapped,t--,r=i.selectionsAfter}return r.length?[$r.selection(r)]:wi}function kJ(n,e,t){let r=JI(n.selectionsAfter.length?n.selectionsAfter.map(l=>l.map(e)):wi,t);if(!n.changes)return $r.selection(r);let i=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new $r(i,it.mapEffects(n.effects,e),o,n.startSelection.map(s),r)}const CJ=/^(input\.type|delete)($|\.)/;let Ih=class Ff{constructor(e,t,r=0,i=void 0){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=i}isolate(){return this.prevTime?new Ff(this.done,this.undone):this}addChanges(e,t,r,i,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!r||CJ.test(r))&&(!l.selectionsAfter.length&&t-this.prevTime<i.newGroupDelay&&i.joinToEvent(s,yJ(l.changes,e.changes))||r=="input.type.compose")?o=h0(o,o.length-1,i.minDepth,new $r(e.changes.compose(l.changes),JI(it.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,wi)):o=h0(o,o.length,i.minDepth,e),new Ff(o,wi,t,r)}addSelection(e,t,r,i){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:wi;return s.length>0&&t-this.prevTime<i&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&bJ(s[s.length-1],e)?this:new Ff(ZI(this.done,e),this.undone,t,r)}addMapping(e){return new Ff(ib(this.done,e),ib(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,r){let i=e==0?this.done:this.undone;if(i.length==0)return null;let s=i[i.length-1],o=s.selectionsAfter[0]||t.selection;if(r&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:fv.of({side:e,rest:vJ(i),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let l=i.length==1?wi:i.slice(0,i.length-1);return s.mapped&&(l=ib(l,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:fv.of({side:e,rest:l,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}};Ih.empty=new Ih(wi,wi);const SJ=[{key:"Mod-z",run:GI,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:hv,preventDefault:!0},{linux:"Ctrl-Shift-z",run:hv,preventDefault:!0},{key:"Mod-u",run:mJ,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:gJ,preventDefault:!0}];function zu(n,e){return re.create(n.ranges.map(e),n.mainIndex)}function ts(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function ns({state:n,dispatch:e},t){let r=zu(n.selection,t);return r.eq(n.selection,!0)?!1:(e(ts(n,r)),!0)}function wy(n,e){return re.cursor(e?n.to:n.from)}function YI(n,e){return ns(n,t=>t.empty?n.moveByChar(t,e):wy(t,e))}function dr(n){return n.textDirectionAt(n.state.selection.main.head)==tn.LTR}const XI=n=>YI(n,!dr(n)),QI=n=>YI(n,dr(n));function eN(n,e){return ns(n,t=>t.empty?n.moveByGroup(t,e):wy(t,e))}const xJ=n=>eN(n,!dr(n)),_J=n=>eN(n,dr(n));function MJ(n,e,t){if(e.type.prop(t))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function vy(n,e,t){let r=er(n).resolveInner(e.head),i=t?pt.closedBy:pt.openedBy;for(let a=e.head;;){let c=t?r.childAfter(a):r.childBefore(a);if(!c)break;MJ(n,c,i)?r=c:a=t?c.to:c.from}let s=r.type.prop(i),o,l;return s&&(o=t?Cs(n,r.from,1):Cs(n,r.to,-1))&&o.matched?l=t?o.end.to:o.end.from:l=t?r.to:r.from,re.cursor(l,t?-1:1)}const TJ=n=>ns(n,e=>vy(n.state,e,!dr(n))),EJ=n=>ns(n,e=>vy(n.state,e,dr(n)));function tN(n,e){return ns(n,t=>{if(!t.empty)return wy(t,e);let r=n.moveVertically(t,e);return r.head!=t.head?r:n.moveToLineBoundary(t,e)})}const nN=n=>tN(n,!1),rN=n=>tN(n,!0);function iN(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,r=0,i;if(e){for(let s of n.state.facet(Re.scrollMargins)){let o=s(n);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(r=Math.max(o==null?void 0:o.bottom,r))}i=n.scrollDOM.clientHeight-t-r}else i=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:r,selfScroll:e,height:Math.max(n.defaultLineHeight,i-5)}}function sN(n,e){let t=iN(n),{state:r}=n,i=zu(r.selection,o=>o.empty?n.moveVertically(o,e,t.height):wy(o,e));if(i.eq(r.selection))return!1;let s;if(t.selfScroll){let o=n.coordsAtPos(r.selection.main.head),l=n.scrollDOM.getBoundingClientRect(),a=l.top+t.marginTop,c=l.bottom-t.marginBottom;o&&o.top>a&&o.bottom<c&&(s=Re.scrollIntoView(i.main.head,{y:"start",yMargin:o.top-a}))}return n.dispatch(ts(r,i),{effects:s}),!0}const gE=n=>sN(n,!1),dv=n=>sN(n,!0);function Tl(n,e,t){let r=n.lineBlockAt(e.head),i=n.moveToLineBoundary(e,t);if(i.head==e.head&&i.head!=(t?r.to:r.from)&&(i=n.moveToLineBoundary(e,t,!1)),!t&&i.head==r.from&&r.length){let s=/^\s*/.exec(n.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&e.head!=r.from+s&&(i=re.cursor(r.from+s))}return i}const AJ=n=>ns(n,e=>Tl(n,e,!0)),OJ=n=>ns(n,e=>Tl(n,e,!1)),LJ=n=>ns(n,e=>Tl(n,e,!dr(n))),DJ=n=>ns(n,e=>Tl(n,e,dr(n))),IJ=n=>ns(n,e=>re.cursor(n.lineBlockAt(e.head).from,1)),NJ=n=>ns(n,e=>re.cursor(n.lineBlockAt(e.head).to,-1));function RJ(n,e,t){let r=!1,i=zu(n.selection,s=>{let o=Cs(n,s.head,-1)||Cs(n,s.head,1)||s.head>0&&Cs(n,s.head-1,1)||s.head<n.doc.length&&Cs(n,s.head+1,-1);if(!o||!o.end)return s;r=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return re.cursor(l)});return r?(e(ts(n,i)),!0):!1}const PJ=({state:n,dispatch:e})=>RJ(n,e);function Oi(n,e){let t=zu(n.state.selection,r=>{let i=e(r);return re.range(r.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(ts(n.state,t)),!0)}function oN(n,e){return Oi(n,t=>n.moveByChar(t,e))}const lN=n=>oN(n,!dr(n)),aN=n=>oN(n,dr(n));function cN(n,e){return Oi(n,t=>n.moveByGroup(t,e))}const BJ=n=>cN(n,!dr(n)),HJ=n=>cN(n,dr(n)),VJ=n=>Oi(n,e=>vy(n.state,e,!dr(n))),FJ=n=>Oi(n,e=>vy(n.state,e,dr(n)));function uN(n,e){return Oi(n,t=>n.moveVertically(t,e))}const fN=n=>uN(n,!1),hN=n=>uN(n,!0);function dN(n,e){return Oi(n,t=>n.moveVertically(t,e,iN(n).height))}const yE=n=>dN(n,!1),bE=n=>dN(n,!0),jJ=n=>Oi(n,e=>Tl(n,e,!0)),$J=n=>Oi(n,e=>Tl(n,e,!1)),zJ=n=>Oi(n,e=>Tl(n,e,!dr(n))),WJ=n=>Oi(n,e=>Tl(n,e,dr(n))),qJ=n=>Oi(n,e=>re.cursor(n.lineBlockAt(e.head).from)),UJ=n=>Oi(n,e=>re.cursor(n.lineBlockAt(e.head).to)),wE=({state:n,dispatch:e})=>(e(ts(n,{anchor:0})),!0),vE=({state:n,dispatch:e})=>(e(ts(n,{anchor:n.doc.length})),!0),kE=({state:n,dispatch:e})=>(e(ts(n,{anchor:n.selection.main.anchor,head:0})),!0),CE=({state:n,dispatch:e})=>(e(ts(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),KJ=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),GJ=({state:n,dispatch:e})=>{let t=ky(n).map(({from:r,to:i})=>re.range(r,Math.min(i+1,n.doc.length)));return e(n.update({selection:re.create(t),userEvent:"select"})),!0},JJ=({state:n,dispatch:e})=>{let t=zu(n.selection,r=>{let i=er(n),s=i.resolveStack(r.from,1);if(r.empty){let o=i.resolveStack(r.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:l}=o;if((l.from<r.from&&l.to>=r.to||l.to>r.to&&l.from<=r.from)&&o.next)return re.range(l.to,l.from)}return r});return t.eq(n.selection)?!1:(e(ts(n,t)),!0)};function pN(n,e){let{state:t}=n,r=t.selection,i=t.selection.ranges.slice();for(let s of t.selection.ranges){let o=t.doc.lineAt(s.head);if(e?o.to<n.state.doc.length:o.from>0)for(let l=s;;){let a=n.moveVertically(l,e);if(a.head<o.from||a.head>o.to){i.some(c=>c.head==a.head)||i.push(a);break}else{if(a.head==l.head)break;l=a}}}return i.length==r.ranges.length?!1:(n.dispatch(ts(t,re.create(i,i.length-1))),!0)}const ZJ=n=>pN(n,!1),YJ=n=>pN(n,!0),XJ=({state:n,dispatch:e})=>{let t=n.selection,r=null;return t.ranges.length>1?r=re.create([t.main]):t.main.empty||(r=re.create([re.cursor(t.main.head)])),r?(e(ts(n,r)),!0):!1};function vp(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:r}=n,i=r.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let a=e(s);a<o?(t="delete.backward",a=pm(n,a,!1)):a>o&&(t="delete.forward",a=pm(n,a,!0)),o=Math.min(o,a),l=Math.max(l,a)}else o=pm(n,o,!1),l=pm(n,l,!0);return o==l?{range:s}:{changes:{from:o,to:l},range:re.cursor(o,o<s.head?-1:1)}});return i.changes.empty?!1:(n.dispatch(r.update(i,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?Re.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function pm(n,e,t){if(n instanceof Re)for(let r of n.state.facet(Re.atomicRanges).map(i=>i(n)))r.between(e,e,(i,s)=>{i<e&&s>e&&(e=t?s:i)});return e}const mN=(n,e,t)=>vp(n,r=>{let i=r.from,{state:s}=n,o=s.doc.lineAt(i),l,a;if(t&&!e&&i>o.from&&i<o.from+200&&!/[^ \t]/.test(l=o.text.slice(0,i-o.from))){if(l[l.length-1]=="	")return i-1;let c=Du(l,s.tabSize),u=c%Ha(s)||Ha(s);for(let f=0;f<u&&l[l.length-1-f]==" ";f++)i--;a=i}else a=Xn(o.text,i-o.from,e,e)+o.from,a==i&&o.number!=(e?s.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(a-o.from,i-o.from))&&(a=Xn(o.text,a-o.from,!1,!1)+o.from);return a}),pv=n=>mN(n,!1,!0),gN=n=>mN(n,!0,!1),yN=(n,e)=>vp(n,t=>{let r=t.head,{state:i}=n,s=i.doc.lineAt(r),o=i.charCategorizer(r);for(let l=null;;){if(r==(e?s.to:s.from)){r==t.head&&s.number!=(e?i.doc.lines:1)&&(r+=e?1:-1);break}let a=Xn(s.text,r-s.from,e)+s.from,c=s.text.slice(Math.min(r,a)-s.from,Math.max(r,a)-s.from),u=o(c);if(l!=null&&u!=l)break;(c!=" "||r!=t.head)&&(l=u),r=a}return r}),bN=n=>yN(n,!1),QJ=n=>yN(n,!0),eZ=n=>vp(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),tZ=n=>vp(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),nZ=n=>vp(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),rZ=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:Tt.of(["",""])},range:re.cursor(r.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},iZ=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>{if(!r.empty||r.from==0||r.from==n.doc.length)return{range:r};let i=r.from,s=n.doc.lineAt(i),o=i==s.from?i-1:Xn(s.text,i-s.from,!1)+s.from,l=i==s.to?i+1:Xn(s.text,i-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:n.doc.slice(i,l).append(n.doc.slice(o,i))},range:re.cursor(l)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function ky(n){let e=[],t=-1;for(let r of n.selection.ranges){let i=n.doc.lineAt(r.from),s=n.doc.lineAt(r.to);if(!r.empty&&r.to==s.from&&(s=n.doc.lineAt(r.to-1)),t>=i.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(r)}else e.push({from:i.from,to:s.to,ranges:[r]});t=s.number+1}return e}function wN(n,e,t){if(n.readOnly)return!1;let r=[],i=[];for(let s of ky(n)){if(t?s.to==n.doc.length:s.from==0)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),l=o.length+1;if(t){r.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let a of s.ranges)i.push(re.range(Math.min(n.doc.length,a.anchor+l),Math.min(n.doc.length,a.head+l)))}else{r.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let a of s.ranges)i.push(re.range(a.anchor-l,a.head-l))}}return r.length?(e(n.update({changes:r,scrollIntoView:!0,selection:re.create(i,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const sZ=({state:n,dispatch:e})=>wN(n,e,!1),oZ=({state:n,dispatch:e})=>wN(n,e,!0);function vN(n,e,t){if(n.readOnly)return!1;let r=[];for(let i of ky(n))t?r.push({from:i.from,insert:n.doc.slice(i.from,i.to)+n.lineBreak}):r.push({from:i.to,insert:n.lineBreak+n.doc.slice(i.from,i.to)});return e(n.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const lZ=({state:n,dispatch:e})=>vN(n,e,!1),aZ=({state:n,dispatch:e})=>vN(n,e,!0),cZ=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(ky(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),r=zu(e.selection,i=>{let s;if(n.lineWrapping){let o=n.lineBlockAt(i.head),l=n.coordsAtPos(i.head,i.assoc||1);l&&(s=o.bottom+n.documentTop-l.bottom+n.defaultLineHeight/2)}return n.moveVertically(i,!0,s)}).map(t);return n.dispatch({changes:t,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function uZ(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=er(n).resolveInner(e),r=t.childBefore(e),i=t.childAfter(e),s;return r&&i&&r.to<=e&&i.from>=e&&(s=r.type.prop(pt.closedBy))&&s.indexOf(i.name)>-1&&n.doc.lineAt(r.to).from==n.doc.lineAt(i.from).from&&!/\S/.test(n.sliceDoc(r.to,i.from))?{from:r.to,to:i.from}:null}const SE=kN(!1),fZ=kN(!0);function kN(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(i=>{let{from:s,to:o}=i,l=e.doc.lineAt(s),a=!n&&s==o&&uZ(e,s);n&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let c=new R0(e,{simulateBreak:s,simulateDoubleBreak:!!a}),u=Xv(c,s);for(u==null&&(u=Du(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:s,to:o}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let f=["",Zh(e,u)];return a&&f.push(Zh(e,c.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:Tt.of(f)},range:re.cursor(s+1+f[1].length)}});return t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function pS(n,e){let t=-1;return n.changeByRange(r=>{let i=[];for(let o=r.from;o<=r.to;){let l=n.doc.lineAt(o);l.number>t&&(r.empty||r.to>l.from)&&(e(l,i,r),t=l.number),o=l.to+1}let s=n.changes(i);return{changes:i,range:re.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}})}const hZ=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),r=new R0(n,{overrideIndentation:s=>{let o=t[s];return o??-1}}),i=pS(n,(s,o,l)=>{let a=Xv(r,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let c=/^\s*/.exec(s.text)[0],u=Zh(n,a);(c!=u||l.from<s.from+c.length)&&(t[s.from]=a,o.push({from:s.from,to:s.from+c.length,insert:u}))});return i.changes.empty||e(n.update(i,{userEvent:"indent"})),!0},CN=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(pS(n,(t,r)=>{r.push({from:t.from,insert:n.facet(N0)})}),{userEvent:"input.indent"})),!0),SN=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(pS(n,(t,r)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let s=Du(i,n.tabSize),o=0,l=Zh(n,Math.max(0,s-Ha(n)));for(;o<i.length&&o<l.length&&i.charCodeAt(o)==l.charCodeAt(o);)o++;r.push({from:t.from+o,to:t.from+i.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),dZ=n=>(n.setTabFocusMode(),!0),pZ=[{key:"Ctrl-b",run:XI,shift:lN,preventDefault:!0},{key:"Ctrl-f",run:QI,shift:aN},{key:"Ctrl-p",run:nN,shift:fN},{key:"Ctrl-n",run:rN,shift:hN},{key:"Ctrl-a",run:IJ,shift:qJ},{key:"Ctrl-e",run:NJ,shift:UJ},{key:"Ctrl-d",run:gN},{key:"Ctrl-h",run:pv},{key:"Ctrl-k",run:eZ},{key:"Ctrl-Alt-h",run:bN},{key:"Ctrl-o",run:rZ},{key:"Ctrl-t",run:iZ},{key:"Ctrl-v",run:dv}],mZ=[{key:"ArrowLeft",run:XI,shift:lN,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:xJ,shift:BJ,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:LJ,shift:zJ,preventDefault:!0},{key:"ArrowRight",run:QI,shift:aN,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:_J,shift:HJ,preventDefault:!0},{mac:"Cmd-ArrowRight",run:DJ,shift:WJ,preventDefault:!0},{key:"ArrowUp",run:nN,shift:fN,preventDefault:!0},{mac:"Cmd-ArrowUp",run:wE,shift:kE},{mac:"Ctrl-ArrowUp",run:gE,shift:yE},{key:"ArrowDown",run:rN,shift:hN,preventDefault:!0},{mac:"Cmd-ArrowDown",run:vE,shift:CE},{mac:"Ctrl-ArrowDown",run:dv,shift:bE},{key:"PageUp",run:gE,shift:yE},{key:"PageDown",run:dv,shift:bE},{key:"Home",run:OJ,shift:$J,preventDefault:!0},{key:"Mod-Home",run:wE,shift:kE},{key:"End",run:AJ,shift:jJ,preventDefault:!0},{key:"Mod-End",run:vE,shift:CE},{key:"Enter",run:SE,shift:SE},{key:"Mod-a",run:KJ},{key:"Backspace",run:pv,shift:pv,preventDefault:!0},{key:"Delete",run:gN,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:bN,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:QJ,preventDefault:!0},{mac:"Mod-Backspace",run:tZ,preventDefault:!0},{mac:"Mod-Delete",run:nZ,preventDefault:!0}].concat(pZ.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),xN=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:TJ,shift:VJ},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:EJ,shift:FJ},{key:"Alt-ArrowUp",run:sZ},{key:"Shift-Alt-ArrowUp",run:lZ},{key:"Alt-ArrowDown",run:oZ},{key:"Shift-Alt-ArrowDown",run:aZ},{key:"Mod-Alt-ArrowUp",run:ZJ},{key:"Mod-Alt-ArrowDown",run:YJ},{key:"Escape",run:XJ},{key:"Mod-Enter",run:fZ},{key:"Alt-l",mac:"Ctrl-l",run:GJ},{key:"Mod-i",run:JJ,preventDefault:!0},{key:"Mod-[",run:SN},{key:"Mod-]",run:CN},{key:"Mod-Alt-\\",run:hZ},{key:"Shift-Mod-k",run:cZ},{key:"Shift-Mod-\\",run:PJ},{key:"Mod-/",run:sJ},{key:"Alt-A",run:lJ},{key:"Ctrl-m",mac:"Shift-Alt-m",run:dZ}].concat(mZ),gZ={key:"Tab",run:CN,shift:SN};var d0=200,Hn=function(){};Hn.prototype.append=function(e){return e.length?(e=Hn.from(e),!this.length&&e||e.length<d0&&this.leafAppend(e)||this.length<d0&&e.leafPrepend(this)||this.appendInner(e)):this};Hn.prototype.prepend=function(e){return e.length?Hn.from(e).append(this):this};Hn.prototype.appendInner=function(e){return new yZ(this,e)};Hn.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Hn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Hn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Hn.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};Hn.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},t,r),i};Hn.from=function(e){return e instanceof Hn?e:e&&e.length?new _N(e):Hn.empty};var _N=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,l){for(var a=s;a<o;a++)if(i(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,l){for(var a=s-1;a>=o;a--)if(i(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=d0)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=d0)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Hn);Hn.empty=new _N([]);var yZ=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(r,Math.min(i,l),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(Hn);const bZ=500;class ji{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;t&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,l,a,c=[],u=[];return this.items.forEach((f,p)=>{if(!f.step){i||(i=this.remapping(r,p+1),s=i.maps.length),s--,u.push(f);return}if(i){u.push(new gs(f.map));let g=f.step.map(i.slice(s)),y;g&&o.maybeStep(g).doc&&(y=o.mapping.maps[o.mapping.maps.length-1],c.push(new gs(y,void 0,void 0,c.length+u.length))),s--,y&&i.appendMap(y,s)}else o.maybeStep(f.step);if(f.selection)return l=i?f.selection.map(i.slice(s)):f.selection,a=new ji(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:o,selection:l}}addTransform(e,t,r,i){let s=[],o=this.eventCount,l=this.items,a=!i&&l.length?l.get(l.length-1):null;for(let u=0;u<e.steps.length;u++){let f=e.steps[u].invert(e.docs[u]),p=new gs(e.mapping.maps[u],f,t),g;(g=a&&a.merge(p))&&(p=g,u?s.pop():l=l.slice(0,l.length-1)),s.push(p),t&&(o++,t=void 0),i||(a=p)}let c=o-r.depth;return c>vZ&&(l=wZ(l,c),o-=c),new ji(l.append(s),o)}remapping(e,t){let r=new ed;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new ji(this.items.append(e.map(t=>new gs(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(p=>{p.selection&&l--},i);let a=t;this.items.forEach(p=>{let g=s.getMirror(--a);if(g==null)return;o=Math.min(o,g);let y=s.maps[g];if(p.step){let v=e.steps[g].invert(e.docs[g]),k=p.selection&&p.selection.map(s.slice(a+1,g));k&&l++,r.push(new gs(y,v,k))}else r.push(new gs(y))},i);let c=[];for(let p=t;p<o;p++)c.push(new gs(s.maps[p]));let u=this.items.slice(0,i).append(c).append(r),f=new ji(u,l);return f.emptyItemCount()>bZ&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)i.push(o),o.selection&&s++;else if(o.step){let a=o.step.map(t.slice(r)),c=a&&a.getMap();if(r--,c&&t.appendMap(c,r),a){let u=o.selection&&o.selection.map(t.slice(r));u&&s++;let f=new gs(c.invert(),a,u),p,g=i.length-1;(p=i.length&&i[g].merge(f))?i[g]=p:i.push(f)}}else o.map&&r--},this.items.length,0),new ji(Hn.from(i.reverse()),s)}}ji.empty=new ji(Hn.empty,0);function wZ(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class gs{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new gs(t.getMap().invert(),t,this.selection)}}}class Jo{constructor(e,t,r,i,s){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const vZ=20;function kZ(n,e,t,r){let i=t.getMeta(La),s;if(i)return i.historyState;t.getMeta(xZ)&&(n=new Jo(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(La))return o.getMeta(La).redo?new Jo(n.done.addTransform(t,void 0,r,lg(e)),n.undone,xE(t.mapping.maps),n.prevTime,n.prevComposition):new Jo(n.done,n.undone.addTransform(t,void 0,r,lg(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=t.getMeta("composition"),a=n.prevTime==0||!o&&n.prevComposition!=l&&(n.prevTime<(t.time||0)-r.newGroupDelay||!CZ(t,n.prevRanges)),c=o?sb(n.prevRanges,t.mapping):xE(t.mapping.maps);return new Jo(n.done.addTransform(t,a?e.selection.getBookmark():void 0,r,lg(e)),ji.empty,c,t.time,l??n.prevComposition)}else return(s=t.getMeta("rebased"))?new Jo(n.done.rebased(t,s),n.undone.rebased(t,s),sb(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Jo(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),sb(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function CZ(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(t=!0)}),t}function xE(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,i,s,o)=>e.push(s,o));return e}function sb(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),s=e.map(n[r+1],-1);i<=s&&t.push(i,s)}return t}function SZ(n,e,t){let r=lg(e),i=La.get(e).spec.config,s=(t?n.undone:n.done).popEvent(e,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),l=(t?n.done:n.undone).addTransform(s.transform,e.selection.getBookmark(),i,r),a=new Jo(t?l:s.remaining,t?s.remaining:l,null,0,-1);return s.transform.setSelection(o).setMeta(La,{redo:t,historyState:a})}let ob=!1,_E=null;function lg(n){let e=n.plugins;if(_E!=e){ob=!1,_E=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){ob=!0;break}}return ob}const La=new rn("history"),xZ=new rn("closeHistory");function _Z(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new nn({key:La,state:{init(){return new Jo(ji.empty,ji.empty,null,0,-1)},apply(e,t,r){return kZ(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?Cy:r=="historyRedo"?xu:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function MN(n,e){return(t,r)=>{let i=La.getState(t);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let s=SZ(i,t,n);s&&r(e?s.scrollIntoView():s)}return!0}}const Cy=MN(!1,!0),xu=MN(!0,!0);var MZ=Object.defineProperty,ME=Object.getOwnPropertySymbols,TZ=Object.prototype.hasOwnProperty,EZ=Object.prototype.propertyIsEnumerable,TE=(n,e,t)=>e in n?MZ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,AZ=(n,e)=>{for(var t in e||(e={}))TZ.call(e,t)&&TE(n,t,e[t]);if(ME)for(var t of ME(e))EZ.call(e,t)&&TE(n,t,e[t]);return n};function TN(n,e){return Object.assign(n,{meta:AZ({package:"@milkdown/components"},e)}),n}const OZ={extensions:[],languages:[],expandIcon:"",searchIcon:"",clearSearchIcon:"",searchPlaceholder:"Search language",noResultText:"No result",copyText:"Copy",copyIcon:"",onCopy:()=>{},renderLanguage:n=>n,renderPreview:()=>null,previewToggleButton:n=>n?"Edit":"Hide",previewLabel:"Preview",previewLoading:"Loading..."},kp=It(OZ,"codeBlockConfigCtx");TN(kp,{displayName:"Config<code-block>",group:"CodeBlock"});class LZ{constructor(e){this.languages=e,this.map={},e.forEach(t=>{t.alias.forEach(r=>{this.map[r]=t})})}getAll(){return this.languages.map(e=>({name:e.name,alias:e.alias}))}load(e){const r=this.map[e.toLowerCase()];return r?r.support?Promise.resolve(r.support):r.load():Promise.resolve(void 0)}}function Nc({icon:n,class:e,onClick:t}){return J("span",{class:Qn("milkdown-icon",e),onPointerdown:t,ref:r=>{r&&n&&(r.innerHTML=Ei.sanitize(n.trim()))}})}Nc.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};var DZ=(n,e,t)=>new Promise((r,i)=>{var s=a=>{try{l(t.next(a))}catch(c){i(c)}},o=a=>{try{l(t.throw(a))}catch(c){i(c)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(s,o);l((t=t.apply(n,e)).next())});function IZ(n){return DZ(this,null,function*(){try{return navigator.clipboard.writeText(n)}catch{const t=document.createElement("textarea"),r=document.activeElement;t.value=n,t.setAttribute("readonly",""),t.style.contain="strict",t.style.position="absolute",t.style.left="-9999px",t.style.fontSize="12pt";const i=document.getSelection(),s=i?i.rangeCount>0&&i.getRangeAt(0):null;document.body.appendChild(t),t.select(),t.selectionStart=0,t.selectionEnd=n.length,document.execCommand("copy"),document.body.removeChild(t),s&&(i.removeAllRanges(),i.addRange(s)),r&&r.focus()}})}const NZ=tr({props:{copyText:{type:String,required:!0},copyIcon:{type:String,required:!0},onCopy:{type:Function,required:!0},text:{type:String,required:!0}},setup(n){const e=()=>{IZ(n.text).then(()=>n.onCopy(n.text)).catch(console.error)};return()=>J(Zn,null,J("button",{type:"button",class:"copy-button",onClick:e},J(Nc,{icon:n.copyIcon}),n.copyText))}}),RZ=tr({props:{language:{type:Object,required:!0},getReadOnly:{type:Function,required:!0},config:{type:Object,required:!0},getAllLanguages:{type:Function,required:!0},setLanguage:{type:Function,required:!0}},setup({language:n,config:e,setLanguage:t,getAllLanguages:r,getReadOnly:i}){const s=Ve(),o=Ve(!1),l=Ve(),a=Ve(),c=Ve("");Oa([o,s,a],()=>{c.value="";const v=s.value,k=a.value;!v||!k||Ki(v,k,{placement:"bottom-start"}).then(({x,y:_})=>{Object.assign(k.style,{left:`${x}px`,top:`${_}px`})}).catch(console.error)});const u=v=>{if(v.preventDefault(),v.stopPropagation(),i())return;const k=!o.value;o.value=k,k&&setTimeout(()=>{var x;return(x=l.value)==null?void 0:x.focus()},0)},f=v=>{const k=v.target;c.value=k.value},p=v=>{v.key==="Escape"&&(c.value="")},g=Cu(()=>{var v;if(!o.value)return[];const k=(v=r())!=null?v:[],x=k.find(M=>M.name.toLowerCase()===n.value.toLowerCase()),_=k.filter(M=>{const T=c.value.toLowerCase();return(M.name.toLowerCase().includes(T)||M.alias.some(S=>S.toLowerCase().includes(T)))&&M!==x});return _.length===0?[]:x?[x,..._]:_}),y=v=>{const k=v.target;if(s.value&&s.value.contains(k))return;const x=a.value,_=s.value;!_||!x||_.dataset.expanded==="true"&&(x.contains(k)||(o.value=!1))};return up(()=>{window.addEventListener("click",y)}),fp(()=>{window.removeEventListener("click",y)}),()=>J(Zn,null,J("button",{type:"button",ref:s,class:"language-button",onClick:u,"data-expanded":String(o.value)},n.value||"Text",J("div",{class:"expand-icon"},J(Nc,{icon:e.expandIcon}))),J("div",{ref:a,class:"language-picker"},o.value?J("div",{class:"list-wrapper"},J("div",{class:"search-box"},J("div",{class:"search-icon"},J(Nc,{icon:e.searchIcon})),J("input",{ref:l,class:"search-input",placeholder:e.searchPlaceholder,value:c.value,onInput:f,onKeydown:p}),J("div",{class:Qn("clear-icon",c.value.length===0&&"hidden"),onMousedown:v=>{v.preventDefault(),c.value=""}},J(Nc,{icon:e.clearSearchIcon}))),J("ul",{class:"language-list",role:"listbox",onKeydown:v=>{if(v.key==="Enter"){const k=document.activeElement;k instanceof HTMLElement&&k.dataset.language&&t(k.dataset.language)}}},g.value.length?g.value.map(v=>J("li",{role:"listitem",tabindex:"0",class:"language-list-item","aria-selected":v.name.toLowerCase()===n.value.toLowerCase(),"data-language":v.name,onClick:()=>{t(v.name),o.value=!1}},e.renderLanguage(v.name,v.name.toLowerCase()===n.value.toLowerCase()))):J("li",{class:"language-list-item no-result"},e.noResultText))):null))}}),PZ=tr({props:{text:{type:Object,required:!0},language:{type:Object,required:!0},config:{type:Object,required:!0},previewOnlyMode:{type:Object,required:!0},preview:{type:Object,required:!0}},setup(n){const{previewOnlyMode:e,config:t,preview:r}=n,i=Ve();return Fu(()=>{const s=i.value;if(!s)return;for(;s.firstChild;)s.removeChild(s.firstChild);const o=r.value;(typeof o=="string"||o instanceof Element)&&(s.innerHTML=Ei.sanitize(o))}),()=>r.value?J("div",{class:"preview-panel"},!e.value&&J(Zn,null,J("div",{class:"preview-divider"}),J("div",{class:Qn("preview-label",e&&"hidden")},t.previewLabel)),J("div",{ref:i,class:"preview"})):null}}),BZ=tr({props:{text:{type:Object,required:!0},selected:{type:Object,required:!0},getReadOnly:{type:Function,required:!0},codemirror:{type:Object,required:!0},language:{type:Object,required:!0},getAllLanguages:{type:Function,required:!0},setLanguage:{type:Function,required:!0},config:{type:Object,required:!0}},setup(n){var e;const t=(e=n.config.previewOnlyByDefault)!=null?e:n.getReadOnly(),r=Ve(t),i=Ve(),s=Ve(null);up(()=>{for(var l;(l=i.value)!=null&&l.firstChild;)i.value.removeChild(i.value.firstChild);i.value&&i.value.appendChild(n.codemirror.dom)}),Oa(()=>[n.text.value,n.language.value],()=>{const l=n.config.renderPreview(n.language.value,n.text.value,c=>s.value=c);l&&(s.value=l),l===void 0&&!s.value&&(s.value=Ei.sanitize(n.config.previewLoading)),l===null&&(s.value=null)},{immediate:!0});const o=()=>{};return()=>{var l;return J(Zn,null,J("div",{class:"tools"},J(RZ,{language:n.language,config:n.config,setLanguage:n.setLanguage,getAllLanguages:n.getAllLanguages,getReadOnly:n.getReadOnly}),J("div",{class:"tools-button-group"},J(NZ,{copyIcon:n.config.copyIcon,copyText:n.config.copyText,onCopy:(l=n.config.onCopy)!=null?l:o,text:n.text.value}),s.value?J("button",{class:"preview-toggle-button",onClick:()=>r.value=!r.value},J(Nc,{icon:n.config.previewToggleButton(r.value)})):null)),J("div",{ref:i,class:Qn("codemirror-host",s.value&&r.value&&"hidden")}),J(PZ,{text:n.text,language:n.language,config:n.config,previewOnlyMode:r,preview:s}))}}});class HZ{constructor(e,t,r,i,s){this.node=e,this.view=t,this.getPos=r,this.loader=i,this.config=s,this.selected=Ve(!1),this.language=Ve(""),this.text=Ve(""),this.updating=!1,this.languageName="",this.forwardUpdate=o=>{var l;if(this.updating||!this.cm.hasFocus)return;let a=((l=this.getPos())!=null?l:0)+1;const{main:c}=o.state.selection,u=a+c.from,f=a+c.to,p=this.view.state.selection;if(o.docChanged||p.from!==u||p.to!==f){const g=this.view.state.tr;o.changes.iterChanges((y,v,k,x,_)=>{_.length?g.replaceWith(a+y,a+v,this.view.state.schema.text(_.toString())):g.delete(a+y,a+v),a+=x-k-(v-y)}),g.setSelection(ze.create(g.doc,u,f)),this.view.dispatch(g)}},this.createApp=()=>es(BZ,{text:this.text,selected:this.selected,codemirror:this.cm,language:this.language,getAllLanguages:this.getAllLanguages,getReadOnly:()=>!this.view.editable,setLanguage:this.setLanguage,config:this.config}),this.codeMirrorKeymap=()=>{const o=this.view;return[{key:"ArrowUp",run:()=>this.maybeEscape("line",-1)},{key:"ArrowLeft",run:()=>this.maybeEscape("char",-1)},{key:"ArrowDown",run:()=>this.maybeEscape("line",1)},{key:"ArrowRight",run:()=>this.maybeEscape("char",1)},{key:"Mod-Enter",run:()=>ZL(o.state,o.dispatch)?(o.focus(),!0):!1},{key:"Mod-z",run:()=>Cy(o.state,o.dispatch)},{key:"Shift-Mod-z",run:()=>xu(o.state,o.dispatch)},{key:"Mod-y",run:()=>xu(o.state,o.dispatch)},{key:"Backspace",run:()=>{var l;const a=this.cm.state.selection.ranges;if(a.length>1)return!1;const c=a[0];if(c&&(!c.empty||c.anchor>0)||this.cm.state.doc.lines>=2)return!1;const u=this.view.state,f=(l=this.getPos())!=null?l:0,p=u.tr.replaceWith(f,f+this.node.nodeSize,u.schema.nodes.paragraph.createChecked({},this.node.content));return p.setSelection(ze.near(p.doc.resolve(f))),this.view.dispatch(p),this.view.focus(),!0}}]},this.maybeEscape=(o,l)=>{var a;const{state:c}=this.cm;let u=c.selection.main;if(!u.empty||(o==="line"&&(u=c.doc.lineAt(u.head)),l<0?u.from>0:u.to<c.doc.length))return!1;const f=((a=this.getPos())!=null?a:0)+(l<0?0:this.node.nodeSize),p=ze.near(this.view.state.doc.resolve(f),l),g=this.view.state.tr.setSelection(p).scrollIntoView();return this.view.dispatch(g),this.view.focus(),!0},this.setLanguage=o=>{var l;this.view.dispatch(this.view.state.tr.setNodeAttribute((l=this.getPos())!=null?l:0,"language",o))},this.getAllLanguages=()=>this.loader.getAll(),this.languageConf=new hu,this.readOnlyConf=new hu,this.cm=new Re({doc:this.node.textContent,root:this.view.root,extensions:[this.readOnlyConf.of(ln.readOnly.of(!this.view.editable)),bO(),Iu.of(this.codeMirrorKeymap()),this.languageConf.of([]),ln.changeFilter.of(()=>this.view.editable),...s.extensions,Re.updateListener.of(this.forwardUpdate)]}),this.app=this.createApp(),this.dom=this.createDom(this.app),this.disposeSelectedWatcher=Fu(()=>{this.selected.value?this.dom.classList.add("selected"):this.dom.classList.remove("selected")}),this.updateLanguage()}createDom(e){const t=document.createElement("div");return t.className="milkdown-code-block",this.text.value=this.node.textContent,e.mount(t),t}updateLanguage(){const e=this.node.attrs.language;if(e===this.languageName)return;this.language.value=e,this.loader.load(e??"").then(r=>{r&&(this.cm.dispatch({effects:this.languageConf.reconfigure(r)}),this.languageName=e)}).catch(console.error)}setSelection(e,t){this.cm.dom.isConnected&&(this.cm.focus(),this.updating=!0,this.cm.dispatch({selection:{anchor:e,head:t}}),this.updating=!1)}update(e){if(e.type!==this.node.type)return!1;if(this.updating)return!0;this.node=e,this.text.value=e.textContent,this.updateLanguage(),this.view.editable===this.cm.state.readOnly&&this.cm.dispatch({effects:this.readOnlyConf.reconfigure(ln.readOnly.of(!this.view.editable))});const t=VZ(this.cm.state.doc.toString(),e.textContent);return t&&(this.updating=!0,this.cm.dispatch({changes:{from:t.from,to:t.to,insert:t.text},scrollIntoView:!0}),this.updating=!1),!0}selectNode(){this.selected.value=!0,this.cm.focus()}deselectNode(){this.selected.value=!1}stopEvent(){return!0}destroy(){this.app.unmount(),this.cm.destroy(),this.disposeSelectedWatcher()}}function VZ(n,e){if(n===e)return null;let t=0,r=n.length,i=e.length;for(;t<r&&n.charCodeAt(t)===e.charCodeAt(t);)++t;for(;r>t&&i>t&&n.charCodeAt(r-1)===e.charCodeAt(i-1);)r--,i--;return{from:t,to:r,text:e.slice(t,i)}}const EN=op(Ls.node,n=>{const e=n.get(kp.key),t=new LZ(e.languages);return(r,i,s)=>new HZ(r,i,s,t,e)});TN(EN,{displayName:"NodeView<code-block>",group:"CodeBlock"});const FZ=[EN,kp],EE=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class _u{constructor(e,t,r=0,i=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,i),this.bufferStart=r,this.normalize=s?l=>s(EE(l)):EE,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Vr(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Bv(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=bs(e);let i=this.normalize(t);if(i.length)for(let s=0,o=r;;s++){let l=i.charCodeAt(s),a=this.match(l,o,this.bufferPos+this.bufferStart);if(s==i.length-1){if(a)return this.value=a,this;break}o==r&&s<t.length&&t.charCodeAt(s)==l&&o++}}}match(e,t,r){let i=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],l=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?i={from:this.matches[s+1],to:r}:(this.matches[s]++,l=!0)),l||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:r}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(_u.prototype[Symbol.iterator]=function(){return this});const AN={from:-1,to:-1,match:/.*/.exec("")},mS="gm"+(/x/.unicode==null?"":"u");class ON{constructor(e,t,r,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=AN,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new LN(e,t,r,i,s);this.re=new RegExp(t,mS+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.iter=e.iter();let o=e.lineAt(i);this.curLineStart=o.from,this.matchPos=p0(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,i=r+t[0].length;if(this.matchPos=p0(this.text,i+(r==i?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<i||r>this.value.to)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const lb=new WeakMap;class Rc{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let i=lb.get(e);if(!i||i.from>=r||i.to<=t){let l=new Rc(t,e.sliceString(t,r));return lb.set(e,l),l}if(i.from==t&&i.to==r)return i;let{text:s,from:o}=i;return o>t&&(s=e.sliceString(t,o)+s,o=t),i.to<r&&(s+=e.sliceString(i.to,r)),lb.set(e,new Rc(o,s)),new Rc(t,s.slice(t-o,r-o))}}class LN{constructor(e,t,r,i,s){this.text=e,this.to=s,this.done=!1,this.value=AN,this.matchPos=p0(e,i),this.re=new RegExp(t,mS+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.flat=Rc.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let r=this.flat.from+t.index,i=r+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this.matchPos=p0(this.text,i+(r==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Rc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(ON.prototype[Symbol.iterator]=LN.prototype[Symbol.iterator]=function(){return this});function jZ(n){try{return new RegExp(n,mS),!0}catch{return!1}}function p0(n,e){if(e>=n.length)return e;let t=n.lineAt(e),r;for(;e<t.to&&(r=t.text.charCodeAt(e-t.from))>=56320&&r<57344;)e++;return e}function mv(n){let e=String(n.state.doc.lineAt(n.state.selection.main.head).number),t=Ht("input",{class:"cm-textfield",name:"line",value:e}),r=Ht("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),n.dispatch({effects:Nh.of(!1)}),n.focus()):s.keyCode==13&&(s.preventDefault(),i())},onsubmit:s=>{s.preventDefault(),i()}},Ht("label",n.state.phrase("Go to line"),": ",t)," ",Ht("button",{class:"cm-button",type:"submit"},n.state.phrase("go")),Ht("button",{name:"close",onclick:()=>{n.dispatch({effects:Nh.of(!1)}),n.focus()},"aria-label":n.state.phrase("close"),type:"button"},[""]));function i(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!s)return;let{state:o}=n,l=o.doc.lineAt(o.selection.main.head),[,a,c,u,f]=s,p=u?+u.slice(1):0,g=c?+c:l.number;if(c&&f){let k=g/100;a&&(k=k*(a=="-"?-1:1)+l.number/o.doc.lines),g=Math.round(o.doc.lines*k)}else c&&a&&(g=g*(a=="-"?-1:1)+l.number);let y=o.doc.line(Math.max(1,Math.min(o.doc.lines,g))),v=re.cursor(y.from+Math.max(0,Math.min(p,y.length)));n.dispatch({effects:[Nh.of(!1),Re.scrollIntoView(v.from,{y:"center"})],selection:v}),n.focus()}return{dom:r}}const Nh=it.define(),AE=jn.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(Nh)&&(n=t.value);return n},provide:n=>Gh.from(n,e=>e?mv:null)}),$Z=n=>{let e=Kh(n,mv);if(!e){let t=[Nh.of(!0)];n.state.field(AE,!1)==null&&t.push(it.appendConfig.of([AE,zZ])),n.dispatch({effects:t}),e=Kh(n,mv)}return e&&e.dom.querySelector("input").select(),!0},zZ=Re.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),WZ={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},qZ=Ie.define({combine(n){return Is(n,WZ,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function UZ(n){return[YZ,ZZ]}const KZ=Je.mark({class:"cm-selectionMatch"}),GZ=Je.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function OE(n,e,t,r){return(t==0||n(e.sliceDoc(t-1,t))!=on.Word)&&(r==e.doc.length||n(e.sliceDoc(r,r+1))!=on.Word)}function JZ(n,e,t,r){return n(e.sliceDoc(t,t+1))==on.Word&&n(e.sliceDoc(r-1,r))==on.Word}const ZZ=En.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(qZ),{state:t}=n,r=t.selection;if(r.ranges.length>1)return Je.none;let i=r.main,s,o=null;if(i.empty){if(!e.highlightWordAroundCursor)return Je.none;let a=t.wordAt(i.head);if(!a)return Je.none;o=t.charCategorizer(i.head),s=t.sliceDoc(a.from,a.to)}else{let a=i.to-i.from;if(a<e.minSelectionLength||a>200)return Je.none;if(e.wholeWords){if(s=t.sliceDoc(i.from,i.to),o=t.charCategorizer(i.head),!(OE(o,t,i.from,i.to)&&JZ(o,t,i.from,i.to)))return Je.none}else if(s=t.sliceDoc(i.from,i.to),!s)return Je.none}let l=[];for(let a of n.visibleRanges){let c=new _u(t.doc,s,a.from,a.to);for(;!c.next().done;){let{from:u,to:f}=c.value;if((!o||OE(o,t,u,f))&&(i.empty&&u<=i.from&&f>=i.to?l.push(GZ.range(u,f)):(u>=i.to||f<=i.from)&&l.push(KZ.range(u,f)),l.length>e.maxMatches))return Je.none}}return Je.set(l)}},{decorations:n=>n.decorations}),YZ=Re.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),XZ=({state:n,dispatch:e})=>{let{selection:t}=n,r=re.create(t.ranges.map(i=>n.wordAt(i.head)||re.cursor(i.head)),t.mainIndex);return r.eq(t)?!1:(e(n.update({selection:r})),!0)};function QZ(n,e){let{main:t,ranges:r}=n.selection,i=n.wordAt(t.head),s=i&&i.from==t.from&&i.to==t.to;for(let o=!1,l=new _u(n.doc,e,r[r.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new _u(n.doc,e,0,Math.max(0,r[r.length-1].from-1)),o=!0}else{if(o&&r.some(a=>a.from==l.value.from))continue;if(s){let a=n.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const eY=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(s=>s.from===s.to))return XZ({state:n,dispatch:e});let r=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(s=>n.sliceDoc(s.from,s.to)!=r))return!1;let i=QZ(n,r);return i?(e(n.update({selection:n.selection.addRange(re.range(i.from,i.to),!1),effects:Re.scrollIntoView(i.to)})),!0):!1},Wu=Ie.define({combine(n){return Is(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new hY(e),scrollToMatch:e=>Re.scrollIntoView(e)})}});class DN{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||jZ(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new iY(this):new nY(this)}getCursor(e,t=0,r){let i=e.doc?e:ln.create({doc:e});return r==null&&(r=i.doc.length),this.regexp?wc(this,i,t,r):bc(this,i,t,r)}}class IN{constructor(e){this.spec=e}}function bc(n,e,t,r){return new _u(e.doc,n.unquoted,t,r,n.caseSensitive?void 0:i=>i.toLowerCase(),n.wholeWord?tY(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function tY(n,e){return(t,r,i,s)=>((s>t||s+i.length<r)&&(s=Math.max(0,t-2),i=n.sliceString(s,Math.min(n.length,r+2))),(e(m0(i,t-s))!=on.Word||e(g0(i,t-s))!=on.Word)&&(e(g0(i,r-s))!=on.Word||e(m0(i,r-s))!=on.Word))}class nY extends IN{constructor(e){super(e)}nextMatch(e,t,r){let i=bc(this.spec,e,r,e.doc.length).nextOverlapping();if(i.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);i=bc(this.spec,e,0,s).nextOverlapping()}return i.done||i.value.from==t&&i.value.to==r?null:i.value}prevMatchInRange(e,t,r){for(let i=r;;){let s=Math.max(t,i-1e4-this.spec.unquoted.length),o=bc(this.spec,e,s,i),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==t)return null;i-=1e4}}prevMatch(e,t,r){let i=this.prevMatchInRange(e,0,t);return i||(i=this.prevMatchInRange(e,Math.max(0,r-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=t||i.to!=r)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=bc(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=bc(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function wc(n,e,t,r){return new ON(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?rY(e.charCategorizer(e.selection.main.head)):void 0},t,r)}function m0(n,e){return n.slice(Xn(n,e,!1),e)}function g0(n,e){return n.slice(e,Xn(n,e))}function rY(n){return(e,t,r)=>!r[0].length||(n(m0(r.input,r.index))!=on.Word||n(g0(r.input,r.index))!=on.Word)&&(n(g0(r.input,r.index+r[0].length))!=on.Word||n(m0(r.input,r.index+r[0].length))!=on.Word)}class iY extends IN{nextMatch(e,t,r){let i=wc(this.spec,e,r,e.doc.length).next();return i.done&&(i=wc(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,r){for(let i=1;;i++){let s=Math.max(t,r-i*1e4),o=wc(this.spec,e,s,r),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==t||l.from>s+10))return l;if(s==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,r)=>{if(r=="&")return e.match[0];if(r=="$")return"$";for(let i=r.length;i>0;i--){let s=+r.slice(0,i);if(s>0&&s<e.match.length)return e.match[s]+r.slice(i)}return t})}matchAll(e,t){let r=wc(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=wc(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const md=it.define(),gS=it.define(),dl=jn.define({create(n){return new ab(gv(n).create(),null)},update(n,e){for(let t of e.effects)t.is(md)?n=new ab(t.value.create(),n.panel):t.is(gS)&&(n=new ab(n.query,t.value?yS:null));return n},provide:n=>Gh.from(n,e=>e.panel)});class ab{constructor(e,t){this.query=e,this.panel=t}}const sY=Je.mark({class:"cm-searchMatch"}),oY=Je.mark({class:"cm-searchMatch cm-searchMatch-selected"}),lY=En.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(dl))}update(n){let e=n.state.field(dl);(e!=n.startState.field(dl)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return Je.none;let{view:t}=this,r=new bo;for(let i=0,s=t.visibleRanges,o=s.length;i<o;i++){let{from:l,to:a}=s[i];for(;i<o-1&&a>s[i+1].from-2*250;)a=s[++i].to;n.highlight(t.state,l,a,(c,u)=>{let f=t.state.selection.ranges.some(p=>p.from==c&&p.to==u);r.add(c,u,f?oY:sY)})}return r.finish()}},{decorations:n=>n.decorations});function Cp(n){return e=>{let t=e.state.field(dl,!1);return t&&t.query.spec.valid?n(e,t):PN(e)}}const y0=Cp((n,{query:e})=>{let{to:t}=n.state.selection.main,r=e.nextMatch(n.state,t,t);if(!r)return!1;let i=re.single(r.from,r.to),s=n.state.facet(Wu);return n.dispatch({selection:i,effects:[bS(n,r),s.scrollToMatch(i.main,n)],userEvent:"select.search"}),RN(n),!0}),b0=Cp((n,{query:e})=>{let{state:t}=n,{from:r}=t.selection.main,i=e.prevMatch(t,r,r);if(!i)return!1;let s=re.single(i.from,i.to),o=n.state.facet(Wu);return n.dispatch({selection:s,effects:[bS(n,i),o.scrollToMatch(s.main,n)],userEvent:"select.search"}),RN(n),!0}),aY=Cp((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:re.create(t.map(r=>re.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),cY=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:r,to:i}=t.main,s=[],o=0;for(let l=new _u(n.doc,n.sliceDoc(r,i));!l.next().done;){if(s.length>1e3)return!1;l.value.from==r&&(o=s.length),s.push(re.range(l.value.from,l.value.to))}return e(n.update({selection:re.create(s,o),userEvent:"select.search.matches"})),!0},LE=Cp((n,{query:e})=>{let{state:t}=n,{from:r,to:i}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,r,r);if(!s)return!1;let o=s,l=[],a,c,u=[];o.from==r&&o.to==i&&(c=t.toText(e.getReplacement(o)),l.push({from:o.from,to:o.to,insert:c}),o=e.nextMatch(t,o.from,o.to),u.push(Re.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(r).number)+".")));let f=n.state.changes(l);return o&&(a=re.single(o.from,o.to).map(f),u.push(bS(n,o)),u.push(t.facet(Wu).scrollToMatch(a.main,n))),n.dispatch({changes:f,selection:a,effects:u,userEvent:"input.replace"}),!0}),uY=Cp((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(i=>{let{from:s,to:o}=i;return{from:s,to:o,insert:e.getReplacement(i)}});if(!t.length)return!1;let r=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:Re.announce.of(r),userEvent:"input.replace.all"}),!0});function yS(n){return n.state.facet(Wu).createPanel(n)}function gv(n,e){var t,r,i,s,o;let l=n.selection.main,a=l.empty||l.to>l.from+100?"":n.sliceDoc(l.from,l.to);if(e&&!a)return e;let c=n.facet(Wu);return new DN({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(r=e==null?void 0:e.caseSensitive)!==null&&r!==void 0?r:c.caseSensitive,literal:(i=e==null?void 0:e.literal)!==null&&i!==void 0?i:c.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:c.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function NN(n){let e=Kh(n,yS);return e&&e.dom.querySelector("[main-field]")}function RN(n){let e=NN(n);e&&e==n.root.activeElement&&e.select()}const PN=n=>{let e=n.state.field(dl,!1);if(e&&e.panel){let t=NN(n);if(t&&t!=n.root.activeElement){let r=gv(n.state,e.query.spec);r.valid&&n.dispatch({effects:md.of(r)}),t.focus(),t.select()}}else n.dispatch({effects:[gS.of(!0),e?md.of(gv(n.state,e.query.spec)):it.appendConfig.of(pY)]});return!0},BN=n=>{let e=n.state.field(dl,!1);if(!e||!e.panel)return!1;let t=Kh(n,yS);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:gS.of(!1)}),!0},fY=[{key:"Mod-f",run:PN,scope:"editor search-panel"},{key:"F3",run:y0,shift:b0,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:y0,shift:b0,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:BN,scope:"editor search-panel"},{key:"Mod-Shift-l",run:cY},{key:"Mod-Alt-g",run:$Z},{key:"Mod-d",run:eY,preventDefault:!0}];class hY{constructor(e){this.view=e;let t=this.query=e.state.field(dl).query.spec;this.commit=this.commit.bind(this),this.searchField=Ht("input",{value:t.search,placeholder:Jr(e,"Find"),"aria-label":Jr(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Ht("input",{value:t.replace,placeholder:Jr(e,"Replace"),"aria-label":Jr(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Ht("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Ht("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Ht("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function r(i,s,o){return Ht("button",{class:"cm-button",name:i,onclick:s,type:"button"},o)}this.dom=Ht("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,r("next",()=>y0(e),[Jr(e,"next")]),r("prev",()=>b0(e),[Jr(e,"previous")]),r("select",()=>aY(e),[Jr(e,"all")]),Ht("label",null,[this.caseField,Jr(e,"match case")]),Ht("label",null,[this.reField,Jr(e,"regexp")]),Ht("label",null,[this.wordField,Jr(e,"by word")]),...e.state.readOnly?[]:[Ht("br"),this.replaceField,r("replace",()=>LE(e),[Jr(e,"replace")]),r("replaceAll",()=>uY(e),[Jr(e,"replace all")])],Ht("button",{name:"close",onclick:()=>BN(e),"aria-label":Jr(e,"close"),type:"button"},[""])])}commit(){let e=new DN({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:md.of(e)}))}keydown(e){F6(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?b0:y0)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),LE(this.view))}update(e){for(let t of e.transactions)for(let r of t.effects)r.is(md)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Wu).top}}function Jr(n,e){return n.state.phrase(e)}const mm=30,gm=/[\s\.,:;?!]/;function bS(n,{from:e,to:t}){let r=n.state.doc.lineAt(e),i=n.state.doc.lineAt(t).to,s=Math.max(r.from,e-mm),o=Math.min(i,t+mm),l=n.state.sliceDoc(s,o);if(s!=r.from){for(let a=0;a<mm;a++)if(!gm.test(l[a+1])&&gm.test(l[a])){l=l.slice(a);break}}if(o!=i){for(let a=l.length-1;a>l.length-mm;a--)if(!gm.test(l[a-1])&&gm.test(l[a])){l=l.slice(0,a);break}}return Re.announce.of(`${n.state.phrase("current match")}. ${l} ${n.state.phrase("on line")} ${r.number}.`)}const dY=Re.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),pY=[dl,Cl.low(lY),dY];class HN{constructor(e,t,r,i){this.state=e,this.pos=t,this.explicit=r,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=er(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),r=Math.max(t.from,this.pos-250),i=t.text.slice(r-t.from,this.pos-t.from),s=i.search(VN(e,!1));return s<0?null:{from:r+s,to:this.pos,text:i.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,r){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),r&&r.onDocChange&&(this.abortOnDocChange=!0))}}function DE(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function mY(n){let e=Object.create(null),t=Object.create(null);for(let{label:i}of n){e[i[0]]=!0;for(let s=1;s<i.length;s++)t[i[s]]=!0}let r=DE(e)+DE(t)+"*$";return[new RegExp("^"+r),new RegExp(r)]}function gY(n){let e=n.map(i=>typeof i=="string"?{label:i}:i),[t,r]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:mY(e);return i=>{let s=i.matchBefore(r);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:t}:null}}function cne(n,e){return t=>{for(let r=er(t.state).resolveInner(t.pos,-1);r;r=r.parent){if(n.indexOf(r.name)>-1)return null;if(r.type.isTop)break}return e(t)}}class IE{constructor(e,t,r,i){this.completion=e,this.source=t,this.match=r,this.score=i}}function Da(n){return n.selection.main.from}function VN(n,e){var t;let{source:r}=n,i=e&&r[0]!="^",s=r[r.length-1]!="$";return!i&&!s?n:new RegExp(`${i?"^":""}(?:${r})${s?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const wS=Mo.define();function yY(n,e,t,r){let{main:i}=n.selection,s=t-i.from,o=r-i.from;return{...n.changeByRange(l=>{if(l!=i&&t!=r&&n.sliceDoc(l.from+s,l.from+o)!=n.sliceDoc(t,r))return{range:l};let a=n.toText(e);return{changes:{from:l.from+s,to:r==i.from?l.to:l.from+o,insert:a},range:re.cursor(l.from+s+a.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const NE=new WeakMap;function bY(n){if(!Array.isArray(n))return n;let e=NE.get(n);return e||NE.set(n,e=gY(n)),e}const w0=it.define(),gd=it.define();class wY{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let r=Vr(e,t),i=bs(r);this.chars.push(r);let s=e.slice(t,t+i),o=s.toUpperCase();this.folded.push(Vr(o==s?s.toLowerCase():o,0)),t+=i}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:r,any:i,precise:s,byWord:o}=this;if(t.length==1){let _=Vr(e,0),M=bs(_),T=M==e.length?0:-100;if(_!=t[0])if(_==r[0])T+=-200;else return null;return this.ret(T,[0,M])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,c=0;if(l<0){for(let _=0,M=Math.min(e.length,200);_<M&&c<a;){let T=Vr(e,_);(T==t[c]||T==r[c])&&(i[c++]=_),_+=bs(T)}if(c<a)return null}let u=0,f=0,p=!1,g=0,y=-1,v=-1,k=/[a-z]/.test(e),x=!0;for(let _=0,M=Math.min(e.length,200),T=0;_<M&&f<a;){let S=Vr(e,_);l<0&&(u<a&&S==t[u]&&(s[u++]=_),g<a&&(S==t[g]||S==r[g]?(g==0&&(y=_),v=_+1,g++):g=0));let A,I=S<255?S>=48&&S<=57||S>=97&&S<=122?2:S>=65&&S<=90?1:0:(A=Bv(S))!=A.toLowerCase()?1:A!=A.toUpperCase()?2:0;(!_||I==1&&k||T==0&&I!=0)&&(t[f]==S||r[f]==S&&(p=!0)?o[f++]=_:o.length&&(x=!1)),T=I,_+=bs(S)}return f==a&&o[0]==0&&x?this.result(-100+(p?-200:0),o,e):g==a&&y==0?this.ret(-200-e.length+(v==e.length?0:-100),[0,v]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):g==a?this.ret(-900-e.length,[y,v]):f==a?this.result(-100+(p?-200:0)+-700+(x?0:-1100),o,e):t.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,t,r){let i=[],s=0;for(let o of t){let l=o+(this.astral?bs(Vr(r,o)):1);s&&i[s-1]==o?i[s-1]=l:(i[s++]=o,i[s++]=l)}return this.ret(e-r.length,i)}}class vY{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),r=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return r==null?null:(this.matched=[0,t.length],this.score=r+(e.length==this.pattern.length?0:-100),this)}}const Bn=Ie.define({combine(n){return Is(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:kY,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>r=>RE(e(r),t(r)),optionClass:(e,t)=>r=>RE(e(r),t(r)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function RE(n,e){return n?e?n+" "+e:n:e}function kY(n,e,t,r,i,s){let o=n.textDirection==tn.RTL,l=o,a=!1,c="top",u,f,p=e.left-i.left,g=i.right-e.right,y=r.right-r.left,v=r.bottom-r.top;if(l&&p<Math.min(y,g)?l=!1:!l&&g<Math.min(y,p)&&(l=!0),y<=(l?p:g))u=Math.max(i.top,Math.min(t.top,i.bottom-v))-e.top,f=Math.min(400,l?p:g);else{a=!0,f=Math.min(400,(o?e.right:i.right-e.left)-30);let _=i.bottom-e.bottom;_>=v||_>e.top?u=t.bottom-e.top:(c="bottom",u=e.bottom-t.top)}let k=(e.bottom-e.top)/s.offsetHeight,x=(e.right-e.left)/s.offsetWidth;return{style:`${c}: ${u/k}px; max-width: ${f/x}px`,class:"cm-completionInfo-"+(a?o?"left-narrow":"right-narrow":l?"left":"right")}}function CY(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let r=document.createElement("div");return r.classList.add("cm-completionIcon"),t.type&&r.classList.add(...t.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),r.setAttribute("aria-hidden","true"),r},position:20}),e.push({render(t,r,i,s){let o=document.createElement("span");o.className="cm-completionLabel";let l=t.displayLabel||t.label,a=0;for(let c=0;c<s.length;){let u=s[c++],f=s[c++];u>a&&o.appendChild(document.createTextNode(l.slice(a,u)));let p=o.appendChild(document.createElement("span"));p.appendChild(document.createTextNode(l.slice(u,f))),p.className="cm-completionMatchedText",a=f}return a<l.length&&o.appendChild(document.createTextNode(l.slice(a))),o},position:50},{render(t){if(!t.detail)return null;let r=document.createElement("span");return r.className="cm-completionDetail",r.textContent=t.detail,r},position:80}),e.sort((t,r)=>t.position-r.position).map(t=>t.render)}function cb(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let i=Math.floor(e/t);return{from:i*t,to:(i+1)*t}}let r=Math.floor((n-e)/t);return{from:n-(r+1)*t,to:n-r*t}}class SY{constructor(e,t,r){this.view=e,this.stateField=t,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:s,selected:o}=i.open,l=e.state.facet(Bn);this.optionContent=CY(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=cb(s.length,o,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=e.state.field(t).open;for(let u=a.target,f;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(f=/-(\d+)$/.exec(u.id))&&+f[1]<c.length){this.applyCompletion(e,c[+f[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(Bn).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:gd.of(null)})}),this.showOptions(s,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let r=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),r!=i){let{options:s,selected:o,disabled:l}=r.open;(!i.open||i.open.options!=s)&&(this.range=cb(s.length,o,e.state.facet(Bn).maxRenderedOptions),this.showOptions(s,r.id)),this.updateSel(),l!=((t=i.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let r of this.currentClass.split(" "))r&&this.dom.classList.remove(r);for(let r of t.split(" "))r&&this.dom.classList.add(r);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=cb(t.options.length,t.selected,this.view.state.facet(Bn).maxRenderedOptions),this.showOptions(t.options,e.id));let r=this.updateSelectedOption(t.selected);if(r){this.destroyInfo();let{completion:i}=t.options[t.selected],{info:s}=i;if(!s)return;let o=typeof s=="string"?document.createTextNode(s):s(i);if(!o)return;"then"in o?o.then(l=>{l&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(l,i)}).catch(l=>jr(this.view.state,l,"completion info")):(this.addInfoPane(o,i),r.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",r.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)r.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:s}=e;r.appendChild(i),this.infoDestroy=s||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let r=this.list.firstChild,i=this.range.from;r;r=r.nextSibling,i++)r.nodeName!="LI"||!r.id?i--:i==e?r.hasAttribute("aria-selected")||(r.setAttribute("aria-selected","true"),t=r):r.hasAttribute("aria-selected")&&(r.removeAttribute("aria-selected"),r.removeAttribute("aria-describedby"));return t&&_Y(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return i.top>Math.min(s.bottom,t.bottom)-10||i.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(Bn).positionInfo(this.view,t,i,r,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,r){const i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions")),i.addEventListener("mousedown",o=>{o.target==i&&o.preventDefault()});let s=null;for(let o=r.from;o<r.to;o++){let{completion:l,match:a}=e[o],{section:c}=l;if(c){let p=typeof c=="string"?c:c.name;if(p!=s&&(o>r.from||r.from==0))if(s=p,typeof c!="string"&&c.header)i.appendChild(c.header(c));else{let g=i.appendChild(document.createElement("completion-section"));g.textContent=p}}const u=i.appendChild(document.createElement("li"));u.id=t+"-"+o,u.setAttribute("role","option");let f=this.optionClass(l);f&&(u.className=f);for(let p of this.optionContent){let g=p(l,this.view.state,this.view,a);g&&u.appendChild(g)}}return r.from&&i.classList.add("cm-completionListIncompleteTop"),r.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function xY(n,e){return t=>new SY(t,n,e)}function _Y(n,e){let t=n.getBoundingClientRect(),r=e.getBoundingClientRect(),i=t.height/n.offsetHeight;r.top<t.top?n.scrollTop-=(t.top-r.top)/i:r.bottom>t.bottom&&(n.scrollTop+=(r.bottom-t.bottom)/i)}function PE(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function MY(n,e){let t=[],r=null,i=null,s=u=>{t.push(u);let{section:f}=u.completion;if(f){r||(r=[]);let p=typeof f=="string"?f:f.name;r.some(g=>g.name==p)||r.push(typeof f=="string"?{name:p}:f)}},o=e.facet(Bn);for(let u of n)if(u.hasResult()){let f=u.result.getMatch;if(u.result.filter===!1)for(let p of u.result.options)s(new IE(p,u.source,f?f(p):[],1e9-t.length));else{let p=e.sliceDoc(u.from,u.to),g,y=o.filterStrict?new vY(p):new wY(p);for(let v of u.result.options)if(g=y.match(v.label)){let k=v.displayLabel?f?f(v,g.matched):[]:g.matched,x=g.score+(v.boost||0);if(s(new IE(v,u.source,k,x)),typeof v.section=="object"&&v.section.rank==="dynamic"){let{name:_}=v.section;i||(i=Object.create(null)),i[_]=Math.max(x,i[_]||-1e9)}}}}if(r){let u=Object.create(null),f=0,p=(g,y)=>(g.rank==="dynamic"&&y.rank==="dynamic"?i[y.name]-i[g.name]:0)||(typeof g.rank=="number"?g.rank:1e9)-(typeof y.rank=="number"?y.rank:1e9)||(g.name<y.name?-1:1);for(let g of r.sort(p))f-=1e5,u[g.name]=f;for(let g of t){let{section:y}=g.completion;y&&(g.score+=u[typeof y=="string"?y:y.name])}}let l=[],a=null,c=o.compareCompletions;for(let u of t.sort((f,p)=>p.score-f.score||c(f.completion,p.completion))){let f=u.completion;!a||a.label!=f.label||a.detail!=f.detail||a.type!=null&&f.type!=null&&a.type!=f.type||a.apply!=f.apply||a.boost!=f.boost?l.push(u):PE(u.completion)>PE(a)&&(l[l.length-1]=u),a=u.completion}return l}class _c{constructor(e,t,r,i,s,o){this.options=e,this.attrs=t,this.tooltip=r,this.timestamp=i,this.selected=s,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new _c(this.options,BE(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,r,i,s,o){if(i&&!o&&e.some(c=>c.isPending))return i.setDisabled();let l=MY(e,t);if(!l.length)return i&&e.some(c=>c.isPending)?i.setDisabled():null;let a=t.facet(Bn).selectOnOpen?0:-1;if(i&&i.selected!=a&&i.selected!=-1){let c=i.options[i.selected].completion;for(let u=0;u<l.length;u++)if(l[u].completion==c){a=u;break}}return new _c(l,BE(r,a),{pos:e.reduce((c,u)=>u.hasResult()?Math.min(c,u.from):c,1e8),create:DY,above:s.aboveCursor},i?i.timestamp:Date.now(),a,!1)}map(e){return new _c(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new _c(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class v0{constructor(e,t,r){this.active=e,this.id=t,this.open=r}static start(){return new v0(OY,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,r=t.facet(Bn),s=(r.override||t.languageDataAt("autocomplete",Da(t)).map(bY)).map(a=>(this.active.find(u=>u.source==a)||new vi(a,this.active.some(u=>u.state!=0)?1:0)).update(e,r));s.length==this.active.length&&s.every((a,c)=>a==this.active[c])&&(s=this.active);let o=this.open,l=e.effects.some(a=>a.is(vS));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!TY(s,this.active)||l?o=_c.build(s,t,this.id,o,r,l):o&&o.disabled&&!s.some(a=>a.isPending)&&(o=null),!o&&s.every(a=>!a.isPending)&&s.some(a=>a.hasResult())&&(s=s.map(a=>a.hasResult()?new vi(a.source,0):a));for(let a of e.effects)a.is(jN)&&(o=o&&o.setSelected(a.value,this.id));return s==this.active&&o==this.open?this:new v0(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?EY:AY}}function TY(n,e){if(n==e)return!0;for(let t=0,r=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;r<e.length&&!e[r].hasResult();)r++;let i=t==n.length,s=r==e.length;if(i||s)return i==s;if(n[t++].result!=e[r++].result)return!1}}const EY={"aria-autocomplete":"list"},AY={};function BE(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const OY=[];function FN(n,e){if(n.isUserEvent("input.complete")){let r=n.annotation(wS);if(r&&e.activateOnCompletion(r))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class vi{constructor(e,t,r=!1){this.source=e,this.state=t,this.explicit=r}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let r=FN(e,t),i=this;(r&8||r&16&&this.touches(e))&&(i=new vi(i.source,0)),r&4&&i.state==0&&(i=new vi(this.source,1)),i=i.updateFor(e,r);for(let s of e.effects)if(s.is(w0))i=new vi(i.source,1,s.value);else if(s.is(gd))i=new vi(i.source,0);else if(s.is(vS))for(let o of s.value)o.source==i.source&&(i=o);return i}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Da(e.state))}}class Pc extends vi{constructor(e,t,r,i,s,o){super(e,3,t),this.limit=r,this.result=i,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,t){var r;if(!(t&3))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),l=Da(e.state);if(l>o||!i||t&2&&(Da(e.startState)==this.from||l<this.limit))return new vi(this.source,t&4?1:0);let a=e.changes.mapPos(this.limit);return LY(i.validFor,e.state,s,o)?new Pc(this.source,this.explicit,a,i,s,o):i.update&&(i=i.update(i,s,o,new HN(e.state,l,!1)))?new Pc(this.source,this.explicit,a,i,i.from,(r=i.to)!==null&&r!==void 0?r:Da(e.state)):new vi(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Pc(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new vi(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function LY(n,e,t,r){if(!n)return!1;let i=e.sliceDoc(t,r);return typeof n=="function"?n(i,t,r,e):VN(n,!0).test(i)}const vS=it.define({map(n,e){return n.map(t=>t.map(e))}}),jN=it.define(),Fr=jn.define({create(){return v0.start()},update(n,e){return n.update(e)},provide:n=>[Yv.from(n,e=>e.tooltip),Re.contentAttributes.from(n,e=>e.attrs)]});function kS(n,e){const t=e.completion.apply||e.completion.label;let r=n.state.field(Fr).active.find(i=>i.source==e.source);return r instanceof Pc?(typeof t=="string"?n.dispatch({...yY(n.state,t,r.from,r.to),annotations:wS.of(e.completion)}):t(n,e.completion,r.from,r.to),!0):!1}const DY=xY(Fr,kS);function ym(n,e="option"){return t=>{let r=t.state.field(Fr,!1);if(!r||!r.open||r.open.disabled||Date.now()-r.open.timestamp<t.state.facet(Bn).interactionDelay)return!1;let i=1,s;e=="page"&&(s=CO(t,r.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=r.open.options,l=r.open.selected>-1?r.open.selected+i*(n?1:-1):n?0:o-1;return l<0?l=e=="page"?0:o-1:l>=o&&(l=e=="page"?o-1:0),t.dispatch({effects:jN.of(l)}),!0}}const IY=n=>{let e=n.state.field(Fr,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(Bn).interactionDelay?!1:kS(n,e.open.options[e.open.selected])},ub=n=>n.state.field(Fr,!1)?(n.dispatch({effects:w0.of(!0)}),!0):!1,NY=n=>{let e=n.state.field(Fr,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:gd.of(null)}),!0)};class RY{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const PY=50,BY=1e3,HY=En.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(Fr).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(Fr),t=n.state.facet(Bn);if(!n.selectionSet&&!n.docChanged&&n.startState.field(Fr)==e)return;let r=n.transactions.some(s=>{let o=FN(s,t);return o&8||(s.selection||s.docChanged)&&!(o&3)});for(let s=0;s<this.running.length;s++){let o=this.running[s];if(r||o.context.abortOnDocChange&&n.docChanged||o.updates.length+n.transactions.length>PY&&Date.now()-o.time>BY){for(let l of o.context.abortListeners)try{l()}catch(a){jr(this.view.state,a)}o.context.abortListeners=null,this.running.splice(s--,1)}else o.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(s=>s.effects.some(o=>o.is(w0)))&&(this.pendingStart=!0);let i=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(o=>o.active.source==s.source))?setTimeout(()=>this.startUpdate(),i):-1,this.composing!=0)for(let s of n.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(Fr);for(let t of e.active)t.isPending&&!this.running.some(r=>r.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Bn).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=Da(e),r=new HN(e,t,n.explicit,this.view),i=new RY(n,r);this.running.push(i),Promise.resolve(n.source(r)).then(s=>{i.context.aborted||(i.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:gd.of(null)}),jr(this.view.state,s)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Bn).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Bn),r=this.view.state.field(Fr);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let l=Da(s.updates.length?s.updates[0].startState:this.view.state),a=Math.min(l,s.done.from+(s.active.explicit?0:1)),c=new Pc(s.active.source,s.active.explicit,a,s.done,s.done.from,(n=s.done.to)!==null&&n!==void 0?n:l);for(let u of s.updates)c=c.update(u,t);if(c.hasResult()){e.push(c);continue}}let o=r.active.find(l=>l.source==s.active.source);if(o&&o.isPending)if(s.done==null){let l=new vi(s.active.source,0);for(let a of s.updates)l=l.update(a,t);l.isPending||e.push(l)}else this.startQuery(o)}(e.length||r.open&&r.open.disabled)&&this.view.dispatch({effects:vS.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(Fr,!1);if(e&&e.tooltip&&this.view.state.facet(Bn).closeOnBlur){let t=e.open&&CO(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:gd.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:w0.of(!1)}),20),this.composing=0}}}),VY=typeof navigator=="object"&&/Win/.test(navigator.platform),FY=Cl.highest(Re.domEventHandlers({keydown(n,e){let t=e.state.field(Fr,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!(VY&&n.altKey)||n.metaKey)return!1;let r=t.open.options[t.open.selected],i=t.active.find(o=>o.source==r.source),s=r.completion.commitCharacters||i.result.commitCharacters;return s&&s.indexOf(n.key)>-1&&kS(e,r),!1}})),$N=Re.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class jY{constructor(e,t,r,i){this.field=e,this.line=t,this.from=r,this.to=i}}class CS{constructor(e,t,r){this.field=e,this.from=t,this.to=r}map(e){let t=e.mapPos(this.from,-1,Yn.TrackDel),r=e.mapPos(this.to,1,Yn.TrackDel);return t==null||r==null?null:new CS(this.field,t,r)}}class SS{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let r=[],i=[t],s=e.doc.lineAt(t),o=/^\s*/.exec(s.text)[0];for(let a of this.lines){if(r.length){let c=o,u=/^\t*/.exec(a)[0].length;for(let f=0;f<u;f++)c+=e.facet(N0);i.push(t+c.length-u),a=c+a.slice(u)}r.push(a),t+=a.length+1}let l=this.fieldPositions.map(a=>new CS(a.field,i[a.line]+a.from,i[a.line]+a.to));return{text:r,ranges:l}}static parse(e){let t=[],r=[],i=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(o);){let l=s[1]?+s[1]:null,a=s[2]||s[3]||"",c=-1,u=a.replace(/\\[{}]/g,f=>f[1]);for(let f=0;f<t.length;f++)(l!=null?t[f].seq==l:u&&t[f].name==u)&&(c=f);if(c<0){let f=0;for(;f<t.length&&(l==null||t[f].seq!=null&&t[f].seq<l);)f++;t.splice(f,0,{seq:l,name:u}),c=f;for(let p of i)p.field>=c&&p.field++}for(let f of i)if(f.line==r.length&&f.from>s.index){let p=s[2]?3+(s[1]||"").length:2;f.from-=p,f.to-=p}i.push(new jY(c,r.length,s.index,s.index+u.length)),o=o.slice(0,s.index)+a+o.slice(s.index+s[0].length)}o=o.replace(/\\([{}])/g,(l,a,c)=>{for(let u of i)u.line==r.length&&u.from>c&&(u.from--,u.to--);return a}),r.push(o)}return new SS(r,i)}}let $Y=Je.widget({widget:new class extends To{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),zY=Je.mark({class:"cm-snippetField"});class qu{constructor(e,t){this.ranges=e,this.active=t,this.deco=Je.set(e.map(r=>(r.from==r.to?$Y:zY).range(r.from,r.to)),!0)}map(e){let t=[];for(let r of this.ranges){let i=r.map(e);if(!i)return null;t.push(i)}return new qu(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(r=>r.field==this.active&&r.from<=t.from&&r.to>=t.to))}}const Sp=it.define({map(n,e){return n&&n.map(e)}}),WY=it.define(),yd=jn.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(Sp))return t.value;if(t.is(WY)&&n)return new qu(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>Re.decorations.from(n,e=>e?e.deco:Je.none)});function xS(n,e){return re.create(n.filter(t=>t.field==e).map(t=>re.range(t.from,t.to)))}function qY(n){let e=SS.parse(n);return(t,r,i,s)=>{let{text:o,ranges:l}=e.instantiate(t.state,i),{main:a}=t.state.selection,c={changes:{from:i,to:s==a.from?a.to:s,insert:Tt.of(o)},scrollIntoView:!0,annotations:r?[wS.of(r),Sr.userEvent.of("input.complete")]:void 0};if(l.length&&(c.selection=xS(l,0)),l.some(u=>u.field>0)){let u=new qu(l,0),f=c.effects=[Sp.of(u)];t.state.field(yd,!1)===void 0&&f.push(it.appendConfig.of([yd,ZY,YY,$N]))}t.dispatch(t.state.update(c))}}function zN(n){return({state:e,dispatch:t})=>{let r=e.field(yd,!1);if(!r||n<0&&r.active==0)return!1;let i=r.active+n,s=n>0&&!r.ranges.some(o=>o.field==i+n);return t(e.update({selection:xS(r.ranges,i),effects:Sp.of(s?null:new qu(r.ranges,i)),scrollIntoView:!0})),!0}}const UY=({state:n,dispatch:e})=>n.field(yd,!1)?(e(n.update({effects:Sp.of(null)})),!0):!1,KY=zN(1),GY=zN(-1),JY=[{key:"Tab",run:KY,shift:GY},{key:"Escape",run:UY}],HE=Ie.define({combine(n){return n.length?n[0]:JY}}),ZY=Cl.highest(Iu.compute([HE],n=>n.facet(HE)));function une(n,e){return{...e,apply:qY(n)}}const YY=Re.domEventHandlers({mousedown(n,e){let t=e.state.field(yd,!1),r;if(!t||(r=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let i=t.ranges.find(s=>s.from<=r&&s.to>=r);return!i||i.field==t.active?!1:(e.dispatch({selection:xS(t.ranges,i.field),effects:Sp.of(t.ranges.some(s=>s.field>i.field)?new qu(t.ranges,i.field):null),scrollIntoView:!0}),!0)}}),bd={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},la=it.define({map(n,e){let t=e.mapPos(n,-1,Yn.TrackAfter);return t??void 0}}),_S=new class extends Na{};_S.startSide=1;_S.endSide=-1;const WN=jn.define({create(){return xt.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:r=>r>=t.from&&r<=t.to})}for(let t of e.effects)t.is(la)&&(n=n.update({add:[_S.range(t.value,t.value+1)]}));return n}});function XY(){return[eX,WN]}const fb="()[]{}<>";function qN(n){for(let e=0;e<fb.length;e+=2)if(fb.charCodeAt(e)==n)return fb.charAt(e+1);return Bv(n<128?n:n+1)}function UN(n,e){return n.languageDataAt("closeBrackets",e)[0]||bd}const QY=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),eX=Re.inputHandler.of((n,e,t,r)=>{if((QY?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let i=n.state.selection.main;if(r.length>2||r.length==2&&bs(Vr(r,0))==1||e!=i.from||t!=i.to)return!1;let s=rX(n.state,r);return s?(n.dispatch(s),!0):!1}),tX=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=UN(n,n.selection.main.head).brackets||bd.brackets,i=null,s=n.changeByRange(o=>{if(o.empty){let l=iX(n.doc,o.head);for(let a of r)if(a==l&&Sy(n.doc,o.head)==qN(Vr(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:re.cursor(o.head-a.length)}}return{range:i=o}});return i||e(n.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},nX=[{key:"Backspace",run:tX}];function rX(n,e){let t=UN(n,n.selection.main.head),r=t.brackets||bd.brackets;for(let i of r){let s=qN(Vr(i,0));if(e==i)return s==i?lX(n,i,r.indexOf(i+i+i)>-1,t):sX(n,i,s,t.before||bd.before);if(e==s&&KN(n,n.selection.main.from))return oX(n,i,s)}return null}function KN(n,e){let t=!1;return n.field(WN).between(0,n.doc.length,r=>{r==e&&(t=!0)}),t}function Sy(n,e){let t=n.sliceString(e,e+2);return t.slice(0,bs(Vr(t,0)))}function iX(n,e){let t=n.sliceString(e-2,e);return bs(Vr(t,0))==t.length?t:t.slice(1)}function sX(n,e,t,r){let i=null,s=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:la.of(o.to+e.length),range:re.range(o.anchor+e.length,o.head+e.length)};let l=Sy(n.doc,o.head);return!l||/\s/.test(l)||r.indexOf(l)>-1?{changes:{insert:e+t,from:o.head},effects:la.of(o.head+e.length),range:re.cursor(o.head+e.length)}:{range:i=o}});return i?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function oX(n,e,t){let r=null,i=n.changeByRange(s=>s.empty&&Sy(n.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:re.cursor(s.head+t.length)}:r={range:s});return r?null:n.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function lX(n,e,t,r){let i=r.stringPrefixes||bd.stringPrefixes,s=null,o=n.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:la.of(l.to+e.length),range:re.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=Sy(n.doc,a),u;if(c==e){if(VE(n,a))return{changes:{insert:e+e,from:a},effects:la.of(a+e.length),range:re.cursor(a+e.length)};if(KN(n,a)){let p=t&&n.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+p.length,insert:p},range:re.cursor(a+p.length)}}}else{if(t&&n.sliceDoc(a-2*e.length,a)==e+e&&(u=FE(n,a-2*e.length,i))>-1&&VE(n,u))return{changes:{insert:e+e+e+e,from:a},effects:la.of(a+e.length),range:re.cursor(a+e.length)};if(n.charCategorizer(a)(c)!=on.Word&&FE(n,a,i)>-1&&!aX(n,a,e,i))return{changes:{insert:e+e,from:a},effects:la.of(a+e.length),range:re.cursor(a+e.length)}}return{range:s=l}});return s?null:n.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function VE(n,e){let t=er(n).resolveInner(e+1);return t.parent&&t.from==e}function aX(n,e,t,r){let i=er(n).resolveInner(e,-1),s=r.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=n.sliceDoc(i.from,Math.min(i.to,i.from+t.length+s)),a=l.indexOf(t);if(!a||a>-1&&r.indexOf(l.slice(0,a))>-1){let u=i.firstChild;for(;u&&u.from==i.from&&u.to-u.from>t.length+a;){if(n.sliceDoc(u.to-t.length,u.to)==t)return!1;u=u.firstChild}return!0}let c=i.to==e&&i.parent;if(!c)break;i=c}return!1}function FE(n,e,t){let r=n.charCategorizer(e);if(r(n.sliceDoc(e-1,e))!=on.Word)return e;for(let i of t){let s=e-i.length;if(n.sliceDoc(s,e)==i&&r(n.sliceDoc(s-1,s))!=on.Word)return s}return-1}function cX(n={}){return[FY,Fr,Bn.of(n),HY,uX,$N]}const GN=[{key:"Ctrl-Space",run:ub},{mac:"Alt-`",run:ub},{mac:"Alt-i",run:ub},{key:"Escape",run:NY},{key:"ArrowDown",run:ym(!0)},{key:"ArrowUp",run:ym(!1)},{key:"PageDown",run:ym(!0,"page")},{key:"PageUp",run:ym(!1,"page")},{key:"Enter",run:IY}],uX=Cl.highest(Iu.computeN([Bn],n=>n.facet(Bn).defaultKeymap?[GN]:[]));class jE{constructor(e,t,r){this.from=e,this.to=t,this.diagnostic=r}}class ea{constructor(e,t,r){this.diagnostics=e,this.panel=t,this.selected=r}static init(e,t,r){let i=r.facet(wd).markerFilter;i&&(e=i(e,r));let s=e.slice().sort((g,y)=>g.from-y.from||g.to-y.to),o=new bo,l=[],a=0,c=r.doc.iter(),u=0,f=r.doc.length;for(let g=0;;){let y=g==s.length?null:s[g];if(!y&&!l.length)break;let v,k;if(l.length)v=a,k=l.reduce((M,T)=>Math.min(M,T.to),y&&y.from>v?y.from:1e8);else{if(v=y.from,v>f)break;k=y.to,l.push(y),g++}for(;g<s.length;){let M=s[g];if(M.from==v&&(M.to>M.from||M.to==v))l.push(M),g++,k=Math.min(M.to,k);else{k=Math.min(M.from,k);break}}k=Math.min(k,f);let x=!1;if(l.some(M=>M.from==v&&(M.to==k||k==f))&&(x=v==k,!x&&k-v<10)){let M=v-(u+c.value.length);M>0&&(c.next(M),u=v);for(let T=v;;){if(T>=k){x=!0;break}if(!c.lineBreak&&u+c.value.length>T)break;T=u+c.value.length,u+=c.value.length,c.next()}}let _=SX(l);if(x)o.add(v,v,Je.widget({widget:new wX(_),diagnostics:l.slice()}));else{let M=l.reduce((T,S)=>S.markClass?T+" "+S.markClass:T,"");o.add(v,k,Je.mark({class:"cm-lintRange cm-lintRange-"+_+M,diagnostics:l.slice(),inclusiveEnd:l.some(T=>T.to>k)}))}if(a=k,a==f)break;for(let M=0;M<l.length;M++)l[M].to<=a&&l.splice(M--,1)}let p=o.finish();return new ea(p,t,Mu(p))}}function Mu(n,e=null,t=0){let r=null;return n.between(t,1e9,(i,s,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!r)r=new jE(i,s,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(r.diagnostic)<0)return!1;r=new jE(r.from,s,r.diagnostic)}}),r}function fX(n,e){let t=e.pos,r=e.end||t,i=n.state.facet(wd).hideOn(n,t,r);if(i!=null)return i;let s=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(o=>o.is(JN))||n.changes.touchesRange(s.from,Math.max(s.to,r)))}function hX(n,e){return n.field(oi,!1)?e:e.concat(it.appendConfig.of(xX))}const JN=it.define(),MS=it.define(),ZN=it.define(),oi=jn.define({create(){return new ea(Je.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),r=null,i=n.panel;if(n.selected){let s=e.changes.mapPos(n.selected.from,1);r=Mu(t,n.selected.diagnostic,s)||Mu(t,null,s)}!t.size&&i&&e.state.facet(wd).autoPanel&&(i=null),n=new ea(t,i,r)}for(let t of e.effects)if(t.is(JN)){let r=e.state.facet(wd).autoPanel?t.value.length?vd.open:null:n.panel;n=ea.init(t.value,r,e.state)}else t.is(MS)?n=new ea(n.diagnostics,t.value?vd.open:null,n.selected):t.is(ZN)&&(n=new ea(n.diagnostics,n.panel,t.value));return n},provide:n=>[Gh.from(n,e=>e.panel),Re.decorations.from(n,e=>e.diagnostics)]}),dX=Je.mark({class:"cm-lintRange cm-lintRange-active"});function pX(n,e,t){let{diagnostics:r}=n.state.field(oi),i,s=-1,o=-1;r.between(e-(t<0?1:0),e+(t>0?1:0),(a,c,{spec:u})=>{if(e>=a&&e<=c&&(a==c||(e>a||t>0)&&(e<c||t<0)))return i=u.diagnostics,s=a,o=c,!1});let l=n.state.facet(wd).tooltipFilter;return i&&l&&(i=l(i,n.state)),i?{pos:s,end:o,above:n.state.doc.lineAt(s).to<o,create(){return{dom:mX(n,i)}}}:null}function mX(n,e){return Ht("ul",{class:"cm-tooltip-lint"},e.map(t=>XN(n,t,!1)))}const gX=n=>{let e=n.state.field(oi,!1);(!e||!e.panel)&&n.dispatch({effects:hX(n.state,[MS.of(!0)])});let t=Kh(n,vd.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},$E=n=>{let e=n.state.field(oi,!1);return!e||!e.panel?!1:(n.dispatch({effects:MS.of(!1)}),!0)},yX=n=>{let e=n.state.field(oi,!1);if(!e)return!1;let t=n.state.selection.main,r=e.diagnostics.iter(t.to+1);return!r.value&&(r=e.diagnostics.iter(0),!r.value||r.from==t.from&&r.to==t.to)?!1:(n.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)},bX=[{key:"Mod-Shift-m",run:gX,preventDefault:!0},{key:"F8",run:yX}],wd=Ie.define({combine(n){return{sources:n.map(e=>e.source).filter(e=>e!=null),...Is(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:zE,tooltipFilter:zE,needsRefresh:(e,t)=>e?t?r=>e(r)||t(r):e:t,hideOn:(e,t)=>e?t?(r,i,s)=>e(r,i,s)||t(r,i,s):e:t,autoPanel:(e,t)=>e||t})}}});function zE(n,e){return n?e?(t,r)=>e(n(t,r),r):n:e}function YN(n){let e=[];if(n)e:for(let{name:t}of n){for(let r=0;r<t.length;r++){let i=t[r];if(/[a-zA-Z]/.test(i)&&!e.some(s=>s.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function XN(n,e,t){var r;let i=t?YN(e.actions):[];return Ht("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Ht("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(r=e.actions)===null||r===void 0?void 0:r.map((s,o)=>{let l=!1,a=g=>{if(g.preventDefault(),l)return;l=!0;let y=Mu(n.state.field(oi).diagnostics,e);y&&s.apply(n,y.from,y.to)},{name:c}=s,u=i[o]?c.indexOf(i[o]):-1,f=u<0?c:[c.slice(0,u),Ht("u",c.slice(u,u+1)),c.slice(u+1)],p=s.markClass?" "+s.markClass:"";return Ht("button",{type:"button",class:"cm-diagnosticAction"+p,onclick:a,onmousedown:a,"aria-label":` Action: ${c}${u<0?"":` (access key "${i[o]})"`}.`},f)}),e.source&&Ht("div",{class:"cm-diagnosticSource"},e.source))}class wX extends To{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Ht("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class WE{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=XN(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class vd{constructor(e){this.view=e,this.items=[];let t=i=>{if(i.keyCode==27)$E(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=YN(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==i.keyCode){let a=Mu(this.view.state.field(oi).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;i.preventDefault()},r=i=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(i.target)&&this.moveSelection(s)};this.list=Ht("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:r}),this.dom=Ht("div",{class:"cm-panel-lint"},this.list,Ht("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>$E(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(oi).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(oi),r=0,i=!1,s=null,o=new Set;for(e.between(0,this.view.state.doc.length,(l,a,{spec:c})=>{for(let u of c.diagnostics){if(o.has(u))continue;o.add(u);let f=-1,p;for(let g=r;g<this.items.length;g++)if(this.items[g].diagnostic==u){f=g;break}f<0?(p=new WE(this.view,u),this.items.splice(r,0,p),i=!0):(p=this.items[f],f>r&&(this.items.splice(r,f-r),i=!0)),t&&p.diagnostic==t.diagnostic?p.dom.hasAttribute("aria-selected")||(p.dom.setAttribute("aria-selected","true"),s=p):p.dom.hasAttribute("aria-selected")&&p.dom.removeAttribute("aria-selected"),r++}});r<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new WE(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:l,panel:a})=>{let c=a.height/this.list.offsetHeight;l.top<a.top?this.list.scrollTop-=(a.top-l.top)/c:l.bottom>a.bottom&&(this.list.scrollTop+=(l.bottom-a.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function t(){let r=e;e=r.nextSibling,r.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)t();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(oi),r=Mu(t.diagnostics,this.items[e].diagnostic);r&&this.view.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:ZN.of(r)})}static open(e){return new vd(e)}}function vX(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function bm(n){return vX(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const kX=Re.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:bm("#d11")},".cm-lintRange-warning":{backgroundImage:bm("orange")},".cm-lintRange-info":{backgroundImage:bm("#999")},".cm-lintRange-hint":{backgroundImage:bm("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function CX(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function SX(n){let e="hint",t=1;for(let r of n){let i=CX(r.severity);i>t&&(t=i,e=r.severity)}return e}const xX=[oi,Re.decorations.compute([oi],n=>{let{selected:e,panel:t}=n.field(oi);return!e||!t||e.from==e.to?Je.none:Je.set([dX.range(e.from,e.to)])}),_B(pX,{hideOn:fX}),kX],_X=[PB(),VB(),nB(),pJ(),kH(),bO(),Z6(),ln.allowMultipleSelections.of(!0),lH(),jO(_H,{fallback:!0}),DH(),XY(),cX(),pB(),yB(),aB(),UZ(),Iu.of([...nX,...xN,...fY,...SJ,...yH,...GN,...bX])],MX=1;function TX(n){return n.nodeType===MX}function EX(n){return TX(n)&&n.namespaceURI==="http://www.w3.org/1999/xhtml"}function AX(n){let e=[[-1,n.state.doc]],t=[];for(;e.length>0;){const[r,i]=e.pop();if(r>=0){let s=n.nodeDOM(r);if(s&&EX(s)){let{top:o,bottom:l,left:a,right:c}=s.getBoundingClientRect();t.push([r,[a,o,c,o]],[r+i.nodeSize,[a,l,c,l]])}}if(i.isBlock&&!i.isTextblock){let s=r+1;for(let o of i.children)e.push([s,o]),s+=o.nodeSize}}return t}function OX(n,e){let t=[],r,i;const s=()=>{const u=n.dom.getBoundingClientRect(),f=n.state.doc;return t&&r&&i&&u.width===i.width&&u.height===i.height&&u.x===i.x&&u.y===i.y&&r.eq(f)||(i=u,r=f,t=AX(n)),t},o=(u,f)=>{if(!n.editable||n.isDestroyed)return;const p=(v,k)=>{const[x,_]=v,[M,T]=k;return UE(u,_)-UE(u,T)||x-M};let g=s();g.sort(p),g=g.slice(0,8);const y=g.find(v=>(e==null?void 0:e({view:n,pos:v[0],event:f}))!==!1);if(!(y&&DX(n,y[0])))return y};let l,a;return(u,f)=>(l&&LX(l,u)||(l=u,a=o(u,f)),a)}function LX(n,e){return n[0]===e[0]&&n[1]===e[1]}function qE(n,e){return Math.abs(n[0]-e[0])+Math.abs(n[1]-e[1])}function UE(n,e){return Math.min(qE(n,[e[0],e[1]]),qE(n,[e[2],e[3]]))}function DX(n,e){const t=n.dragging;if(!t)return;const{move:r}=t;if(!r)return;const i=n.state.selection;if(!(i instanceof Ke))return;const{from:s,to:o}=i;return s<=e&&e<=o}function IX(n){let e;return new nn({key:new rn("prosekit-drop-indicator"),view:t=>(e=OX(t,n.onDrag),RX(t,e,n)),props:{handleDrop(t,r,i,s){if(!e)return!1;const o=e([r.clientX,r.clientY],r);if(!o)return!1;r.preventDefault();let l=o[0],a=t.state.tr;if(s){let{node:g}=t.dragging||{};g?g.replace(a):a.deleteSelection()}let c=a.mapping.map(l),u=i.openStart==0&&i.openEnd==0&&i.content.childCount==1,f=a.doc;if(u?a.replaceRangeWith(c,c,i.content.firstChild):a.replaceRange(c,c,i),a.doc.eq(f))return!0;let p=a.doc.resolve(c);if(u&&Ke.isSelectable(i.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(i.content.firstChild))a.setSelection(new Ke(p));else{let g=a.mapping.map(l);a.mapping.maps[a.mapping.maps.length-1].forEach((y,v,k,x)=>g=x),a.setSelection(NX(t,p,a.doc.resolve(g)))}return t.focus(),t.dispatch(a.setMeta("uiEvent","drop")),!0}}})}function NX(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||ze.between(e,t,r)}function RX(n,e,t){let r=n.dom,i,s,o,l=!1;const a=()=>{i&&clearTimeout(i),l=!1,i=setTimeout(()=>{var f;l||(f=t.onHide)==null||f.call(t)},30)},c=f=>{var v;l=!0;const{clientX:p,clientY:g}=f;if(s===p&&o===g)return;s=p,o=g;let y=e([p,g],f);if(y){const[k,[x,_,M,T]]=y,S={p1:{x,y:_},p2:{x:M,y:T}};(v=t.onShow)==null||v.call(t,{view:n,pos:k,line:S})}else{a();return}};return r.addEventListener("dragover",c),r.addEventListener("dragend",a),r.addEventListener("drop",a),r.addEventListener("dragleave",a),{destroy:()=>{r.removeEventListener("dragover",c),r.removeEventListener("dragend",a),r.removeEventListener("drop",a),r.removeEventListener("dragleave",a)}}}class pn extends tt{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return pn.valid(r)?new pn(r):tt.near(r)}content(){return Le.empty}eq(e){return e instanceof pn&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new pn(e.resolve(t.pos))}getBookmark(){return new TS(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!PX(e)||!BX(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&pn.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let l=e.node(o);if(t>0?e.indexAfter(o)<l.childCount:e.index(o)>0){s=l.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=t;let a=e.doc.resolve(i);if(pn.valid(a))return a}for(;;){let o=t>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!Ke.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*t),r=!1;continue e}break}s=o,i+=t;let l=e.doc.resolve(i);if(pn.valid(l))return l}return null}}}pn.prototype.visible=!1;pn.findFrom=pn.findGapCursorFrom;tt.jsonID("gapcursor",pn);class TS{constructor(e){this.pos=e}map(e){return new TS(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return pn.valid(t)?new pn(t):tt.near(t)}}function QN(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function PX(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||QN(i.type))return!0;if(i.inlineContent)return!1}}return!0}function BX(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||QN(i.type))return!0;if(i.inlineContent)return!1}}return!0}function HX(){return new nn({props:{decorations:$X,createSelectionBetween(n,e,t){return e.pos==t.pos&&pn.valid(t)?new pn(t):null},handleClick:FX,handleKeyDown:VX,handleDOMEvents:{beforeinput:jX}}})}const VX=pk({ArrowLeft:wm("horiz",-1),ArrowRight:wm("horiz",1),ArrowUp:wm("vert",-1),ArrowDown:wm("vert",1)});function wm(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,l=e>0?o.$to:o.$from,a=o.empty;if(o instanceof ze){if(!s.endOfTextblock(t)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let c=pn.findGapCursorFrom(l,e,a);return c?(i&&i(r.tr.setSelection(new pn(c))),!0):!1}}function FX(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!pn.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&Ke.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new pn(r))),!0)}function jX(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof pn))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=we.empty;for(let o=r.length-1;o>=0;o--)i=we.from(r[o].createAndFill(null,i));let s=n.state.tr.replace(t.pos,t.pos,new Le(i,0,0));return s.setSelection(ze.near(s.doc.resolve(t.pos+1))),n.dispatch(s),!1}function $X(n){if(!(n.selection instanceof pn))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ft.create(n.doc,[Tn.widget(n.selection.head,e,{key:"gapcursor"})])}function xp(n,e){return Object.assign(n,{meta:{package:"@milkdown/plugin-cursor",...e}}),n}const kd=It(null,"dropIndicatorState");xp(kd,{displayName:"Ctx<dropIndicatorState>"});const xy=It({width:2,color:!1,class:"milkdown-drop-indicator"},"dropIndicatorConfig");xp(xy,{displayName:"Ctx<dropIndicatorConfig>"});const zX=new rn("MILKDOWN_DROP_INDICATOR_DOM"),eR=An(n=>new nn({key:zX,view:e=>{var o;const t=n.get(xy.key),r=document.createElement("div");Object.assign(r.style,{position:"fixed",pointerEvents:"none",display:"none",backgroundColor:t.color,top:"0",left:"0"}),r.classList.add(t.class),r.classList.add("milkdown-drop-indicator"),(o=e.dom.parentNode)==null||o.appendChild(r);const i=n.use(kd.key),s=l=>{WX(r,l,t)};return i.on(s),{destroy:()=>{i.off(s),r.remove()}}}}));xp(eR,{displayName:"Prose<dropIndicatorDOM>"});function WX(n,e,t){if(!e){Object.assign(n.style,{display:"none"});return}const{line:r}=e,{width:i}=t,{p1:{x:s,y:o},p2:{x:l,y:a}}=r,c=o===a;let u,f,p=o,g=s;c?(u=l-s,f=i,p-=i/2):(u=i,f=a-o,g-=i/2),p=Math.round(p),g=Math.round(g),Object.assign(n.style,{display:"block",width:`${u}px`,height:`${f}px`,transform:`translate(${g}px, ${p}px)`})}const tR=An(n=>IX({onShow:i=>{n.set(kd.key,i)},onHide:()=>{n.set(kd.key,null)},onDrag:()=>!0}));xp(tR,{displayName:"Prose<dropIndicator>"});const nR=An(()=>HX());xp(nR,{displayName:"Prose<gapCursor>"});const qX=[nR,xy,kd,eR,tR].flat();function UX(n){var e;const t=(e=void 0)!=null?e:!1;let r=typeof document>"u"?null:document.createElement("div");return new nn({key:KX,view:i=>{t!==!0&&YX(i.state.schema,t||[]);const s=i.dom.ownerDocument;r=r||document.createElement("div");const o=r,l=()=>{JX(i,o)};let a;return window.ResizeObserver&&(a=new window.ResizeObserver(()=>l()),a.observe(i.dom)),s.addEventListener("selectionchange",l),{update:()=>{l()},destroy:()=>{s.removeEventListener("selectionchange",l),a&&a.unobserve(i.dom)}}},props:{handleKeyDown:(i,s)=>{var o;const{selection:l}=i.state;if(s.altKey||s.ctrlKey||s.metaKey||s.shiftKey||s.isComposing||!["ArrowLeft","ArrowRight"].includes(s.key)||!yv(l)||!l.empty)return!1;const a=l.$head,[c,u]=rR(a),f=i.state.storedMarks||a.marks();if(c&&u&&!ct.sameSet(c,u)){if(s.key==="ArrowLeft"&&!ct.sameSet(c,f))return i.dispatch(i.state.tr.setStoredMarks(c)),!0;if(s.key==="ArrowRight"&&!ct.sameSet(u,f))return i.dispatch(i.state.tr.setStoredMarks(u)),!0}return s.key==="ArrowLeft"&&a.textOffset===1?(i.dispatch(i.state.tr.setSelection(ze.create(i.state.doc,a.pos-1)).setStoredMarks(a.marks())),!0):s.key==="ArrowRight"&&a.textOffset+1===((o=a.parent.maybeChild(a.index()))==null?void 0:o.nodeSize)?(i.dispatch(i.state.tr.setSelection(ze.create(i.state.doc,a.pos+1)).setStoredMarks(a.marks())),!0):!1},decorations:i=>{if(!(!r||!yv(i.selection)||!i.selection.empty))return Ft.create(i.doc,[Tn.widget(0,r,{key:"prosemirror-virtual-cursor"})])},attributes:{class:"virtual-cursor-enabled"}}})}var KX=new rn("prosemirror-virtual-cursor");function GX(n,e){var t;const r=window.getSelection();if(!r||!r.rangeCount)return null;const i=(t=r==null?void 0:r.getRangeAt(0))==null?void 0:t.cloneRange();if(!i)return null;i.collapse(e);const s=i.getClientRects(),o=s!=null&&s.length?s[s.length-1]:null;return o!=null&&o.height?o:n.coordsAtPos(n.state.selection.head)}function rR(n){const e=n.index(),t=n.parent.maybeChild(e);let r=n.textOffset?t:null;return!r&&e>0&&(r=n.parent.maybeChild(e-1)),[r==null?void 0:r.marks,t==null?void 0:t.marks]}function yv(n){return n&&typeof n=="object"&&"$cursor"in n}function JX(n,e){if(!n||!n.dom||n.isDestroyed||!e)return;const{state:t,dom:r}=n,{selection:i}=t;if(!yv(i))return;const s=GX(n,i.$head===i.$from);if(!s)return e;const o=r.getBoundingClientRect();let l="prosemirror-virtual-cursor";const a=t.selection.$head,[c,u]=rR(a),f=t.storedMarks||a.marks();i.$cursor&&c&&u&&f&&!ct.sameSet(c,u)&&(ct.sameSet(c,f)?l+=" prosemirror-virtual-cursor-left":ct.sameSet(u,f)&&(l+=" prosemirror-virtual-cursor-right")),e.className=l,ZX(e,"prosemirror-virtual-cursor-animation"),e.style.height=`${s.bottom-s.top}px`,e.style.left=`${s.left-o.left}px`,e.style.top=`${s.top-o.top}px`}function ZX(n,e){n.classList.remove(e),n.offsetWidth,n.classList.add(e)}function YX(n,e){for(const[t,r]of Object.entries(n.marks))r.spec.inclusive===!1&&!e.includes(t)&&console.warn(`[prosemirror-virtual-cursor] Virtual cursor does not work well with marks that have inclusive set to false. Please consider removing the inclusive option from the "${t}" mark or adding it to the "skipWarning" option.`)}var XX=Object.defineProperty,KE=Object.getOwnPropertySymbols,QX=Object.prototype.hasOwnProperty,eQ=Object.prototype.propertyIsEnumerable,GE=(n,e,t)=>e in n?XX(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,tQ=(n,e)=>{for(var t in e||(e={}))QX.call(e,t)&&GE(n,t,e[t]);if(KE)for(var t of KE(e))eQ.call(e,t)&&GE(n,t,e[t]);return n};function iR(n,e){return Object.assign(n,{meta:tQ({package:"@milkdown/components"},e)}),n}const nQ={imageIcon:"",uploadButton:"Upload",confirmButton:"",uploadPlaceholderText:"/Paste",onUpload:n=>Promise.resolve(URL.createObjectURL(n))},_y=It(nQ,"inlineImageConfigCtx");iR(_y,{displayName:"Config<image-inline>",group:"ImageInline"});function ag({icon:n,class:e,onClick:t}){return J("span",{class:Qn("milkdown-icon",e),onPointerdown:t,ref:r=>{r&&n&&(r.innerHTML=Ei.sanitize(n.trim()))}})}ag.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const rQ=_k("abcdefg",8),iQ=tr({props:{src:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setLink:{type:Function,required:!0},imageIcon:{type:String,required:!1},uploadButton:{type:String,required:!1},confirmButton:{type:String,required:!1},uploadPlaceholderText:{type:String,required:!1},onUpload:{type:Function,required:!0}},setup({readonly:n,src:e,setLink:t,onUpload:r,imageIcon:i,uploadButton:s,confirmButton:o,uploadPlaceholderText:l,className:a}){var c,u;const f=Ve(!1),p=Ve(),g=Ve((c=e.value)!=null?c:""),y=Ve(rQ()),v=Ve(((u=e.value)==null?void 0:u.length)!==0),k=T=>{const A=T.target.value;v.value=A.length!==0,g.value=A},x=T=>{var S,A;T.key==="Enter"&&t((A=(S=p.value)==null?void 0:S.value)!=null?A:"")},_=()=>{var T,S;t((S=(T=p.value)==null?void 0:T.value)!=null?S:"")},M=T=>{var S;const A=(S=T.target.files)==null?void 0:S[0];A&&r(A).then(I=>{I&&(t(I),v.value=!0)}).catch(I=>{console.error("An error occurred while uploading image"),console.error(I)})};return()=>J("div",{class:Qn("image-edit",a)},J(ag,{icon:i,class:"image-icon"}),J("div",{class:Qn("link-importer",f.value&&"focus")},J("input",{ref:p,draggable:"true",onDragstart:T=>{T.preventDefault(),T.stopPropagation()},disabled:n.value,class:"link-input-area",value:g.value,onInput:k,onKeydown:x,onFocus:()=>f.value=!0,onBlur:()=>f.value=!1}),!v.value&&J("div",{class:"placeholder"},J("input",{disabled:n.value,class:"hidden",id:y.value,type:"file",accept:"image/*",onChange:M}),J("label",{class:"uploader",for:y.value},J(ag,{icon:s})),J("span",{class:"text",onClick:()=>{var T;return(T=p.value)==null?void 0:T.focus()}},l))),g.value&&J("div",{class:"confirm",onClick:()=>_()},J(ag,{icon:o})))}}),sQ=tr({props:{src:{type:Object,required:!0},alt:{type:Object,required:!0},title:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setAttr:{type:Function,required:!0},config:{type:Object,required:!0}},setup(n){const{src:e,alt:t,title:r}=n;return()=>{var i;return(i=e.value)!=null&&i.length?J("img",{class:"image-inline",src:e.value,alt:t.value,title:r.value}):J(iQ,{src:n.src,selected:n.selected,readonly:n.readonly,setLink:s=>n.setAttr("src",s),imageIcon:n.config.imageIcon,uploadButton:n.config.uploadButton,confirmButton:n.config.confirmButton,uploadPlaceholderText:n.config.uploadPlaceholderText,onUpload:n.config.onUpload,className:"empty-image-inline"})}}}),sR=op(Ya.node,n=>(e,t,r)=>{const i=Ve(e.attrs.src),s=Ve(e.attrs.alt),o=Ve(e.attrs.title),l=Ve(!1),a=Ve(!t.editable),c=(k,x)=>{if(!t.editable)return;const _=r();_!=null&&t.dispatch(t.state.tr.setNodeAttribute(_,k,k==="src"?Ei.sanitize(x):x))},u=n.get(_y.key),f=es(sQ,{src:i,alt:s,title:o,selected:l,readonly:a,setAttr:c,config:u}),p=document.createElement("span");p.className="milkdown-image-inline";const g=Fu(()=>{l.value?p.classList.add("selected"):p.classList.remove("selected")}),y=u.proxyDomURL,v=k=>{if(!y)i.value=k.attrs.src;else{const x=y(k.attrs.src);typeof x=="string"?i.value=x:x.then(_=>{i.value=_}).catch(console.error)}s.value=k.attrs.alt,o.value=k.attrs.title};return v(e),f.mount(p),{dom:p,update:k=>k.type!==e.type?!1:(v(k),!0),stopEvent:k=>k.target instanceof HTMLInputElement,selectNode:()=>{l.value=!0},deselectNode:()=>{l.value=!1},destroy:()=>{g(),f.unmount(),p.remove()}}});iR(sR,{displayName:"NodeView<image-inline>",group:"ImageInline"});const oQ=[_y,sR];var qd,Ud,su,ou,Kd,lu,au,cu,uu,Gd,x0,oR;class My{constructor(e){be(this,x0);be(this,qd);be(this,Ud);be(this,su);be(this,ou);be(this,Kd);be(this,lu);be(this,au);be(this,cu);be(this,uu);be(this,Gd);X(this,lu,!1),this.onShow=()=>{},this.onHide=()=>{},X(this,Gd,(t,r)=>{const{state:i,composing:s}=t,{selection:o,doc:l}=i,{ranges:a}=o,c=Math.min(...a.map(g=>g.$from.pos)),u=Math.max(...a.map(g=>g.$to.pos)),f=r&&r.doc.eq(l)&&r.selection.eq(o);if(V(this,lu)||((V(this,Kd)??t.dom.parentElement??document.body).appendChild(this.element),X(this,lu,!0)),s||f)return;if(!V(this,Ud).call(this,t,r)){this.hide();return}Ki({getBoundingClientRect:()=>U0(t,c,u)},this.element,{placement:V(this,ou).placement??"top",middleware:[Tg(),pl(V(this,au)),dx(V(this,cu)),...V(this,su)]}).then(({x:g,y})=>{Object.assign(this.element.style,{left:`${g}px`,top:`${y}px`})}).catch(console.error),this.show()}),this.update=(t,r)=>{V(this,uu).call(this,t,r)},this.destroy=()=>{V(this,uu).cancel()},this.show=t=>{this.element.dataset.show="true",t&&Ki(t,this.element,{placement:"top",middleware:[Tg(),pl(V(this,au)),dx(V(this,cu)),...V(this,su)],...V(this,ou)}).then(({x:r,y:i})=>{Object.assign(this.element.style,{left:`${r}px`,top:`${i}px`})}).catch(console.error),this.onShow()},this.hide=()=>{this.element.dataset.show!=="false"&&(this.element.dataset.show="false",this.onHide())},this.element=e.content,X(this,qd,e.debounce??200),X(this,Ud,e.shouldShow??Pp(this,x0,oR)),X(this,au,e.offset),X(this,cu,e.shift),X(this,su,e.middleware??[]),X(this,ou,e.floatingUIOptions??{}),X(this,Kd,e.root),this.element.dataset.show="false",X(this,uu,A0(V(this,Gd),V(this,qd)))}}qd=new WeakMap,Ud=new WeakMap,su=new WeakMap,ou=new WeakMap,Kd=new WeakMap,lu=new WeakMap,au=new WeakMap,cu=new WeakMap,uu=new WeakMap,Gd=new WeakMap,x0=new WeakSet,oR=function(e){const{doc:t,selection:r}=e.state,{empty:i,from:s,to:o}=r,l=!t.textBetween(s,o).length&&e.state.selection instanceof ze,a=this.element.contains(document.activeElement),c=!e.hasFocus()&&!a,u=!e.editable;return!(c||i||l||u)};function Ty(n){const e=It({},`${n}_TOOLTIP_SPEC`),t=An(i=>{const s=i.get(e.key);return new nn({key:new rn(`${n}_TOOLTIP`),...s})}),r=[e,t];return r.key=e.key,r.pluginKey=t.key,e.meta={package:"@milkdown/plugin-tooltip",displayName:`Ctx<tooltipSpec>|${n}`},t.meta={package:"@milkdown/plugin-tooltip",displayName:`Prose<tooltip>|${n}`},r}var lQ=Object.defineProperty,JE=Object.getOwnPropertySymbols,aQ=Object.prototype.hasOwnProperty,cQ=Object.prototype.propertyIsEnumerable,ZE=(n,e,t)=>e in n?lQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,uQ=(n,e)=>{for(var t in e||(e={}))aQ.call(e,t)&&ZE(n,t,e[t]);if(JE)for(var t of JE(e))cQ.call(e,t)&&ZE(n,t,e[t]);return n};function tc(n,e){return Object.assign(n,{meta:uQ({package:"@milkdown/components"},e)}),n}var fQ=Object.defineProperty,YE=Object.getOwnPropertySymbols,hQ=Object.prototype.hasOwnProperty,dQ=Object.prototype.propertyIsEnumerable,XE=(n,e,t)=>e in n?fQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ES=(n,e)=>{for(var t in e||(e={}))hQ.call(e,t)&&XE(n,t,e[t]);if(YE)for(var t of YE(e))dQ.call(e,t)&&XE(n,t,e[t]);return n};const pQ={mode:"preview"},xo=It(ES({},pQ),"linkTooltipStateCtx");tc(xo,{displayName:"State<link-tooltip>",group:"LinkTooltip"});const mQ={addLink:()=>{},editLink:()=>{},removeLink:()=>{}},Tu=It(ES({},mQ),"linkTooltipAPICtx");tc(xo,{displayName:"API<link-tooltip>",group:"LinkTooltip"});const gQ={linkIcon:"",editButton:"",removeButton:"",confirmButton:"Confirm ",onCopyLink:()=>{},inputPlaceholder:"Paste link..."},Eu=It(ES({},gQ),"linkTooltipConfigCtx");tc(xo,{displayName:"Config<link-tooltip>",group:"LinkTooltip"});const lR=et("ToggleLink",n=>()=>e=>{const{doc:t,selection:r}=e,i=zi.type(n);return t.rangeHasMark(r.from,r.to,i)?(n.get(Tu.key).removeLink(r.from,r.to),!0):(n.get(Tu.key).addLink(r.from,r.to),!0)}),_p=Ty("LINK_PREVIEW");tc(_p[0],{displayName:"PreviewTooltipSpec<link-tooltip>",group:"LinkTooltip"});tc(_p[1],{displayName:"PreviewTooltipPlugin<link-tooltip>",group:"LinkTooltip"});const Ey=Ty("LINK_EDIT");tc(Ey[0],{displayName:"EditTooltipSpec<link-tooltip>",group:"LinkTooltip"});tc(Ey[1],{displayName:"EditTooltipPlugin<link-tooltip>",group:"LinkTooltip"});function Rh({icon:n,class:e,onClick:t}){return J("span",{class:Qn("milkdown-icon",e),onPointerdown:t,ref:r=>{r&&n&&(r.innerHTML=Ei.sanitize(n.trim()))}})}Rh.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const yQ=tr({props:{config:{type:Object,required:!0},src:{type:Object,required:!0},onConfirm:{type:Function,required:!0},onCancel:{type:Function,required:!0}},setup({config:n,src:e,onConfirm:t,onCancel:r}){const i=Ve(e);Oa(e,l=>{i.value=l});const s=()=>{t(i.value)},o=l=>{l.stopPropagation(),l.key==="Enter"&&(l.preventDefault(),s()),l.key==="Escape"&&(l.preventDefault(),r())};return()=>J("div",{class:"link-edit"},J("input",{class:"input-area",placeholder:n.value.inputPlaceholder,onKeydown:o,onInput:l=>{i.value=l.target.value},value:i.value}),i.value?J(Rh,{class:"button confirm",icon:n.value.confirmButton,onClick:s}):null)}});var bQ=Object.defineProperty,wQ=Object.defineProperties,vQ=Object.getOwnPropertyDescriptors,QE=Object.getOwnPropertySymbols,kQ=Object.prototype.hasOwnProperty,CQ=Object.prototype.propertyIsEnumerable,aR=n=>{throw TypeError(n)},eA=(n,e,t)=>e in n?bQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vm=(n,e)=>{for(var t in e||(e={}))kQ.call(e,t)&&eA(n,t,e[t]);if(QE)for(var t of QE(e))CQ.call(e,t)&&eA(n,t,e[t]);return n},tA=(n,e)=>wQ(n,vQ(e)),cR=(n,e,t)=>e.has(n)||aR("Cannot "+t),cn=(n,e,t)=>(cR(n,e,"read from private field"),t?t.call(n):e.get(n)),Us=(n,e,t)=>e.has(n)?aR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),jl=(n,e,t,r)=>(cR(n,e,"write to private field"),e.set(n,t),t),jf,Fo,jo,cg,$f,ug,Gl,bv,fg;const nA={from:-1,to:-1,mark:null};class SQ{constructor(e,t){this.ctx=e,Us(this,jf),Us(this,Fo),Us(this,jo,vm({},nA)),Us(this,cg),Us(this,$f),Us(this,ug,Ve("")),Us(this,Gl,()=>{cn(this,Fo).hide(),this.ctx.update(xo.key,s=>tA(vm({},s),{mode:"preview"})),jl(this,jo,vm({},nA))}),Us(this,bv,s=>{const o=this.ctx.get(Gt),{from:l,to:a,mark:c}=cn(this,jo),u=zi.type(this.ctx),f=Ei.sanitize(s);if(c&&c.attrs.href===f){cn(this,Gl).call(this);return}const p=o.state.tr;c&&p.removeMark(l,a,c),p.addMark(l,a,u.create({href:f})),o.dispatch(p),cn(this,Gl).call(this)}),Us(this,fg,(s,o,l)=>{const a=this.ctx.get(Eu.key);cn(this,$f).value=a,cn(this,ug).value=s,this.ctx.update(xo.key,u=>tA(vm({},u),{mode:"edit"}));const c=this.ctx.get(Gt);c.dispatch(c.state.tr.setSelection(ze.create(c.state.doc,o,l))),cn(this,Fo).show({getBoundingClientRect:()=>U0(c,o,l)}),requestAnimationFrame(()=>{var u;(u=cn(this,jf).querySelector("input"))==null||u.focus()})}),this.update=s=>{const{state:o}=s,{selection:l}=o;if(!(l instanceof ze))return;const{from:a,to:c}=l;a===cn(this,jo).from&&c===cn(this,jo).to||cn(this,Gl).call(this)},this.destroy=()=>{cn(this,cg).unmount(),cn(this,Fo).destroy(),cn(this,jf).remove()},this.addLink=(s,o)=>{jl(this,jo,{from:s,to:o,mark:null}),cn(this,fg).call(this,"",s,o)},this.editLink=(s,o,l)=>{jl(this,jo,{from:o,to:l,mark:s}),cn(this,fg).call(this,s.attrs.href,o,l)},this.removeLink=(s,o)=>{const l=this.ctx.get(Gt),a=l.state.tr;a.removeMark(s,o,zi.type(this.ctx)),l.dispatch(a),cn(this,Gl).call(this)},jl(this,$f,Ve(this.ctx.get(Eu.key)));const r=document.createElement("div");r.className="milkdown-link-edit";const i=es(yQ,{config:cn(this,$f),src:cn(this,ug),onConfirm:cn(this,bv),onCancel:cn(this,Gl)});i.mount(r),jl(this,cg,i),jl(this,jf,r),jl(this,Fo,new My({content:r,debounce:0,shouldShow:()=>!1})),cn(this,Fo).onHide=()=>{requestAnimationFrame(()=>{t.dom.focus({preventScroll:!0})})},cn(this,Fo).update(t)}}jf=new WeakMap;Fo=new WeakMap;jo=new WeakMap;cg=new WeakMap;$f=new WeakMap;ug=new WeakMap;Gl=new WeakMap;bv=new WeakMap;fg=new WeakMap;var xQ=Object.defineProperty,_Q=Object.defineProperties,MQ=Object.getOwnPropertyDescriptors,rA=Object.getOwnPropertySymbols,TQ=Object.prototype.hasOwnProperty,EQ=Object.prototype.propertyIsEnumerable,iA=(n,e,t)=>e in n?xQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,AQ=(n,e)=>{for(var t in e||(e={}))TQ.call(e,t)&&iA(n,t,e[t]);if(rA)for(var t of rA(e))EQ.call(e,t)&&iA(n,t,e[t]);return n},OQ=(n,e)=>_Q(n,MQ(e));function LQ(n){let e;n.update(Tu.key,t=>OQ(AQ({},t),{addLink:(r,i)=>{e==null||e.addLink(r,i)},editLink:(r,i,s)=>{e==null||e.editLink(r,i,s)},removeLink:(r,i)=>{e==null||e.removeLink(r,i)}})),n.set(Ey.key,{view:t=>(e=new SQ(n,t),e)})}function DQ(n,e,t,r,i){let s={start:-1,end:-1};return t.nodesBetween(r,i,(o,l)=>{if(s.start>-1)return!1;s.start===-1&&n.isInSet(o.marks)&&e===o&&(s={start:l,end:l+Math.max(o.textContent.length,1)})}),s}function IQ(n,e,t){const r=e.posAtCoords({left:t.clientX,top:t.clientY});if(!r)return;const{pos:i}=r,s=e.state.doc.nodeAt(i);if(!s)return;const o=s.marks.find(a=>a.type===zi.mark.type(n));if(!(!o||!_p.pluginKey()))return{show:!0,pos:i,node:s,mark:o}}const NQ=tr({props:{config:{type:Object,required:!0},src:{type:Object,required:!0},onEdit:{type:Object,required:!0},onRemove:{type:Object,required:!0}},setup({config:n,src:e,onEdit:t,onRemove:r}){const i=l=>{l.preventDefault(),l.stopPropagation(),t.value()},s=l=>{l.preventDefault(),l.stopPropagation(),r.value()},o=l=>{l.preventDefault();const a=e.value;navigator.clipboard&&a&&navigator.clipboard.writeText(a).then(()=>{n.value.onCopyLink(a)}).catch(c=>console.error(c))};return()=>J("div",{class:"link-preview"},J(Rh,{class:"button link-icon",icon:n.value.linkIcon,onClick:o}),J("a",{href:e.value,target:"_blank",class:"link-display"},e.value),J(Rh,{class:"button link-edit-button",icon:n.value.editButton,onClick:i}),J(Rh,{class:"button link-remove-button",icon:n.value.removeButton,onClick:s}))}});var uR=n=>{throw TypeError(n)},fR=(n,e,t)=>e.has(n)||uR("Cannot "+t),Ct=(n,e,t)=>(fR(n,e,"read from private field"),t?t.call(n):e.get(n)),Zr=(n,e,t)=>e.has(n)?uR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),$l=(n,e,t,r)=>(fR(n,e,"write to private field"),e.set(n,t),t),Jl,Pi,zf,Wf,hg,dg,pg,qf,Uf,mg,gg,yg,Kf;class RQ{constructor(e,t){this.ctx=e,Zr(this,Jl),Zr(this,Pi),Zr(this,zf,this.ctx.use(xo.key)),Zr(this,Wf),Zr(this,hg,Ve("")),Zr(this,dg,Ve(()=>{})),Zr(this,pg,Ve(()=>{})),Zr(this,qf),Zr(this,Uf,!1),Zr(this,mg,({mode:r})=>{r==="edit"&&Ct(this,Kf).call(this)}),Zr(this,gg,()=>{$l(this,Uf,!0)}),Zr(this,yg,()=>{$l(this,Uf,!1)}),Zr(this,Kf,()=>{Ct(this,Pi).hide(),Ct(this,Pi).element.removeEventListener("mouseenter",Ct(this,gg)),Ct(this,Pi).element.removeEventListener("mouseleave",Ct(this,yg))}),this.show=(r,i,s,o)=>{Ct(this,Wf).value=this.ctx.get(Eu.key),Ct(this,hg).value=r.attrs.href,Ct(this,dg).value=()=>{this.ctx.get(Tu.key).editLink(r,i,s)},Ct(this,pg).value=()=>{this.ctx.get(Tu.key).removeLink(i,s),Ct(this,Kf).call(this)},Ct(this,Pi).show({getBoundingClientRect:()=>o}),Ct(this,Pi).element.addEventListener("mouseenter",Ct(this,gg)),Ct(this,Pi).element.addEventListener("mouseleave",Ct(this,yg))},this.hide=()=>{Ct(this,Uf)||Ct(this,Kf).call(this)},this.update=()=>{},this.destroy=()=>{Ct(this,qf).unmount(),Ct(this,zf).off(Ct(this,mg)),Ct(this,Pi).destroy(),Ct(this,Jl).remove()},$l(this,Wf,Ve(this.ctx.get(Eu.key))),$l(this,qf,es(NQ,{config:Ct(this,Wf),src:Ct(this,hg),onEdit:Ct(this,dg),onRemove:Ct(this,pg)})),$l(this,Jl,document.createElement("div")),Ct(this,Jl).className="milkdown-link-preview",Ct(this,qf).mount(Ct(this,Jl)),$l(this,Pi,new My({debounce:0,content:Ct(this,Jl),shouldShow:()=>!1})),Ct(this,Pi).update(t),$l(this,zf,e.use(xo.key)),Ct(this,zf).on(Ct(this,mg))}}Jl=new WeakMap;Pi=new WeakMap;zf=new WeakMap;Wf=new WeakMap;hg=new WeakMap;dg=new WeakMap;pg=new WeakMap;qf=new WeakMap;Uf=new WeakMap;mg=new WeakMap;gg=new WeakMap;yg=new WeakMap;Kf=new WeakMap;function PQ(n){let e;const r=E0((s,o)=>{if(!e||!s.hasFocus()||n.get(xo.key).mode==="edit")return;const a=IQ(n,s,o);if(a){const c=s.state.doc.resolve(a.pos),u=DQ(a.mark,a.node,s.state.doc,c.before(),c.after()),f=u.start,p=u.end;e.show(a.mark,f,p,U0(s,f,p));return}e.hide()},50),i=()=>{setTimeout(()=>{e==null||e.hide()},50)};n.set(_p.key,{props:{handleDOMEvents:{mousemove:r,mouseleave:i}},view:s=>(e=new RQ(n,s),e)})}function BQ(n){PQ(n),LQ(n)}const HQ=[xo,Tu,Eu,_p,Ey,lR].flat();var VQ=Object.defineProperty,sA=Object.getOwnPropertySymbols,FQ=Object.prototype.hasOwnProperty,jQ=Object.prototype.propertyIsEnumerable,oA=(n,e,t)=>e in n?VQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$Q=(n,e)=>{for(var t in e||(e={}))FQ.call(e,t)&&oA(n,t,e[t]);if(sA)for(var t of sA(e))jQ.call(e,t)&&oA(n,t,e[t]);return n};function hR(n,e){return Object.assign(n,{meta:$Q({package:"@milkdown/components"},e)}),n}const zQ={renderLabel:({label:n,listType:e,checked:t})=>t==null?e==="bullet"?"":n:t?"":""},Ay=It(zQ,"listItemBlockConfigCtx");hR(Ay,{displayName:"Config<list-item-block>",group:"ListItemBlock"});function dR({icon:n,class:e,onClick:t}){return J("span",{class:Qn("milkdown-icon",e),onPointerdown:t,ref:r=>{r&&n&&(r.innerHTML=Ei.sanitize(n.trim()))}})}dR.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const WQ=tr({props:{label:{type:Object,required:!0},checked:{type:Object,required:!0},listType:{type:Object,required:!0},config:{type:Object,required:!0},readonly:{type:Object,required:!0},selected:{type:Object,required:!0},setAttr:{type:Function,required:!0},onMount:{type:Function,required:!0}},setup({label:n,checked:e,listType:t,config:r,readonly:i,setAttr:s,onMount:o,selected:l}){const a=p=>{p!=null&&p instanceof Element&&o(p)},c=p=>{p.stopPropagation(),p.preventDefault(),e.value!=null&&s("checked",!e.value)},u=Cu(()=>r.renderLabel({label:n.value,listType:t.value,checked:e.value,readonly:i.value})),f=Cu(()=>e.value==null?t.value==="bullet"?"bullet":"ordered":e.value?"checked":"unchecked");return()=>J("li",{class:Qn("list-item",l.value&&"ProseMirror-selectednode")},J("div",{class:"label-wrapper",onPointerdown:c,contenteditable:!1},J(dR,{class:Qn("label",i.value&&"readonly",f.value),icon:u.value})),J("div",{class:"children",ref:a}))}}),pR=op(Qi.node,n=>(e,t,r)=>{const i=document.createElement("div");i.className="milkdown-list-item-block";const s=document.createElement("div");s.setAttribute("data-content-dom","true"),s.classList.add("content-dom");const o=Ve(e.attrs.label),l=Ve(e.attrs.checked),a=Ve(e.attrs.listType),c=Ve(!t.editable),u=n.get(Ay.key),f=Ve(!1),p=(M,T)=>{if(!t.editable)return;const S=r();S!=null&&(t.hasFocus()||t.focus(),t.dispatch(t.state.tr.setNodeAttribute(S,M,T)))},g=Fu(()=>{f.value?i.classList.add("selected"):i.classList.remove("selected")});let y=0;const k=es(WQ,{label:o,checked:l,listType:a,readonly:c,config:u,selected:f,setAttr:p,onMount:M=>{const{anchor:T,head:S}=t.state.selection;M.appendChild(s);const A=t.state.doc.resolve(T),I=t.state.doc.resolve(S);y=requestAnimationFrame(()=>{if(cancelAnimationFrame(y),!A.doc.eq(t.state.doc))return;const B=new ze(A,I);t.dispatch(t.state.tr.setSelection(B))})}});k.mount(i);const x=M=>{a.value=M.attrs.listType,o.value=M.attrs.label,l.value=M.attrs.checked,c.value=!t.editable};x(e);let _=e;return{dom:i,contentDOM:s,update:M=>M.type!==e.type?!1:(M.sameMarkup(_)&&M.content.eq(_.content)||(_=M,x(M)),!0),ignoreMutation:M=>!i||!s?!0:M.type==="selection"?!1:s===M.target&&M.type==="attributes"?!0:!s.contains(M.target),selectNode:()=>{f.value=!0},deselectNode:()=>{f.value=!1},destroy:()=>{g(),k.unmount(),i.remove(),s.remove()}}});hR(pR,{displayName:"NodeView<list-item-block>",group:"ListItemBlock"});const qQ=[Ay,pR];var UQ=Object.defineProperty,lA=Object.getOwnPropertySymbols,KQ=Object.prototype.hasOwnProperty,GQ=Object.prototype.propertyIsEnumerable,aA=(n,e,t)=>e in n?UQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,JQ=(n,e)=>{for(var t in e||(e={}))KQ.call(e,t)&&aA(n,t,e[t]);if(lA)for(var t of lA(e))GQ.call(e,t)&&aA(n,t,e[t]);return n};function mR(n,e){return Object.assign(n,{meta:JQ({package:"@milkdown/components"},e)}),n}var ZQ=Object.defineProperty,cA=Object.getOwnPropertySymbols,YQ=Object.prototype.hasOwnProperty,XQ=Object.prototype.propertyIsEnumerable,uA=(n,e,t)=>e in n?ZQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,QQ=(n,e)=>{for(var t in e||(e={}))YQ.call(e,t)&&uA(n,t,e[t]);if(cA)for(var t of cA(e))XQ.call(e,t)&&uA(n,t,e[t]);return n};const eee={renderButton:n=>{switch(n){case"add_row":return"+";case"add_col":return"+";case"delete_row":return"-";case"delete_col":return"-";case"align_col_left":return"left";case"align_col_center":return"center";case"align_col_right":return"right";case"col_drag_handle":return"=";case"row_drag_handle":return"="}}},Oy=It(QQ({},eee),"tableBlockConfigCtx");mR(Oy,{displayName:"Config<table-block>",group:"TableBlock"});function ps({icon:n,class:e,onClick:t}){return J("span",{class:Qn("milkdown-icon",e),onPointerdown:t,ref:r=>{r&&n&&(r.innerHTML=Ei.sanitize(n.trim()))}})}ps.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};function gR(n){const{dragPreviewRef:e,tableWrapperRef:t,contentWrapperRef:r,yLineHandleRef:i,xLineHandleRef:s,colHandleRef:o,rowHandleRef:l}=n,a=e.value;if(!a)return;const c=t.value;if(!c)return;const u=r.value;if(!u)return;const f=u.querySelector("tbody");if(!f)return;const p=a.querySelector("tbody");if(!p)return;const g=i.value;if(!g)return;const y=s.value;if(!y)return;const v=o.value;if(!v)return;const k=l.value;return k?{preview:a,wrapper:c,content:u,contentRoot:f,previewRoot:p,yHandle:g,xHandle:y,colHandle:v,rowHandle:k}:void 0}function yR(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function bR(n,e,t,r,i){const{width:s,height:o}=r.querySelector("tbody").getBoundingClientRect();if(n==="y"){const a=r.querySelectorAll("tr")[i];if(!a)return;t.appendChild(a.cloneNode(!0));const c=a.getBoundingClientRect().height;Object.assign(e.style,{width:`${s}px`,height:`${c}px`}),e.dataset.show="true";return}if(n==="x"){const l=r.querySelectorAll("tr");let a;Array.from(l).forEach(c=>{const u=c.children[i];if(!u)return;a===void 0&&(a=u.getBoundingClientRect().width);const f=u.parentElement.cloneNode(!1),p=u.cloneNode(!0);f.appendChild(p),t.appendChild(f)}),Object.assign(e.style,{width:`${a}px`,height:`${o}px`}),e.dataset.show="true";return}}function tee(n,e){return t=>{vR(n,t,e,r=>{wR("y",t,r,n);const{preview:i,content:s,previewRoot:o}=r;yR(o);const{hoverIndex:l}=n,[a]=l.value;bR("y",i,o,s,a)})}}function nee(n,e){return t=>{vR(n,t,e,r=>{wR("x",t,r,n);const{preview:i,content:s,previewRoot:o}=r,{hoverIndex:l}=n,[a,c]=l.value;yR(o),bR("x",i,o,s,c)})}}function wR(n,e,t,r){const{xHandle:i,yHandle:s,colHandle:o,rowHandle:l,preview:a}=t;i.dataset.displayType=n==="y"?"indicator":"none",s.dataset.displayType=n==="x"?"indicator":"none",n==="y"?(o.dataset.show="false",fA(l)):(l.dataset.show="false",fA(o));const{hoverIndex:c,dragInfo:u}=r,[f,p]=c.value;u.value={startCoords:[e.clientX,e.clientY],startIndex:n==="y"?f:p,endIndex:n==="y"?f:p,type:n==="y"?"row":"col"},a.dataset.direction=n==="y"?"vertical":"horizontal"}function vR(n,e,t,r){const i=t==null?void 0:t.get(Gt);if(!(i!=null&&i.editable))return;e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.effectAllowed="move");const s=gR(n);s&&requestAnimationFrame(()=>{r(s)})}function fA(n){var e;(e=n.querySelector(".button-group"))==null||e.setAttribute("data-show","false")}function wv(n,e){for(let t=0;t<n.childCount;t++)if(n.child(t)===e)return t;return-1}function ree(n,e){var t,r,i;if(e)try{const s=e.posAtCoords({left:n.clientX,top:n.clientY});if(!s)return;const o=s==null?void 0:s.inside;if(o==null||o<0)return;const l=e.state.doc.resolve(o),a=e.state.doc.nodeAt(o);if(!a)return;const c=["table_cell","table_header"],u=["table_row","table_header_row"],f=c.includes(a.type.name)?a:(t=Ms(k=>c.includes(k.type.name))(l))==null?void 0:t.node,p=(r=Ms(k=>u.includes(k.type.name))(l))==null?void 0:r.node,g=(i=Ms(k=>k.type.name==="table")(l))==null?void 0:i.node;if(!f||!p||!g)return;const y=wv(p,f);return[wv(g,p),y]}catch{return}}function Ly(n,[e,t]){const r=n.value;if(!r)return;const i=r.querySelectorAll("tr"),s=i[e];if(!s)return;const o=i[0];if(!o)return;const l=o.children[t];if(!l)return;const a=s.children[t];if(a)return{row:s,col:a,headerCol:l}}function iee(n,e,t){if(!t||!e)return;const{selection:r}=e.state;if(!(r instanceof jt))return;const{$from:i}=r,s=ju(i);if(!(!s||s.node!==t)){if(r.isColSelection()){const{$head:o}=r,l=o.index(o.depth-1);AS({refs:n,index:[0,l],before:a=>{var c;(c=a.querySelector(".button-group"))==null||c.setAttribute("data-show","true")}});return}if(r.isRowSelection()){const{$head:o}=r,l=Ms(c=>c.type.name==="table_row"||c.type.name==="table_header_row")(o);if(!l)return;const a=wv(s.node,l.node);OS({refs:n,index:[a,0],before:c=>{var u;a>0&&((u=c.querySelector(".button-group"))==null||u.setAttribute("data-show","true"))}})}}}function AS({refs:n,index:e,before:t,after:r}){const{contentWrapperRef:i,colHandleRef:s,hoverIndex:o}=n,l=s.value;if(!l)return;o.value=e;const a=Ly(i,e);if(!a)return;const{headerCol:c}=a;l.dataset.show="true",t&&t(l),Ki(c,l,{placement:"top"}).then(({x:u,y:f})=>{Object.assign(l.style,{left:`${u}px`,top:`${f}px`}),r&&r(l)}).catch(console.error)}function OS({refs:n,index:e,before:t,after:r}){const{contentWrapperRef:i,rowHandleRef:s,hoverIndex:o}=n,l=s.value;if(!l)return;o.value=e;const a=Ly(i,e);if(!a)return;const{row:c}=a;l.dataset.show="true",t&&t(l),Ki(c,l,{placement:"left"}).then(({x:u,y:f})=>{Object.assign(l.style,{left:`${u}px`,top:`${f}px`}),r&&r(l)}).catch(console.error)}function kR(n,e,t){const r=t==="x"?"left":"top",i=t==="x"?"right":"bottom",s=n.length-1,o=n.findIndex((a,c)=>{const u=a.getBoundingClientRect(),f=u[r],p=u[i];return f<=e&&e<=p||c===s&&e>p||c===0&&e<f}),l=n[o];return l?[l,o]:void 0}function see(n,e){const t=n.querySelector("tr");if(!t)return;const r=Array.from(t.children);return kR(r,e,"x")}function oee(n,e){const t=Array.from(n.querySelectorAll("tr"));return kR(t,e,"y")}function lee(n){return A0(e=>{const t=gR(n);if(!t)return;const{preview:r,content:i,contentRoot:s,xHandle:o,yHandle:l}=t,{dragInfo:a,hoverIndex:c}=n;if(r.dataset.show==="false")return;const u=Ly(n.contentWrapperRef,c.value);if(!u||!s.querySelector("tr"))return;const p=a.value;if(!p||!s.offsetParent)return;const g=s.offsetParent.offsetTop,y=s.offsetParent.offsetLeft;if(p.type==="col"){const v=u.col.getBoundingClientRect().width,{left:k,width:x}=s.getBoundingClientRect(),_=y-k,M=e.clientX+_-v/2,[T]=p.startCoords,S=T<e.clientX?"right":"left";r.style.top=`${g}px`;const A=M<k+_-20?k+_-20:M>k+x+_-v+20?k+x+_-v+20:M;r.style.left=`${A}px`;const I=see(s,e.clientX);if(I){const[B,R]=I,K=l.getBoundingClientRect().width,U=i.getBoundingClientRect();p.endIndex=R,Ki(B,l,{placement:S==="left"?"left":"right",middleware:[pl(S==="left"?-1*K:0)]}).then(({x:z})=>{l.dataset.show="true",Object.assign(l.style,{height:`${U.height}px`,left:`${z}px`,top:`${g}px`})}).catch(console.error)}}else if(p.type==="row"){const v=u.row.getBoundingClientRect().height,{top:k,height:x}=s.getBoundingClientRect(),_=g-k,M=e.clientY+_-v/2,[T,S]=p.startCoords,A=S<e.clientY?"down":"up",I=M<k+_-20?k+_-20:M>k+x+_-v+20?k+x+_-v+20:M;r.style.top=`${I}px`,r.style.left=`${y}px`;const B=oee(s,e.clientY);if(B){const[R,K]=B,U=o.getBoundingClientRect().height,z=i.getBoundingClientRect();p.endIndex=K,Ki(R,o,{placement:A==="up"?"top":"bottom",middleware:[pl(A==="up"?-1*U:0)]}).then(({y:oe})=>{o.dataset.show="true",Object.assign(o.style,{width:`${z.width}px`,top:`${oe}px`})}).catch(console.error)}}},20)}function aee(n,e,t){const{dragPreviewRef:r,yLineHandleRef:i,xLineHandleRef:s,dragInfo:o}=n,l=tee(n,e),a=nee(n,e),c=()=>{const p=r.value;if(!p||p.dataset.show==="false")return;const g=p==null?void 0:p.querySelector("tbody");for(;g!=null&&g.firstChild;)g==null||g.removeChild(g.firstChild);p&&(p.dataset.show="false")},u=()=>{var p;const g=r.value;if(!g)return;const y=i.value;if(!y)return;const v=s.value;if(!v)return;const k=o.value;if(!k||!e||g.dataset.show==="false"||!n.colHandleRef.value||!n.rowHandleRef.value||(y.dataset.show="false",v.dataset.show="false",k.startIndex===k.endIndex))return;const M=e.get(Be),T={from:k.startIndex,to:k.endIndex,pos:((p=t==null?void 0:t())!=null?p:0)+1};if(k.type==="col"){M.call(oa.key,{pos:T.pos,index:k.startIndex}),M.call(eS.key,T);const S=[0,k.endIndex];AS({refs:n,index:S})}else{M.call(sa.key,{pos:T.pos,index:k.startIndex}),M.call(QC.key,T);const S=[k.endIndex,0];OS({refs:n,index:S})}requestAnimationFrame(()=>{e.get(Gt).focus()})},f=lee(n);return up(()=>{window.addEventListener("dragover",f),window.addEventListener("dragend",c),window.addEventListener("drop",u)}),fp(()=>{window.removeEventListener("dragover",f),window.removeEventListener("dragend",c),window.removeEventListener("drop",u)}),{dragRow:l,dragCol:a}}function cee(n,e,t){const{xLineHandleRef:r,contentWrapperRef:i,colHandleRef:s,rowHandleRef:o,hoverIndex:l,lineHoverIndex:a}=n;return{onAddRow:()=>{var v,k,x;if(!e)return;const _=r.value;if(!_)return;const[M]=a.value;if(M<0||!e.get(Gt).editable)return;const T=Array.from((k=(v=i.value)==null?void 0:v.querySelectorAll("tr"))!=null?k:[]),S=e.get(Be),A=((x=t==null?void 0:t())!=null?x:0)+1;T.length===M?(S.call(sa.key,{pos:A,index:M-1}),S.call(sS.key)):(S.call(sa.key,{pos:A,index:M}),S.call(iS.key)),S.call(sa.key,{pos:A,index:M}),_.dataset.show="false"},onAddCol:()=>{var v,k,x,_;if(!e||!r.value)return;const[T,S]=a.value;if(S<0||!e.get(Gt).editable)return;const A=Array.from((x=(k=(v=i.value)==null?void 0:v.querySelector("tr"))==null?void 0:k.children)!=null?x:[]),I=e.get(Be),B=((_=t==null?void 0:t())!=null?_:0)+1;A.length===S?(I.call(oa.key,{pos:B,index:S-1}),I.call(rS.key)):(I.call(oa.key,{pos:B,index:S}),I.call(nS.key)),I.call(oa.key,{pos:B,index:S})},selectCol:()=>{var v,k;if(!e)return;const[x,_]=l.value,M=e.get(Be),T=((v=t==null?void 0:t())!=null?v:0)+1;M.call(oa.key,{pos:T,index:_});const S=(k=s.value)==null?void 0:k.querySelector(".button-group");S&&(S.dataset.show=S.dataset.show==="true"?"false":"true")},selectRow:()=>{var v,k;if(!e)return;const[x,_]=l.value,M=e.get(Be),T=((v=t==null?void 0:t())!=null?v:0)+1;M.call(sa.key,{pos:T,index:x});const S=(k=o.value)==null?void 0:k.querySelector(".button-group");S&&x>0&&(S.dataset.show=S.dataset.show==="true"?"false":"true")},deleteSelected:v=>{if(!e||!e.get(Gt).editable)return;v.preventDefault(),v.stopPropagation(),e.get(Be).call(tS.key),requestAnimationFrame(()=>{e.get(Gt).focus()})},onAlign:v=>k=>{if(!e||!e.get(Gt).editable)return;k.preventDefault(),k.stopPropagation(),e.get(Be).call(oS.key,v),requestAnimationFrame(()=>{e.get(Gt).focus()})}}}function uee(n,e){return A0(t=>{if(!(e!=null&&e.editable))return;const{contentWrapperRef:r,yLineHandleRef:i,xLineHandleRef:s,colHandleRef:o,rowHandleRef:l,hoverIndex:a,lineHoverIndex:c}=n,u=i.value;if(!u)return;const f=s.value;if(!f)return;const p=r.value;if(!p)return;const g=l.value;if(!g)return;const y=o.value;if(!y)return;const v=ree(t,e);if(!v)return;const k=Ly(r,v);if(!k)return;const[x,_]=v,M=k.col.getBoundingClientRect(),T=Math.abs(t.clientX-M.left)<8,S=Math.abs(M.right-t.clientX)<8,A=Math.abs(t.clientY-M.top)<8,I=Math.abs(M.bottom-t.clientY)<8,B=T||S||A||I,R=g.querySelector(".button-group"),K=y.querySelector(".button-group");if(R&&(R.dataset.show="false"),K&&(K.dataset.show="false"),B){const U=p.getBoundingClientRect();g.dataset.show="false",y.dataset.show="false",f.dataset.displayType="tool",u.dataset.displayType="tool";const z=u.getBoundingClientRect().width,oe=f.getBoundingClientRect().height;T||S?(c.value[1]=T?_:_+1,Ki(k.col,u,{placement:T?"left":"right",middleware:[pl(T?-1*z:0)]}).then(({x:ne})=>{u.dataset.show="true",Object.assign(u.style,{height:`${U.height}px`,left:`${ne}px`})}).catch(console.error)):u.dataset.show="false",v[0]!==0&&(A||I)?(c.value[0]=A?x:x+1,Ki(k.row,f,{placement:A?"top":"bottom",middleware:[pl(A?-1*oe:0)]}).then(({y:ne})=>{f.dataset.show="true",Object.assign(f.style,{width:`${U.width}px`,top:`${ne}px`})}).catch(console.error)):f.dataset.show="false";return}c.value=[-1,-1],u.dataset.show="false",f.dataset.show="false",g.dataset.show="true",y.dataset.show="true",OS({refs:n,index:v}),AS({refs:n,index:v}),a.value=v},20)}function fee(n){return()=>{const{rowHandleRef:e,colHandleRef:t,yLineHandleRef:r,xLineHandleRef:i}=n;setTimeout(()=>{const s=e.value;if(!s)return;const o=t.value;if(!o)return;const l=r.value;if(!l)return;const a=i.value;a&&(s.dataset.show="false",o.dataset.show="false",l.dataset.show="false",a.dataset.show="false")},200)}}function hee(n,e){const t=uee(n,e),r=fee(n);return{pointerMove:t,pointerLeave:r}}const dee=tr({props:{view:{type:Object,required:!0},ctx:{type:Object,required:!0},getPos:{type:Function,required:!0},config:{type:Object,required:!0},onMount:{type:Function,required:!0},node:{type:Object,required:!0}},setup({view:n,node:e,ctx:t,getPos:r,config:i,onMount:s}){const o=Ve(),l=z=>{z!=null&&(z instanceof HTMLElement?(o.value=z,s(z)):o.value=void 0)},a=Ve(),c=Ve(),u=Ve(),f=Ve(),p=Ve(),g=Ve(),y=Ve([0,0]),v=Ve([-1,-1]),k=Ve(),x={dragPreviewRef:g,tableWrapperRef:p,contentWrapperRef:o,yLineHandleRef:f,xLineHandleRef:u,colHandleRef:a,rowHandleRef:c,hoverIndex:y,lineHoverIndex:v,dragInfo:k},{pointerLeave:_,pointerMove:M}=hee(x,n),{dragRow:T,dragCol:S}=aee(x,t,r),{onAddRow:A,onAddCol:I,selectCol:B,selectRow:R,deleteSelected:K,onAlign:U}=cee(x,t,r);return up(()=>{requestAnimationFrame(()=>{n.editable&&iee(x,n,e.value)})}),()=>J("div",{onDragstart:z=>z.preventDefault(),onDragover:z=>z.preventDefault(),onDragleave:z=>z.preventDefault(),onPointermove:M,onPointerleave:_},J("button",{type:"button","data-show":"false",contenteditable:"false",draggable:"true","data-role":"col-drag-handle",class:"handle cell-handle",onDragstart:S,onClick:B,onPointerdown:z=>z.stopPropagation(),onPointermove:z=>z.stopPropagation(),ref:a},J(ps,{icon:i.renderButton("col_drag_handle")}),J("div",{"data-show":"false",class:"button-group",onPointermove:z=>z.stopPropagation()},J("button",{type:"button",onPointerdown:U("left")},J(ps,{icon:i.renderButton("align_col_left")})),J("button",{type:"button",onPointerdown:U("center")},J(ps,{icon:i.renderButton("align_col_center")})),J("button",{type:"button",onPointerdown:U("right")},J(ps,{icon:i.renderButton("align_col_right")})),J("button",{type:"button",onPointerdown:K},J(ps,{icon:i.renderButton("delete_col")})))),J("button",{type:"button","data-show":"false",contenteditable:"false",draggable:"true","data-role":"row-drag-handle",class:"handle cell-handle",onDragstart:T,onClick:R,onPointerdown:z=>z.stopPropagation(),onPointermove:z=>z.stopPropagation(),ref:c},J(ps,{icon:i.renderButton("row_drag_handle")}),J("div",{"data-show":"false",class:"button-group",onPointermove:z=>z.stopPropagation()},J("button",{type:"button",onPointerdown:K},J(ps,{icon:i.renderButton("delete_row")})))),J("div",{class:"table-wrapper",ref:p},J("div",{"data-show":"false",class:"drag-preview","data-direction":"vertical",ref:g},J("table",null,J("tbody",null))),J("div",{"data-show":"false",contenteditable:"false","data-display-type":"tool","data-role":"x-line-drag-handle",class:"handle line-handle",onPointermove:z=>z.stopPropagation(),ref:u},J("button",{type:"button",onClick:A,class:"add-button"},J(ps,{icon:i.renderButton("add_row")}))),J("div",{"data-show":"false",contenteditable:"false","data-display-type":"tool","data-role":"y-line-drag-handle",class:"handle line-handle",onPointermove:z=>z.stopPropagation(),ref:f},J("button",{type:"button",onClick:I,class:"add-button"},J(ps,{icon:i.renderButton("add_col")}))),J("table",{ref:l,class:"children"})))}});var CR=n=>{throw TypeError(n)},pee=(n,e,t)=>e.has(n)||CR("Cannot "+t),mee=(n,e,t)=>e.has(n)?CR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),gee=(n,e,t)=>(pee(n,e,"access private method"),t),vv,SR;class yee{constructor(e,t,r,i){this.ctx=e,this.node=t,this.view=r,this.getPos=i,mee(this,vv);const s=document.createElement("div");s.className="milkdown-table-block";const o=document.createElement("tbody");this.contentDOM=o,o.setAttribute("data-content-dom","true"),o.classList.add("content-dom"),this.nodeRef=n0(t);const l=es(dee,{view:r,ctx:e,getPos:i,config:e.get(Oy.key),onMount:a=>{a.appendChild(o)},node:this.nodeRef});l.mount(s),this.app=l,this.dom=s}update(e){return e.type!==this.node.type||e.sameMarkup(this.node)&&e.content.eq(this.node.content)?!1:(this.node=e,this.nodeRef.value=e,!0)}stopEvent(e){if(e.type==="drop"||e.type.startsWith("drag"))return!0;if(e.type==="mousedown"||e.type==="pointerdown"){if(e.target instanceof Element&&e.target.closest("button"))return!0;const t=e.target;if(t instanceof HTMLElement&&(t.closest("th")||t.closest("td"))){const r=e;return gee(this,vv,SR).call(this,r)}}return!1}ignoreMutation(e){return!this.dom||!this.contentDOM?!0:e.type==="selection"?!1:this.contentDOM===e.target&&e.type==="attributes"?!0:!this.contentDOM.contains(e.target)}destroy(){this.app.unmount(),this.dom.remove(),this.contentDOM.remove()}}vv=new WeakSet;SR=function(n){const e=this.view;if(!e.editable)return!1;const{state:t,dispatch:r}=e,i=e.posAtCoords({left:n.clientX,top:n.clientY});if(!i)return!1;const s=t.doc.resolve(i.inside),o=Ms(c=>c.type.name==="table_cell"||c.type.name==="table_header")(s);if(!o)return!1;if(t.selection instanceof ze){const c=Ms(u=>u.type.name==="table_cell"||u.type.name==="table_header")(t.selection.$from);if((c==null?void 0:c.node)===o.node)return!1}const{from:l}=o,a=Ke.create(t.doc,l+1);return t.selection.eq(a)?!1:(t.selection instanceof jt?setTimeout(()=>{r(t.tr.setSelection(a).scrollIntoView())},20):requestAnimationFrame(()=>{r(t.tr.setSelection(a).scrollIntoView())}),!0)};const xR=op(Ml.node,n=>(e,t,r)=>new yee(n,e,t,r));mR(xR,{displayName:"NodeView<table-block>",group:"TableBlock"});const bee=[Oy,xR];function kv(n){if(!n)return!1;if(Array.isArray(n))return n.length>1?!1:kv(n[0]);const e=n.content;return e?kv(e):n.type==="text"}function wee(n,e){return Object.assign(n,{meta:{package:"@milkdown/plugin-clipboard",...e}}),n}const _R=An(n=>{const e=n.get(Ts);n.update(Ch,i=>({...i,editable:i.editable??(()=>!0)}));const t=new rn("MILKDOWN_CLIPBOARD");return new nn({key:t,props:{handlePaste:(i,s)=>{var x,_;const o=n.get(vh),l=(_=(x=i.props).editable)==null?void 0:_.call(x,i.state),{clipboardData:a}=s;if(!l||!a||i.state.selection.$from.node().type.spec.code)return!1;const u=a.getData("text/plain"),f=a.getData("vscode-editor-data");if(f){const M=JSON.parse(f),T=M==null?void 0:M.mode;if(u&&T){const{tr:S}=i.state,A=AF("code_block",e);return S.replaceSelectionWith(A.create({language:T})).setSelection(ze.near(S.doc.resolve(Math.max(0,S.selection.from-2)))).insertText(u.replace(/\r\n?/g,`
`)),i.dispatch(S),!0}}const p=a.getData("text/html");if(p.length===0&&u.length===0)return!1;const g=H0.fromSchema(e);let y;if(p.length===0){const M=o(u);if(!M||typeof M=="string")return!1;y=Ja.fromSchema(e).serializeFragment(M.content)}else{const M=document.createElement("template");M.innerHTML=p,y=M.content.cloneNode(!0),M.remove()}const v=g.parseSlice(y),k=TF(v);if(k)return i.dispatch(i.state.tr.replaceSelectionWith(k,!0)),!0;try{return i.dispatch(i.state.tr.replaceSelection(v)),!0}catch{return!1}},clipboardTextSerializer:i=>{const s=n.get(Lc);if(kv(i.content.toJSON()))return i.content.textBetween(0,i.content.size,`

`);const l=e.topNodeType.createAndFill(void 0,i.content);return l?s(l):""}}})});wee(_R,{displayName:"Prose<clipboard>"});function Uu(n,e){return Object.assign(n,{meta:{package:"@milkdown/plugin-history",...e}}),n}const LS=et("Undo",()=>()=>Cy);Uu(LS,{displayName:"Command<undo>"});const DS=et("Redo",()=>()=>xu);Uu(DS,{displayName:"Command<redo>"});const IS=It({},"historyProviderConfig");Uu(IS,{displayName:"Ctx<historyProviderConfig>"});const MR=An(n=>_Z(n.get(IS.key)));Uu(MR,{displayName:"Ctx<historyProviderPlugin>"});const NS=Kr("historyKeymap",{Undo:{shortcuts:"Mod-z",command:n=>{const e=n.get(Be);return()=>e.call(LS.key)}},Redo:{shortcuts:["Mod-y","Shift-Mod-z"],command:n=>{const e=n.get(Be);return()=>e.call(DS.key)}}});Uu(NS.ctx,{displayName:"KeymapCtx<history>"});Uu(NS.shortcuts,{displayName:"Keymap<history>"});const vee=[IS,MR,NS,LS,DS].flat();function kee(n,e){const{doc:t,selection:r}=n;if(!t||!r||!(r instanceof ze||r instanceof zr))return n;const{to:i}=r,s=e.type==="space"?Array(e.size).fill(" ").join(""):"	";return n.insertText(s,i)}const Dy=It({type:"space",size:2},"indentConfig");Dy.meta={package:"@milkdown/plugin-indent",displayName:"Ctx<indentConfig>"};const TR=UD(n=>({Tab:(e,t)=>{const r=n.get(Dy.key),{tr:i}=e,s=kee(i,r);return s.docChanged?(t==null||t(s),!0):!1}}));TR.meta={package:"@milkdown/plugin-indent",displayName:"Shortcut<indent>"};const Cee=[Dy,TR];class ER{constructor(){this.beforeMountedListeners=[],this.mountedListeners=[],this.updatedListeners=[],this.selectionUpdatedListeners=[],this.markdownUpdatedListeners=[],this.blurListeners=[],this.focusListeners=[],this.destroyListeners=[],this.beforeMount=e=>(this.beforeMountedListeners.push(e),this),this.mounted=e=>(this.mountedListeners.push(e),this),this.updated=e=>(this.updatedListeners.push(e),this)}get listeners(){return{beforeMount:this.beforeMountedListeners,mounted:this.mountedListeners,updated:this.updatedListeners,markdownUpdated:this.markdownUpdatedListeners,blur:this.blurListeners,focus:this.focusListeners,destroy:this.destroyListeners,selectionUpdated:this.selectionUpdatedListeners}}markdownUpdated(e){return this.markdownUpdatedListeners.push(e),this}blur(e){return this.blurListeners.push(e),this}focus(e){return this.focusListeners.push(e),this}destroy(e){return this.destroyListeners.push(e),this}selectionUpdated(e){return this.selectionUpdatedListeners.push(e),this}}const k0=mt(new ER,"listener"),See=new rn("MILKDOWN_LISTENER"),AR=n=>(n.inject(k0,new ER),async()=>{await n.wait(Ma);const e=n.get(k0),{listeners:t}=e;t.beforeMount.forEach(a=>a(n)),await n.wait(kh);const r=n.get(Lc);let i=null,s=null,o=null;const l=new nn({key:See,view:()=>({destroy:()=>{t.destroy.forEach(a=>a(n))}}),props:{handleDOMEvents:{focus:()=>(t.focus.forEach(a=>a(n)),!1),blur:()=>(t.blur.forEach(a=>a(n)),!1)}},state:{init:(a,c)=>{i=c.doc,s=r(c.doc)},apply:a=>{const c=a.selection;return(!o&&c||o&&!c.eq(o))&&(t.selectionUpdated.forEach(f=>{f(n,c,o)}),o=c),!a.docChanged||a.getMeta("addToHistory")===!1?void 0:E0(()=>{const{doc:f}=a;if(t.updated.length>0&&i&&!i.eq(f)&&t.updated.forEach(p=>{p(n,f,i)}),t.markdownUpdated.length>0&&i&&!i.eq(f)){const p=r(f);t.markdownUpdated.forEach(g=>{g(n,p,s)}),s=p}i=f},200)()}}});n.update(vl,a=>a.concat(l)),await n.wait(Xm),t.mounted.forEach(a=>a(n))});AR.meta={package:"@milkdown/plugin-listener",displayName:"Listener"};const RS=It({shouldAppend:n=>!(!n||["heading","paragraph"].includes(n.type.name)),getNode:n=>n.schema.nodes.paragraph.create()},"trailingConfig");RS.meta={package:"@milkdown/plugin-trailing",displayName:"Ctx<trailingConfig>"};const OR=An(n=>{const e=new rn("MILKDOWN_TRAILING"),{shouldAppend:t,getNode:r}=n.get(RS.key),i=new nn({key:e,state:{init:(s,o)=>{const l=o.tr.doc.lastChild;return t(l,o)},apply:(s,o,l,a)=>{if(!s.docChanged)return o;const c=s.doc.lastChild;return t(c,a)}},appendTransaction:(s,o,l)=>{const{doc:a,tr:c}=l,u=r==null?void 0:r(l),f=i.getState(l),p=a.content.size;if(!(!f||!u))return c.insert(p,u)}});return i});OR.meta={package:"@milkdown/plugin-trailing",displayName:"Prose<trailing>"};const xee=[RS,OR];var St=(n=>(n.CodeMirror="code-mirror",n.ListItem="list-item",n.LinkTooltip="link-tooltip",n.Cursor="cursor",n.ImageBlock="image-block",n.BlockEdit="block-edit",n.Toolbar="toolbar",n.Placeholder="placeholder",n.Table="table",n.Latex="latex",n))(St||{});const _ee={cursor:!0,"list-item":!0,"link-tooltip":!0,"image-block":!0,"block-edit":!0,placeholder:!0,toolbar:!0,"code-mirror":!0,table:!0,latex:!0},Mee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      d="M4.25 20.5C4.0375 20.5 3.85942 20.4281 3.71575 20.2843C3.57192 20.1404 3.5 19.9622 3.5 19.7498C3.5 19.5371 3.57192 19.359 3.71575 19.2155C3.85942 19.0718 4.0375 19 4.25 19H19.75C19.9625 19 20.1406 19.0719 20.2843 19.2158C20.4281 19.3596 20.5 19.5378 20.5 19.7502C20.5 19.9629 20.4281 20.141 20.2843 20.2845C20.1406 20.4282 19.9625 20.5 19.75 20.5H4.25ZM8.25 16.625C8.0375 16.625 7.85942 16.5531 7.71575 16.4093C7.57192 16.2654 7.5 16.0872 7.5 15.8748C7.5 15.6621 7.57192 15.484 7.71575 15.3405C7.85942 15.1968 8.0375 15.125 8.25 15.125H15.75C15.9625 15.125 16.1406 15.1969 16.2843 15.3408C16.4281 15.4846 16.5 15.6628 16.5 15.8753C16.5 16.0879 16.4281 16.266 16.2843 16.4095C16.1406 16.5532 15.9625 16.625 15.75 16.625H8.25ZM4.25 12.75C4.0375 12.75 3.85942 12.6781 3.71575 12.5343C3.57192 12.3904 3.5 12.2122 3.5 11.9998C3.5 11.7871 3.57192 11.609 3.71575 11.4655C3.85942 11.3218 4.0375 11.25 4.25 11.25H19.75C19.9625 11.25 20.1406 11.3219 20.2843 11.4658C20.4281 11.6096 20.5 11.7878 20.5 12.0003C20.5 12.2129 20.4281 12.391 20.2843 12.5345C20.1406 12.6782 19.9625 12.75 19.75 12.75H4.25ZM8.25 8.875C8.0375 8.875 7.85942 8.80308 7.71575 8.65925C7.57192 8.51542 7.5 8.33725 7.5 8.12475C7.5 7.91208 7.57192 7.734 7.71575 7.5905C7.85942 7.44683 8.0375 7.375 8.25 7.375H15.75C15.9625 7.375 16.1406 7.44692 16.2843 7.59075C16.4281 7.73458 16.5 7.91275 16.5 8.12525C16.5 8.33792 16.4281 8.516 16.2843 8.6595C16.1406 8.80317 15.9625 8.875 15.75 8.875H8.25ZM4.25 5C4.0375 5 3.85942 4.92808 3.71575 4.78425C3.57192 4.64042 3.5 4.46225 3.5 4.24975C3.5 4.03708 3.57192 3.859 3.71575 3.7155C3.85942 3.57183 4.0375 3.5 4.25 3.5H19.75C19.9625 3.5 20.1406 3.57192 20.2843 3.71575C20.4281 3.85958 20.5 4.03775 20.5 4.25025C20.5 4.46292 20.4281 4.641 20.2843 4.7845C20.1406 4.92817 19.9625 5 19.75 5H4.25Z"
    />
  </svg>
`,Tee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      d="M4.25 20.5C4.0375 20.5 3.85942 20.4281 3.71575 20.2843C3.57192 20.1404 3.5 19.9622 3.5 19.7498C3.5 19.5371 3.57192 19.359 3.71575 19.2155C3.85942 19.0718 4.0375 19 4.25 19H19.75C19.9625 19 20.1406 19.0719 20.2843 19.2158C20.4281 19.3596 20.5 19.5378 20.5 19.7502C20.5 19.9629 20.4281 20.141 20.2843 20.2845C20.1406 20.4282 19.9625 20.5 19.75 20.5H4.25ZM4.25 16.625C4.0375 16.625 3.85942 16.5531 3.71575 16.4093C3.57192 16.2654 3.5 16.0872 3.5 15.8748C3.5 15.6621 3.57192 15.484 3.71575 15.3405C3.85942 15.1968 4.0375 15.125 4.25 15.125H13.75C13.9625 15.125 14.1406 15.1969 14.2843 15.3408C14.4281 15.4846 14.5 15.6628 14.5 15.8753C14.5 16.0879 14.4281 16.266 14.2843 16.4095C14.1406 16.5532 13.9625 16.625 13.75 16.625H4.25ZM4.25 12.75C4.0375 12.75 3.85942 12.6781 3.71575 12.5343C3.57192 12.3904 3.5 12.2122 3.5 11.9998C3.5 11.7871 3.57192 11.609 3.71575 11.4655C3.85942 11.3218 4.0375 11.25 4.25 11.25H19.75C19.9625 11.25 20.1406 11.3219 20.2843 11.4658C20.4281 11.6096 20.5 11.7878 20.5 12.0003C20.5 12.2129 20.4281 12.391 20.2843 12.5345C20.1406 12.6782 19.9625 12.75 19.75 12.75H4.25ZM4.25 8.875C4.0375 8.875 3.85942 8.80308 3.71575 8.65925C3.57192 8.51542 3.5 8.33725 3.5 8.12475C3.5 7.91208 3.57192 7.734 3.71575 7.5905C3.85942 7.44683 4.0375 7.375 4.25 7.375H13.75C13.9625 7.375 14.1406 7.44692 14.2843 7.59075C14.4281 7.73458 14.5 7.91275 14.5 8.12525C14.5 8.33792 14.4281 8.516 14.2843 8.6595C14.1406 8.80317 13.9625 8.875 13.75 8.875H4.25ZM4.25 5C4.0375 5 3.85942 4.92808 3.71575 4.78425C3.57192 4.64042 3.5 4.46225 3.5 4.24975C3.5 4.03708 3.57192 3.859 3.71575 3.7155C3.85942 3.57183 4.0375 3.5 4.25 3.5H19.75C19.9625 3.5 20.1406 3.57192 20.2843 3.71575C20.4281 3.85958 20.5 4.03775 20.5 4.25025C20.5 4.46292 20.4281 4.641 20.2843 4.7845C20.1406 4.92817 19.9625 5 19.75 5H4.25Z"
    />
  </svg>
`,Eee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      d="M4.25 5C4.0375 5 3.85942 4.92808 3.71575 4.78425C3.57192 4.64042 3.5 4.46225 3.5 4.24975C3.5 4.03708 3.57192 3.859 3.71575 3.7155C3.85942 3.57183 4.0375 3.5 4.25 3.5H19.75C19.9625 3.5 20.1406 3.57192 20.2843 3.71575C20.4281 3.85958 20.5 4.03775 20.5 4.25025C20.5 4.46292 20.4281 4.641 20.2843 4.7845C20.1406 4.92817 19.9625 5 19.75 5H4.25ZM10.25 8.875C10.0375 8.875 9.85942 8.80308 9.71575 8.65925C9.57192 8.51542 9.5 8.33725 9.5 8.12475C9.5 7.91208 9.57192 7.734 9.71575 7.5905C9.85942 7.44683 10.0375 7.375 10.25 7.375H19.75C19.9625 7.375 20.1406 7.44692 20.2843 7.59075C20.4281 7.73458 20.5 7.91275 20.5 8.12525C20.5 8.33792 20.4281 8.516 20.2843 8.6595C20.1406 8.80317 19.9625 8.875 19.75 8.875H10.25ZM4.25 12.75C4.0375 12.75 3.85942 12.6781 3.71575 12.5343C3.57192 12.3904 3.5 12.2122 3.5 11.9998C3.5 11.7871 3.57192 11.609 3.71575 11.4655C3.85942 11.3218 4.0375 11.25 4.25 11.25H19.75C19.9625 11.25 20.1406 11.3219 20.2843 11.4658C20.4281 11.6096 20.5 11.7878 20.5 12.0003C20.5 12.2129 20.4281 12.391 20.2843 12.5345C20.1406 12.6782 19.9625 12.75 19.75 12.75H4.25ZM10.25 16.625C10.0375 16.625 9.85942 16.5531 9.71575 16.4093C9.57192 16.2654 9.5 16.0872 9.5 15.8748C9.5 15.6621 9.57192 15.484 9.71575 15.3405C9.85942 15.1968 10.0375 15.125 10.25 15.125H19.75C19.9625 15.125 20.1406 15.1969 20.2843 15.3408C20.4281 15.4846 20.5 15.6628 20.5 15.8753C20.5 16.0879 20.4281 16.266 20.2843 16.4095C20.1406 16.5532 19.9625 16.625 19.75 16.625H10.25ZM4.25 20.5C4.0375 20.5 3.85942 20.4281 3.71575 20.2843C3.57192 20.1404 3.5 19.9622 3.5 19.7498C3.5 19.5371 3.57192 19.359 3.71575 19.2155C3.85942 19.0718 4.0375 19 4.25 19H19.75C19.9625 19 20.1406 19.0719 20.2843 19.2158C20.4281 19.3596 20.5 19.5378 20.5 19.7502C20.5 19.9629 20.4281 20.141 20.2843 20.2845C20.1406 20.4282 19.9625 20.5 19.75 20.5H4.25Z"
    />
  </svg>
`,Aee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      d="M8.85758 18.625C8.4358 18.625 8.07715 18.4772 7.78163 18.1817C7.48613 17.8862 7.33838 17.5275 7.33838 17.1058V6.8942C7.33838 6.47242 7.48613 6.11377 7.78163 5.81825C8.07715 5.52275 8.4358 5.375 8.85758 5.375H12.1999C13.2191 5.375 14.1406 5.69231 14.9643 6.32693C15.788 6.96154 16.1999 7.81603 16.1999 8.89038C16.1999 9.63779 16.0194 10.2471 15.6585 10.7183C15.2976 11.1894 14.9088 11.5314 14.4922 11.7442C15.005 11.9211 15.4947 12.2708 15.9614 12.7933C16.428 13.3157 16.6614 14.0192 16.6614 14.9038C16.6614 16.182 16.1902 17.1217 15.2479 17.723C14.3056 18.3243 13.3563 18.625 12.3999 18.625H8.85758ZM9.4883 16.6327H12.3191C13.1063 16.6327 13.6627 16.4141 13.9884 15.9769C14.314 15.5397 14.4768 15.1205 14.4768 14.7192C14.4768 14.3179 14.314 13.8987 13.9884 13.4615C13.6627 13.0243 13.0909 12.8057 12.273 12.8057H9.4883V16.6327ZM9.4883 10.875H12.0826C12.6903 10.875 13.172 10.7013 13.5278 10.3539C13.8836 10.0064 14.0615 9.59037 14.0615 9.10575C14.0615 8.59035 13.8733 8.16918 13.497 7.84225C13.1207 7.51533 12.6595 7.35188 12.1133 7.35188H9.4883V10.875Z"
    />
  </svg>
`,Oee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_952_6527)">
      <circle cx="12" cy="12" r="3" />
    </g>
    <defs>
      <clipPath id="clip0_952_6527">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Lee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_8070)">
      <path
        d="M4 10.5C3.17 10.5 2.5 11.17 2.5 12C2.5 12.83 3.17 13.5 4 13.5C4.83 13.5 5.5 12.83 5.5 12C5.5 11.17 4.83 10.5 4 10.5ZM4 4.5C3.17 4.5 2.5 5.17 2.5 6C2.5 6.83 3.17 7.5 4 7.5C4.83 7.5 5.5 6.83 5.5 6C5.5 5.17 4.83 4.5 4 4.5ZM4 16.5C3.17 16.5 2.5 17.18 2.5 18C2.5 18.82 3.18 19.5 4 19.5C4.82 19.5 5.5 18.82 5.5 18C5.5 17.18 4.83 16.5 4 16.5ZM8 19H20C20.55 19 21 18.55 21 18C21 17.45 20.55 17 20 17H8C7.45 17 7 17.45 7 18C7 18.55 7.45 19 8 19ZM8 13H20C20.55 13 21 12.55 21 12C21 11.45 20.55 11 20 11H8C7.45 11 7 11.45 7 12C7 12.55 7.45 13 8 13ZM7 6C7 6.55 7.45 7 8 7H20C20.55 7 21 6.55 21 6C21 5.45 20.55 5 20 5H8C7.45 5 7 5.45 7 6Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_8070">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Dee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="32"
    height="32"
    viewBox="0 0 24 24"
  >
    <path
      fill="currentColor"
      d="M9 22a1 1 0 0 1-1-1v-3H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6.1l-3.7 3.71c-.2.19-.45.29-.7.29zm1-6v3.08L13.08 16H20V4H4v12z"
    />
  </svg>
`,Iee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_1803_1151)">
      <path
        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM10.71 16.29C10.32 16.68 9.69 16.68 9.3 16.29L5.71 12.7C5.32 12.31 5.32 11.68 5.71 11.29C6.1 10.9 6.73 10.9 7.12 11.29L10 14.17L16.88 7.29C17.27 6.9 17.9 6.9 18.29 7.29C18.68 7.68 18.68 8.31 18.29 8.7L10.71 16.29Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_1803_1151">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Nee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_1803_535)">
      <path
        d="M18 19H6C5.45 19 5 18.55 5 18V6C5 5.45 5.45 5 6 5H18C18.55 5 19 5.45 19 6V18C19 18.55 18.55 19 18 19ZM19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_1803_535">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,LR=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    fill="none"
    viewBox="0 0 24 24"
    stroke-width="1.5"
    stroke="currentColor"
    class="w-6 h-6"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      d="M19.5 8.25l-7.5 7.5-7.5-7.5"
    />
  </svg>
`,DR=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_1098_15553)">
      <path
        d="M18.3007 5.70973C17.9107 5.31973 17.2807 5.31973 16.8907 5.70973L12.0007 10.5897L7.1107 5.69973C6.7207 5.30973 6.0907 5.30973 5.7007 5.69973C5.3107 6.08973 5.3107 6.71973 5.7007 7.10973L10.5907 11.9997L5.7007 16.8897C5.3107 17.2797 5.3107 17.9097 5.7007 18.2997C6.0907 18.6897 6.7207 18.6897 7.1107 18.2997L12.0007 13.4097L16.8907 18.2997C17.2807 18.6897 17.9107 18.6897 18.3007 18.2997C18.6907 17.9097 18.6907 17.2797 18.3007 16.8897L13.4107 11.9997L18.3007 7.10973C18.6807 6.72973 18.6807 6.08973 18.3007 5.70973Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_1098_15553">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,IR=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_8081)">
      <path
        d="M9.4 16.6L4.8 12L9.4 7.4L8 6L2 12L8 18L9.4 16.6ZM14.6 16.6L19.2 12L14.6 7.4L16 6L22 12L16 18L14.6 16.6Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_8081">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,PS=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
  >
    <g clip-path="url(#clip0_1013_1606)">
      <path
        d="M9.00012 16.1998L5.50012 12.6998C5.11012 12.3098 4.49012 12.3098 4.10012 12.6998C3.71012 13.0898 3.71012 13.7098 4.10012 14.0998L8.29012 18.2898C8.68012 18.6798 9.31012 18.6798 9.70012 18.2898L20.3001 7.69982C20.6901 7.30982 20.6901 6.68982 20.3001 6.29982C19.9101 5.90982 19.2901 5.90982 18.9001 6.29982L9.00012 16.1998Z"
        fill="#817567"
      />
    </g>
    <defs>
      <clipPath id="clip0_1013_1606">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,NR=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    height="24px"
    viewBox="0 -960 960 960"
    width="24px"
    fill="none"
  >
    <path
      d="M360-240q-33 0-56.5-23.5T280-320v-480q0-33 23.5-56.5T360-880h360q33 0 56.5 23.5T800-800v480q0 33-23.5 56.5T720-240H360Zm0-80h360v-480H360v480ZM200-80q-33 0-56.5-23.5T120-160v-560h80v560h440v80H200Zm160-240v-480 480Z"
    />
  </svg>
`,Ree=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_7900)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M19 13H5C4.45 13 4 12.55 4 12C4 11.45 4.45 11 5 11H19C19.55 11 20 11.45 20 12C20 12.55 19.55 13 19 13Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_7900">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,hA=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="16"
    height="16"
    viewBox="0 0 16 16"
  >
    <path
      d="M3.5 9.83366C3.35833 9.83366 3.23961 9.78571 3.14383 9.68983C3.04794 9.59394 3 9.47516 3 9.33349C3 9.19171 3.04794 9.07299 3.14383 8.97733C3.23961 8.88155 3.35833 8.83366 3.5 8.83366H12.5C12.6417 8.83366 12.7604 8.8816 12.8562 8.97749C12.9521 9.07338 13 9.19216 13 9.33383C13 9.4756 12.9521 9.59433 12.8562 9.68999C12.7604 9.78577 12.6417 9.83366 12.5 9.83366H3.5ZM3.5 7.16699C3.35833 7.16699 3.23961 7.11905 3.14383 7.02316C3.04794 6.92727 3 6.80849 3 6.66683C3 6.52505 3.04794 6.40633 3.14383 6.31066C3.23961 6.21488 3.35833 6.16699 3.5 6.16699H12.5C12.6417 6.16699 12.7604 6.21494 12.8562 6.31083C12.9521 6.40671 13 6.52549 13 6.66716C13 6.80894 12.9521 6.92766 12.8562 7.02333C12.7604 7.1191 12.6417 7.16699 12.5 7.16699H3.5Z"
    />
  </svg>
`,BS=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_1013_1585)">
      <path
        d="M14.06 9.02L14.98 9.94L5.92 19H5V18.08L14.06 9.02ZM17.66 3C17.41 3 17.15 3.1 16.96 3.29L15.13 5.12L18.88 8.87L20.71 7.04C21.1 6.65 21.1 6.02 20.71 5.63L18.37 3.29C18.17 3.09 17.92 3 17.66 3ZM14.06 6.19L3 17.25V21H6.75L17.81 9.94L14.06 6.19Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_1013_1585">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Pee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_992_5553)">
      <path
        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM12 17H14V7H10V9H12V17Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_992_5553">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Bee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_992_5559)">
      <path
        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM15 15H11V13H13C14.1 13 15 12.11 15 11V9C15 7.89 14.1 7 13 7H9V9H13V11H11C9.9 11 9 11.89 9 13V17H15V15Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_992_5559">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Hee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_992_5565)">
      <path
        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM15 15V13.5C15 12.67 14.33 12 13.5 12C14.33 12 15 11.33 15 10.5V9C15 7.89 14.1 7 13 7H9V9H13V11H11V13H13V15H9V17H13C14.1 17 15 16.11 15 15Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_992_5565">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Vee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_7757)">
      <path
        d="M19.04 3H5.04004C3.94004 3 3.04004 3.9 3.04004 5V19C3.04004 20.1 3.94004 21 5.04004 21H19.04C20.14 21 21.04 20.1 21.04 19V5C21.04 3.9 20.14 3 19.04 3ZM19.04 19H5.04004V5H19.04V19ZM13.04 17H15.04V7H13.04V11H11.04V7H9.04004V13H13.04V17Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_7757">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Fee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_7760)">
      <path
        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM15 15V13C15 11.89 14.1 11 13 11H11V9H15V7H9V13H13V15H9V17H13C14.1 17 15 16.11 15 15Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_7760">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,jee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_7763)">
      <path
        d="M11 17H13C14.1 17 15 16.11 15 15V13C15 11.89 14.1 11 13 11H11V9H15V7H11C9.9 7 9 7.89 9 9V15C9 16.11 9.9 17 11 17ZM11 13H13V15H11V13ZM19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_7763">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Cv=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_8075)">
      <path
        d="M19 5V19H5V5H19ZM19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM14.14 11.86L11.14 15.73L9 13.14L6 17H18L14.14 11.86Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_8075">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,$ee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      d="M6.29811 18.625C6.04505 18.625 5.83115 18.5375 5.65641 18.3626C5.48166 18.1877 5.39429 17.9736 5.39429 17.7203C5.39429 17.467 5.48166 17.2532 5.65641 17.0788C5.83115 16.9045 6.04505 16.8173 6.29811 16.8173H9.21159L12.452 7.18265H9.53851C9.28545 7.18265 9.07155 7.0952 8.89681 6.9203C8.72206 6.7454 8.63469 6.5313 8.63469 6.278C8.63469 6.02472 8.72206 5.81089 8.89681 5.63652C9.07155 5.46217 9.28545 5.375 9.53851 5.375H16.8847C17.1377 5.375 17.3516 5.46245 17.5264 5.63735C17.7011 5.81225 17.7885 6.02634 17.7885 6.27962C17.7885 6.53293 17.7011 6.74676 17.5264 6.92113C17.3516 7.09548 17.1377 7.18265 16.8847 7.18265H14.2789L11.0385 16.8173H13.6443C13.8973 16.8173 14.1112 16.9048 14.286 17.0797C14.4607 17.2546 14.5481 17.4687 14.5481 17.722C14.5481 17.9752 14.4607 18.1891 14.286 18.3634C14.1112 18.5378 13.8973 18.625 13.6443 18.625H6.29811Z"
    />
  </svg>
`,zee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      d="M17.0385 19.5003V16.5388H14.0769V15.0388H17.0385V12.0773H18.5384V15.0388H21.5V16.5388H18.5384V19.5003H17.0385ZM10.8077 16.5388H7.03845C5.78282 16.5388 4.7125 16.0963 3.8275 15.2114C2.9425 14.3266 2.5 13.2564 2.5 12.0009C2.5 10.7454 2.9425 9.67504 3.8275 8.78979C4.7125 7.90454 5.78282 7.46191 7.03845 7.46191H10.8077V8.96186H7.03845C6.1987 8.96186 5.48235 9.25834 4.8894 9.85129C4.29645 10.4442 3.99998 11.1606 3.99998 12.0003C3.99998 12.8401 4.29645 13.5564 4.8894 14.1494C5.48235 14.7423 6.1987 15.0388 7.03845 15.0388H10.8077V16.5388ZM8.25 12.7503V11.2504H15.75V12.7503H8.25ZM21.5 12.0003H20C20 11.1606 19.7035 10.4442 19.1106 9.85129C18.5176 9.25834 17.8013 8.96186 16.9615 8.96186H13.1923V7.46191H16.9615C18.2171 7.46191 19.2875 7.90441 20.1725 8.78939C21.0575 9.67439 21.5 10.7447 21.5 12.0003Z"
    />
  </svg>
`,Wee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_971_7680)">
      <path
        d="M11 18C11 19.1 10.1 20 9 20C7.9 20 7 19.1 7 18C7 16.9 7.9 16 9 16C10.1 16 11 16.9 11 18ZM9 10C7.9 10 7 10.9 7 12C7 13.1 7.9 14 9 14C10.1 14 11 13.1 11 12C11 10.9 10.1 10 9 10ZM9 4C7.9 4 7 4.9 7 6C7 7.1 7.9 8 9 8C10.1 8 11 7.1 11 6C11 4.9 10.1 4 9 4ZM15 8C16.1 8 17 7.1 17 6C17 4.9 16.1 4 15 4C13.9 4 13 4.9 13 6C13 7.1 13.9 8 15 8ZM15 10C13.9 10 13 10.9 13 12C13 13.1 13.9 14 15 14C16.1 14 17 13.1 17 12C17 10.9 16.1 10 15 10ZM15 16C13.9 16 13 16.9 13 18C13 19.1 13.9 20 15 20C16.1 20 17 19.1 17 18C17 16.9 16.1 16 15 16Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_971_7680">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,qee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_8067)">
      <path
        d="M8 7H20C20.55 7 21 6.55 21 6C21 5.45 20.55 5 20 5H8C7.45 5 7 5.45 7 6C7 6.55 7.45 7 8 7ZM20 17H8C7.45 17 7 17.45 7 18C7 18.55 7.45 19 8 19H20C20.55 19 21 18.55 21 18C21 17.45 20.55 17 20 17ZM20 11H8C7.45 11 7 11.45 7 12C7 12.55 7.45 13 8 13H20C20.55 13 21 12.55 21 12C21 11.45 20.55 11 20 11ZM4.5 16H2.5C2.22 16 2 16.22 2 16.5C2 16.78 2.22 17 2.5 17H4V17.5H3.5C3.22 17.5 3 17.72 3 18C3 18.28 3.22 18.5 3.5 18.5H4V19H2.5C2.22 19 2 19.22 2 19.5C2 19.78 2.22 20 2.5 20H4.5C4.78 20 5 19.78 5 19.5V16.5C5 16.22 4.78 16 4.5 16ZM2.5 5H3V7.5C3 7.78 3.22 8 3.5 8C3.78 8 4 7.78 4 7.5V4.5C4 4.22 3.78 4 3.5 4H2.5C2.22 4 2 4.22 2 4.5C2 4.78 2.22 5 2.5 5ZM4.5 10H2.5C2.22 10 2 10.22 2 10.5C2 10.78 2.22 11 2.5 11H3.8L2.12 12.96C2.04 13.05 2 13.17 2 13.28V13.5C2 13.78 2.22 14 2.5 14H4.5C4.78 14 5 13.78 5 13.5C5 13.22 4.78 13 4.5 13H3.2L4.88 11.04C4.96 10.95 5 10.83 5 10.72V10.5C5 10.22 4.78 10 4.5 10Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_8067">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Sv=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_971_7676)">
      <path
        d="M18 13H13V18C13 18.55 12.55 19 12 19C11.45 19 11 18.55 11 18V13H6C5.45 13 5 12.55 5 12C5 11.45 5.45 11 6 11H11V6C11 5.45 11.45 5 12 5C12.55 5 13 5.45 13 6V11H18C18.55 11 19 11.45 19 12C19 12.55 18.55 13 18 13Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_971_7676">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Uee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_7897)">
      <path
        d="M7.17 17C7.68 17 8.15 16.71 8.37 16.26L9.79 13.42C9.93 13.14 10 12.84 10 12.53V8C10 7.45 9.55 7 9 7H5C4.45 7 4 7.45 4 8V12C4 12.55 4.45 13 5 13H7L5.97 15.06C5.52 15.95 6.17 17 7.17 17ZM17.17 17C17.68 17 18.15 16.71 18.37 16.26L19.79 13.42C19.93 13.14 20 12.84 20 12.53V8C20 7.45 19.55 7 19 7H15C14.45 7 14 7.45 14 8V12C14 12.55 14.45 13 15 13H17L15.97 15.06C15.52 15.95 16.17 17 17.17 17Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_7897">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,xv=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      d="M7.30775 20.4997C6.81058 20.4997 6.385 20.3227 6.031 19.9687C5.677 19.6147 5.5 19.1892 5.5 18.692V5.99973H5.25C5.0375 5.99973 4.85942 5.92782 4.71575 5.78398C4.57192 5.64015 4.5 5.46198 4.5 5.24948C4.5 5.03682 4.57192 4.85873 4.71575 4.71523C4.85942 4.57157 5.0375 4.49973 5.25 4.49973H9C9 4.2549 9.08625 4.04624 9.25875 3.87374C9.43108 3.7014 9.63967 3.61523 9.8845 3.61523H14.1155C14.3603 3.61523 14.5689 3.7014 14.7413 3.87374C14.9138 4.04624 15 4.2549 15 4.49973H18.75C18.9625 4.49973 19.1406 4.57165 19.2843 4.71548C19.4281 4.85932 19.5 5.03748 19.5 5.24998C19.5 5.46265 19.4281 5.64073 19.2843 5.78423C19.1406 5.9279 18.9625 5.99973 18.75 5.99973H18.5V18.692C18.5 19.1892 18.323 19.6147 17.969 19.9687C17.615 20.3227 17.1894 20.4997 16.6923 20.4997H7.30775ZM17 5.99973H7V18.692C7 18.7818 7.02883 18.8556 7.0865 18.9132C7.14417 18.9709 7.21792 18.9997 7.30775 18.9997H16.6923C16.7821 18.9997 16.8558 18.9709 16.9135 18.9132C16.9712 18.8556 17 18.7818 17 18.692V5.99973ZM10.1543 16.9997C10.3668 16.9997 10.5448 16.9279 10.6885 16.7842C10.832 16.6404 10.9037 16.4622 10.9037 16.2497V8.74973C10.9037 8.53723 10.8318 8.35907 10.688 8.21523C10.5443 8.07157 10.3662 7.99973 10.1535 7.99973C9.941 7.99973 9.76292 8.07157 9.61925 8.21523C9.47575 8.35907 9.404 8.53723 9.404 8.74973V16.2497C9.404 16.4622 9.47583 16.6404 9.6195 16.7842C9.76333 16.9279 9.94158 16.9997 10.1543 16.9997ZM13.8465 16.9997C14.059 16.9997 14.2371 16.9279 14.3807 16.7842C14.5243 16.6404 14.596 16.4622 14.596 16.2497V8.74973C14.596 8.53723 14.5242 8.35907 14.3805 8.21523C14.2367 8.07157 14.0584 7.99973 13.8458 7.99973C13.6333 7.99973 13.4552 8.07157 13.3115 8.21523C13.168 8.35907 13.0962 8.53723 13.0962 8.74973V16.2497C13.0962 16.4622 13.1682 16.6404 13.312 16.7842C13.4557 16.9279 13.6338 16.9997 13.8465 16.9997Z"
    />
  </svg>
`,RR=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    fill="none"
    viewBox="0 0 24 24"
    stroke-width="1.5"
    stroke="currentColor"
    class="w-6 h-6"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"
    />
  </svg>
`,Kee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      d="M3.25 13.7404C3.0375 13.7404 2.85938 13.6684 2.71563 13.5246C2.57188 13.3808 2.5 13.2026 2.5 12.99C2.5 12.7774 2.57188 12.5993 2.71563 12.4558C2.85938 12.3122 3.0375 12.2404 3.25 12.2404H20.75C20.9625 12.2404 21.1406 12.3123 21.2843 12.4561C21.4281 12.5999 21.5 12.7781 21.5 12.9907C21.5 13.2033 21.4281 13.3814 21.2843 13.525C21.1406 13.6686 20.9625 13.7404 20.75 13.7404H3.25ZM10.9423 10.2596V6.62495H6.5673C6.2735 6.62495 6.02377 6.52201 5.8181 6.31613C5.61245 6.11026 5.50963 5.86027 5.50963 5.56615C5.50963 5.27205 5.61245 5.02083 5.8181 4.8125C6.02377 4.60417 6.2735 4.5 6.5673 4.5H17.4423C17.7361 4.5 17.9858 4.60294 18.1915 4.80883C18.3971 5.01471 18.5 5.2647 18.5 5.5588C18.5 5.85292 18.3971 6.10413 18.1915 6.31245C17.9858 6.52078 17.7361 6.62495 17.4423 6.62495H13.0673V10.2596H10.9423ZM10.9423 15.7211H13.0673V18.4423C13.0673 18.7361 12.9643 18.9858 12.7584 19.1915C12.5526 19.3971 12.3026 19.5 12.0085 19.5C11.7144 19.5 11.4631 19.3962 11.2548 19.1887C11.0465 18.9811 10.9423 18.7291 10.9423 18.4327V15.7211Z"
    />
  </svg>
`,Gee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_977_8078)">
      <path
        d="M20 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H20C21.1 21 22 20.1 22 19V5C22 3.9 21.1 3 20 3ZM20 5V8H5V5H20ZM15 19H10V10H15V19ZM5 10H8V19H5V10ZM17 19V10H20V19H17Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_977_8078">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Jee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <g clip-path="url(#clip0_992_5547)">
      <path
        d="M5 5.5C5 6.33 5.67 7 6.5 7H10.5V17.5C10.5 18.33 11.17 19 12 19C12.83 19 13.5 18.33 13.5 17.5V7H17.5C18.33 7 19 6.33 19 5.5C19 4.67 18.33 4 17.5 4H6.5C5.67 4 5 4.67 5 5.5Z"
      />
    </g>
    <defs>
      <clipPath id="clip0_992_5547">
        <rect width="24" height="24" />
      </clipPath>
    </defs>
  </svg>
`,Zee=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      d="M5.66936 16.3389L9.39244 12.6158C9.54115 12.4671 9.71679 12.3937 9.91936 12.3957C10.1219 12.3976 10.2975 12.4761 10.4463 12.6312C10.5847 12.7823 10.654 12.9585 10.654 13.1599C10.654 13.3613 10.5847 13.5363 10.4463 13.6851L6.32704 17.8197C6.14627 18.0004 5.93538 18.0908 5.69436 18.0908C5.45333 18.0908 5.24243 18.0004 5.06166 17.8197L3.01744 15.7754C2.87899 15.637 2.81136 15.4629 2.81456 15.2533C2.81776 15.0437 2.88859 14.8697 3.02706 14.7312C3.16551 14.5928 3.34008 14.5235 3.55076 14.5235C3.76144 14.5235 3.93494 14.5928 4.07126 14.7312L5.66936 16.3389ZM5.66936 8.72359L9.39244 5.00049C9.54115 4.85177 9.71679 4.77838 9.91936 4.78031C10.1219 4.78223 10.2975 4.86075 10.4463 5.01586C10.5847 5.16691 10.654 5.34314 10.654 5.54454C10.654 5.74592 10.5847 5.92097 10.4463 6.06969L6.32704 10.2043C6.14627 10.3851 5.93538 10.4755 5.69436 10.4755C5.45333 10.4755 5.24243 10.3851 5.06166 10.2043L3.01744 8.16009C2.87899 8.02162 2.81136 7.84759 2.81456 7.63799C2.81776 7.42837 2.88859 7.25433 3.02706 7.11586C3.16551 6.97741 3.34008 6.90819 3.55076 6.90819C3.76144 6.90819 3.93494 6.97741 4.07126 7.11586L5.66936 8.72359ZM13.7597 16.5581C13.5472 16.5581 13.3691 16.4862 13.2253 16.3424C13.0816 16.1986 13.0097 16.0204 13.0097 15.8078C13.0097 15.5952 13.0816 15.4171 13.2253 15.2735C13.3691 15.13 13.5472 15.0582 13.7597 15.0582H20.7597C20.9722 15.0582 21.1503 15.1301 21.2941 15.2739C21.4378 15.4177 21.5097 15.5959 21.5097 15.8085C21.5097 16.0211 21.4378 16.1992 21.2941 16.3427C21.1503 16.4863 20.9722 16.5581 20.7597 16.5581H13.7597ZM13.7597 8.94276C13.5472 8.94276 13.3691 8.87085 13.2253 8.72704C13.0816 8.58324 13.0097 8.40504 13.0097 8.19244C13.0097 7.97985 13.0816 7.80177 13.2253 7.65819C13.3691 7.5146 13.5472 7.44281 13.7597 7.44281H20.7597C20.9722 7.44281 21.1503 7.51471 21.2941 7.65851C21.4378 7.80233 21.5097 7.98053 21.5097 8.19311C21.5097 8.40571 21.4378 8.5838 21.2941 8.72739C21.1503 8.87097 20.9722 8.94276 20.7597 8.94276H13.7597Z"
    />
  </svg>
`,PR=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="32"
    height="32"
    viewBox="0 0 24 24"
  >
    <path
      fill="currentColor"
      d="M7 19v-.808L13.096 12L7 5.808V5h10v1.25H9.102L14.727 12l-5.625 5.77H17V19z"
    />
  </svg>
`,BR=`
  <svg
    xmlns="http://www.w3.org/2000/svg"
    height="24px"
    viewBox="0 -960 960 960"
    width="24px"
  >
    <path
      d="m644-428-58-58q9-47-27-88t-93-32l-58-58q17-8 34.5-12t37.5-4q75 0 127.5 52.5T660-500q0 20-4 37.5T644-428Zm128 126-58-56q38-29 67.5-63.5T832-500q-50-101-143.5-160.5T480-720q-29 0-57 4t-55 12l-62-62q41-17 84-25.5t90-8.5q151 0 269 83.5T920-500q-23 59-60.5 109.5T772-302Zm20 246L624-222q-35 11-70.5 16.5T480-200q-151 0-269-83.5T40-500q21-53 53-98.5t73-81.5L56-792l56-56 736 736-56 56ZM222-624q-29 26-53 57t-41 67q50 101 143.5 160.5T480-280q20 0 39-2.5t39-5.5l-36-38q-11 3-21 4.5t-21 1.5q-75 0-127.5-52.5T300-500q0-11 1.5-21t4.5-21l-84-82Zm319 93Zm-151 75Z"
    />
  </svg>
`,Yee={[St.CodeMirror]:{theme:eV,languages:zH,expandIcon:LR,searchIcon:RR,clearSearchIcon:DR,searchPlaceholder:"Search language",noResultText:"No result",previewToggleIcon:n=>n?BS:BR}},Xee=mt([],"FeaturesCtx"),Qee=mt({},"CrepeCtx");function ete(n){return n.get("CrepeCtx")}function Iy(n){return n.use("FeaturesCtx")}function Ps(n){return e=>{Iy(e).update(t=>t.includes(n)?t:[...t,n])}}function HR(n){return n.$from.parent.type.name==="code_block"}function VR(n){var e;const t=(e=n.$from.node(n.$from.depth-1))==null?void 0:e.type;return(t==null?void 0:t.name)==="list_item"}var FR=n=>{throw TypeError(n)},jR=(n,e,t)=>e.has(n)||FR("Cannot "+t),gf=(n,e,t)=>(jR(n,e,"read from private field"),t?t.call(n):e.get(n)),dA=(n,e,t)=>e.has(n)?FR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),tte=(n,e,t,r)=>(jR(n,e,"write to private field"),e.set(n,t),t),vc,bg;class $R{constructor(){dA(this,vc,[]),this.clear=()=>(tte(this,vc,[]),this),dA(this,bg,e=>{const t={group:e,addItem:(r,i)=>{const s={...i,key:r};return e.items.push(s),t},clear:()=>(e.items=[],t)};return t}),this.addGroup=(e,t)=>{const i={key:e,label:t,items:[]};return gf(this,vc).push(i),gf(this,bg).call(this,i)},this.getGroup=e=>{const t=gf(this,vc).find(r=>r.key===e);if(!t)throw new Error(`Group with key ${e} not found`);return gf(this,bg).call(this,t)},this.build=()=>gf(this,vc)}}vc=new WeakMap;bg=new WeakMap;function nte(n,e,t){var r,i,s,o,l,a,c,u,f,p,g,y,v,k,x,_,M,T,S,A,I,B,R,K,U,z,oe,ne,ve,ke,Se,Te,Ge,Xe,He,j,Ze,sn,st,Nt,ie,rt,xe,he,_t,De,N,H,W,q,Y,Q,pe,me,ge,ce,qe,_e,ye,Ue,nt,vt,ft,hn,Zt,gn,$t,$n,yn,Yt,Mt,zn,kn,rs,Dr,Li,bn,is,Oo,an,Cn,Dn,ui,Bs,El,Al,Rt,pr,In,Ol,Di,ss,Lo,nr,Hs,Vs,Fs,zt,Do,Fe,F,ue,Pe,Lt,ut,Wt,On,mr,fi,Io,dn,Ll,Dl,Mp,nc,Il,Tp,Ku,Gu;const js=t&&Iy(t).get(),Ep=js==null?void 0:js.includes(St.Latex),Ap=js==null?void 0:js.includes(St.ImageBlock),Nl=js==null?void 0:js.includes(St.Table),Rl=new $R;if((e==null?void 0:e.textGroup)!==null){const bt=Rl.addGroup("text",(i=(r=e==null?void 0:e.textGroup)==null?void 0:r.label)!=null?i:"Text");((s=e==null?void 0:e.textGroup)==null?void 0:s.text)!==null&&bt.addItem("text",{label:(a=(l=(o=e==null?void 0:e.textGroup)==null?void 0:o.text)==null?void 0:l.label)!=null?a:"Text",icon:(f=(u=(c=e==null?void 0:e.textGroup)==null?void 0:c.text)==null?void 0:u.icon)!=null?f:Jee,onRun:je=>{const We=je.get(Be),kt=Xi.type(je);We.call(qn.key),We.call(Gs.key,{nodeType:kt})}}),((p=e==null?void 0:e.textGroup)==null?void 0:p.h1)!==null&&bt.addItem("h1",{label:(v=(y=(g=e==null?void 0:e.textGroup)==null?void 0:g.h1)==null?void 0:y.label)!=null?v:"Heading 1",icon:(_=(x=(k=e==null?void 0:e.textGroup)==null?void 0:k.h1)==null?void 0:x.icon)!=null?_:Pee,onRun:je=>{const We=je.get(Be),kt=ri.type(je);We.call(qn.key),We.call(Gs.key,{nodeType:kt,attrs:{level:1}})}}),((M=e==null?void 0:e.textGroup)==null?void 0:M.h2)!==null&&bt.addItem("h2",{label:(A=(S=(T=e==null?void 0:e.textGroup)==null?void 0:T.h2)==null?void 0:S.label)!=null?A:"Heading 2",icon:(R=(B=(I=e==null?void 0:e.textGroup)==null?void 0:I.h2)==null?void 0:B.icon)!=null?R:Bee,onRun:je=>{const We=je.get(Be),kt=ri.type(je);We.call(qn.key),We.call(Gs.key,{nodeType:kt,attrs:{level:2}})}}),((K=e==null?void 0:e.textGroup)==null?void 0:K.h3)!==null&&bt.addItem("h3",{label:(oe=(z=(U=e==null?void 0:e.textGroup)==null?void 0:U.h3)==null?void 0:z.label)!=null?oe:"Heading 3",icon:(ke=(ve=(ne=e==null?void 0:e.textGroup)==null?void 0:ne.h3)==null?void 0:ve.icon)!=null?ke:Hee,onRun:je=>{const We=je.get(Be),kt=ri.type(je);We.call(qn.key),We.call(Gs.key,{nodeType:kt,attrs:{level:3}})}}),((Se=e==null?void 0:e.textGroup)==null?void 0:Se.h4)!==null&&bt.addItem("h4",{label:(Xe=(Ge=(Te=e==null?void 0:e.textGroup)==null?void 0:Te.h4)==null?void 0:Ge.label)!=null?Xe:"Heading 4",icon:(Ze=(j=(He=e==null?void 0:e.textGroup)==null?void 0:He.h4)==null?void 0:j.icon)!=null?Ze:Vee,onRun:je=>{const We=je.get(Be),kt=ri.type(je);We.call(qn.key),We.call(Gs.key,{nodeType:kt,attrs:{level:4}})}}),((sn=e==null?void 0:e.textGroup)==null?void 0:sn.h5)!==null&&bt.addItem("h5",{label:(ie=(Nt=(st=e==null?void 0:e.textGroup)==null?void 0:st.h5)==null?void 0:Nt.label)!=null?ie:"Heading 5",icon:(he=(xe=(rt=e==null?void 0:e.textGroup)==null?void 0:rt.h5)==null?void 0:xe.icon)!=null?he:Fee,onRun:je=>{const We=je.get(Be),kt=ri.type(je);We.call(qn.key),We.call(Gs.key,{nodeType:kt,attrs:{level:5}})}}),((_t=e==null?void 0:e.textGroup)==null?void 0:_t.h6)!==null&&bt.addItem("h6",{label:(H=(N=(De=e==null?void 0:e.textGroup)==null?void 0:De.h6)==null?void 0:N.label)!=null?H:"Heading 6",icon:(Y=(q=(W=e==null?void 0:e.textGroup)==null?void 0:W.h6)==null?void 0:q.icon)!=null?Y:jee,onRun:je=>{const We=je.get(Be),kt=ri.type(je);We.call(qn.key),We.call(Gs.key,{nodeType:kt,attrs:{level:6}})}}),((Q=e==null?void 0:e.textGroup)==null?void 0:Q.quote)!==null&&bt.addItem("quote",{label:(ge=(me=(pe=e==null?void 0:e.textGroup)==null?void 0:pe.quote)==null?void 0:me.label)!=null?ge:"Quote",icon:(_e=(qe=(ce=e==null?void 0:e.textGroup)==null?void 0:ce.quote)==null?void 0:qe.icon)!=null?_e:Uee,onRun:je=>{const We=je.get(Be),kt=Bu.type(je);We.call(qn.key),We.call(Pf.key,{nodeType:kt})}}),((ye=e==null?void 0:e.textGroup)==null?void 0:ye.divider)!==null&&bt.addItem("divider",{label:(vt=(nt=(Ue=e==null?void 0:e.textGroup)==null?void 0:Ue.divider)==null?void 0:nt.label)!=null?vt:"Divider",icon:(Zt=(hn=(ft=e==null?void 0:e.textGroup)==null?void 0:ft.divider)==null?void 0:hn.icon)!=null?Zt:Ree,onRun:je=>{const We=je.get(Be),kt=Hu.type(je);We.call(qn.key),We.call(Bf.key,{nodeType:kt})}})}if((e==null?void 0:e.listGroup)!==null){const bt=Rl.addGroup("list",($t=(gn=e==null?void 0:e.listGroup)==null?void 0:gn.label)!=null?$t:"List");(($n=e==null?void 0:e.listGroup)==null?void 0:$n.bulletList)!==null&&bt.addItem("bullet-list",{label:(Mt=(Yt=(yn=e==null?void 0:e.listGroup)==null?void 0:yn.bulletList)==null?void 0:Yt.label)!=null?Mt:"Bullet List",icon:(rs=(kn=(zn=e==null?void 0:e.listGroup)==null?void 0:zn.bulletList)==null?void 0:kn.icon)!=null?rs:Lee,onRun:je=>{const We=je.get(Be),kt=Xa.type(je);We.call(qn.key),We.call(Pf.key,{nodeType:kt})}}),((Dr=e==null?void 0:e.listGroup)==null?void 0:Dr.orderedList)!==null&&bt.addItem("ordered-list",{label:(is=(bn=(Li=e==null?void 0:e.listGroup)==null?void 0:Li.orderedList)==null?void 0:bn.label)!=null?is:"Ordered List",icon:(Cn=(an=(Oo=e==null?void 0:e.listGroup)==null?void 0:Oo.orderedList)==null?void 0:an.icon)!=null?Cn:qee,onRun:je=>{const We=je.get(Be),kt=Qa.type(je);We.call(qn.key),We.call(Pf.key,{nodeType:kt})}}),((Dn=e==null?void 0:e.listGroup)==null?void 0:Dn.taskList)!==null&&bt.addItem("task-list",{label:(El=(Bs=(ui=e==null?void 0:e.listGroup)==null?void 0:ui.taskList)==null?void 0:Bs.label)!=null?El:"Task List",icon:(pr=(Rt=(Al=e==null?void 0:e.listGroup)==null?void 0:Al.taskList)==null?void 0:Rt.icon)!=null?pr:Zee,onRun:je=>{const We=je.get(Be),kt=Qi.type(je);We.call(qn.key),We.call(Pf.key,{nodeType:kt,attrs:{checked:!1}})}})}if((e==null?void 0:e.advancedGroup)!==null){const bt=Rl.addGroup("advanced",(Ol=(In=e==null?void 0:e.advancedGroup)==null?void 0:In.label)!=null?Ol:"Advanced");((Di=e==null?void 0:e.advancedGroup)==null?void 0:Di.image)!==null&&Ap&&bt.addItem("image",{label:(nr=(Lo=(ss=e==null?void 0:e.advancedGroup)==null?void 0:ss.image)==null?void 0:Lo.label)!=null?nr:"Image",icon:(Fs=(Vs=(Hs=e==null?void 0:e.advancedGroup)==null?void 0:Hs.image)==null?void 0:Vs.icon)!=null?Fs:Cv,onRun:je=>{const We=je.get(Be),kt=py.type(je);We.call(qn.key),We.call(Bf.key,{nodeType:kt})}}),((zt=e==null?void 0:e.advancedGroup)==null?void 0:zt.codeBlock)!==null&&bt.addItem("code",{label:(F=(Fe=(Do=e==null?void 0:e.advancedGroup)==null?void 0:Do.codeBlock)==null?void 0:Fe.label)!=null?F:"Code",icon:(Lt=(Pe=(ue=e==null?void 0:e.advancedGroup)==null?void 0:ue.codeBlock)==null?void 0:Pe.icon)!=null?Lt:IR,onRun:je=>{const We=je.get(Be),kt=Ls.type(je);We.call(qn.key),We.call(Gs.key,{nodeType:kt})}}),((ut=e==null?void 0:e.advancedGroup)==null?void 0:ut.table)!==null&&Nl&&bt.addItem("table",{label:(mr=(On=(Wt=e==null?void 0:e.advancedGroup)==null?void 0:Wt.table)==null?void 0:On.label)!=null?mr:"Table",icon:(dn=(Io=(fi=e==null?void 0:e.advancedGroup)==null?void 0:fi.table)==null?void 0:Io.icon)!=null?dn:Gee,onRun:je=>{const We=je.get(Be),kt=je.get(Gt);We.call(qn.key);const{from:Zu}=kt.state.selection;We.call(Bf.key,{nodeType:JC(je,3,3)}),We.call(p5.key,{pos:Zu})}}),((Ll=e==null?void 0:e.advancedGroup)==null?void 0:Ll.math)!==null&&Ep&&bt.addItem("math",{label:(nc=(Mp=(Dl=e==null?void 0:e.advancedGroup)==null?void 0:Dl.math)==null?void 0:Mp.label)!=null?nc:"Math",icon:(Ku=(Tp=(Il=e==null?void 0:e.advancedGroup)==null?void 0:Il.math)==null?void 0:Tp.icon)!=null?Ku:PR,onRun:je=>{const We=je.get(Be),kt=Ls.type(je);We.call(qn.key),We.call(Bf.key,{nodeType:kt,attrs:{language:"LaTex"}})}})}(Gu=e==null?void 0:e.buildMenu)==null||Gu.call(e,Rl);let Pl=Rl.build();n&&(Pl=Pl.map(bt=>{const je=bt.items.filter(We=>We.label.toLowerCase().includes(n.toLowerCase()));return{...bt,items:je}}).filter(bt=>bt.items.length>0));const Ju=Pl.flatMap(bt=>bt.items);return Ju.forEach((bt,je)=>{Object.assign(bt,{index:je})}),Pl.reduce((bt,je)=>{const We=bt+je.items.length;return Object.assign(je,{range:[bt,We]}),We},0),{groups:Pl,size:Ju.length}}const rte=tr({props:{ctx:{type:Object,required:!0},show:{type:Object,required:!0},filter:{type:Object,required:!0},hide:{type:Function,required:!0},config:{type:Object,required:!1}},setup({ctx:n,show:e,filter:t,hide:r,config:i}){const s=Ve(),o=Cu(()=>nte(t.value,i,n)),l=Ve(0),a=Ve({x:-999,y:-999}),c=v=>{const{x:k,y:x}=v;a.value={x:k,y:x}};Oa([o,e],()=>{const{size:v}=o.value;v===0&&e.value?r():l.value>=v&&(l.value=0)});const u=(v,k)=>{const x=l.value,_=typeof v=="function"?v(x):v;k==null||k(_),l.value=_},f=v=>{var k,x;const _=(k=s.value)==null?void 0:k.querySelector(`[data-index="${v}"]`),M=(x=s.value)==null?void 0:x.querySelector(".menu-groups");!_||!M||(M.scrollTop=_.offsetTop-M.offsetTop)},p=v=>{const k=o.value.groups.flatMap(x=>x.items).at(v);k&&n&&k.onRun(n),r()},g=v=>{const{size:k,groups:x}=o.value;if(v.key==="Escape"){v.preventDefault(),r==null||r();return}if(v.key==="ArrowDown")return v.preventDefault(),u(_=>_<k-1?_+1:_,f);if(v.key==="ArrowUp")return v.preventDefault(),u(_=>_<=0?_:_-1,f);if(v.key==="ArrowLeft")return v.preventDefault(),u(_=>{const M=x.find(S=>S.range[0]<=_&&S.range[1]>_);if(!M)return _;const T=x[x.indexOf(M)-1];return T?T.range[1]-1:_},f);if(v.key==="ArrowRight")return v.preventDefault(),u(_=>{const M=x.find(S=>S.range[0]<=_&&S.range[1]>_);if(!M)return _;const T=x[x.indexOf(M)+1];return T?T.range[0]:_},f);v.key==="Enter"&&(v.preventDefault(),p(l.value))},y=v=>k=>{const x=a.value;if(!x)return;const{x:_,y:M}=k;_===x.x&&M===x.y||u(v)};return Fu(()=>{e.value?window.addEventListener("keydown",g,{capture:!0}):window.removeEventListener("keydown",g,{capture:!0})}),fp(()=>{window.removeEventListener("keydown",g,{capture:!0})}),()=>J("div",{ref:s,onPointerdown:v=>v.preventDefault()},J("nav",{class:"tab-group"},J("ul",null,o.value.groups.map(v=>J("li",{key:v.key,onPointerdown:()=>u(v.range[0],f),class:l.value>=v.range[0]&&l.value<v.range[1]?"selected":""},v.label)))),J("div",{class:"menu-groups",onPointermove:c},o.value.groups.map(v=>J("div",{key:v.key,class:"menu-group"},J("h6",null,v.label),J("ul",null,v.items.map(k=>J("li",{key:k.key,"data-index":k.index,class:l.value===k.index?"hover":"",onPointerenter:y(k.index),onPointerdown:()=>{var x,_;(_=(x=s.value)==null?void 0:x.querySelector(`[data-index="${k.index}"]`))==null||_.classList.add("active")},onPointerup:()=>{var x,_;(_=(x=s.value)==null?void 0:x.querySelector(`[data-index="${k.index}"]`))==null||_.classList.remove("active"),p(k.index)}},J(Su,{icon:k.icon}),J("span",null,k.label))))))))}});var zR=n=>{throw TypeError(n)},WR=(n,e,t)=>e.has(n)||zR("Cannot "+t),Ni=(n,e,t)=>(WR(n,e,"read from private field"),t?t.call(n):e.get(n)),yf=(n,e,t)=>e.has(n)?zR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),zl=(n,e,t,r)=>(WR(n,e,"write to private field"),e.set(n,t),t),Gf,wg,vg,Ys,kc;const qR=OU("CREPE_MENU"),HS=It({show:()=>{},hide:()=>{}},"menuAPICtx");function ite(n,e){n.set(qR.key,{view:t=>new ste(n,t,e)})}class ste{constructor(e,t,r){yf(this,Gf),yf(this,wg),yf(this,vg),yf(this,Ys),yf(this,kc,null),this.update=u=>{Ni(this,Ys).update(u)},this.show=u=>{zl(this,kc,u),Ni(this,vg).value="",Ni(this,Ys).show()},this.hide=()=>{zl(this,kc,null),Ni(this,Ys).hide()},this.destroy=()=>{Ni(this,Ys).destroy(),Ni(this,wg).unmount(),Ni(this,Gf).remove()};const i=document.createElement("div");i.classList.add("milkdown-slash-menu");const s=Ve(!1),o=Ve("");zl(this,vg,o);const l=this.hide,a=es(rte,{ctx:e,config:r,show:s,filter:o,hide:l});zl(this,wg,a),a.mount(i),zl(this,Gf,i);const c=this;zl(this,Ys,new LU({content:Ni(this,Gf),debounce:20,shouldShow(u){if(HR(u.state.selection)||VR(u.state.selection))return!1;const f=this.getContent(u,g=>["paragraph","heading"].includes(g.type.name));if(f==null||!ote(u.state.selection))return!1;const p=Ni(c,kc);if(o.value=f.startsWith("/")?f.slice(1):f,typeof p=="number"){const g=u.state.doc.nodeSize-2,y=Math.min(p,g);return u.state.doc.resolve(y).node()!==u.state.doc.resolve(u.state.selection.from).node()?(zl(c,kc,null),!1):!0}return!!f.startsWith("/")},offset:10})),Ni(this,Ys).onShow=()=>{s.value=!0},Ni(this,Ys).onHide=()=>{s.value=!1},this.update(t),e.set(HS.key,{show:u=>this.show(u),hide:()=>this.hide()})}}Gf=new WeakMap;wg=new WeakMap;vg=new WeakMap;Ys=new WeakMap;kc=new WeakMap;function ote(n){if(!(n instanceof ze))return!1;const{$head:e}=n,t=e.parent;return e.parentOffset===t.content.size}const lte=tr({props:{onAdd:{type:Function,required:!0},addIcon:{type:String,required:!0},handleIcon:{type:String,required:!0}},setup(n){const e=Ve();return()=>J(Zn,null,J("div",{ref:e,class:"operation-item",onPointerdown:t=>{var r;t.preventDefault(),t.stopPropagation(),(r=e.value)==null||r.classList.add("active")},onPointerup:t=>{var r;t.preventDefault(),t.stopPropagation(),(r=e.value)==null||r.classList.remove("active"),n.onAdd()}},J(Su,{icon:n.addIcon})),J("div",{class:"operation-item"},J(Su,{icon:n.handleIcon})))}});var UR=n=>{throw TypeError(n)},KR=(n,e,t)=>e.has(n)||UR("Cannot "+t),Wl=(n,e,t)=>(KR(n,e,"read from private field"),t?t.call(n):e.get(n)),km=(n,e,t)=>e.has(n)?UR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Cm=(n,e,t,r)=>(KR(n,e,"write to private field"),e.set(n,t),t),kg,Zl,Cg,Sg;class ate{constructor(e,t){km(this,kg),km(this,Zl),km(this,Cg),km(this,Sg),this.update=()=>{Wl(this,Zl).update()},this.destroy=()=>{Wl(this,Zl).destroy(),Wl(this,kg).remove(),Wl(this,Cg).unmount()},this.onAdd=()=>{const c=Wl(this,Sg),u=c.get(Gt);u.hasFocus()||u.focus();const{state:f,dispatch:p}=u,g=Wl(this,Zl).active;if(!g)return;const v=g.$pos.pos+g.node.nodeSize;let k=f.tr.insert(v,Xi.type(c).create());k=k.setSelection(ze.near(k.doc.resolve(v))),p(k.scrollIntoView()),Wl(this,Zl).hide(),c.get(HS.key).show(k.selection.from)};var r,i,s;Cm(this,Sg,e);const o=document.createElement("div");o.classList.add("milkdown-block-handle");const l=es(lte,{onAdd:this.onAdd,addIcon:(r=t==null?void 0:t.handleAddIcon)!=null?r:Sv,handleIcon:(i=t==null?void 0:t.handleDragIcon)!=null?i:Wee});l.mount(o),Cm(this,Cg,l),Cm(this,kg,o);const a=(s=t==null?void 0:t.blockHandle)!=null?s:{};Cm(this,Zl,new Ez({ctx:e,content:o,getOffset:()=>16,getPlacement:({active:c,blockDom:u})=>{if(c.node.type.name==="heading")return"left";let f=0;c.node.descendants(T=>{f+=T.childCount});const p=c.el,g=p.getBoundingClientRect(),y=u.getBoundingClientRect(),v=window.getComputedStyle(p),k=Number.parseInt(v.paddingTop,10)||0,x=Number.parseInt(v.paddingBottom,10)||0,_=g.height-k-x,M=y.height;return f>2||M<_?"left-start":"left"},...a})),this.update()}}kg=new WeakMap;Zl=new WeakMap;Cg=new WeakMap;Sg=new WeakMap;function cte(n,e){n.set(Y0.key,{filterNodes:t=>!Ms(i=>["table","blockquote","math_inline"].includes(i.type.name))(t)}),n.set(ey.key,{view:()=>new ate(n,e)})}const ute=(n,e)=>{n.config(Ps(St.BlockEdit)).config(t=>cte(t,e)).config(t=>ite(t,e)).use(HS).use(ey).use(qR)},fte=(n,e={})=>{n.config(Ps(St.CodeMirror)).config(t=>{const{languages:r=[],theme:i}=e,s=[Iu.of(xN.concat(gZ)),_X];i&&s.push(i),e.extensions&&s.push(...e.extensions),t.update(kp.key,o=>{var l;return{extensions:s,languages:r,expandIcon:e.expandIcon||LR,searchIcon:e.searchIcon||RR,clearSearchIcon:e.clearSearchIcon||DR,searchPlaceholder:e.searchPlaceholder||"Search language",copyText:e.copyText||"Copy",copyIcon:e.copyIcon||NR,onCopy:e.onCopy||(()=>{}),noResultText:e.noResultText||"No result",renderLanguage:e.renderLanguage||o.renderLanguage,renderPreview:e.renderPreview||o.renderPreview,previewToggleButton:a=>{var c,u;const f=((c=e.previewToggleIcon)==null?void 0:c.call(e,a))||(a?BS:BR),p=((u=e.previewToggleText)==null?void 0:u.call(e,a))||(a?"Edit":"Hide");return[f,p].map(g=>g.trim()).join(" ")},previewLabel:e.previewLabel||o.previewLabel,previewLoading:e.previewLoading||o.previewLoading,previewOnlyByDefault:(l=e.previewOnlyByDefault)!=null?l:o.previewOnlyByDefault}})}).use(FZ)},hte=(n,e)=>{if(n.config(Ps(St.Cursor)).config(r=>{r.update(xy.key,()=>{var i,s;return{class:"crepe-drop-cursor",width:(i=e==null?void 0:e.width)!=null?i:4,color:(s=e==null?void 0:e.color)!=null?s:!1}})}).use(qX),(e==null?void 0:e.virtual)===!1)return;const t=UX();n.use(An(()=>t))},dte=(n,e)=>{n.config(Ps(St.ImageBlock)).config(t=>{t.update(_y.key,r=>{var i,s,o,l,a,c;return{uploadButton:(i=e==null?void 0:e.inlineUploadButton)!=null?i:"Upload",imageIcon:(s=e==null?void 0:e.inlineImageIcon)!=null?s:Cv,confirmButton:(o=e==null?void 0:e.inlineConfirmButton)!=null?o:PS,uploadPlaceholderText:(l=e==null?void 0:e.inlineUploadPlaceholderText)!=null?l:"or paste link",onUpload:(c=(a=e==null?void 0:e.inlineOnUpload)!=null?a:e==null?void 0:e.onUpload)!=null?c:r.onUpload,proxyDomURL:e==null?void 0:e.proxyDomURL}}),t.update(dy.key,r=>{var i,s,o,l,a,c,u,f;return{uploadButton:(i=e==null?void 0:e.blockUploadButton)!=null?i:"Upload file",imageIcon:(s=e==null?void 0:e.blockImageIcon)!=null?s:Cv,captionIcon:(o=e==null?void 0:e.blockCaptionIcon)!=null?o:Dee,confirmButton:(l=e==null?void 0:e.blockConfirmButton)!=null?l:"Confirm",captionPlaceholderText:(a=e==null?void 0:e.blockCaptionPlaceholderText)!=null?a:"Write Image Caption",uploadPlaceholderText:(c=e==null?void 0:e.blockUploadPlaceholderText)!=null?c:"or paste link",onUpload:(f=(u=e==null?void 0:e.blockOnUpload)!=null?u:e==null?void 0:e.onUpload)!=null?f:r.onUpload,proxyDomURL:e==null?void 0:e.proxyDomURL}})}).use(yK).use(oQ)},pte=Ls.extendSchema(n=>e=>{const t=n(e);return{...t,toMarkdown:{match:t.toMarkdown.match,runner:(r,i)=>{var s,o;if(((s=i.attrs.language)!=null?s:"").toLowerCase()==="latex")r.addNode("math",void 0,((o=i.content.firstChild)==null?void 0:o.text)||"");else return t.toMarkdown.runner(r,i)}}}}),Jf="math_inline",Cd=vn(Jf,()=>({group:"inline",inline:!0,draggable:!0,atom:!0,attrs:{value:{default:""}},parseDOM:[{tag:`span[data-type="${Jf}"]`,getAttrs:n=>{var e;return{value:(e=n.dataset.value)!=null?e:""}}}],toDOM:n=>{const e=n.attrs.value,t=document.createElement("span");return t.dataset.type=Jf,t.dataset.value=e,CA.render(e,t,{throwOnError:!1}),t},parseMarkdown:{match:n=>n.type==="inlineMath",runner:(n,e,t)=>{n.addNode(t,{value:e.value})}},toMarkdown:{match:n=>n.type.name===Jf,runner:(n,e)=>{n.addNode("inlineMath",void 0,e.attrs.value)}}})),GR=et("ToggleLatex",n=>()=>(e,t)=>{const{hasNode:r,pos:i,target:s}=VL(e,Cd.type(n)),{selection:o,doc:l,tr:a}=e;if(!r){const g=l.textBetween(o.from,o.to);let y=a.replaceSelectionWith(Cd.type(n).create({value:g}));return t&&t(y.setSelection(Ke.create(y.doc,o.from))),!0}const{from:c,to:u}=o;if(!s||i<0)return!1;let f=a.delete(i,i+1);const p=s.attrs.value;return f=f.insertText(p,i),t&&t(f.setSelection(ze.create(f.doc,c,u+p.length-1))),!0}),pA=Ty("INLINE_LATEX"),mte=tr({props:{config:{type:Object,required:!0},innerView:{type:Object,required:!0},updateValue:{type:Object,required:!0}},setup(n){const e=r=>{if(!(!r||!(r instanceof HTMLElement))){for(;r.firstChild;)r.removeChild(r.firstChild);n.innerView.value&&r.appendChild(n.innerView.value.dom)}},t=r=>{r.preventDefault(),n.updateValue.value()};return()=>J("div",{class:"container"},n.innerView&&J("div",{ref:e}),J("button",{onPointerdown:t},J(Su,{icon:n.config.inlineEditConfirm})))}});var JR=n=>{throw TypeError(n)},ZR=(n,e,t)=>e.has(n)||JR("Cannot "+t),Rn=(n,e,t)=>(ZR(n,e,"read from private field"),t?t.call(n):e.get(n)),Ho=(n,e,t)=>e.has(n)?JR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Sm=(n,e,t,r)=>(ZR(n,e,"write to private field"),e.set(n,t),t),Zf,Cc,xg,Yl,Yf,Xf,_v,Mv;class gte{constructor(e,t,r){this.ctx=e,Ho(this,Zf),Ho(this,Cc),Ho(this,xg),Ho(this,Yl,n0(null)),Ho(this,Yf,n0(()=>{})),Ho(this,Xf),Ho(this,_v,()=>{Rn(this,Yl).value&&(Rn(this,Yl).value.destroy(),Rn(this,Yl).value=null)}),Ho(this,Mv,s=>{const l=(()=>{const{selection:a,schema:c}=s.state;if(a.empty||!(a instanceof Ke))return!1;const u=a.node;if(u.type.name!==Jf)return!1;const f=a.from,p=c.nodes.paragraph.create(null,c.text(u.attrs.value)),g=new xk(Rn(this,xg),{state:na.create({doc:p,schema:new dL({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return["p",0]}},text:{group:"inline"}}}),plugins:[eD({"Mod-z":Cy,"Mod-Z":xu,"Mod-y":xu,Enter:()=>(Rn(this,Yf).value(),!0)})]})});return Rn(this,Yl).value=g,Rn(this,Yf).value=()=>{const{tr:y}=s.state;y.setNodeAttribute(f,"value",g.state.doc.textContent),s.dispatch(y),requestAnimationFrame(()=>{s.focus()})},!0})();return l||Rn(this,_v).call(this),l}),this.update=(s,o)=>{Rn(this,Cc).update(s,o)},this.destroy=()=>{Rn(this,Xf).unmount(),Rn(this,Cc).destroy(),Rn(this,Zf).remove()};const i=document.createElement("div");i.className="milkdown-latex-inline-edit",Sm(this,Zf,i),Sm(this,Xf,es(mte,{config:r,innerView:Rn(this,Yl),updateValue:Rn(this,Yf)})),Rn(this,Xf).mount(i),Sm(this,Cc,new My({debounce:0,content:Rn(this,Zf),shouldShow:Rn(this,Mv),offset:10,floatingUIOptions:{placement:"bottom"}})),Rn(this,Cc).update(t),Sm(this,xg,document.createElement("div"))}}Zf=new WeakMap;Cc=new WeakMap;xg=new WeakMap;Yl=new WeakMap;Yf=new WeakMap;Xf=new WeakMap;_v=new WeakMap;Mv=new WeakMap;const yte=hr(n=>bF(/(?:\$)([^$]+)(?:\$)$/,Cd.type(n),{getAttr:e=>{var t;return{value:(t=e[1])!=null?t:""}}})),bte=hr(n=>ak(/^\$\$[\s\n]$/,Ls.type(n),()=>({language:"LaTeX"}))),wte=Rs("remarkMath",()=>z3);function vte(n){return Ka(n,"math",(e,t,r)=>{const{value:i}=e,s={type:"code",lang:"LaTeX",value:i};r.children.splice(t,1,s)})}const kte=Rs("remarkMathBlock",()=>()=>vte),Cte=(n,e)=>{n.config(Ps(St.Latex)).config(t=>{if(!Iy(t).get().includes(St.CodeMirror))throw new Error("You need to enable CodeMirror to use LaTeX feature");t.update(kp.key,s=>({...s,renderPreview:(o,l,a)=>{if(o.toLowerCase()==="latex"&&l.length>0)return Ste(l,e==null?void 0:e.katexOptions);const c=s.renderPreview;return c(o,l,a)}})),t.set(pA.key,{view:s=>{var o;return new gte(t,s,{inlineEditConfirm:(o=e==null?void 0:e.inlineEditConfirm)!=null?o:PS,...e})}})}).use(wte).use(kte).use(Cd).use(pA).use(yte).use(bte).use(pte).use(GR)};function Ste(n,e){return CA.renderToString(n,{...e,throwOnError:!1,displayMode:!0})}const xte=(n,e)=>{n.config(Ps(St.LinkTooltip)).config(BQ).config(t=>{t.update(Eu.key,r=>{var i,s,o,l,a,c;return{...r,linkIcon:(i=e==null?void 0:e.linkIcon)!=null?i:NR,editButton:(s=e==null?void 0:e.editButton)!=null?s:BS,removeButton:(o=e==null?void 0:e.removeButton)!=null?o:xv,confirmButton:(l=e==null?void 0:e.confirmButton)!=null?l:PS,inputPlaceholder:(a=e==null?void 0:e.inputPlaceholder)!=null?a:"Paste link...",onCopyLink:(c=e==null?void 0:e.onCopyLink)!=null?c:()=>{}}})}).use(HQ)};function _te(n,e){n.set(Ay.key,{renderLabel:({label:t,listType:r,checked:i})=>{var s,o,l;return i==null?r==="bullet"?(s=e==null?void 0:e.bulletIcon)!=null?s:Oee:t:i?(o=e==null?void 0:e.checkBoxCheckedIcon)!=null?o:Iee:(l=e==null?void 0:e.checkBoxUncheckedIcon)!=null?l:Nee}})}const Mte=(n,e)=>{n.config(Ps(St.ListItem)).config(t=>_te(t,e)).use(qQ)};function Tte(n){var e;return n.childCount<=1&&!((e=n.firstChild)!=null&&e.content.size)}function Ete(n,e){const{selection:t}=n;if(!t.empty)return null;const r=t.$anchor,i=r.parent;if(i.content.size>0||Ms(l=>l.type.name==="table")(r))return null;const o=r.before();return Tn.node(o,o+i.nodeSize,{class:"crepe-placeholder","data-placeholder":e})}const Tv=It({text:"Please enter...",mode:"block"},"placeholderConfigCtx"),Ate=An(n=>new nn({key:new rn("CREPE_PLACEHOLDER"),props:{decorations:e=>{var t;if(ete(n).readonly)return null;const i=n.get(Tv.key);if(i.mode==="doc"&&!Tte(e.doc)||HR(e.selection)||VR(e.selection))return null;const s=(t=i.text)!=null?t:"Please enter...",o=Ete(e,s);return o?Ft.create(e.doc,[o]):null}}})),Ote=(n,e)=>{n.config(Ps(St.Placeholder)).config(t=>{e&&t.update(Tv.key,r=>({...r,...e}))}).use(Ate).use(Tv)},Lte=(n,e)=>{n.config(Ps(St.Table)).config(t=>{t.update(Oy.key,r=>({...r,renderButton:i=>{var s,o,l,a,c,u,f,p,g;switch(i){case"add_row":return(s=e==null?void 0:e.addRowIcon)!=null?s:Sv;case"add_col":return(o=e==null?void 0:e.addColIcon)!=null?o:Sv;case"delete_row":return(l=e==null?void 0:e.deleteRowIcon)!=null?l:xv;case"delete_col":return(a=e==null?void 0:e.deleteColIcon)!=null?a:xv;case"align_col_left":return(c=e==null?void 0:e.alignLeftIcon)!=null?c:Tee;case"align_col_center":return(u=e==null?void 0:e.alignCenterIcon)!=null?u:Mee;case"align_col_right":return(f=e==null?void 0:e.alignRightIcon)!=null?f:Eee;case"col_drag_handle":return(p=e==null?void 0:e.colDragHandleIcon)!=null?p:hA;case"row_drag_handle":return(g=e==null?void 0:e.rowDragHandleIcon)!=null?g:hA}}}))}).use(bee)};function Dte(n,e){var t,r,i,s,o,l,a;const c=new $R;c.addGroup("formatting","Formatting").addItem("bold",{icon:(t=n==null?void 0:n.boldIcon)!=null?t:Aee,active:g=>g.get(Be).call(pc.key,Pu.type(g)),onRun:g=>{g.get(Be).call(ny.key)}}).addItem("italic",{icon:(r=n==null?void 0:n.italicIcon)!=null?r:$ee,active:g=>g.get(Be).call(pc.key,Za.type(g)),onRun:g=>{g.get(Be).call(ty.key)}}).addItem("strikethrough",{icon:(i=n==null?void 0:n.strikethroughIcon)!=null?i:Kee,active:g=>g.get(Be).call(pc.key,$u.type(g)),onRun:g=>{g.get(Be).call(gy.key)}});const u=c.addGroup("function","Function");u.addItem("code",{icon:(s=n==null?void 0:n.codeIcon)!=null?s:IR,active:g=>g.get(Be).call(pc.key,ho.type(g)),onRun:g=>{g.get(Be).call(ry.key)}});const f=e&&Iy(e).get();return(f==null?void 0:f.includes(St.Latex))&&u.addItem("latex",{icon:(o=n==null?void 0:n.latexIcon)!=null?o:PR,active:g=>g.get(Be).call(d5.key,Cd.type(g)),onRun:g=>{g.get(Be).call(GR.key)}}),u.addItem("link",{icon:(l=n==null?void 0:n.linkIcon)!=null?l:zee,active:g=>g.get(Be).call(pc.key,zi.type(g)),onRun:g=>{g.get(Be).call(lR.key)}}),(a=n==null?void 0:n.buildToolbar)==null||a.call(n,c),c.build()}const Ite=tr({props:{ctx:{type:Object,required:!0},hide:{type:Function,required:!0},show:{type:Object,required:!0},selection:{type:Object,required:!0},config:{type:Object,required:!1}},setup(n){const{ctx:e,config:t}=n,r=o=>l=>{l.preventDefault(),e&&o(e)};function i(o){return n.selection.value,e.get(Hw).status!==Qg.Created?!1:o(e)}const s=Cu(()=>Dte(t,e));return()=>J(Zn,null,s.value.map(o=>o.items.map(l=>J("button",{type:"button",class:Qn("toolbar-item",e&&i(l.active)&&"active"),onPointerdown:r(l.onRun)},J(Su,{icon:l.icon})))).reduce((o,l,a)=>(a===0?o.push(...l):o.push(J("div",{class:"divider"}),...l),o),[]))}});var YR=n=>{throw TypeError(n)},XR=(n,e,t)=>e.has(n)||YR("Cannot "+t),Yr=(n,e,t)=>(XR(n,e,"read from private field"),t?t.call(n):e.get(n)),bf=(n,e,t)=>e.has(n)?YR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),xm=(n,e,t,r)=>(XR(n,e,"write to private field"),e.set(n,t),t),$o,Qf,_g,eh,th;const mA=Ty("CREPE_TOOLBAR");class Nte{constructor(e,t,r){bf(this,$o),bf(this,Qf),bf(this,_g),bf(this,eh),bf(this,th,Ve(!1)),this.update=(o,l)=>{Yr(this,$o).update(o,l),Yr(this,eh).value=o.state.selection},this.destroy=()=>{Yr(this,$o).destroy(),Yr(this,_g).unmount(),Yr(this,Qf).remove()},this.hide=()=>{Yr(this,$o).hide()};const i=document.createElement("div");i.className="milkdown-toolbar",xm(this,eh,n0(t.state.selection));const s=es(Ite,{ctx:e,hide:this.hide,config:r,selection:Yr(this,eh),show:Yr(this,th)});s.mount(i),xm(this,Qf,i),xm(this,_g,s),xm(this,$o,new My({content:Yr(this,Qf),debounce:20,offset:10,shouldShow(o){const{doc:l,selection:a}=o.state,{empty:c,from:u,to:f}=a,p=!l.textBetween(u,f).length&&a instanceof ze,g=!(a instanceof ze),y=o.dom.getRootNode().activeElement,v=i.contains(y),k=!o.hasFocus()&&!v,x=!o.editable;return!(k||g||c||p||x)}})),Yr(this,$o).onShow=()=>{Yr(this,th).value=!0},Yr(this,$o).onHide=()=>{Yr(this,th).value=!1},this.update(t)}}$o=new WeakMap;Qf=new WeakMap;_g=new WeakMap;eh=new WeakMap;th=new WeakMap;const Rte=(n,e)=>{n.config(Ps(St.Toolbar)).config(t=>{t.set(mA.key,{view:r=>new Nte(t,r,e)})}).use(mA)};function Pte(n,e,t){switch(n){case St.CodeMirror:return fte(e,t);case St.ListItem:return Mte(e,t);case St.LinkTooltip:return xte(e,t);case St.ImageBlock:return dte(e,t);case St.Cursor:return hte(e,t);case St.BlockEdit:return ute(e,t);case St.Placeholder:return Ote(e,t);case St.Toolbar:return Rte(e,t);case St.Table:return Lte(e,t);case St.Latex:return Cte(e,t)}}var QR=n=>{throw TypeError(n)},eP=(n,e,t)=>e.has(n)||QR("Cannot "+t),Xr=(n,e,t)=>(eP(n,e,"read from private field"),t?t.call(n):e.get(n)),hb=(n,e,t)=>e.has(n)?QR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),db=(n,e,t,r)=>(eP(n,e,"write to private field"),e.set(n,t),t),Qr,Mg,nh;class Bte{constructor({root:e,defaultValue:t=""}={}){hb(this,Qr),hb(this,Mg),hb(this,nh,!0),this.addFeature=(i,s)=>(i(Xr(this,Qr),s),this),this.create=()=>Xr(this,Qr).create(),this.destroy=()=>Xr(this,Qr).destroy(),this.setReadonly=i=>(db(this,nh,!i),Xr(this,Qr).action(s=>{Xr(this,Qr).status===Qg.Created&&s.get(Gt).setProps({editable:()=>!i})}),this),this.getMarkdown=()=>Xr(this,Qr).action(xz()),this.on=i=>Xr(this,Qr).status!==Qg.Created?(Xr(this,Qr).config(s=>{const o=s.get(k0);i(o)}),this):(Xr(this,Qr).action(s=>{const o=s.get(k0);i(o)}),this);var r;db(this,Mg,(r=typeof e=="string"?document.querySelector(e):e)!=null?r:document.body),db(this,Qr,jw.make().config(i=>{i.inject(Qee,this),i.inject(Xee,[])}).config(i=>{i.set(Qm,Xr(this,Mg)),i.set(Jm,t),i.set(Ch,{editable:()=>Xr(this,nh)}),i.update(Dy.key,s=>({...s,size:4}))}).use(Qz).use(AR).use(vee).use(Cee).use(xee).use(_R).use(iJ))}get editor(){return Xr(this,Qr)}get readonly(){return!Xr(this,nh)}}Qr=new WeakMap;Mg=new WeakMap;nh=new WeakMap;class tP extends Bte{constructor({features:e={},featureConfigs:t={},...r}={}){super(r);const i=E8(t,Yee);Object.entries({..._ee,...e}).filter(([,o])=>o).map(([o])=>o).forEach(o=>{const l=i[o];Pte(o,this.editor,l)})}}tP.Feature=St;const nP=un.forwardRef(({note:n,onClose:e,onSave:t,isSaving:r=!1,showToolbar:i=!0,toolbarTitle:s,toolbarButtons:o,editorId:l="milkdown-editor",className:a="",mode:c="full"},u)=>{const{toast:f}=C3(),[p,g]=un.useState(!1),[y,v]=un.useState((n==null?void 0:n.title)||""),[k,x]=un.useState(!1),_=un.useRef(null),M=un.useRef(null),T=un.useRef(null),S=un.useRef(void 0),A=un.useRef(!1);un.useEffect(()=>{v((n==null?void 0:n.title)||"")},[n==null?void 0:n.title]);const I=un.useCallback(async ne=>{try{const ve=ne.name.replace(/[\\/:*?"<>|]/g,""),ke=ve!==ne.name?new File([ne],ve,{type:ne.type}):ne,Se=await S3.uploadFiles([ke]);if(!Se||Se.length===0)throw new Error("");const Ge=Se[0].oss_url;if(!Ge)throw new Error(" URL");return Ge}catch(ve){throw console.error(" :",ve),ve}},[]);un.useEffect(()=>{if(console.log(" useEffect  - note?.uuid:",n==null?void 0:n.uuid,"lastNoteUuid:",S.current),console.log(" useEffect - note?.content:",JSON.stringify(n==null?void 0:n.content)),console.log(" useEffect - isInitializing:",A.current),A.current){console.warn(" ");return}if(S.current===(n==null?void 0:n.uuid)&&M.current){console.log(" UUID ");return}if(!T.current){console.warn(" editorContainerRef.current ");return}return(async()=>{if(console.log(" ..."),A.current=!0,x(!1),M.current){console.log(" ");try{M.current.destroy()}catch(Se){console.error(":",Se)}M.current=null}const ve=((n==null?void 0:n.content)||"").replace(/\n+$/,"");console.log(" :",JSON.stringify(n==null?void 0:n.content)),console.log(" :",JSON.stringify(ve));const ke=new tP({root:T.current,defaultValue:ve,features:{[St.CodeMirror]:!0,[St.ListItem]:!0,[St.LinkTooltip]:!0,[St.ImageBlock]:!0,[St.Table]:!0},featureConfigs:{[St.ImageBlock]:{onUpload:I,inlineOnUpload:I,blockOnUpload:I}}});await ke.create(),M.current=ke,S.current=n==null?void 0:n.uuid,A.current=!1,x(!0),console.log(" Milkdown ",ke),console.log("  getMarkdown():",ke.getMarkdown())})().catch(ve=>{console.error(" :",ve),A.current=!1}),()=>{console.log("  useEffect")}},[n==null?void 0:n.uuid]);const B=()=>{g(!0),setTimeout(()=>{var ne,ve;(ne=_.current)==null||ne.focus(),(ve=_.current)==null||ve.select()},0)},R=()=>{g(!1)},K=ne=>{var ve;ne.key==="Enter"&&(ne.preventDefault(),(ve=_.current)==null||ve.blur())},U=()=>{var Se;if(!k||!M.current){console.warn(" "),f({title:"",description:"",variant:"destructive",duration:2e3});return}console.log(" MilkdownEditor handleSave - crepeRef.current :",M.current),console.log(" MilkdownEditor handleSave - :",Object.keys(M.current)),console.log(" MilkdownEditor handleSave - getMarkdown :",typeof M.current.getMarkdown);const ne=(Se=T.current)==null?void 0:Se.querySelector(".milkdown"),ve=(ne==null?void 0:ne.textContent)||"",ke=M.current.getMarkdown();if(console.log(" MilkdownEditor handleSave - getMarkdown() :",ke),console.log(" MilkdownEditor handleSave - DOM textContent:",ve),console.log(" MilkdownEditor handleSave - :",ke==null?void 0:ke.length),console.log(" MilkdownEditor handleSave - :",y),console.log(" MilkdownEditor handleSave - :",k),console.log(" MilkdownEditor handleSave - editorContainerRef:",T.current),f({title:"MilkdownEditor",description:`: ${(ke==null?void 0:ke.length)||0} 
100: ${(ke||"").substring(0,100)}...`,duration:3e3}),!ke||!ke.trim()){console.warn(" ");return}t==null||t(ke.trim(),y)},z=()=>{e==null||e()};un.useImperativeHandle(u,()=>({getContent:()=>{if(!M.current)return console.warn(" "),"";const ne=M.current.getMarkdown();return console.log(" MilkdownEditor getContent - :",ne),console.log(" MilkdownEditor getContent - :",ne==null?void 0:ne.length),ne||""},setContent:ne=>{console.log(" MilkdownEditor setContent - Crepe "),console.warn(" Crepe  setContent")},getTitle:()=>y}),[y]);const oe=wt.jsxs(wt.Fragment,{children:[wt.jsxs(Eg,{onClick:U,disabled:r||!k,size:"sm",children:[r?wt.jsx(yA,{className:"h-4 w-4 animate-spin"}):wt.jsx(xA,{className:"h-4 w-4"}),""]}),wt.jsxs(Eg,{onClick:z,variant:"ghost",size:"sm",children:[wt.jsx(bA,{className:"h-4 w-4"}),""]})]});return wt.jsxs("div",{className:`h-full w-full flex flex-col ${a}`,children:[i&&wt.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-background",children:[wt.jsx("div",{className:"flex items-center space-x-2 flex-1 mr-4 min-w-0",children:p?wt.jsx(gA,{ref:_,value:y,onChange:ne=>v(ne.target.value),onBlur:R,onKeyDown:K,className:"text-sm font-semibold h-6 max-w-xs border-0 shadow-none focus-visible:ring-0 px-1",placeholder:""}):wt.jsxs("div",{className:"flex items-center space-x-2 group cursor-pointer min-w-0",onClick:B,children:[wt.jsx("h3",{className:"text-lg font-semibold truncate max-w-md",children:s||y||(n?"":"")}),wt.jsx(SA,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"})]})}),wt.jsx("div",{className:"flex items-center space-x-2",children:o||oe})]}),wt.jsx("div",{className:"flex-1 overflow-auto",children:wt.jsx("div",{ref:T,id:l,className:`milkdown-editor-container milkdown-mode-${c} h-full w-full`})})]})});nP.displayName="MilkdownEditor";async function Hte(n){try{return(await wA.post("/note/tag/page",{page:n.page||1,rows:n.rows||20,keyword:n.keyword||"",parent_id:n.parent_id||null})).data.items||[]}catch(e){return console.error(":",e),[]}}async function fne(){try{return(await wA.post("/note/tag/list",{})).data||[]}catch(n){return console.error(":",n),[]}}var rP={exports:{}};/*!
 * Vditor v3.11.2 - A markdown editor written in TypeScript.
 *
 * MIT License
 *
 * Copyright (c) 2018-present B3log , b3log.org
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */(function(n,e){(function(r,i){n.exports=i()})(x3,function(){return(()=>{var t={173:o=>{var l=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},a=-1,c=1,u=0;l.Diff=function(f,p){return[f,p]},l.prototype.diff_main=function(f,p,g,y){typeof y>"u"&&(this.Diff_Timeout<=0?y=Number.MAX_VALUE:y=new Date().getTime()+this.Diff_Timeout*1e3);var v=y;if(f==null||p==null)throw new Error("Null input. (diff_main)");if(f==p)return f?[new l.Diff(u,f)]:[];typeof g>"u"&&(g=!0);var k=g,x=this.diff_commonPrefix(f,p),_=f.substring(0,x);f=f.substring(x),p=p.substring(x),x=this.diff_commonSuffix(f,p);var M=f.substring(f.length-x);f=f.substring(0,f.length-x),p=p.substring(0,p.length-x);var T=this.diff_compute_(f,p,k,v);return _&&T.unshift(new l.Diff(u,_)),M&&T.push(new l.Diff(u,M)),this.diff_cleanupMerge(T),T},l.prototype.diff_compute_=function(f,p,g,y){var v;if(!f)return[new l.Diff(c,p)];if(!p)return[new l.Diff(a,f)];var k=f.length>p.length?f:p,x=f.length>p.length?p:f,_=k.indexOf(x);if(_!=-1)return v=[new l.Diff(c,k.substring(0,_)),new l.Diff(u,x),new l.Diff(c,k.substring(_+x.length))],f.length>p.length&&(v[0][0]=v[2][0]=a),v;if(x.length==1)return[new l.Diff(a,f),new l.Diff(c,p)];var M=this.diff_halfMatch_(f,p);if(M){var T=M[0],S=M[1],A=M[2],I=M[3],B=M[4],R=this.diff_main(T,A,g,y),K=this.diff_main(S,I,g,y);return R.concat([new l.Diff(u,B)],K)}return g&&f.length>100&&p.length>100?this.diff_lineMode_(f,p,y):this.diff_bisect_(f,p,y)},l.prototype.diff_lineMode_=function(f,p,g){var y=this.diff_linesToChars_(f,p);f=y.chars1,p=y.chars2;var v=y.lineArray,k=this.diff_main(f,p,!1,g);this.diff_charsToLines_(k,v),this.diff_cleanupSemantic(k),k.push(new l.Diff(u,""));for(var x=0,_=0,M=0,T="",S="";x<k.length;){switch(k[x][0]){case c:M++,S+=k[x][1];break;case a:_++,T+=k[x][1];break;case u:if(_>=1&&M>=1){k.splice(x-_-M,_+M),x=x-_-M;for(var A=this.diff_main(T,S,!1,g),I=A.length-1;I>=0;I--)k.splice(x,0,A[I]);x=x+A.length}M=0,_=0,T="",S="";break}x++}return k.pop(),k},l.prototype.diff_bisect_=function(f,p,g){for(var y=f.length,v=p.length,k=Math.ceil((y+v)/2),x=k,_=2*k,M=new Array(_),T=new Array(_),S=0;S<_;S++)M[S]=-1,T[S]=-1;M[x+1]=0,T[x+1]=0;for(var A=y-v,I=A%2!=0,B=0,R=0,K=0,U=0,z=0;z<k&&!(new Date().getTime()>g);z++){for(var oe=-z+B;oe<=z-R;oe+=2){var ne=x+oe,ve;oe==-z||oe!=z&&M[ne-1]<M[ne+1]?ve=M[ne+1]:ve=M[ne-1]+1;for(var ke=ve-oe;ve<y&&ke<v&&f.charAt(ve)==p.charAt(ke);)ve++,ke++;if(M[ne]=ve,ve>y)R+=2;else if(ke>v)B+=2;else if(I){var Se=x+A-oe;if(Se>=0&&Se<_&&T[Se]!=-1){var Te=y-T[Se];if(ve>=Te)return this.diff_bisectSplit_(f,p,ve,ke,g)}}}for(var Ge=-z+K;Ge<=z-U;Ge+=2){var Se=x+Ge,Te;Ge==-z||Ge!=z&&T[Se-1]<T[Se+1]?Te=T[Se+1]:Te=T[Se-1]+1;for(var Xe=Te-Ge;Te<y&&Xe<v&&f.charAt(y-Te-1)==p.charAt(v-Xe-1);)Te++,Xe++;if(T[Se]=Te,Te>y)U+=2;else if(Xe>v)K+=2;else if(!I){var ne=x+A-Ge;if(ne>=0&&ne<_&&M[ne]!=-1){var ve=M[ne],ke=x+ve-ne;if(Te=y-Te,ve>=Te)return this.diff_bisectSplit_(f,p,ve,ke,g)}}}}return[new l.Diff(a,f),new l.Diff(c,p)]},l.prototype.diff_bisectSplit_=function(f,p,g,y,v){var k=f.substring(0,g),x=p.substring(0,y),_=f.substring(g),M=p.substring(y),T=this.diff_main(k,x,!1,v),S=this.diff_main(_,M,!1,v);return T.concat(S)},l.prototype.diff_linesToChars_=function(f,p){var g=[],y={};g[0]="";function v(M){for(var T="",S=0,A=-1,I=g.length;A<M.length-1;){A=M.indexOf(`
`,S),A==-1&&(A=M.length-1);var B=M.substring(S,A+1);(y.hasOwnProperty?y.hasOwnProperty(B):y[B]!==void 0)?T+=String.fromCharCode(y[B]):(I==k&&(B=M.substring(S),A=M.length),T+=String.fromCharCode(I),y[B]=I,g[I++]=B),S=A+1}return T}var k=4e4,x=v(f);k=65535;var _=v(p);return{chars1:x,chars2:_,lineArray:g}},l.prototype.diff_charsToLines_=function(f,p){for(var g=0;g<f.length;g++){for(var y=f[g][1],v=[],k=0;k<y.length;k++)v[k]=p[y.charCodeAt(k)];f[g][1]=v.join("")}},l.prototype.diff_commonPrefix=function(f,p){if(!f||!p||f.charAt(0)!=p.charAt(0))return 0;for(var g=0,y=Math.min(f.length,p.length),v=y,k=0;g<v;)f.substring(k,v)==p.substring(k,v)?(g=v,k=g):y=v,v=Math.floor((y-g)/2+g);return v},l.prototype.diff_commonSuffix=function(f,p){if(!f||!p||f.charAt(f.length-1)!=p.charAt(p.length-1))return 0;for(var g=0,y=Math.min(f.length,p.length),v=y,k=0;g<v;)f.substring(f.length-v,f.length-k)==p.substring(p.length-v,p.length-k)?(g=v,k=g):y=v,v=Math.floor((y-g)/2+g);return v},l.prototype.diff_commonOverlap_=function(f,p){var g=f.length,y=p.length;if(g==0||y==0)return 0;g>y?f=f.substring(g-y):g<y&&(p=p.substring(0,g));var v=Math.min(g,y);if(f==p)return v;for(var k=0,x=1;;){var _=f.substring(v-x),M=p.indexOf(_);if(M==-1)return k;x+=M,(M==0||f.substring(v-x)==p.substring(0,x))&&(k=x,x++)}},l.prototype.diff_halfMatch_=function(f,p){if(this.Diff_Timeout<=0)return null;var g=f.length>p.length?f:p,y=f.length>p.length?p:f;if(g.length<4||y.length*2<g.length)return null;var v=this;function k(R,K,U){for(var z=R.substring(U,U+Math.floor(R.length/4)),oe=-1,ne="",ve,ke,Se,Te;(oe=K.indexOf(z,oe+1))!=-1;){var Ge=v.diff_commonPrefix(R.substring(U),K.substring(oe)),Xe=v.diff_commonSuffix(R.substring(0,U),K.substring(0,oe));ne.length<Xe+Ge&&(ne=K.substring(oe-Xe,oe)+K.substring(oe,oe+Ge),ve=R.substring(0,U-Xe),ke=R.substring(U+Ge),Se=K.substring(0,oe-Xe),Te=K.substring(oe+Ge))}return ne.length*2>=R.length?[ve,ke,Se,Te,ne]:null}var x=k(g,y,Math.ceil(g.length/4)),_=k(g,y,Math.ceil(g.length/2)),M;if(!x&&!_)return null;_?x?M=x[4].length>_[4].length?x:_:M=_:M=x;var T,S,A,I;f.length>p.length?(T=M[0],S=M[1],A=M[2],I=M[3]):(A=M[0],I=M[1],T=M[2],S=M[3]);var B=M[4];return[T,S,A,I,B]},l.prototype.diff_cleanupSemantic=function(f){for(var p=!1,g=[],y=0,v=null,k=0,x=0,_=0,M=0,T=0;k<f.length;)f[k][0]==u?(g[y++]=k,x=M,_=T,M=0,T=0,v=f[k][1]):(f[k][0]==c?M+=f[k][1].length:T+=f[k][1].length,v&&v.length<=Math.max(x,_)&&v.length<=Math.max(M,T)&&(f.splice(g[y-1],0,new l.Diff(a,v)),f[g[y-1]+1][0]=c,y--,y--,k=y>0?g[y-1]:-1,x=0,_=0,M=0,T=0,v=null,p=!0)),k++;for(p&&this.diff_cleanupMerge(f),this.diff_cleanupSemanticLossless(f),k=1;k<f.length;){if(f[k-1][0]==a&&f[k][0]==c){var S=f[k-1][1],A=f[k][1],I=this.diff_commonOverlap_(S,A),B=this.diff_commonOverlap_(A,S);I>=B?(I>=S.length/2||I>=A.length/2)&&(f.splice(k,0,new l.Diff(u,A.substring(0,I))),f[k-1][1]=S.substring(0,S.length-I),f[k+1][1]=A.substring(I),k++):(B>=S.length/2||B>=A.length/2)&&(f.splice(k,0,new l.Diff(u,S.substring(0,B))),f[k-1][0]=c,f[k-1][1]=A.substring(0,A.length-B),f[k+1][0]=a,f[k+1][1]=S.substring(B),k++),k++}k++}},l.prototype.diff_cleanupSemanticLossless=function(f){function p(B,R){if(!B||!R)return 6;var K=B.charAt(B.length-1),U=R.charAt(0),z=K.match(l.nonAlphaNumericRegex_),oe=U.match(l.nonAlphaNumericRegex_),ne=z&&K.match(l.whitespaceRegex_),ve=oe&&U.match(l.whitespaceRegex_),ke=ne&&K.match(l.linebreakRegex_),Se=ve&&U.match(l.linebreakRegex_),Te=ke&&B.match(l.blanklineEndRegex_),Ge=Se&&R.match(l.blanklineStartRegex_);return Te||Ge?5:ke||Se?4:z&&!ne&&ve?3:ne||ve?2:z||oe?1:0}for(var g=1;g<f.length-1;){if(f[g-1][0]==u&&f[g+1][0]==u){var y=f[g-1][1],v=f[g][1],k=f[g+1][1],x=this.diff_commonSuffix(y,v);if(x){var _=v.substring(v.length-x);y=y.substring(0,y.length-x),v=_+v.substring(0,v.length-x),k=_+k}for(var M=y,T=v,S=k,A=p(y,v)+p(v,k);v.charAt(0)===k.charAt(0);){y+=v.charAt(0),v=v.substring(1)+k.charAt(0),k=k.substring(1);var I=p(y,v)+p(v,k);I>=A&&(A=I,M=y,T=v,S=k)}f[g-1][1]!=M&&(M?f[g-1][1]=M:(f.splice(g-1,1),g--),f[g][1]=T,S?f[g+1][1]=S:(f.splice(g+1,1),g--))}g++}},l.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,l.whitespaceRegex_=/\s/,l.linebreakRegex_=/[\r\n]/,l.blanklineEndRegex_=/\n\r?\n$/,l.blanklineStartRegex_=/^\r?\n\r?\n/,l.prototype.diff_cleanupEfficiency=function(f){for(var p=!1,g=[],y=0,v=null,k=0,x=!1,_=!1,M=!1,T=!1;k<f.length;)f[k][0]==u?(f[k][1].length<this.Diff_EditCost&&(M||T)?(g[y++]=k,x=M,_=T,v=f[k][1]):(y=0,v=null),M=T=!1):(f[k][0]==a?T=!0:M=!0,v&&(x&&_&&M&&T||v.length<this.Diff_EditCost/2&&x+_+M+T==3)&&(f.splice(g[y-1],0,new l.Diff(a,v)),f[g[y-1]+1][0]=c,y--,v=null,x&&_?(M=T=!0,y=0):(y--,k=y>0?g[y-1]:-1,M=T=!1),p=!0)),k++;p&&this.diff_cleanupMerge(f)},l.prototype.diff_cleanupMerge=function(f){f.push(new l.Diff(u,""));for(var p=0,g=0,y=0,v="",k="",x;p<f.length;)switch(f[p][0]){case c:y++,k+=f[p][1],p++;break;case a:g++,v+=f[p][1],p++;break;case u:g+y>1?(g!==0&&y!==0&&(x=this.diff_commonPrefix(k,v),x!==0&&(p-g-y>0&&f[p-g-y-1][0]==u?f[p-g-y-1][1]+=k.substring(0,x):(f.splice(0,0,new l.Diff(u,k.substring(0,x))),p++),k=k.substring(x),v=v.substring(x)),x=this.diff_commonSuffix(k,v),x!==0&&(f[p][1]=k.substring(k.length-x)+f[p][1],k=k.substring(0,k.length-x),v=v.substring(0,v.length-x))),p-=g+y,f.splice(p,g+y),v.length&&(f.splice(p,0,new l.Diff(a,v)),p++),k.length&&(f.splice(p,0,new l.Diff(c,k)),p++),p++):p!==0&&f[p-1][0]==u?(f[p-1][1]+=f[p][1],f.splice(p,1)):p++,y=0,g=0,v="",k="";break}f[f.length-1][1]===""&&f.pop();var _=!1;for(p=1;p<f.length-1;)f[p-1][0]==u&&f[p+1][0]==u&&(f[p][1].substring(f[p][1].length-f[p-1][1].length)==f[p-1][1]?(f[p][1]=f[p-1][1]+f[p][1].substring(0,f[p][1].length-f[p-1][1].length),f[p+1][1]=f[p-1][1]+f[p+1][1],f.splice(p-1,1),_=!0):f[p][1].substring(0,f[p+1][1].length)==f[p+1][1]&&(f[p-1][1]+=f[p+1][1],f[p][1]=f[p][1].substring(f[p+1][1].length)+f[p+1][1],f.splice(p+1,1),_=!0)),p++;_&&this.diff_cleanupMerge(f)},l.prototype.diff_xIndex=function(f,p){var g=0,y=0,v=0,k=0,x;for(x=0;x<f.length&&(f[x][0]!==c&&(g+=f[x][1].length),f[x][0]!==a&&(y+=f[x][1].length),!(g>p));x++)v=g,k=y;return f.length!=x&&f[x][0]===a?k:k+(p-v)},l.prototype.diff_prettyHtml=function(f){for(var p=[],g=/&/g,y=/</g,v=/>/g,k=/\n/g,x=0;x<f.length;x++){var _=f[x][0],M=f[x][1],T=M.replace(g,"&amp;").replace(y,"&lt;").replace(v,"&gt;").replace(k,"&para;<br>");switch(_){case c:p[x]='<ins style="background:#e6ffe6;">'+T+"</ins>";break;case a:p[x]='<del style="background:#ffe6e6;">'+T+"</del>";break;case u:p[x]="<span>"+T+"</span>";break}}return p.join("")},l.prototype.diff_text1=function(f){for(var p=[],g=0;g<f.length;g++)f[g][0]!==c&&(p[g]=f[g][1]);return p.join("")},l.prototype.diff_text2=function(f){for(var p=[],g=0;g<f.length;g++)f[g][0]!==a&&(p[g]=f[g][1]);return p.join("")},l.prototype.diff_levenshtein=function(f){for(var p=0,g=0,y=0,v=0;v<f.length;v++){var k=f[v][0],x=f[v][1];switch(k){case c:g+=x.length;break;case a:y+=x.length;break;case u:p+=Math.max(g,y),g=0,y=0;break}}return p+=Math.max(g,y),p},l.prototype.diff_toDelta=function(f){for(var p=[],g=0;g<f.length;g++)switch(f[g][0]){case c:p[g]="+"+encodeURI(f[g][1]);break;case a:p[g]="-"+f[g][1].length;break;case u:p[g]="="+f[g][1].length;break}return p.join("	").replace(/%20/g," ")},l.prototype.diff_fromDelta=function(f,p){for(var g=[],y=0,v=0,k=p.split(/\t/g),x=0;x<k.length;x++){var _=k[x].substring(1);switch(k[x].charAt(0)){case"+":try{g[y++]=new l.Diff(c,decodeURI(_))}catch{throw new Error("Illegal escape in diff_fromDelta: "+_)}break;case"-":case"=":var M=parseInt(_,10);if(isNaN(M)||M<0)throw new Error("Invalid number in diff_fromDelta: "+_);var T=f.substring(v,v+=M);k[x].charAt(0)=="="?g[y++]=new l.Diff(u,T):g[y++]=new l.Diff(a,T);break;default:if(k[x])throw new Error("Invalid diff operation in diff_fromDelta: "+k[x])}}if(v!=f.length)throw new Error("Delta length ("+v+") does not equal source text length ("+f.length+").");return g},l.prototype.match_main=function(f,p,g){if(f==null||p==null||g==null)throw new Error("Null input. (match_main)");return g=Math.max(0,Math.min(g,f.length)),f==p?0:f.length?f.substring(g,g+p.length)==p?g:this.match_bitap_(f,p,g):-1},l.prototype.match_bitap_=function(f,p,g){if(p.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var y=this.match_alphabet_(p),v=this;function k(ve,ke){var Se=ve/p.length,Te=Math.abs(g-ke);return v.Match_Distance?Se+Te/v.Match_Distance:Te?1:Se}var x=this.Match_Threshold,_=f.indexOf(p,g);_!=-1&&(x=Math.min(k(0,_),x),_=f.lastIndexOf(p,g+p.length),_!=-1&&(x=Math.min(k(0,_),x)));var M=1<<p.length-1;_=-1;for(var T,S,A=p.length+f.length,I,B=0;B<p.length;B++){for(T=0,S=A;T<S;)k(B,g+S)<=x?T=S:A=S,S=Math.floor((A-T)/2+T);A=S;var R=Math.max(1,g-S+1),K=Math.min(g+S,f.length)+p.length,U=Array(K+2);U[K+1]=(1<<B)-1;for(var z=K;z>=R;z--){var oe=y[f.charAt(z-1)];if(B===0?U[z]=(U[z+1]<<1|1)&oe:U[z]=(U[z+1]<<1|1)&oe|((I[z+1]|I[z])<<1|1)|I[z+1],U[z]&M){var ne=k(B,z-1);if(ne<=x)if(x=ne,_=z-1,_>g)R=Math.max(1,2*g-_);else break}}if(k(B+1,g)>x)break;I=U}return _},l.prototype.match_alphabet_=function(f){for(var p={},g=0;g<f.length;g++)p[f.charAt(g)]=0;for(var g=0;g<f.length;g++)p[f.charAt(g)]|=1<<f.length-g-1;return p},l.prototype.patch_addContext_=function(f,p){if(p.length!=0){if(f.start2===null)throw Error("patch not initialized");for(var g=p.substring(f.start2,f.start2+f.length1),y=0;p.indexOf(g)!=p.lastIndexOf(g)&&g.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)y+=this.Patch_Margin,g=p.substring(f.start2-y,f.start2+f.length1+y);y+=this.Patch_Margin;var v=p.substring(f.start2-y,f.start2);v&&f.diffs.unshift(new l.Diff(u,v));var k=p.substring(f.start2+f.length1,f.start2+f.length1+y);k&&f.diffs.push(new l.Diff(u,k)),f.start1-=v.length,f.start2-=v.length,f.length1+=v.length+k.length,f.length2+=v.length+k.length}},l.prototype.patch_make=function(f,p,g){var y,v;if(typeof f=="string"&&typeof p=="string"&&typeof g>"u")y=f,v=this.diff_main(y,p,!0),v.length>2&&(this.diff_cleanupSemantic(v),this.diff_cleanupEfficiency(v));else if(f&&typeof f=="object"&&typeof p>"u"&&typeof g>"u")v=f,y=this.diff_text1(v);else if(typeof f=="string"&&p&&typeof p=="object"&&typeof g>"u")y=f,v=p;else if(typeof f=="string"&&typeof p=="string"&&g&&typeof g=="object")y=f,v=g;else throw new Error("Unknown call format to patch_make.");if(v.length===0)return[];for(var k=[],x=new l.patch_obj,_=0,M=0,T=0,S=y,A=y,I=0;I<v.length;I++){var B=v[I][0],R=v[I][1];switch(!_&&B!==u&&(x.start1=M,x.start2=T),B){case c:x.diffs[_++]=v[I],x.length2+=R.length,A=A.substring(0,T)+R+A.substring(T);break;case a:x.length1+=R.length,x.diffs[_++]=v[I],A=A.substring(0,T)+A.substring(T+R.length);break;case u:R.length<=2*this.Patch_Margin&&_&&v.length!=I+1?(x.diffs[_++]=v[I],x.length1+=R.length,x.length2+=R.length):R.length>=2*this.Patch_Margin&&_&&(this.patch_addContext_(x,S),k.push(x),x=new l.patch_obj,_=0,S=A,M=T);break}B!==c&&(M+=R.length),B!==a&&(T+=R.length)}return _&&(this.patch_addContext_(x,S),k.push(x)),k},l.prototype.patch_deepCopy=function(f){for(var p=[],g=0;g<f.length;g++){var y=f[g],v=new l.patch_obj;v.diffs=[];for(var k=0;k<y.diffs.length;k++)v.diffs[k]=new l.Diff(y.diffs[k][0],y.diffs[k][1]);v.start1=y.start1,v.start2=y.start2,v.length1=y.length1,v.length2=y.length2,p[g]=v}return p},l.prototype.patch_apply=function(f,p){if(f.length==0)return[p,[]];f=this.patch_deepCopy(f);var g=this.patch_addPadding(f);p=g+p+g,this.patch_splitMax(f);for(var y=0,v=[],k=0;k<f.length;k++){var x=f[k].start2+y,_=this.diff_text1(f[k].diffs),M,T=-1;if(_.length>this.Match_MaxBits?(M=this.match_main(p,_.substring(0,this.Match_MaxBits),x),M!=-1&&(T=this.match_main(p,_.substring(_.length-this.Match_MaxBits),x+_.length-this.Match_MaxBits),(T==-1||M>=T)&&(M=-1))):M=this.match_main(p,_,x),M==-1)v[k]=!1,y-=f[k].length2-f[k].length1;else{v[k]=!0,y=M-x;var S;if(T==-1?S=p.substring(M,M+_.length):S=p.substring(M,T+this.Match_MaxBits),_==S)p=p.substring(0,M)+this.diff_text2(f[k].diffs)+p.substring(M+_.length);else{var A=this.diff_main(_,S,!1);if(_.length>this.Match_MaxBits&&this.diff_levenshtein(A)/_.length>this.Patch_DeleteThreshold)v[k]=!1;else{this.diff_cleanupSemanticLossless(A);for(var I=0,B,R=0;R<f[k].diffs.length;R++){var K=f[k].diffs[R];K[0]!==u&&(B=this.diff_xIndex(A,I)),K[0]===c?p=p.substring(0,M+B)+K[1]+p.substring(M+B):K[0]===a&&(p=p.substring(0,M+B)+p.substring(M+this.diff_xIndex(A,I+K[1].length))),K[0]!==a&&(I+=K[1].length)}}}}}return p=p.substring(g.length,p.length-g.length),[p,v]},l.prototype.patch_addPadding=function(f){for(var p=this.Patch_Margin,g="",y=1;y<=p;y++)g+=String.fromCharCode(y);for(var y=0;y<f.length;y++)f[y].start1+=p,f[y].start2+=p;var v=f[0],k=v.diffs;if(k.length==0||k[0][0]!=u)k.unshift(new l.Diff(u,g)),v.start1-=p,v.start2-=p,v.length1+=p,v.length2+=p;else if(p>k[0][1].length){var x=p-k[0][1].length;k[0][1]=g.substring(k[0][1].length)+k[0][1],v.start1-=x,v.start2-=x,v.length1+=x,v.length2+=x}if(v=f[f.length-1],k=v.diffs,k.length==0||k[k.length-1][0]!=u)k.push(new l.Diff(u,g)),v.length1+=p,v.length2+=p;else if(p>k[k.length-1][1].length){var x=p-k[k.length-1][1].length;k[k.length-1][1]+=g.substring(0,x),v.length1+=x,v.length2+=x}return g},l.prototype.patch_splitMax=function(f){for(var p=this.Match_MaxBits,g=0;g<f.length;g++)if(!(f[g].length1<=p)){var y=f[g];f.splice(g--,1);for(var v=y.start1,k=y.start2,x="";y.diffs.length!==0;){var _=new l.patch_obj,M=!0;for(_.start1=v-x.length,_.start2=k-x.length,x!==""&&(_.length1=_.length2=x.length,_.diffs.push(new l.Diff(u,x)));y.diffs.length!==0&&_.length1<p-this.Patch_Margin;){var T=y.diffs[0][0],S=y.diffs[0][1];T===c?(_.length2+=S.length,k+=S.length,_.diffs.push(y.diffs.shift()),M=!1):T===a&&_.diffs.length==1&&_.diffs[0][0]==u&&S.length>2*p?(_.length1+=S.length,v+=S.length,M=!1,_.diffs.push(new l.Diff(T,S)),y.diffs.shift()):(S=S.substring(0,p-_.length1-this.Patch_Margin),_.length1+=S.length,v+=S.length,T===u?(_.length2+=S.length,k+=S.length):M=!1,_.diffs.push(new l.Diff(T,S)),S==y.diffs[0][1]?y.diffs.shift():y.diffs[0][1]=y.diffs[0][1].substring(S.length))}x=this.diff_text2(_.diffs),x=x.substring(x.length-this.Patch_Margin);var A=this.diff_text1(y.diffs).substring(0,this.Patch_Margin);A!==""&&(_.length1+=A.length,_.length2+=A.length,_.diffs.length!==0&&_.diffs[_.diffs.length-1][0]===u?_.diffs[_.diffs.length-1][1]+=A:_.diffs.push(new l.Diff(u,A))),M||f.splice(++g,0,_)}}},l.prototype.patch_toText=function(f){for(var p=[],g=0;g<f.length;g++)p[g]=f[g];return p.join("")},l.prototype.patch_fromText=function(f){var p=[];if(!f)return p;for(var g=f.split(`
`),y=0,v=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;y<g.length;){var k=g[y].match(v);if(!k)throw new Error("Invalid patch string: "+g[y]);var x=new l.patch_obj;for(p.push(x),x.start1=parseInt(k[1],10),k[2]===""?(x.start1--,x.length1=1):k[2]=="0"?x.length1=0:(x.start1--,x.length1=parseInt(k[2],10)),x.start2=parseInt(k[3],10),k[4]===""?(x.start2--,x.length2=1):k[4]=="0"?x.length2=0:(x.start2--,x.length2=parseInt(k[4],10)),y++;y<g.length;){var _=g[y].charAt(0);try{var M=decodeURI(g[y].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+M)}if(_=="-")x.diffs.push(new l.Diff(a,M));else if(_=="+")x.diffs.push(new l.Diff(c,M));else if(_==" ")x.diffs.push(new l.Diff(u,M));else{if(_=="@")break;if(_!=="")throw new Error('Invalid patch mode "'+_+'" in: '+M)}y++}}return p},l.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},l.patch_obj.prototype.toString=function(){var f,p;this.length1===0?f=this.start1+",0":this.length1==1?f=this.start1+1:f=this.start1+1+","+this.length1,this.length2===0?p=this.start2+",0":this.length2==1?p=this.start2+1:p=this.start2+1+","+this.length2;for(var g=["@@ -"+f+" +"+p+` @@
`],y,v=0;v<this.diffs.length;v++){switch(this.diffs[v][0]){case c:y="+";break;case a:y="-";break;case u:y=" ";break}g[v+1]=y+encodeURI(this.diffs[v][1])+`
`}return g.join("").replace(/%20/g," ")},o.exports=l,o.exports.diff_match_patch=l,o.exports.DIFF_DELETE=a,o.exports.DIFF_INSERT=c,o.exports.DIFF_EQUAL=u},408:(o,l,a)=>{a.d(l,{default:()=>Nt});var c=a(135),u=a(840),f=a(775),p=a(428),g=a(325),y=a(483),v=a(999),k=function(ie){ie===void 0&&(ie=document);var rt=function(xe){var he=document.createElement("img");he.src=xe.getAttribute("data-src"),he.addEventListener("load",function(){!xe.getAttribute("style")&&!xe.getAttribute("class")&&!xe.getAttribute("width")&&!xe.getAttribute("height")&&he.naturalHeight>he.naturalWidth&&he.naturalWidth/he.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&he.naturalHeight>window.innerHeight-40&&(xe.style.height=window.innerHeight-40+"px"),xe.src=he.src}),xe.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return ie.querySelectorAll("img").forEach(function(xe){xe.getAttribute("data-src")&&rt(xe)}),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),ie.querySelectorAll("img").forEach(function(xe){window.vditorImageIntersectionObserver.observe(xe)})):(window.vditorImageIntersectionObserver=new IntersectionObserver(function(xe){xe.forEach(function(he){(typeof he.isIntersecting>"u"?he.intersectionRatio!==0:he.isIntersecting)&&he.target.getAttribute("data-src")&&rt(he.target)})}),ie.querySelectorAll("img").forEach(function(xe){window.vditorImageIntersectionObserver.observe(xe)}))},x=a(472),_=a(280),M=a(637),T=a(825),S=a(11),A=a(194),I=a(436),B=a(229),R=a(145),K=a(538),U=a(413),z=a(106),oe=a(673),ne=function(ie){document.querySelectorAll(".vditor-anchor").forEach(function(rt){ie===1&&rt.classList.add("vditor-anchor--left"),rt.onclick=function(){var xe=rt.getAttribute("href").substr(1),he=document.getElementById("vditorAnchor-"+xe).offsetTop;document.querySelector("html").scrollTop=he}}),window.onhashchange=function(){var rt=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));rt&&(document.querySelector("html").scrollTop=rt.offsetTop)}},ve=a(214),ke=a(810),Se=function(ie,rt){if(rt===void 0&&(rt="zh_CN"),!(typeof speechSynthesis>"u"||typeof SpeechSynthesisUtterance>"u")){var xe=function(){var W=speechSynthesis.getVoices(),q,Y;return W.forEach(function(Q){Q.lang===rt.replace("_","-")&&(q=Q),Q.default&&(Y=Q)}),q||(q=Y),q},he='<svg><use xlink:href="#vditor-icon-play"></use></svg>',_t='<svg><use xlink:href="#vditor-icon-pause"></use></svg>';document.getElementById("vditorIconScript")||(he='<svg viewBox="0 0 32 32"><path d="M3.436 0l25.128 16-25.128 16v-32z"></path></svg>',_t='<svg viewBox="0 0 32 32"><path d="M20.617 0h9.128v32h-9.128v-32zM2.255 32v-32h9.128v32h-9.128z"></path></svg>');var De=document.querySelector(".vditor-speech");De||(De=document.createElement("button"),De.className="vditor-speech",ie.insertAdjacentElement("beforeend",De),speechSynthesis.onvoiceschanged!==void 0&&(speechSynthesis.onvoiceschanged=xe));var N=xe(),H=new SpeechSynthesisUtterance;H.voice=N,H.onend=H.onerror=function(){De.style.display="none",speechSynthesis.cancel(),De.classList.remove("vditor-speech--current"),De.innerHTML=he},ie.addEventListener(window.ontouchstart!==void 0?"touchend":"click",function(W){var q=W.target;if(q.classList.contains("vditor-speech")||q.parentElement.classList.contains("vditor-speech")){De.classList.contains("vditor-speech--current")?speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),De.innerHTML=_t):(speechSynthesis.pause(),De.innerHTML=he)):(H.text=De.getAttribute("data-text"),speechSynthesis.speak(H),De.classList.add("vditor-speech--current"),De.innerHTML=_t),(0,ke.Hc)(window.vditorSpeechRange),ie.focus();return}if(De.style.display="none",speechSynthesis.cancel(),De.classList.remove("vditor-speech--current"),De.innerHTML=he,getSelection().rangeCount!==0){var Y=getSelection().getRangeAt(0),Q=Y.toString().trim();if(Q){window.vditorSpeechRange=Y.cloneRange();var pe=Y.getBoundingClientRect();De.innerHTML=he,De.style.display="block",De.style.top=pe.top+pe.height+document.querySelector("html").scrollTop-20+"px",window.ontouchstart!==void 0?De.style.left=W.changedTouches[W.changedTouches.length-1].pageX+2+"px":De.style.left=W.clientX+2+"px",De.setAttribute("data-text",Q)}}})}},Te=function(ie,rt,xe,he){function _t(De){return De instanceof xe?De:new xe(function(N){N(De)})}return new(xe||(xe=Promise))(function(De,N){function H(Y){try{q(he.next(Y))}catch(Q){N(Q)}}function W(Y){try{q(he.throw(Y))}catch(Q){N(Q)}}function q(Y){Y.done?De(Y.value):_t(Y.value).then(H,W)}q((he=he.apply(ie,rt||[])).next())})},Ge=function(ie,rt){var xe={label:0,sent:function(){if(De[0]&1)throw De[1];return De[1]},trys:[],ops:[]},he,_t,De,N;return N={next:H(0),throw:H(1),return:H(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function H(q){return function(Y){return W([q,Y])}}function W(q){if(he)throw new TypeError("Generator is already executing.");for(;N&&(N=0,q[0]&&(xe=0)),xe;)try{if(he=1,_t&&(De=q[0]&2?_t.return:q[0]?_t.throw||((De=_t.return)&&De.call(_t),0):_t.next)&&!(De=De.call(_t,q[1])).done)return De;switch(_t=0,De&&(q=[q[0]&2,De.value]),q[0]){case 0:case 1:De=q;break;case 4:return xe.label++,{value:q[1],done:!1};case 5:xe.label++,_t=q[1],q=[0];continue;case 7:q=xe.ops.pop(),xe.trys.pop();continue;default:if(De=xe.trys,!(De=De.length>0&&De[De.length-1])&&(q[0]===6||q[0]===2)){xe=0;continue}if(q[0]===3&&(!De||q[1]>De[0]&&q[1]<De[3])){xe.label=q[1];break}if(q[0]===6&&xe.label<De[1]){xe.label=De[1],De=q;break}if(De&&xe.label<De[2]){xe.label=De[2],xe.ops.push(q);break}De[2]&&xe.ops.pop(),xe.trys.pop();continue}q=rt.call(ie,xe)}catch(Y){q=[6,Y],_t=0}finally{he=De=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}},Xe=function(ie){var rt,xe={anchor:0,cdn:R.g.CDN,customEmoji:{},emojiPath:"".concat(R.g.CDN,"/dist/images/emoji"),hljs:R.g.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:R.g.MARKDOWN_OPTIONS,math:R.g.MATH_OPTIONS,mode:"light",speech:{enable:!1},render:{media:{enable:!0}},theme:R.g.THEME_OPTIONS};return ie.cdn&&(!((rt=ie.theme)===null||rt===void 0)&&rt.path||(xe.theme.path="".concat(ie.cdn,"/dist/css/content-theme")),ie.emojiPath||(xe.emojiPath="".concat(ie.cdn,"/dist/images/emoji"))),(0,oe.T)(xe,ie)},He=function(ie,rt){var xe=Xe(rt);return(0,U.G)("".concat(xe.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){var he=(0,ve.X)({autoSpace:xe.markdown.autoSpace,gfmAutoLink:xe.markdown.gfmAutoLink,codeBlockPreview:xe.markdown.codeBlockPreview,emojiSite:xe.emojiPath,emojis:xe.customEmoji,fixTermTypo:xe.markdown.fixTermTypo,footnotes:xe.markdown.footnotes,headingAnchor:xe.anchor!==0,inlineMathDigit:xe.math.inlineDigit,lazyLoadImage:xe.lazyLoadImage,linkBase:xe.markdown.linkBase,linkPrefix:xe.markdown.linkPrefix,listStyle:xe.markdown.listStyle,mark:xe.markdown.mark,mathBlockPreview:xe.markdown.mathBlockPreview,paragraphBeginningSpace:xe.markdown.paragraphBeginningSpace,sanitize:xe.markdown.sanitize,toc:xe.markdown.toc});return rt!=null&&rt.renderers&&he.SetJSRenderers({renderers:{Md2HTML:rt.renderers}}),he.SetHeadingID(!0),he.Md2HTML(ie)})},j=function(ie,rt,xe){return Te(void 0,void 0,void 0,function(){var he,_t,De,N;return Ge(this,function(H){switch(H.label){case 0:return he=Xe(xe),[4,He(rt,he)];case 1:if(_t=H.sent(),he.transform&&(_t=he.transform(_t)),ie.innerHTML=_t,ie.classList.add("vditor-reset"),he.i18n)return[3,5];if(["de_DE","en_US","es_ES","fr_FR","ja_JP","ko_KR","pt_BR","ru_RU","sv_SE","vi_VN","zh_CN","zh_TW"].includes(he.lang))return[3,2];throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");case 2:return De="vditorI18nScript",N=De+he.lang,document.querySelectorAll('head script[id^="'.concat(De,'"]')).forEach(function(W){W.id!==N&&document.head.removeChild(W)}),[4,(0,U.G)("".concat(he.cdn,"/dist/js/i18n/").concat(he.lang,".js"),N)];case 3:H.sent(),H.label=4;case 4:return[3,6];case 5:window.VditorI18n=he.i18n,H.label=6;case 6:return he.icon?[4,(0,U.G)("".concat(he.cdn,"/dist/js/icons/").concat(he.icon,".js"),"vditorIconScript")]:[3,8];case 7:H.sent(),H.label=8;case 8:return(0,K.Z)(he.theme.current,he.theme.path),he.anchor===1&&ie.classList.add("vditor-reset--anchor"),(0,p.O)(ie,he.hljs),(0,v.s)(he.hljs,ie,he.cdn),(0,x.H)(ie,{cdn:he.cdn,math:he.math}),(0,M.i)(ie,he.cdn,he.mode),(0,T.J)(ie,he.cdn,he.mode),(0,S.K)(ie,he.cdn),(0,g.P)(ie,he.cdn),(0,y.v)(ie,he.cdn),(0,f.p)(ie,he.cdn,he.mode),(0,A.P)(ie,he.cdn,he.mode),(0,B.B)(ie,he.cdn),(0,c.Q)(ie,he.cdn),he.render.media.enable&&(0,_.Y)(ie),he.speech.enable&&Se(ie),he.anchor!==0&&ne(he.anchor),he.after&&he.after(),he.lazyLoadImage&&k(ie),ie.addEventListener("click",function(W){var q=(0,z.lG)(W.target,"SPAN");if(q&&(0,z.fb)(q,"vditor-toc")){var Y=ie.querySelector("#"+q.getAttribute("data-target-id"));Y&&window.scrollTo(window.scrollX,Y.offsetTop);return}}),[2]}})})},Ze=a(190),sn=a(580),st=function(){function ie(){}return ie.adapterRender=u,ie.previewImage=Ze.E,ie.codeRender=p.O,ie.graphvizRender=y.v,ie.highlightRender=v.s,ie.mathRender=x.H,ie.mermaidRender=M.i,ie.SMILESRender=T.J,ie.markmapRender=S.K,ie.flowchartRender=g.P,ie.chartRender=f.p,ie.abcRender=c.Q,ie.mindmapRender=A.P,ie.plantumlRender=B.B,ie.outlineRender=I.k,ie.mediaRender=_.Y,ie.speechRender=Se,ie.lazyLoadImageRender=k,ie.md2html=He,ie.preview=j,ie.setCodeTheme=sn.Y,ie.setContentTheme=K.Z,ie}();const Nt=st},145:(o,l,a)=>{a.d(l,{H:()=>c,g:()=>u});var c="3.11.2",u=function(){function f(){}return f.ZWSP="",f.DROP_EDITOR="application/editor",f.MOBILE_WIDTH=520,f.CLASS_MENU_DISABLED="vditor-menu--disabled",f.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],f.CODE_THEME=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256","ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],f.ALIAS_CODE_LANGUAGES=["abc","plantuml","mermaid","flowchart","echarts","mindmap","graphviz","math","markmap","smiles","js","ts","html","toml","c#","bat"],f.CDN="https://unpkg.com/vditor@".concat("3.11.2"),f.MARKDOWN_OPTIONS={autoSpace:!1,gfmAutoLink:!0,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",linkPrefix:"",listStyle:!1,mark:!1,mathBlockPreview:!0,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},f.HLJS_OPTIONS={enable:!0,lineNumber:!1,defaultLang:"",style:"github"},f.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},f.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:"".concat(f.CDN,"/dist/css/content-theme")},f}()},825:(o,l,a)=>{a.d(l,{J:()=>g});var c=a(145),u=a(413),f=a(840),p=a(494),g=function(y,v,k){y===void 0&&(y=document),v===void 0&&(v=c.g.CDN);var x=f.SMILESRenderAdapter.getElements(y);x.length>0&&(0,u.G)("".concat(v,"/dist/js/smiles-drawer/smiles-drawer.min.js?v=2.1.7"),"vditorAbcjsScript").then(function(){var _=new SmiDrawer({},{});x.forEach(function(M){var T=f.SMILESRenderAdapter.getCode(M).trim();if(!(M.getAttribute("data-processed")==="true"||T.trim()==="")){var S="smiles"+(0,p.Wb)();M.innerHTML='<svg id="'.concat(S,'"></svg>'),_.draw(T,"#"+S,k==="dark"?"dark":void 0),M.setAttribute("data-processed","true")}})})}},135:(o,l,a)=>{a.d(l,{Q:()=>p});var c=a(145),u=a(413),f=a(840),p=function(g,y){g===void 0&&(g=document),y===void 0&&(y=c.g.CDN);var v=f.abcRenderAdapter.getElements(g);v.length>0&&(0,u.G)("".concat(y,"/dist/js/abcjs/abcjs_basic.min.js"),"vditorAbcjsScript").then(function(){v.forEach(function(k){k.parentElement.classList.contains("vditor-wysiwyg__pre")||k.parentElement.classList.contains("vditor-ir__marker--pre")||k.getAttribute("data-processed")!=="true"&&(ABCJS.renderAbc(k,f.abcRenderAdapter.getCode(k).trim()),k.style.overflowX="auto",k.setAttribute("data-processed","true"))})})}},840:(o,l,a)=>{a.r(l),a.d(l,{mathRenderAdapter:()=>c,SMILESRenderAdapter:()=>u,mermaidRenderAdapter:()=>f,markmapRenderAdapter:()=>p,mindmapRenderAdapter:()=>g,chartRenderAdapter:()=>y,abcRenderAdapter:()=>v,graphvizRenderAdapter:()=>k,flowchartRenderAdapter:()=>x,plantumlRenderAdapter:()=>_});var c={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-math")}},u={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-smiles")}},f={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-mermaid")}},p={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-markmap")}},g={getCode:function(M){return M.getAttribute("data-code")},getElements:function(M){return M.querySelectorAll(".language-mindmap")}},y={getCode:function(M){return M.innerText},getElements:function(M){return M.querySelectorAll(".language-echarts")}},v={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-abc")}},k={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-graphviz")}},x={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-flowchart")}},_={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-plantuml")}}},775:(o,l,a)=>{a.d(l,{p:()=>v});var c=a(145),u=a(413),f=a(840),p=a(494),g=function(k,x,_,M){function T(S){return S instanceof _?S:new _(function(A){A(S)})}return new(_||(_=Promise))(function(S,A){function I(K){try{R(M.next(K))}catch(U){A(U)}}function B(K){try{R(M.throw(K))}catch(U){A(U)}}function R(K){K.done?S(K.value):T(K.value).then(I,B)}R((M=M.apply(k,x||[])).next())})},y=function(k,x){var _={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},M,T,S,A;return A={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function I(R){return function(K){return B([R,K])}}function B(R){if(M)throw new TypeError("Generator is already executing.");for(;A&&(A=0,R[0]&&(_=0)),_;)try{if(M=1,T&&(S=R[0]&2?T.return:R[0]?T.throw||((S=T.return)&&S.call(T),0):T.next)&&!(S=S.call(T,R[1])).done)return S;switch(T=0,S&&(R=[R[0]&2,S.value]),R[0]){case 0:case 1:S=R;break;case 4:return _.label++,{value:R[1],done:!1};case 5:_.label++,T=R[1],R=[0];continue;case 7:R=_.ops.pop(),_.trys.pop();continue;default:if(S=_.trys,!(S=S.length>0&&S[S.length-1])&&(R[0]===6||R[0]===2)){_=0;continue}if(R[0]===3&&(!S||R[1]>S[0]&&R[1]<S[3])){_.label=R[1];break}if(R[0]===6&&_.label<S[1]){_.label=S[1],S=R;break}if(S&&_.label<S[2]){_.label=S[2],_.ops.push(R);break}S[2]&&_.ops.pop(),_.trys.pop();continue}R=x.call(k,_)}catch(K){R=[6,K],T=0}finally{M=S=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}},v=function(k,x,_){k===void 0&&(k=document),x===void 0&&(x=c.g.CDN);var M=f.chartRenderAdapter.getElements(k);M.length>0&&(0,u.G)("".concat(x,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){M.forEach(function(T){return g(void 0,void 0,void 0,function(){var S,A,I;return y(this,function(B){switch(B.label){case 0:if(T.parentElement.classList.contains("vditor-wysiwyg__pre")||T.parentElement.classList.contains("vditor-ir__marker--pre"))return[2];if(S=f.chartRenderAdapter.getCode(T).trim(),!S)return[2];B.label=1;case 1:return B.trys.push([1,3,,4]),T.getAttribute("data-processed")==="true"?[2]:[4,(0,p.Qf)(S)];case 2:return A=B.sent(),echarts.init(T,_==="dark"?"dark":void 0).setOption(A),T.setAttribute("data-processed","true"),[3,4];case 3:return I=B.sent(),T.className="vditor-reset--error",T.innerHTML="echarts render error: <br>".concat(I),[3,4];case 4:return[2]}})})})})}},428:(o,l,a)=>{a.d(l,{O:()=>f});var c=a(105),u=a(145),f=function(p,g){Array.from(p.querySelectorAll("pre > code")).filter(function(y,v){return!(y.parentElement.classList.contains("vditor-wysiwyg__pre")||y.parentElement.classList.contains("vditor-ir__marker--pre")||y.classList.contains("language-mermaid")||y.classList.contains("language-flowchart")||y.classList.contains("language-echarts")||y.classList.contains("language-mindmap")||y.classList.contains("language-plantuml")||y.classList.contains("language-markmap")||y.classList.contains("language-abc")||y.classList.contains("language-graphviz")||y.classList.contains("language-math")||y.classList.contains("language-smiles")||y.style.maxHeight.indexOf("px")>-1||p.classList.contains("vditor-preview")&&v>5)}).forEach(function(y){var v,k,x,_=y.innerText;if(y.classList.contains("highlight-chroma")){var M=y.cloneNode(!0);M.querySelectorAll(".highlight-ln").forEach(function(I){I.remove()}),_=M.innerText}else _.endsWith(`
`)&&(_=_.substr(0,_.length-1));var T='<svg><use xlink:href="#vditor-icon-copy"></use></svg>';document.getElementById("vditorIconScript")||(T='<svg viewBox="0 0 32 32"><path d="M22.545-0h-17.455c-1.6 0-2.909 1.309-2.909 2.909v20.364h2.909v-20.364h17.455v-2.909zM26.909 5.818h-16c-1.6 0-2.909 1.309-2.909 2.909v20.364c0 1.6 1.309 2.909 2.909 2.909h16c1.6 0 2.909-1.309 2.909-2.909v-20.364c0-1.6-1.309-2.909-2.909-2.909zM26.909 29.091h-16v-20.364h16v20.364z"></path></svg>');var S=document.createElement("div");S.className="vditor-copy",S.innerHTML='<span aria-label="'.concat(((v=window.VditorI18n)===null||v===void 0?void 0:v.copy)||"",`"
onmouseover="this.setAttribute('aria-label', '`).concat(((k=window.VditorI18n)===null||k===void 0?void 0:k.copy)||"",`')"
class="vditor-tooltipped vditor-tooltipped__w"
onclick="event.stopPropagation();this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '`).concat(((x=window.VditorI18n)===null||x===void 0?void 0:x.copied)||"",`');this.previousElementSibling.blur()">`).concat(T,"</span>");var A=document.createElement("textarea");A.value=(0,c.X)(_),S.insertAdjacentElement("afterbegin",A),g&&g.renderMenu&&g.renderMenu(y,S),y.before(S),y.style.maxHeight=window.outerHeight-40+"px",y.insertAdjacentHTML("afterend",'<span style="position: absolute">'.concat(u.g.ZWSP,"</span>"))})}},325:(o,l,a)=>{a.d(l,{P:()=>p});var c=a(145),u=a(413),f=a(840),p=function(g,y){y===void 0&&(y=c.g.CDN);var v=f.flowchartRenderAdapter.getElements(g);v.length!==0&&(0,u.G)("".concat(y,"/dist/js/flowchart.js/flowchart.min.js"),"vditorFlowchartScript").then(function(){v.forEach(function(k){if(k.getAttribute("data-processed")!=="true"){var x=flowchart.parse(f.flowchartRenderAdapter.getCode(k));k.innerHTML="",x.drawSVG(k),k.setAttribute("data-processed","true")}})})}},483:(o,l,a)=>{a.d(l,{v:()=>p});var c=a(145),u=a(413),f=a(840),p=function(g,y){y===void 0&&(y=c.g.CDN);var v=f.graphvizRenderAdapter.getElements(g);v.length!==0&&(0,u.G)("".concat(y,"/dist/js/graphviz/viz.js"),"vditorGraphVizScript").then(function(){v.forEach(function(k){var x=f.graphvizRenderAdapter.getCode(k);if(!(k.parentElement.classList.contains("vditor-wysiwyg__pre")||k.parentElement.classList.contains("vditor-ir__marker--pre"))&&!(k.getAttribute("data-processed")==="true"||x.trim()==="")){try{var _=new Blob(["importScripts('".concat(document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js"),"');")],{type:"application/javascript"}),M=window.URL||window.webkitURL,T=M.createObjectURL(_),S=new Worker(T);new Viz({worker:S}).renderSVGElement(x).then(function(A){k.innerHTML=A.outerHTML}).catch(function(A){k.innerHTML="graphviz render error: <br>".concat(A),k.className="vditor-reset--error"})}catch(A){console.error("graphviz error",A)}k.setAttribute("data-processed","true")}})})}},999:(o,l,a)=>{a.d(l,{s:()=>p});var c=a(145),u=a(413),f=a(290),p=function(g,y,v){y===void 0&&(y=document),v===void 0&&(v=c.g.CDN);var k=g.style;c.g.CODE_THEME.includes(k)||(k="github");var x=document.getElementById("vditorHljsStyle"),_="".concat(v,"/dist/js/highlight.js/styles/").concat(k,".min.css");if(x&&x.getAttribute("href")!==_&&x.remove(),(0,f.c)("".concat(v,"/dist/js/highlight.js/styles/").concat(k,".min.css"),"vditorHljsStyle"),g.enable!==!1){var M=y.querySelectorAll("pre > code");M.length!==0&&(0,u.G)("".concat(v,"/dist/js/highlight.js/highlight.min.js?v=11.7.0"),"vditorHljsScript").then(function(){(0,u.G)("".concat(v,"/dist/js/highlight.js/third-languages.js?v=1.0.1"),"vditorHljsThirdScript").then(function(){y.querySelectorAll("pre > code").forEach(function(T){if(!(T.parentElement.classList.contains("vditor-ir__marker--pre")||T.parentElement.classList.contains("vditor-wysiwyg__pre"))&&!(T.classList.contains("language-mermaid")||T.classList.contains("language-flowchart")||T.classList.contains("language-echarts")||T.classList.contains("language-mindmap")||T.classList.contains("language-plantuml")||T.classList.contains("language-smiles")||T.classList.contains("language-abc")||T.classList.contains("language-graphviz")||T.classList.contains("language-math"))){g.defaultLang!==""&&T.className.indexOf("language-")===-1&&T.classList.add("language-"+g.defaultLang);var S=T.className.replace("language-","");if(window.hljs.getLanguage(S)||(S="plaintext"),T.innerHTML=window.hljs.highlight(T.textContent,{language:S,ignoreIllegals:!0}).value,T.classList.add("hljs"),!!g.lineNumber){T.classList.add("vditor-linenumber");var A=T.querySelector(".vditor-linenumber__temp");A||(A=document.createElement("div"),A.className="vditor-linenumber__temp",T.insertAdjacentElement("beforeend",A));var I=getComputedStyle(T).whiteSpace,B=!1;(I==="pre-wrap"||I==="pre-line")&&(B=!0);var R="",K=T.textContent.split(/\r\n|\r|\n/g);K.pop(),K.map(function(U){var z="";B&&(A.textContent=U||`
`,z=' style="height:'.concat(A.getBoundingClientRect().height,'px"')),R+="<span".concat(z,"></span>")}),A.style.display="none",R='<span class="vditor-linenumber__rows">'.concat(R,"</span>"),T.insertAdjacentHTML("beforeend",R)}}})})})}}},11:(o,l,a)=>{a.d(l,{K:()=>v});var c=a(145),u=a(413),f=a(840),p={},g=function(k,x){var _=k.transform(x),M=Object.keys(_.features).filter(function(B){return!p[B]});M.forEach(function(B){p[B]=!0});var T=k.getAssets(M),S=T.styles,A=T.scripts,I=window.markmap;return S&&I.loadCSS(S),A&&I.loadJS(A),_},y=function(k,x){var _=window.markmap,M=_.Transformer,T=_.Markmap,S=_.deriveOptions;_.globalCSS;var A=new M;k.innerHTML='<svg style="width:100%"></svg>';var I=k.firstChild,B=T.create(I,null),R=g(A,x),K=R.root,U=R.frontmatter,z=U==null?void 0:U.markmap,oe=S(z);B.setData(K,oe),B.fit()},v=function(k,x){k===void 0&&(k=document),x===void 0&&(x=c.g.CDN);var _=f.markmapRenderAdapter.getElements(k);_.length!==0&&(0,u.G)("".concat(x,"/dist/js/markmap/markmap.min.js"),"vditorMarkerScript").then(function(){_.forEach(function(M){var T=f.markmapRenderAdapter.getCode(M);if(!(M.getAttribute("data-processed")==="true"||T.trim()==="")){var S=document.createElement("div");S.className="language-markmap",M.parentNode.appendChild(S),y(S,T),M.parentNode.childNodes[0].nodeName=="CODE"&&M.parentNode.removeChild(M.parentNode.childNodes[0])}})})}},472:(o,l,a)=>{a.d(l,{H:()=>y});var c=a(145),u=a(413),f=a(290),p=a(105),g=a(840),y=function(v,k){v===void 0&&(v=document);var x=g.mathRenderAdapter.getElements(v);if(x.length!==0){var _={cdn:c.g.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(k&&k.math&&(k.math=Object.assign({},_.math,k.math)),k=Object.assign({},_,k),k.math.engine==="KaTeX")(0,f.c)("".concat(k.cdn,"/dist/js/katex/katex.min.css?v=0.16.9"),"vditorKatexStyle"),(0,u.G)("".concat(k.cdn,"/dist/js/katex/katex.min.js?v=0.16.9"),"vditorKatexScript").then(function(){(0,u.G)("".concat(k.cdn,"/dist/js/katex/mhchem.min.js?v=0.16.9"),"vditorKatexChemScript").then(function(){x.forEach(function(S){if(!(S.parentElement.classList.contains("vditor-wysiwyg__pre")||S.parentElement.classList.contains("vditor-ir__marker--pre"))&&!S.getAttribute("data-math")){var A=(0,p.X)(g.mathRenderAdapter.getCode(S));S.setAttribute("data-math",A);try{S.innerHTML=katex.renderToString(A,{displayMode:S.tagName==="DIV",output:"html",macros:k.math.macros})}catch(I){S.innerHTML=I.message,S.className="language-math vditor-reset--error"}S.addEventListener("copy",function(I){I.stopPropagation(),I.preventDefault();var B=I.currentTarget.closest(".language-math");I.clipboardData.setData("text/html",B.innerHTML),I.clipboardData.setData("text/plain",B.getAttribute("data-math"))})}})})});else if(k.math.engine==="MathJax"){var M=function(S){if(S.length!==0){var A=0,I=S[S.length-1],B=function(){var R=S[A++];R===I?R():R(B)};B()}};window.MathJax||(window.MathJax={loader:{paths:{mathjax:"".concat(k.cdn,"/dist/js/mathjax")}},startup:{typeset:!1},tex:{macros:k.math.macros}},Object.assign(window.MathJax,k.math.mathJaxOptions)),(0,u.J)("".concat(k.cdn,"/dist/js/mathjax/tex-svg-full.js"),"protyleMathJaxScript");var T=function(S,A){var I=(0,p.X)(S.textContent).trim(),B=window.MathJax.getMetricsFor(S);B.display=S.tagName==="DIV",window.MathJax.tex2svgPromise(I,B).then(function(R){S.innerHTML="",S.setAttribute("data-math",I),S.append(R),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var K=R.querySelector('[data-mml-node="merror"]');K&&K.textContent.trim()!==""&&(S.innerHTML=K.textContent.trim(),S.className="vditor-reset--error"),A&&A()})};window.MathJax.startup.promise.then(function(){for(var S=[],A=function(B){var R=x[B];!R.parentElement.classList.contains("vditor-wysiwyg__pre")&&!R.parentElement.classList.contains("vditor-ir__marker--pre")&&!R.getAttribute("data-math")&&(0,p.X)(R.textContent).trim()&&S.push(function(K){B===x.length-1?T(R):T(R,K)})},I=0;I<x.length;I++)A(I);M(S)})}}}},280:(o,l,a)=>{a.d(l,{Y:()=>g});var c=a(494),u=function(y,v){y.insertAdjacentHTML("afterend",'<video controls="controls" src="'.concat(v,'"></video>')),y.remove()},f=function(y,v){y.insertAdjacentHTML("afterend",'<audio controls="controls" src="'.concat(v,'"></audio>')),y.remove()},p=function(y,v){var k=v.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),x=v.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),_=v.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),M=v.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),T=v.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),S=v.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),A=v.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),I=v.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);if(k&&k[1].length===11)y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'.concat(k[1]+(k[2]?"?start="+k[2]:""),'"></iframe>')),y.remove();else if(x&&x[1])y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'.concat(x[1],'"></iframe>')),y.remove();else if(_&&_[1])y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='.concat(_[1],'"></iframe>')),y.remove();else if(M&&M[1])y.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="//coub.com/embed/`.concat(M[1],'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>')),y.remove();else if(T&&T[0])y.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.facebook.com/plugins/video.php?href=`.concat(encodeURIComponent(T[0]),'"></iframe>')),y.remove();else if(S&&S[2])y.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.dailymotion.com/embed/video/`.concat(S[2],'"></iframe>')),y.remove();else if(v.indexOf("bilibili.com")>-1&&(v.indexOf("bvid=")>-1||A&&A[1])){var B={bvid:(0,c.on)("bvid",v)||A&&A[1],page:"1",high_quality:"1",as_wide:"1",allowfullscreen:"true",autoplay:"0"};new URL(v.startsWith("http")?v:"https:"+v).search.split("&").forEach(function(U,z){if(U){z===0&&(U=U.substr(1));var oe=U.split("=");B[oe[0]]=oe[1]}});var R="https://player.bilibili.com/player.html?",K=Object.keys(B);K.forEach(function(U,z){R+="".concat(U,"=").concat(B[U]),z<K.length-1&&(R+="&")}),y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="'.concat(R,'"></iframe>')),y.remove()}else I&&I[1]&&(y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'.concat(I[1],'"></iframe>')),y.remove())},g=function(y){y&&y.querySelectorAll("a").forEach(function(v){var k=v.getAttribute("href");k&&(k.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?u(v,k):k.match(/^.+.(mp3|wav|flac)$/)?f(v,k):p(v,k))})}},637:(o,l,a)=>{a.d(l,{i:()=>v});var c=a(145),u=a(413),f=a(840),p=a(494),g=function(k,x,_,M){function T(S){return S instanceof _?S:new _(function(A){A(S)})}return new(_||(_=Promise))(function(S,A){function I(K){try{R(M.next(K))}catch(U){A(U)}}function B(K){try{R(M.throw(K))}catch(U){A(U)}}function R(K){K.done?S(K.value):T(K.value).then(I,B)}R((M=M.apply(k,x||[])).next())})},y=function(k,x){var _={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},M,T,S,A;return A={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function I(R){return function(K){return B([R,K])}}function B(R){if(M)throw new TypeError("Generator is already executing.");for(;A&&(A=0,R[0]&&(_=0)),_;)try{if(M=1,T&&(S=R[0]&2?T.return:R[0]?T.throw||((S=T.return)&&S.call(T),0):T.next)&&!(S=S.call(T,R[1])).done)return S;switch(T=0,S&&(R=[R[0]&2,S.value]),R[0]){case 0:case 1:S=R;break;case 4:return _.label++,{value:R[1],done:!1};case 5:_.label++,T=R[1],R=[0];continue;case 7:R=_.ops.pop(),_.trys.pop();continue;default:if(S=_.trys,!(S=S.length>0&&S[S.length-1])&&(R[0]===6||R[0]===2)){_=0;continue}if(R[0]===3&&(!S||R[1]>S[0]&&R[1]<S[3])){_.label=R[1];break}if(R[0]===6&&_.label<S[1]){_.label=S[1],S=R;break}if(S&&_.label<S[2]){_.label=S[2],_.ops.push(R);break}S[2]&&_.ops.pop(),_.trys.pop();continue}R=x.call(k,_)}catch(K){R=[6,K],T=0}finally{M=S=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}},v=function(k,x,_){k===void 0&&(k=document),x===void 0&&(x=c.g.CDN);var M=f.mermaidRenderAdapter.getElements(k);M.length!==0&&(0,u.G)("".concat(x,"/dist/js/mermaid/mermaid.min.js?v=11.6.0"),"vditorMermaidScript").then(function(){var T={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8,showSequenceNumbers:!0},gantt:{leftPadding:75,rightPadding:20}};_==="dark"&&(T.theme="dark"),mermaid.initialize(T),M.forEach(function(S){return g(void 0,void 0,void 0,function(){var A,I,B,R,K;return y(this,function(U){switch(U.label){case 0:if(A=f.mermaidRenderAdapter.getCode(S),S.getAttribute("data-processed")==="true"||A.trim()==="")return[2];I="mermaid"+(0,p.Wb)(),U.label=1;case 1:return U.trys.push([1,3,,4]),[4,mermaid.render(I,S.textContent)];case 2:return B=U.sent(),S.innerHTML=B.svg,[3,4];case 3:return R=U.sent(),K=document.querySelector("#"+I),S.innerHTML="".concat(K.outerHTML,`<br>
<div style="text-align: left"><small>`).concat(R.message.replace(/\n/,"<br>"),"</small></div>"),K.parentElement.remove(),[3,4];case 4:return S.setAttribute("data-processed","true"),[2]}})})})})}},194:(o,l,a)=>{a.d(l,{P:()=>p});var c=a(145),u=a(413),f=a(840),p=function(g,y,v){g===void 0&&(g=document),y===void 0&&(y=c.g.CDN);var k=f.mindmapRenderAdapter.getElements(g);k.length>0&&(0,u.G)("".concat(y,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){k.forEach(function(x){if(!(x.parentElement.classList.contains("vditor-wysiwyg__pre")||x.parentElement.classList.contains("vditor-ir__marker--pre"))){var _=f.mindmapRenderAdapter.getCode(x);if(_)try{if(x.getAttribute("data-processed")==="true")return;echarts.init(x,v==="dark"?"dark":void 0).setOption({series:[{data:[JSON.parse(decodeURIComponent(_))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(M,T){var S;return!((S=T==null?void 0:T.data)===null||S===void 0)&&S.children?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}}),x.setAttribute("data-processed","true")}catch(M){x.className="vditor-reset--error",x.innerHTML="mindmap render error: <br>".concat(M)}}})})}},436:(o,l,a)=>{a.d(l,{k:()=>f});var c=a(771),u=a(472),f=function(p,g,y){var v="",k=[];if(Array.from(p.children).forEach(function(T,S){if((0,c.W)(T)){if(y){var A=T.id.lastIndexOf("_");T.id=T.id.substring(0,A===-1?void 0:A)+"_"+S}k.push(T.id),v+=T.outerHTML.replace("<wbr>","")}}),v==="")return g.innerHTML="","";var x=document.createElement("div");if(y)y.lute.SetToC(!0),y.currentMode==="wysiwyg"&&!y.preview.element.contains(p)?x.innerHTML=y.lute.SpinVditorDOM("<p>[ToC]</p>"+v):y.currentMode==="ir"&&!y.preview.element.contains(p)?x.innerHTML=y.lute.SpinVditorIRDOM("<p>[ToC]</p>"+v):x.innerHTML=y.lute.HTML2VditorDOM("<p>[ToC]</p>"+v),y.lute.SetToC(y.options.preview.markdown.toc);else{g.classList.add("vditor-outline");var _=Lute.New();_.SetToC(!0),x.innerHTML=_.HTML2VditorDOM("<p>[ToC]</p>"+v)}var M=x.firstElementChild.querySelectorAll("li > span[data-target-id]");return M.forEach(function(T,S){if(T.nextElementSibling&&T.nextElementSibling.tagName==="UL"){var A="<svg class='vditor-outline__action'><use xlink:href='#vditor-icon-down'></use></svg>";document.getElementById("vditorIconScript")||(A='<svg class="vditor-outline__action" viewBox="0 0 32 32"><path d="M3.76 6.12l12.24 12.213 12.24-12.213 3.76 3.76-16 16-16-16 3.76-3.76z"></path></svg>'),T.innerHTML="".concat(A,"<span>").concat(T.innerHTML,"</span>")}else T.innerHTML="<svg></svg><span>".concat(T.innerHTML,"</span>");T.setAttribute("data-target-id",k[S])}),v=x.firstElementChild.innerHTML,M.length===0?(g.innerHTML="",v):(g.innerHTML=v,y&&(0,u.H)(g,{cdn:y.options.cdn,math:y.options.preview.math}),g.firstElementChild.addEventListener("click",function(T){for(var S=T.target;S&&!S.isEqualNode(g);){if(S.classList.contains("vditor-outline__action")){S.classList.contains("vditor-outline__action--close")?(S.classList.remove("vditor-outline__action--close"),S.parentElement.nextElementSibling.setAttribute("style","display:block")):(S.classList.add("vditor-outline__action--close"),S.parentElement.nextElementSibling.setAttribute("style","display:none")),T.preventDefault(),T.stopPropagation();break}else if(S.getAttribute("data-target-id")){T.preventDefault(),T.stopPropagation();var A=document.getElementById(S.getAttribute("data-target-id"));if(!A)return;if(y)if(y.options.height==="auto"){var I=A.offsetTop+y.element.offsetTop;y.options.toolbarConfig.pin||(I+=y.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,I)}else y.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,y.element.offsetTop),y.preview.element.contains(p)?p.parentElement.scrollTop=A.offsetTop:p.scrollTop=A.offsetTop;else window.scrollTo(window.scrollX,A.offsetTop);break}S=S.parentElement}}),v)}},229:(o,l,a)=>{a.d(l,{B:()=>p});var c=a(145),u=a(413),f=a(840),p=function(g,y){g===void 0&&(g=document),y===void 0&&(y=c.g.CDN);var v=f.plantumlRenderAdapter.getElements(g);v.length!==0&&(0,u.G)("".concat(y,"/dist/js/plantuml/plantuml-encoder.min.js"),"vditorPlantumlScript").then(function(){v.forEach(function(k){if(!(k.parentElement.classList.contains("vditor-wysiwyg__pre")||k.parentElement.classList.contains("vditor-ir__marker--pre"))){var x=f.plantumlRenderAdapter.getCode(k).trim();if(x)try{k.innerHTML='<object type="image/svg+xml" data="https://www.plantuml.com/plantuml/svg/~1'.concat(plantumlEncoder.encode(x),'"/>')}catch(_){k.className="vditor-reset--error",k.innerHTML="plantuml render error: <br>".concat(_)}}})})}},214:(o,l,a)=>{a.d(l,{X:()=>c});var c=function(u){var f=Lute.New();return f.PutEmojis(u.emojis),f.SetEmojiSite(u.emojiSite),f.SetHeadingAnchor(u.headingAnchor),f.SetInlineMathAllowDigitAfterOpenMarker(u.inlineMathDigit),f.SetAutoSpace(u.autoSpace),f.SetToC(u.toc),f.SetFootnotes(u.footnotes),f.SetFixTermTypo(u.fixTermTypo),f.SetVditorCodeBlockPreview(u.codeBlockPreview),f.SetVditorMathBlockPreview(u.mathBlockPreview),f.SetSanitize(u.sanitize),f.SetChineseParagraphBeginningSpace(u.paragraphBeginningSpace),f.SetRenderListStyle(u.listStyle),f.SetLinkBase(u.linkBase),f.SetLinkPrefix(u.linkPrefix),f.SetMark(u.mark),f.SetGFMAutoLink(u.gfmAutoLink),u.lazyLoadImage&&f.SetImageLazyLoading(u.lazyLoadImage),f}},190:(o,l,a)=>{a.d(l,{E:()=>c});var c=function(u,f,p){p===void 0&&(p="classic");var g=u.getBoundingClientRect(),y=36;document.body.insertAdjacentHTML("beforeend",'<div class="vditor vditor-img'.concat(p==="dark"?" vditor--dark":"",`">
    <div class="vditor-img__bar">
      <span class="vditor-img__btn" data-deg="0">
        <svg><use xlink:href="#vditor-icon-redo"></use></svg>
        `).concat(window.VditorI18n.spin,`
      </span>
      <span class="vditor-img__btn"  onclick="this.parentElement.parentElement.outerHTML = '';document.body.style.overflow = ''">
        X &nbsp;`).concat(window.VditorI18n.close,`
      </span>
    </div>
    <div class="vditor-img__img" onclick="this.parentElement.outerHTML = '';document.body.style.overflow = ''">
      <img style="width: `).concat(u.width,"px;height:").concat(u.height,"px;transform: translate3d(").concat(g.left,"px, ").concat(g.top-y,'px, 0)" src="').concat(u.getAttribute("src"),`">
    </div>
</div>`)),document.body.style.overflow="hidden";var v=document.querySelector(".vditor-img img"),k="translate3d(".concat(Math.max(0,window.innerWidth-u.naturalWidth)/2,"px, ").concat(Math.max(0,window.innerHeight-y-u.naturalHeight)/2,"px, 0)");setTimeout(function(){v.setAttribute("style","transition: transform .3s ease-in-out;transform: ".concat(k)),setTimeout(function(){v.parentElement.scrollTo((v.parentElement.scrollWidth-v.parentElement.clientWidth)/2,(v.parentElement.scrollHeight-v.parentElement.clientHeight)/2)},400)});var x=document.querySelector(".vditor-img__btn");x.addEventListener("click",function(){var _=parseInt(x.getAttribute("data-deg"),10)+90;_/90%2===1&&u.naturalWidth>v.parentElement.clientHeight?v.style.transform="translate3d(".concat(Math.max(0,window.innerWidth-u.naturalWidth)/2,"px, ").concat(u.naturalWidth/2-u.naturalHeight/2,"px, 0) rotateZ(").concat(_,"deg)"):v.style.transform="".concat(k," rotateZ(").concat(_,"deg)"),x.setAttribute("data-deg",_.toString()),setTimeout(function(){v.parentElement.scrollTo((v.parentElement.scrollWidth-v.parentElement.clientWidth)/2,(v.parentElement.scrollHeight-v.parentElement.clientHeight)/2)},400)})}},580:(o,l,a)=>{a.d(l,{Y:()=>f});var c=a(145),u=a(290),f=function(p,g){g===void 0&&(g=c.g.CDN),c.g.CODE_THEME.includes(p)||(p="github");var y=document.getElementById("vditorHljsStyle"),v="".concat(g,"/dist/js/highlight.js/styles/").concat(p,".min.css");y?y.getAttribute("href")!==v&&(y.remove(),(0,u.c)(v,"vditorHljsStyle")):(0,u.c)(v,"vditorHljsStyle")}},538:(o,l,a)=>{a.d(l,{Z:()=>u});var c=a(290),u=function(f,p){if(!(!f||!p)){var g=document.getElementById("vditorContentTheme"),y="".concat(p,"/").concat(f,".css");g?g.getAttribute("href")!==y&&(g.remove(),(0,c.c)(y,"vditorContentTheme")):(0,c.c)(y,"vditorContentTheme")}}},413:(o,l,a)=>{a.d(l,{J:()=>c,G:()=>u});var c=function(f,p){if(document.getElementById(p))return!1;var g=new XMLHttpRequest;g.open("GET",f,!1),g.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),g.send("");var y=document.createElement("script");y.type="text/javascript",y.text=g.responseText,y.id=p,document.head.appendChild(y)},u=function(f,p){return new Promise(function(g,y){if(document.getElementById(p))return g(!0),!1;var v=document.createElement("script");v.src=f,v.async=!0,document.head.appendChild(v),v.onerror=function(k){y(k)},v.onload=function(){if(document.getElementById(p))return v.remove(),g(!0),!1;v.id=p,g(!0)}})}},290:(o,l,a)=>{a.d(l,{c:()=>c});var c=function(u,f){if(!document.getElementById(f)){var p=document.createElement("link");p.id=f,p.rel="stylesheet",p.type="text/css",p.href=u,document.getElementsByTagName("head")[0].appendChild(p)}}},105:(o,l,a)=>{a.d(l,{X:()=>c});var c=function(u){return u.replace(/\u00a0/g," ")}},410:(o,l,a)=>{a.d(l,{G6:()=>c,vU:()=>u,pK:()=>f,Le:()=>p,yl:()=>g,ns:()=>y,i7:()=>v});var c=function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")===-1},u=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},f=function(){try{return typeof localStorage<"u"}catch{return!1}},p=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},g=function(k){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!!(k.metaKey&&!k.ctrlKey):!!(!k.metaKey&&k.ctrlKey)},y=function(k){return/Mac/.test(navigator.platform)||navigator.platform==="iPhone"?k.indexOf("")>-1&&u()&&(k=k.replace(";",":").replace("=","+").replace("-","_")):(k.startsWith("")?k=k.replace("","+"):k.startsWith("")&&k.substr(1,1)!==""?k=k.replace("","+"):k=k.replace("","++").replace("","++"),k=k.replace("","Ctrl").replace("","Shift").replace("","Alt"),k.indexOf("Shift")>-1&&(k=k.replace(";",":").replace("=","+").replace("-","_"))),k},v=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},494:(o,l,a)=>{a.d(l,{Wb:()=>c,on:()=>u,Qf:()=>f});var c=function(){return([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(p){return(parseInt(p,10)^window.crypto.getRandomValues(new Uint32Array(1))[0]&15>>parseInt(p,10)/4).toString(16)})},u=function(p,g){g===void 0&&(g=window.location.search);var y=g.substring(g.indexOf("?")),v=y.indexOf("#"),k=new URLSearchParams(y.substring(0,v>=0?v:void 0));return k.get(p)},f=function(p){return Function('"use strict";return ('.concat(p,")"))()}},106:(o,l,a)=>{a.d(l,{JQ:()=>u,E2:()=>f,O9:()=>p,a1:()=>g,F9:()=>y,lG:()=>v,fb:()=>k,DX:()=>x});var c=a(771),u=function(_,M){for(var T=k(_,M),S=!1,A=!1;T&&!T.classList.contains("vditor-reset")&&!A;)S=k(T.parentElement,M),S?T=S:A=!0;return T||!1},f=function(_,M){for(var T=(0,c.S)(_,M),S=!1,A=!1;T&&!T.classList.contains("vditor-reset")&&!A;)S=(0,c.S)(T.parentElement,M),S?T=S:A=!0;return T||!1},p=function(_){var M=f(_,"UL"),T=f(_,"OL"),S=M;return T&&(!M||M&&T.contains(M))&&(S=T),S},g=function(_,M,T){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var S=_,A=!1;S&&!A&&!S.classList.contains("vditor-reset");)S.getAttribute(M)===T?A=!0:S=S.parentElement;return A&&S},y=function(_){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);var M=_,T=!1,S=g(_,"data-block","0");if(S)return S;for(;M&&!T&&!M.classList.contains("vditor-reset");)M.tagName==="H1"||M.tagName==="H2"||M.tagName==="H3"||M.tagName==="H4"||M.tagName==="H5"||M.tagName==="H6"||M.tagName==="P"||M.tagName==="BLOCKQUOTE"||M.tagName==="OL"||M.tagName==="UL"?T=!0:M=M.parentElement;return T&&M},v=function(_,M){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var T=_,S=!1;T&&!S&&!T.classList.contains("vditor-reset");)T.nodeName===M?S=!0:T=T.parentElement;return S&&T},k=function(_,M){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var T=_,S=!1;T&&!S&&!T.classList.contains("vditor-reset");)T.classList.contains(M)?S=!0:T=T.parentElement;return S&&T},x=function(_){for(;_&&_.lastChild;)_=_.lastChild;return _}},771:(o,l,a)=>{a.d(l,{S:()=>c,W:()=>u});var c=function(f,p){if(!f)return!1;f.nodeType===3&&(f=f.parentElement);for(var g=f,y=!1;g&&!y&&!g.classList.contains("vditor-reset");)g.nodeName.indexOf(p)===0?y=!0:g=g.parentElement;return y&&g},u=function(f){var p=c(f,"H");return p&&p.tagName.length===2&&p.tagName!=="HR"?p:!1}},673:(o,l,a)=>{a.d(l,{T:()=>c});var c=function(){for(var u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];for(var p={},g=function(v){for(var k in v)v.hasOwnProperty(k)&&(Object.prototype.toString.call(v[k])==="[object Object]"?p[k]=c(p[k],v[k]):p[k]=v[k])},y=0;y<u.length;y++)g(u[y]);return p}},810:(o,l,a)=>{a.d(l,{zh:()=>p,Ny:()=>g,Gb:()=>y,Hc:()=>v,im:()=>k,$j:()=>x,ib:()=>_,oC:()=>M});var c=a(145),u=a(410),f=a(106),p=function(T){var S,A=T[T.currentMode].element;return getSelection().rangeCount>0&&(S=getSelection().getRangeAt(0),A.isEqualNode(S.startContainer)||A.contains(S.startContainer))?S:T[T.currentMode].range?T[T.currentMode].range:(A.focus(),S=A.ownerDocument.createRange(),S.setStart(A,0),S.collapse(!0),S)},g=function(T){var S=window.getSelection().getRangeAt(0);if(!T.contains(S.startContainer)&&!(0,f.fb)(S.startContainer,"vditor-panel--none"))return{left:0,top:0};var A=T.parentElement.getBoundingClientRect(),I;if(S.getClientRects().length===0)if(S.startContainer.nodeType===3){var B=S.startContainer.parentElement;if(B&&B.getClientRects().length>0)I=B.getClientRects()[0];else return{left:0,top:0}}else{var R=S.startContainer.children;if(R[S.startOffset]&&R[S.startOffset].getClientRects().length>0)I=R[S.startOffset].getClientRects()[0];else if(S.startContainer.childNodes.length>0){var K=S.cloneRange();S.selectNode(S.startContainer.childNodes[Math.max(0,S.startOffset-1)]),I=S.getClientRects()[0],S.setEnd(K.endContainer,K.endOffset),S.setStart(K.startContainer,K.startOffset)}else I=S.startContainer.getClientRects()[0];if(!I){for(var U=S.startContainer.childNodes[S.startOffset];!U.getClientRects||U.getClientRects&&U.getClientRects().length===0;)U=U.parentElement;I=U.getClientRects()[0]}}else I=S.getClientRects()[0];return{left:I.left-A.left,top:I.top-A.top}},y=function(T,S){if(!S){if(getSelection().rangeCount===0)return!1;S=getSelection().getRangeAt(0)}var A=S.commonAncestorContainer;return T.isEqualNode(A)||T.contains(A)},v=function(T){var S=window.getSelection();S.removeAllRanges(),S.addRange(T)},k=function(T,S,A){var I={end:0,start:0};if(!A){if(getSelection().rangeCount===0)return I;A=window.getSelection().getRangeAt(0)}if(y(S,A)){var B=A.cloneRange();T.childNodes[0]&&T.childNodes[0].childNodes[0]?B.setStart(T.childNodes[0].childNodes[0],0):B.selectNodeContents(T),B.setEnd(A.startContainer,A.startOffset),I.start=B.toString().length,I.end=I.start+A.toString().length}return I},x=function(T,S,A){var I=0,B=0,R=A.childNodes[B],K=!1,U=!1;T=Math.max(0,T),S=Math.max(0,S);var z=A.ownerDocument.createRange();for(z.setStart(R||A,0),z.collapse(!0);!U&&R;){var oe=I+R.textContent.length;if(!K&&T>=I&&T<=oe&&(T===0?z.setStart(R,0):R.childNodes[0].nodeType===3?z.setStart(R.childNodes[0],T-I):R.nextSibling?z.setStartBefore(R.nextSibling):z.setStartAfter(R),K=!0,T===S)){U=!0;break}K&&S>=I&&S<=oe&&(S===0?z.setEnd(R,0):R.childNodes[0].nodeType===3?z.setEnd(R.childNodes[0],S-I):R.nextSibling?z.setEndBefore(R.nextSibling):z.setEndAfter(R),U=!0),I=oe,R=A.childNodes[++B]}return!U&&A.childNodes[B-1]&&z.setStartBefore(A.childNodes[B-1]),v(z),z},_=function(T,S){var A=T.querySelector("wbr");if(A){if(!A.previousElementSibling)A.previousSibling?S.setStart(A.previousSibling,A.previousSibling.textContent.length):A.nextSibling?A.nextSibling.nodeType===3?S.setStart(A.nextSibling,0):S.setStartBefore(A.nextSibling):S.setStart(A.parentElement,0);else if(A.previousElementSibling.isSameNode(A.previousSibling))if(A.previousElementSibling.lastChild){S.setStartBefore(A),S.collapse(!0),v(S),(0,u.i7)()&&(A.previousElementSibling.tagName==="EM"||A.previousElementSibling.tagName==="STRONG"||A.previousElementSibling.tagName==="S")&&(S.insertNode(document.createTextNode(c.g.ZWSP)),S.collapse(!1)),A.remove();return}else S.setStartAfter(A.previousElementSibling);else S.setStart(A.previousSibling,A.previousSibling.textContent.length);S.collapse(!0),A.remove(),v(S)}},M=function(T,S){var A=document.createElement("div");A.innerHTML=T;var I=A.querySelectorAll("p");I.length===1&&!I[0].previousSibling&&!I[0].nextSibling&&S[S.currentMode].element.children.length>0&&A.firstElementChild.tagName==="P"&&(T=I[0].innerHTML.trim());var B=document.createElement("div");B.innerHTML=T;var R=p(S);if(R.toString()!==""&&(S[S.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),B.firstElementChild&&B.firstElementChild.getAttribute("data-block")==="0"){B.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var K=(0,f.F9)(R.startContainer);if(!K)S[S.currentMode].element.insertAdjacentHTML("beforeend",B.innerHTML);else{var U=(0,f.lG)(R.startContainer,"LI");U&&B.firstElementChild.tagName==="UL"?U.insertAdjacentHTML("afterend",B.firstElementChild.innerHTML):K.insertAdjacentHTML("afterend",B.innerHTML)}_(S[S.currentMode].element,R)}else{var z=document.createElement("template");z.innerHTML=T,R.insertNode(z.content.cloneNode(!0)),R.collapse(!1),v(R)}}}},r={};function i(o){var l=r[o];if(l!==void 0)return l.exports;var a=r[o]={exports:{}};return t[o](a,a.exports,i),a.exports}i.d=(o,l)=>{for(var a in l)i.o(l,a)&&!i.o(o,a)&&Object.defineProperty(o,a,{enumerable:!0,get:l[a]})},i.o=(o,l)=>Object.prototype.hasOwnProperty.call(o,l),i.r=o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var s={};return(()=>{i.d(s,{default:()=>v3});var o=i(408),l=i(145),a=i(105),c=function(h){return h.currentMode==="sv"?(0,a.X)("".concat(h.sv.element.textContent,`
`).replace(/\n\n$/,`
`)):h.currentMode==="wysiwyg"?h.lute.VditorDOM2Md(h.wysiwyg.element.innerHTML):h.currentMode==="ir"?h.lute.VditorIRDOM2Md(h.ir.element.innerHTML):""},u=i(413),f=function(){function h(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return h.prototype.renderEchart=function(d){var m=this;d.devtools.element.style.display==="block"&&(0,u.G)("".concat(d.options.cdn,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){m.ASTChart||(m.ASTChart=echarts.init(d.devtools.element.lastElementChild));try{m.element.lastElementChild.style.display="block",m.element.firstElementChild.innerHTML="",m.ASTChart.setOption({series:[{data:JSON.parse(d.lute.RenderEChartsJSON(c(d))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),m.ASTChart.resize()}catch(b){m.element.lastElementChild.style.display="none",m.element.firstElementChild.innerHTML=b}})},h}(),p=i(410),g=function(h,d){d.forEach(function(m){if(h[m]){var b=h[m].children[0];b&&b.classList.contains("vditor-menu--current")&&b.classList.remove("vditor-menu--current")}})},y=function(h,d){d.forEach(function(m){if(h[m]){var b=h[m].children[0];b&&!b.classList.contains("vditor-menu--current")&&b.classList.add("vditor-menu--current")}})},v=function(h,d){d.forEach(function(m){if(h[m]){var b=h[m].children[0];b&&b.classList.contains(l.g.CLASS_MENU_DISABLED)&&b.classList.remove(l.g.CLASS_MENU_DISABLED)}})},k=function(h,d){d.forEach(function(m){if(h[m]){var b=h[m].children[0];b&&!b.classList.contains(l.g.CLASS_MENU_DISABLED)&&b.classList.add(l.g.CLASS_MENU_DISABLED)}})},x=function(h,d){d.forEach(function(m){h[m]&&h[m]&&(h[m].style.display="none")})},_=function(h,d){d.forEach(function(m){h[m]&&h[m]&&(h[m].style.display="block")})},M=function(h,d,m){d.includes("subToolbar")&&(h.toolbar.element.querySelectorAll(".vditor-hint").forEach(function(b){m&&b.isEqualNode(m)||(b.style.display="none")}),h.toolbar.elements.emoji&&(h.toolbar.elements.emoji.lastElementChild.style.display="none")),d.includes("hint")&&(h.hint.element.style.display="none"),h.wysiwyg.popover&&d.includes("popover")&&(h.wysiwyg.popover.style.display="none")},T=function(h,d,m,b){m.addEventListener((0,p.Le)(),function(w){w.preventDefault(),w.stopPropagation(),!m.classList.contains(l.g.CLASS_MENU_DISABLED)&&(h.toolbar.element.querySelectorAll(".vditor-hint--current").forEach(function(C){C.classList.remove("vditor-hint--current")}),d.style.display==="block"?d.style.display="none":(M(h,["subToolbar","hint","popover"],m.parentElement.parentElement),m.classList.contains("vditor-tooltipped")||m.classList.add("vditor-hint--current"),d.style.display="block",h.toolbar.element.getBoundingClientRect().right-m.getBoundingClientRect().right<250?d.classList.add("vditor-panel--left"):d.classList.remove("vditor-panel--left")))})},S=i(106),A=i(771),I=function(h,d,m,b){b&&console.log("".concat(h," - ").concat(m,": ").concat(d))},B=i(135),R=i(775),K=i(428),U=i(325),z=i(483),oe=i(999),ne=i(472),ve=i(637),ke=i(11),Se=i(194),Te=i(229),Ge=i(825),Xe=function(h,d,m){m===void 0&&(m="sv");var b=document.createElement("div");b.innerHTML=h;var w=!1;b.childElementCount===1&&b.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(w=!0);var C=b.querySelectorAll("pre");if(b.childElementCount===1&&C.length===1&&C[0].className!=="vditor-wysiwyg"&&C[0].className!=="vditor-sv"&&(w=!0),h.indexOf(`
<p class="p1">`)===0&&(w=!0),b.childElementCount===1&&b.firstElementChild.tagName==="TABLE"&&b.querySelector(".line-number")&&b.querySelector(".line-content")&&(w=!0),w){var E=d||h;return/\n/.test(E)||C.length===1?m==="wysiwyg"?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'.concat(E.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"<wbr></code></pre></div>"):"\n```\n"+E.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":m==="wysiwyg"?"<code>".concat(E.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"</code><wbr>"):"`".concat(E,"`")}return!1},He=function(h,d){if(h){if(h.parentElement.getAttribute("data-type")==="html-block"){h.setAttribute("data-render","1");return}var m=h.firstElementChild.className.replace("language-","");if(m==="abc")(0,B.Q)(h,d.options.cdn);else if(m==="mermaid")(0,ve.i)(h,d.options.cdn,d.options.theme);else if(m==="smiles")(0,Ge.J)(h,d.options.cdn,d.options.theme);else if(m==="markmap")(0,ke.K)(h,d.options.cdn);else if(m==="flowchart")(0,U.P)(h,d.options.cdn);else if(m==="echarts")(0,R.p)(h,d.options.cdn,d.options.theme);else if(m==="mindmap")(0,Se.P)(h,d.options.cdn,d.options.theme);else if(m==="plantuml")(0,Te.B)(h,d.options.cdn);else if(m==="graphviz")(0,z.v)(h,d.options.cdn);else if(m==="math")(0,ne.H)(h,{cdn:d.options.cdn,math:d.options.preview.math});else{var b=d.options.customRenders.find(function(w){if(w.language===m)return w.render(h,d),!0});b||((0,oe.s)(Object.assign({},d.options.preview.hljs),h,d.options.cdn),(0,K.O)(h,d.options.preview.hljs))}h.setAttribute("data-render","1")}},j=i(810),Ze=function(h){if(h.currentMode!=="sv"){var d=h[h.currentMode].element,m=h.outline.render(h);m===""&&(m="[ToC]"),d.querySelectorAll('[data-type="toc-block"]').forEach(function(b){b.innerHTML=m,(0,ne.H)(b,{cdn:h.options.cdn,math:h.options.preview.math})})}},sn=function(h,d){var m=(0,S.lG)(h.target,"SPAN");if(m&&(0,S.fb)(m,"vditor-toc")){var b=d[d.currentMode].element.querySelector("#"+m.getAttribute("data-target-id"));if(b)if(d.options.height==="auto"){var w=b.offsetTop+d.element.offsetTop;d.options.toolbarConfig.pin||(w+=d.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,w)}else d.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,d.element.offsetTop),d[d.currentMode].element.scrollTop=b.offsetTop;return}},st=function(h,d,m,b){if(h.previousElementSibling&&h.previousElementSibling.classList.contains("vditor-toc")){if(m.key==="Backspace"&&(0,j.im)(h,d[d.currentMode].element,b).start===0)return h.previousElementSibling.remove(),ht(d),!0;if(je(d,m,b,h,h.previousElementSibling))return!0}if(h.nextElementSibling&&h.nextElementSibling.classList.contains("vditor-toc")){if(m.key==="Delete"&&(0,j.im)(h,d[d.currentMode].element,b).start>=h.textContent.trimRight().length)return h.nextElementSibling.remove(),ht(d),!0;if(bt(d,m,b,h,h.nextElementSibling))return!0}if(m.key==="Backspace"||m.key==="Delete"){var w=(0,S.fb)(b.startContainer,"vditor-toc");if(w)return w.remove(),ht(d),!0}},Nt=function(h,d,m,b){m===void 0&&(m=!1);var w=(0,S.F9)(d.startContainer);if(w&&!m&&w.getAttribute("data-type")!=="code-block"){if(Ny(w.innerHTML)&&w.previousElementSibling||Ry(w.innerHTML))return;for(var C=(0,j.im)(w,h.ir.element,d).start,E=!0,O=C-1;O>w.textContent.substr(0,C).lastIndexOf(`
`);O--)if(w.textContent.charAt(O)!==" "&&w.textContent.charAt(O)!=="	"){E=!1;break}C===0&&(E=!1);for(var D=!0,O=C-1;O<w.textContent.length;O++)if(w.textContent.charAt(O)!==" "&&w.textContent.charAt(O)!==`
`){D=!1;break}if(E){typeof h.options.input=="function"&&h.options.input(c(h));return}if(D&&/^#{1,6} $/.test(w.textContent)&&(D=!1),D){var L=(0,S.fb)(d.startContainer,"vditor-ir__marker");if(!L){var P=d.startContainer.previousSibling;P&&P.nodeType!==3&&P.classList.contains("vditor-ir__node--expand")&&P.classList.remove("vditor-ir__node--expand"),typeof h.options.input=="function"&&h.options.input(c(h));return}}}if(h.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(ot){ot.classList.remove("vditor-ir__node--expand")}),w||(w=h.ir.element),!w.querySelector("wbr")){var $=(0,S.fb)(d.startContainer,"vditor-ir__preview");$?$.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):d.insertNode(document.createElement("wbr"))}w.querySelectorAll("[style]").forEach(function(ot){ot.removeAttribute("style")}),w.getAttribute("data-type")==="link-ref-defs-block"&&(w=h.ir.element);var fe=w.isEqualNode(h.ir.element),de=(0,S.a1)(w,"data-type","footnotes-block"),le="";if(fe)le=w.innerHTML;else{var Me=(0,A.S)(d.startContainer,"BLOCKQUOTE"),Ce=(0,S.O9)(d.startContainer);if(Ce&&(w=Ce),Me&&(!Ce||Ce&&!Me.contains(Ce))&&(w=Me),de&&(w=de),le=w.outerHTML,w.tagName==="UL"||w.tagName==="OL"){var ae=w.previousElementSibling,$e=w.nextElementSibling;ae&&(ae.tagName==="UL"||ae.tagName==="OL")&&(le=ae.outerHTML+le,ae.remove()),$e&&($e.tagName==="UL"||$e.tagName==="OL")&&(le=le+$e.outerHTML,$e.remove()),le=le.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else w.previousElementSibling&&w.previousElementSibling.textContent.replace(l.g.ZWSP,"")!==""&&b&&b.inputType==="insertParagraph"&&(le=w.previousElementSibling.outerHTML+le,w.previousElementSibling.remove());w.innerText.startsWith("```")||(h.ir.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ot){ot&&!w.isEqualNode(ot)&&(le+=ot.outerHTML,ot.remove())}),h.ir.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(ot){ot&&!w.isEqualNode(ot)&&(le+=ot.outerHTML,ot.remove())}))}if(I("SpinVditorIRDOM",le,"argument",h.options.debugger),le=h.lute.SpinVditorIRDOM(le),I("SpinVditorIRDOM",le,"result",h.options.debugger),fe)w.innerHTML=le;else if(w.outerHTML=le,de){var Ae=(0,S.a1)(h.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(Ae){var Ye=Ae.textContent,Bt=Ye.substring(1,Ye.indexOf("]:")),Dt=h.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(Bt,'"]'));Dt&&Dt.setAttribute("aria-label",Ye.substr(Bt.length+3).trim().substr(0,24))}}var qt,Ir=h.ir.element.querySelectorAll("[data-type='link-ref-defs-block']");Ir.forEach(function(ot,Sn){Sn===0?qt=ot:(qt.insertAdjacentHTML("beforeend",ot.innerHTML),ot.remove())}),Ir.length>0&&h.ir.element.insertAdjacentElement("beforeend",Ir[0]);var Wn,Nr=h.ir.element.querySelectorAll("[data-type='footnotes-block']");Nr.forEach(function(ot,Sn){Sn===0?Wn=ot:(Wn.insertAdjacentHTML("beforeend",ot.innerHTML),ot.remove())}),Nr.length>0&&h.ir.element.insertAdjacentElement("beforeend",Nr[0]),(0,j.ib)(h.ir.element,d),h.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(ot){He(ot,h)}),Ze(h),$s(h,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},ie=function(h,d){if(h==="")return!1;if(h.indexOf("")===-1&&h.indexOf("")===-1&&h.indexOf("")===-1)return!(0,p.yl)(d)&&!d.altKey&&!d.shiftKey&&d.code===h;if(h==="Tab")return!!(!(0,p.yl)(d)&&!d.altKey&&d.shiftKey&&d.code==="Tab");var m=h.split("");if(h.startsWith("")){var b=m.length===3?m[2]:m[1];return!!((m.length===3?(0,p.yl)(d):!(0,p.yl)(d))&&d.altKey&&!d.shiftKey&&d.code===(/^[0-9]$/.test(b)?"Digit":"Key")+b)}h==="Enter"&&(m=["","Enter"]);var w=m.length>2&&m[0]==="",C=w?m[2]:m[1];return w&&((0,p.vU)()||!/Mac/.test(navigator.platform))&&(C==="-"?C="_":C==="="&&(C="+")),!!((0,p.yl)(d)&&d.key.toLowerCase()===C.toLowerCase()&&!d.altKey&&(!w&&!d.shiftKey||w&&d.shiftKey))},rt=function(h){var d=h.startContainer;if(d.nodeType===3&&d.nodeValue.length!==h.startOffset)return!1;for(var m=d.nextSibling;m&&m.textContent==="";)m=m.nextSibling;if(m){if(m&&m.nodeType!==3&&m.classList.contains("vditor-ir__node")&&!m.getAttribute("data-block"))return m}else{var b=(0,S.fb)(d,"vditor-ir__marker");if(b&&!b.nextSibling){var w=d.parentElement.parentElement.nextSibling;if(w&&w.nodeType!==3&&w.classList.contains("vditor-ir__node"))return w}return!1}return!1},xe=function(h){var d=h.startContainer,m=d.previousSibling;return d.nodeType===3&&h.startOffset===0&&m&&m.nodeType!==3&&m.classList.contains("vditor-ir__node")&&!m.getAttribute("data-block")?m:!1},he=function(h,d){d.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(E){E.classList.remove("vditor-ir__node--expand")});var m=(0,S.JQ)(h.startContainer,"vditor-ir__node"),b=!h.collapsed&&(0,S.JQ)(h.endContainer,"vditor-ir__node");if(!(!h.collapsed&&(!m||m!==b))){m&&(m.classList.add("vditor-ir__node--expand"),m.classList.remove("vditor-ir__node--hidden"),(0,j.Hc)(h));var w=rt(h);if(w){w.classList.add("vditor-ir__node--expand"),w.classList.remove("vditor-ir__node--hidden");return}var C=xe(h);if(C){C.classList.add("vditor-ir__node--expand"),C.classList.remove("vditor-ir__node--hidden");return}}},_t=function(h,d){if(h.ir.composingLock=d.isComposing,d.isComposing)return!1;d.key.indexOf("Arrow")===-1&&d.key!=="Meta"&&d.key!=="Control"&&d.key!=="Alt"&&d.key!=="Shift"&&d.key!=="CapsLock"&&d.key!=="Escape"&&!/^F\d{1,2}$/.test(d.key)&&h.undo.recordFirstPosition(h,d);var m=(0,j.zh)(h),b=m.startContainer;if(!js(d,h,b)||(Ep(m,h,d),XS(m),d.key!=="Enter"&&d.key!=="Tab"&&d.key!=="Backspace"&&d.key.indexOf("Arrow")===-1&&!(0,p.yl)(d)&&d.key!=="Escape"&&d.key!=="Delete"))return!1;var w=(0,S.a1)(b,"data-newline","1");if(!(0,p.yl)(d)&&!d.altKey&&!d.shiftKey&&d.key==="Enter"&&w&&m.startOffset<w.textContent.length){var C=w.previousElementSibling;C&&(m.insertNode(document.createTextNode(C.textContent)),m.collapse(!1));var E=w.nextSibling;E&&(m.insertNode(document.createTextNode(E.textContent)),m.collapse(!0))}var O=(0,S.lG)(b,"P");if($S(d,h,O,m)||jS(m,h,O,d)||JS(h,m,d,O))return!0;var D=(0,S.fb)(b,"vditor-ir__marker--pre");if(D&&D.tagName==="PRE"){var L=D.firstChild;if(GS(h,d,D,m)||(L.getAttribute("data-type")==="math-block"||L.getAttribute("data-type")==="html-block")&&je(h,d,m,L,D.parentElement)||bt(h,d,m,L,D.parentElement))return!0}var P=(0,S.a1)(b,"data-type","code-block-info");if(P){if(d.key==="Enter"||d.key==="Tab")return m.selectNodeContents(P.nextElementSibling.firstChild),m.collapse(!0),d.preventDefault(),M(h,["hint"]),!0;if(d.key==="Backspace"){var $=(0,j.im)(P,h.ir.element).start;$===1&&m.setStart(b,0),$===2&&(h.hint.recentLanguage="")}if(je(h,d,m,P,P.parentElement))return M(h,["hint"]),!0}var fe=(0,S.lG)(b,"TD")||(0,S.lG)(b,"TH");if(d.key.indexOf("Arrow")>-1&&fe){var de=Rl(fe);if(de&&je(h,d,m,fe,de))return!0;var le=Pl(fe);if(le&&bt(h,d,m,fe,le))return!0}if(KS(h,d,m)||ZS(h,m,d)||Py(h,m,d))return!0;var Me=(0,A.W)(b);if(Me){if(ie("=",d)){var Ce=Me.querySelector(".vditor-ir__marker--heading");return Ce&&Ce.textContent.trim().length>1&&Yu(h,Ce.textContent.substr(1)),d.preventDefault(),!0}if(ie("-",d)){var Ce=Me.querySelector(".vditor-ir__marker--heading");return Ce&&Ce.textContent.trim().length<6&&Yu(h,Ce.textContent.trim()+"# "),d.preventDefault(),!0}}var ae=(0,S.F9)(b);if(d.key==="Backspace"&&!(0,p.yl)(d)&&!d.shiftKey&&!d.altKey&&m.toString()===""){if(YS(h,m,d,O))return!0;if(ae&&ae.previousElementSibling&&ae.tagName!=="UL"&&ae.tagName!=="OL"&&(ae.previousElementSibling.getAttribute("data-type")==="code-block"||ae.previousElementSibling.getAttribute("data-type")==="math-block")){var $e=(0,j.im)(ae,h.ir.element,m).start;if($e===0||$e===1&&ae.innerText.startsWith(l.g.ZWSP))return m.selectNodeContents(ae.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),m.collapse(!1),he(m,h),ae.textContent.trim().replace(l.g.ZWSP,"")===""&&(ae.remove(),$s(h)),d.preventDefault(),!0}if(Me){var Ae=Me.firstElementChild.textContent.length;(0,j.im)(Me,h.ir.element).start===Ae&&Ae!==0&&(m.setStart(Me.firstElementChild.firstChild,Ae-1),m.collapse(!0),(0,j.Hc)(m))}}return(d.key==="ArrowUp"||d.key==="ArrowDown")&&ae&&(ae.querySelectorAll(".vditor-ir__node").forEach(function(Ye){Ye.contains(b)||Ye.classList.add("vditor-ir__node--hidden")}),QS(d,ae,m))?!0:(Ap(m,d.key),ae&&st(ae,h,d,m)?(d.preventDefault(),!0):!1)},De=i(190),N=function(h,d){h.querySelectorAll("[data-type=footnotes-link]").forEach(function(m){for(var b=m.parentElement,w=b.nextSibling;w&&w.textContent.startsWith("    ");){var C=w;C.childNodes.forEach(function(E){b.append(E.cloneNode(!0))}),w=w.nextSibling,C.remove()}d&&d(b)})},H=function(h,d){var m,b=getSelection().getRangeAt(0).cloneRange(),w=b.startContainer;b.startContainer.nodeType!==3&&b.startContainer.tagName==="DIV"&&(w=b.startContainer.childNodes[b.startOffset-1]);var C=(0,S.a1)(w,"data-block","0");if(C&&d&&(d.inputType==="deleteContentBackward"||d.data===" ")){for(var E=(0,j.im)(C,h.sv.element,b).start,O=!0,D=E-1;D>C.textContent.substr(0,E).lastIndexOf(`
`);D--)if(C.textContent.charAt(D)!==" "&&C.textContent.charAt(D)!=="	"){O=!1;break}if(E===0&&(O=!1),O){ut(h);return}if(d.inputType==="deleteContentBackward"){var L=(0,S.a1)(w,"data-type","code-block-open-marker")||(0,S.a1)(w,"data-type","code-block-close-marker");if(L){if(L.getAttribute("data-type")==="code-block-close-marker"){var P=ue(w,"code-block-open-marker");if(P){P.textContent=L.textContent,ut(h);return}}if(L.getAttribute("data-type")==="code-block-open-marker"){var P=ue(w,"code-block-close-marker",!1);if(P){P.textContent=L.textContent,ut(h);return}}}var $=(0,S.a1)(w,"data-type","math-block-open-marker");if($){var fe=$.nextElementSibling.nextElementSibling;fe&&fe.getAttribute("data-type")==="math-block-close-marker"&&(fe.remove(),ut(h));return}C.querySelectorAll('[data-type="code-block-open-marker"]').forEach(function(ae){ae.textContent.length===1&&ae.remove()}),C.querySelectorAll('[data-type="code-block-close-marker"]').forEach(function(ae){ae.textContent.length===1&&ae.remove()});var de=(0,S.a1)(w,"data-type","heading-marker");if(de&&de.textContent.indexOf("#")===-1){ut(h);return}}if((d.data===" "||d.inputType==="deleteContentBackward")&&((0,S.a1)(w,"data-type","padding")||(0,S.a1)(w,"data-type","li-marker")||(0,S.a1)(w,"data-type","task-marker")||(0,S.a1)(w,"data-type","blockquote-marker"))){ut(h);return}}if(C&&C.textContent.trimRight()==="$$"){ut(h);return}C||(C=h.sv.element),((m=C.firstElementChild)===null||m===void 0?void 0:m.getAttribute("data-type"))==="link-ref-defs-block"&&(C=h.sv.element),(0,S.a1)(w,"data-type","footnotes-link")&&(C=h.sv.element),C.textContent.indexOf(Lute.Caret)===-1&&b.insertNode(document.createTextNode(Lute.Caret)),C.querySelectorAll("[style]").forEach(function(ae){ae.removeAttribute("style")}),C.querySelectorAll("font").forEach(function(ae){ae.outerHTML=ae.innerHTML});var le=C.textContent,Me=C.isEqualNode(h.sv.element);if(Me)le=C.textContent;else{C.previousElementSibling&&(le=C.previousElementSibling.textContent+le,C.previousElementSibling.remove()),C.previousElementSibling&&le.indexOf(`---
`)===0&&(le=C.previousElementSibling.textContent+le,C.previousElementSibling.remove());var Ce="";h.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ae,$e){ae&&!C.isEqualNode(ae.parentElement)&&(Ce+=ae.parentElement.textContent+`
`,ae.parentElement.remove())}),h.sv.element.querySelectorAll("[data-type='footnotes-link']").forEach(function(ae,$e){ae&&!C.isEqualNode(ae.parentElement)&&(Ce+=ae.parentElement.textContent+`
`,ae.parentElement.remove())}),le=Ce+le}le=Pe(le,h),Me?C.innerHTML=le:C.outerHTML=le,h.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ae){h.sv.element.insertAdjacentElement("beforeend",ae.parentElement)}),N(h.sv.element,function(ae){h.sv.element.insertAdjacentElement("beforeend",ae)}),(0,j.ib)(h.sv.element,b),zt(h),ut(h,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},W=function(h,d){var m,b,w,C,E;if(h.sv.composingLock=d.isComposing,d.isComposing||(d.key.indexOf("Arrow")===-1&&d.key!=="Meta"&&d.key!=="Control"&&d.key!=="Alt"&&d.key!=="Shift"&&d.key!=="CapsLock"&&d.key!=="Escape"&&!/^F\d{1,2}$/.test(d.key)&&h.undo.recordFirstPosition(h,d),d.key!=="Enter"&&d.key!=="Tab"&&d.key!=="Backspace"&&d.key.indexOf("Arrow")===-1&&!(0,p.yl)(d)&&d.key!=="Escape"))return!1;var O=(0,j.zh)(h),D=O.startContainer;O.startContainer.nodeType!==3&&O.startContainer.tagName==="DIV"&&(D=O.startContainer.childNodes[O.startOffset-1]);var L=(0,S.a1)(D,"data-type","text"),P=(0,S.a1)(D,"data-type","blockquote-marker");if(!P&&O.startOffset===0&&L&&L.previousElementSibling&&L.previousElementSibling.getAttribute("data-type")==="blockquote-marker"&&(P=L.previousElementSibling),P&&d.key==="Enter"&&!(0,p.yl)(d)&&!d.altKey&&P.nextElementSibling.textContent.trim()===""&&(0,j.im)(P,h.sv.element,O).start===P.textContent.length)return((m=P.previousElementSibling)===null||m===void 0?void 0:m.getAttribute("data-type"))==="padding"&&P.previousElementSibling.setAttribute("data-action","enter-remove"),P.remove(),ut(h),d.preventDefault(),!0;var $=(0,S.a1)(D,"data-type","li-marker"),fe=(0,S.a1)(D,"data-type","task-marker"),de=$;if(de||fe&&fe.nextElementSibling.getAttribute("data-type")!=="task-marker"&&(de=fe),!de&&O.startOffset===0&&L&&L.previousElementSibling&&(L.previousElementSibling.getAttribute("data-type")==="li-marker"||L.previousElementSibling.getAttribute("data-type")==="task-marker")&&(de=L.previousElementSibling),de){var le=(0,j.im)(de,h.sv.element,O).start,Me=de.getAttribute("data-type")==="task-marker",Ce=de;if(Me&&(Ce=de.previousElementSibling.previousElementSibling.previousElementSibling),le===de.textContent.length){if(d.key==="Enter"&&!(0,p.yl)(d)&&!d.altKey&&!d.shiftKey&&de.nextElementSibling.textContent.trim()==="")return((b=Ce.previousElementSibling)===null||b===void 0?void 0:b.getAttribute("data-type"))==="padding"?(Ce.previousElementSibling.remove(),H(h)):(Me&&(Ce.remove(),de.previousElementSibling.previousElementSibling.remove(),de.previousElementSibling.remove()),de.nextElementSibling.remove(),de.remove(),ut(h)),d.preventDefault(),!0;if(d.key==="Tab")return d.shiftKey?Ce.previousElementSibling.getAttribute("data-type")==="padding"&&Ce.previousElementSibling.remove():Ce.insertAdjacentHTML("beforebegin",'<span data-type="padding">'.concat(Ce.textContent.replace(/\S/g," "),"</span>")),/^\d/.test(Ce.textContent)&&(Ce.textContent=Ce.textContent.replace(/^\d{1,}/,"1"),O.selectNodeContents(de.firstChild),O.collapse(!1)),H(h),d.preventDefault(),!0}}if(Py(h,O,d))return!0;var ae=(0,S.a1)(D,"data-block","0"),$e=(0,A.S)(D,"SPAN");if(d.key==="Enter"&&!(0,p.yl)(d)&&!d.altKey&&!d.shiftKey&&ae){var Ae=!1,Ye=ae.textContent.match(/^\n+/);(0,j.im)(ae,h.sv.element).start<=(Ye?Ye[0].length:0)&&(Ae=!0);var Bt=`
`;if($e){if(((w=$e.previousElementSibling)===null||w===void 0?void 0:w.getAttribute("data-action"))==="enter-remove")return $e.previousElementSibling.remove(),ut(h),d.preventDefault(),!0;Bt+=Lt($e)}return O.insertNode(document.createTextNode(Bt)),O.collapse(!1),ae&&ae.textContent.trim()!==""&&!Ae?H(h):ut(h),d.preventDefault(),!0}if(d.key==="Backspace"&&!(0,p.yl)(d)&&!d.altKey&&!d.shiftKey){if($e&&((C=$e.previousElementSibling)===null||C===void 0?void 0:C.getAttribute("data-type"))==="newline"&&(0,j.im)($e,h.sv.element,O).start===1&&$e.getAttribute("data-type").indexOf("code-block-")===-1)return O.setStart($e,0),O.extractContents(),$e.textContent.trim()!==""?H(h):ut(h),d.preventDefault(),!0;if(ae&&(0,j.im)(ae,h.sv.element,O).start===0&&ae.previousElementSibling){O.extractContents();var Dt=ae.previousElementSibling.lastElementChild;return Dt.getAttribute("data-type")==="newline"&&(Dt.remove(),Dt=ae.previousElementSibling.lastElementChild),Dt.getAttribute("data-type")!=="newline"&&(Dt.insertAdjacentHTML("afterend",ae.innerHTML),ae.remove()),ae.textContent.trim()!==""&&!(!((E=ae.previousElementSibling)===null||E===void 0)&&E.querySelector('[data-type="code-block-open-marker"]'))?H(h):(Dt.getAttribute("data-type")!=="newline"&&(O.selectNodeContents(Dt.lastChild),O.collapse(!1)),ut(h)),d.preventDefault(),!0}}return!1},q=i(538),Y=function(h){h.options.theme==="dark"?h.element.classList.add("vditor--dark"):h.element.classList.remove("vditor--dark")},Q=function(h){h.element.innerHTML="",h.element.classList.add("vditor"),h.options.rtl&&h.element.setAttribute("dir","rtl"),Y(h),(0,q.Z)(h.options.preview.theme.current,h.options.preview.theme.path),typeof h.options.height=="number"?h.element.style.height=h.options.height+"px":h.element.style.height=h.options.height,typeof h.options.minHeight=="number"&&(h.element.style.minHeight=h.options.minHeight+"px"),typeof h.options.width=="number"?h.element.style.width=h.options.width+"px":h.element.style.width=h.options.width,h.element.appendChild(h.toolbar.element);var d=document.createElement("div");if(d.className="vditor-content",h.options.outline.position==="left"&&d.appendChild(h.outline.element),d.appendChild(h.wysiwyg.element.parentElement),d.appendChild(h.sv.element),d.appendChild(h.ir.element.parentElement),d.appendChild(h.preview.element),h.toolbar.elements.devtools&&d.appendChild(h.devtools.element),h.options.outline.position==="right"&&(h.outline.element.classList.add("vditor-outline--right"),d.appendChild(h.outline.element)),h.upload&&d.appendChild(h.upload.element),h.options.resize.enable&&d.appendChild(h.resize.element),d.appendChild(h.hint.element),d.appendChild(h.tip.element),h.element.appendChild(d),d.addEventListener("click",function(){M(h,["subToolbar"])}),h.toolbar.elements.export&&h.element.insertAdjacentHTML("beforeend",'<iframe id="vditorExportIframe" style="width: 100%;height: 0;border: 0"></iframe>'),In(h,h.options.mode,qe(h)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&typeof window.visualViewport<"u"){var m=!1,b=function(w){m||(m=!0,requestAnimationFrame(function(){m=!1;var C=h.toolbar.element;C.style.transform="none",C.getBoundingClientRect().top<0&&(C.style.transform="translate(0, ".concat(-C.getBoundingClientRect().top,"px)"))}))};window.visualViewport.addEventListener("scroll",b),window.visualViewport.addEventListener("resize",b)}},pe=function(h){var d=window.innerWidth<=l.g.MOBILE_WIDTH?10:35;if(h.wysiwyg.element.parentElement.style.display!=="none"){var m=(h.wysiwyg.element.parentElement.clientWidth-h.options.preview.maxWidth)/2;h.wysiwyg.element.style.padding="10px ".concat(Math.max(d,m),"px")}if(h.ir.element.parentElement.style.display!=="none"){var m=(h.ir.element.parentElement.clientWidth-h.options.preview.maxWidth)/2;h.ir.element.style.padding="10px ".concat(Math.max(d,m),"px")}h.preview.element.style.display!=="block"?h.toolbar.element.style.paddingLeft=Math.max(5,parseInt(h[h.currentMode].element.style.paddingLeft||"0",10)+(h.options.outline.position==="left"?h.outline.element.offsetWidth:0))+"px":h.toolbar.element.style.paddingLeft=5+(h.options.outline.position==="left"?h.outline.element.offsetWidth:0)+"px"},me=function(h){if(h.options.typewriterMode){var d=window.innerHeight;typeof h.options.height=="number"?(d=h.options.height,typeof h.options.minHeight=="number"&&(d=Math.max(d,h.options.minHeight)),d=Math.min(window.innerHeight,d)):d=h.element.clientHeight,h.element.classList.contains("vditor--fullscreen")&&(d=window.innerHeight),h[h.currentMode].element.style.setProperty("--editor-bottom",(d-h.toolbar.element.offsetHeight)/2+"px")}},ge;function ce(){window.removeEventListener("resize",ge)}var qe=function(h){me(h),ce(),window.addEventListener("resize",ge=function(){pe(h),me(h)});var d=(0,p.pK)()&&localStorage.getItem(h.options.cache.id);return(!h.options.cache.enable||!d)&&(h.options.value?d=h.options.value:h.originalInnerHTML?d=h.lute.HTML2Md(h.originalInnerHTML):h.options.cache.enable||(d="")),d||""},_e=function(h){clearTimeout(h[h.currentMode].hlToolbarTimeoutId),h[h.currentMode].hlToolbarTimeoutId=window.setTimeout(function(){if(h[h.currentMode].element.getAttribute("contenteditable")!=="false"&&(0,j.Gb)(h[h.currentMode].element)){g(h.toolbar.elements,l.g.EDIT_TOOLBARS),v(h.toolbar.elements,l.g.EDIT_TOOLBARS);var d=(0,j.zh)(h),m=d.startContainer;d.startContainer.nodeType===3&&(m=d.startContainer.parentElement),m.classList.contains("vditor-reset")&&(m=m.childNodes[d.startOffset]);var b=h.currentMode==="sv"?(0,S.a1)(m,"data-type","heading"):(0,A.W)(m);b&&y(h.toolbar.elements,["headings"]);var w=h.currentMode==="sv"?(0,S.a1)(m,"data-type","blockquote"):(0,S.lG)(m,"BLOCKQUOTE");w&&y(h.toolbar.elements,["quote"]);var C=(0,S.a1)(m,"data-type","strong");C&&y(h.toolbar.elements,["bold"]);var E=(0,S.a1)(m,"data-type","em");E&&y(h.toolbar.elements,["italic"]);var O=(0,S.a1)(m,"data-type","s");O&&y(h.toolbar.elements,["strike"]);var D=(0,S.a1)(m,"data-type","a");D&&y(h.toolbar.elements,["link"]);var L=(0,S.lG)(m,"LI");L?(L.classList.contains("vditor-task")?y(h.toolbar.elements,["check"]):L.parentElement.tagName==="OL"?y(h.toolbar.elements,["ordered-list"]):L.parentElement.tagName==="UL"&&y(h.toolbar.elements,["list"]),v(h.toolbar.elements,["outdent","indent"])):k(h.toolbar.elements,["outdent","indent"]);var P=(0,S.a1)(m,"data-type","code-block");P&&(k(h.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),y(h.toolbar.elements,["code"]));var $=(0,S.a1)(m,"data-type","code");$&&(k(h.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),y(h.toolbar.elements,["inline-code"]));var fe=(0,S.a1)(m,"data-type","table");fe&&k(h.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}},200)},ye=function(h,d){d===void 0&&(d={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),d.enableHint&&h.hint.render(h),clearTimeout(h.wysiwyg.afterRenderTimeoutId),h.wysiwyg.afterRenderTimeoutId=window.setTimeout(function(){if(!h.wysiwyg.composingLock){var m=c(h);typeof h.options.input=="function"&&d.enableInput&&h.options.input(m),h.options.counter.enable&&h.counter.render(h,m),h.options.cache.enable&&(0,p.pK)()&&(localStorage.setItem(h.options.cache.id,m),h.options.cache.after&&h.options.cache.after(m)),h.devtools&&h.devtools.renderEchart(h),d.enableAddUndoStack&&h.undo.addToUndoStack(h)}},h.options.undoDelay)},Ue=function(h){for(var d=h.previousSibling;d;){if(d.nodeType!==3&&d.tagName==="A"&&!d.previousSibling&&d.innerHTML.replace(l.g.ZWSP,"")===""&&d.nextSibling)return d;d=d.previousSibling}return!1},nt=function(h){for(var d=h.startContainer.nextSibling;d&&d.textContent==="";)d=d.nextSibling;return!!(d&&d.nodeType!==3&&(d.tagName==="CODE"||d.getAttribute("data-type")==="math-inline"||d.getAttribute("data-type")==="html-entity"||d.getAttribute("data-type")==="html-inline"))},vt=function(h){for(var d="",m=h.nextSibling;m;)m.nodeType===3?d+=m.textContent:d+=m.outerHTML,m=m.nextSibling;return d},ft=function(h){for(var d="",m=h.previousSibling;m;)m.nodeType===3?d=m.textContent+d:d=m.outerHTML+d,m=m.previousSibling;return d},hn=function(h){for(var d=h;d&&!d.nextSibling;)d=d.parentElement;return d.nextSibling},Zt=function(h){var d=ft(h.startContainer),m=vt(h.startContainer),b=h.startContainer.textContent,w=h.startOffset,C="",E="";return(b.substr(0,w)!==""&&b.substr(0,w)!==l.g.ZWSP||d)&&(C="".concat(d).concat(b.substr(0,w))),(b.substr(w)!==""&&b.substr(w)!==l.g.ZWSP||m)&&(E="".concat(b.substr(w)).concat(m)),{afterHTML:E,beforeHTML:C}},gn=function(h,d){Array.from(h.wysiwyg.element.childNodes).find(function(m){if(m.nodeType===3){var b=document.createElement("p");b.setAttribute("data-block","0"),b.textContent=m.textContent;var w=d.startContainer.nodeType===3?d.startOffset:m.textContent.length;return m.parentNode.insertBefore(b,m),m.remove(),d.setStart(b.firstChild,Math.min(b.firstChild.textContent.length,w)),d.collapse(!0),(0,j.Hc)(d),!0}else if(!m.getAttribute("data-block"))return m.tagName==="P"?m.remove():(m.tagName==="DIV"?(d.insertNode(document.createElement("wbr")),m.outerHTML='<p data-block="0">'.concat(m.innerHTML,"</p>")):m.tagName==="BR"?m.outerHTML='<p data-block="0">'.concat(m.outerHTML,"<wbr></p>"):(d.insertNode(document.createElement("wbr")),m.outerHTML='<p data-block="0">'.concat(m.outerHTML,"</p>")),(0,j.ib)(h.wysiwyg.element,d),d=getSelection().getRangeAt(0)),!0})},$t=function(h,d){var m=(0,j.zh)(h),b=(0,S.F9)(m.startContainer);b||(b=m.startContainer.childNodes[m.startOffset]),!b&&h.wysiwyg.element.children.length===0&&(b=h.wysiwyg.element),b&&!b.classList.contains("vditor-wysiwyg__block")&&(m.insertNode(document.createElement("wbr")),b.innerHTML.trim()==="<wbr>"&&(b.innerHTML="<wbr><br>"),b.tagName==="BLOCKQUOTE"||b.classList.contains("vditor-reset")?b.innerHTML="<".concat(d,' data-block="0">').concat(b.innerHTML.trim(),"</").concat(d,">"):b.outerHTML="<".concat(d,' data-block="0">').concat(b.innerHTML.trim(),"</").concat(d,">"),(0,j.ib)(h.wysiwyg.element,m),Ze(h))},$n=function(h){var d=getSelection().getRangeAt(0),m=(0,S.F9)(d.startContainer);m||(m=d.startContainer.childNodes[d.startOffset]),m&&(d.insertNode(document.createElement("wbr")),m.outerHTML='<p data-block="0">'.concat(m.innerHTML,"</p>"),(0,j.ib)(h.wysiwyg.element,d)),h.wysiwyg.popover.style.display="none"},yn=function(h,d,m){m===void 0&&(m=!0);var b=h.previousElementSibling,w=b.ownerDocument.createRange();b.tagName==="CODE"?(b.style.display="inline-block",m?w.setStart(b.firstChild,1):w.selectNodeContents(b)):(b.style.display="block",b.firstChild.firstChild||b.firstChild.appendChild(document.createTextNode("")),w.selectNodeContents(b.firstChild)),m?w.collapse(!0):w.collapse(!1),(0,j.Hc)(w),!h.firstElementChild.classList.contains("language-mindmap")&&zt(d)},Yt=function(h,d){if(h.wysiwyg.composingLock=d.isComposing,d.isComposing)return!1;d.key.indexOf("Arrow")===-1&&d.key!=="Meta"&&d.key!=="Control"&&d.key!=="Alt"&&d.key!=="Shift"&&d.key!=="CapsLock"&&d.key!=="Escape"&&!/^F\d{1,2}$/.test(d.key)&&h.undo.recordFirstPosition(h,d);var m=(0,j.zh)(h),b=m.startContainer;if(!js(d,h,b)||(Ep(m,h,d),XS(m),d.key!=="Enter"&&d.key!=="Tab"&&d.key!=="Backspace"&&d.key.indexOf("Arrow")===-1&&!(0,p.yl)(d)&&d.key!=="Escape"&&d.key!=="Delete"))return!1;var w=(0,S.F9)(b),C=(0,S.lG)(b,"P");if($S(d,h,C,m)||jS(m,h,C,d)||KS(h,d,m))return!0;var E=(0,S.fb)(b,"vditor-wysiwyg__block");if(E){if(d.key==="Escape"&&E.children.length===2)return h.wysiwyg.popover.style.display="none",E.firstElementChild.style.display="none",h.wysiwyg.element.blur(),d.preventDefault(),!0;if(!(0,p.yl)(d)&&!d.shiftKey&&d.altKey&&d.key==="Enter"&&E.getAttribute("data-type")==="code-block"){var O=h.wysiwyg.popover.querySelector(".vditor-input");return O.focus(),O.select(),d.preventDefault(),!0}if(E.getAttribute("data-block")==="0"&&(GS(h,d,E.firstElementChild,m)||bt(h,d,m,E.firstElementChild,E)||E.getAttribute("data-type")!=="yaml-front-matter"&&je(h,d,m,E.firstElementChild,E)))return!0}if(JS(h,m,d,C))return!0;var D=(0,S.E2)(b,"BLOCKQUOTE");if(D&&!d.shiftKey&&d.altKey&&d.key==="Enter"){(0,p.yl)(d)?m.setStartBefore(D):m.setStartAfter(D),(0,j.Hc)(m);var L=document.createElement("p");return L.setAttribute("data-block","0"),L.innerHTML=`
`,m.insertNode(L),m.collapse(!0),(0,j.Hc)(m),ye(h),zt(h),d.preventDefault(),!0}var P=(0,A.W)(b);if(P){if(P.tagName==="H6"&&b.textContent.length===m.startOffset&&!(0,p.yl)(d)&&!d.shiftKey&&!d.altKey&&d.key==="Enter"){var $=document.createElement("p");return $.textContent=`
`,$.setAttribute("data-block","0"),b.parentElement.insertAdjacentElement("afterend",$),m.setStart($,0),(0,j.Hc)(m),ye(h),zt(h),d.preventDefault(),!0}if(ie("=",d)){var fe=parseInt(P.tagName.substr(1),10)-1;return fe>0&&($t(h,"h".concat(fe)),ye(h)),d.preventDefault(),!0}if(ie("-",d)){var fe=parseInt(P.tagName.substr(1),10)+1;return fe<7&&($t(h,"h".concat(fe)),ye(h)),d.preventDefault(),!0}d.key==="Backspace"&&!(0,p.yl)(d)&&!d.shiftKey&&!d.altKey&&P.textContent.length===1&&$n(h)}if(ZS(h,m,d))return!0;if(d.altKey&&d.key==="Enter"&&!(0,p.yl)(d)&&!d.shiftKey){var de=(0,S.lG)(b,"A"),le=(0,S.a1)(b,"data-type","link-ref"),Me=(0,S.a1)(b,"data-type","footnotes-ref");if(de||le||Me||P&&P.tagName.length===2){var Ce=h.wysiwyg.popover.querySelector("input");Ce.focus(),Ce.select()}}if(Mt(h,d))return!0;if(ie("U",d)){var ae=h.wysiwyg.popover.querySelector('[data-type="up"]');if(ae)return ae.click(),d.preventDefault(),!0}if(ie("D",d)){var ae=h.wysiwyg.popover.querySelector('[data-type="down"]');if(ae)return ae.click(),d.preventDefault(),!0}if(Py(h,m,d))return!0;if(!(0,p.yl)(d)&&d.shiftKey&&!d.altKey&&d.key==="Enter"&&b.parentElement.tagName!=="LI"&&b.parentElement.tagName!=="P")return["STRONG","STRIKE","S","I","EM","B"].includes(b.parentElement.tagName)?m.insertNode(document.createTextNode(`
`+l.g.ZWSP)):m.insertNode(document.createTextNode(`
`)),m.collapse(!1),(0,j.Hc)(m),ye(h),zt(h),d.preventDefault(),!0;if(d.key==="Backspace"&&!(0,p.yl)(d)&&!d.shiftKey&&!d.altKey&&m.toString()===""){if(YS(h,m,d,C))return!0;if(w){if(w.previousElementSibling&&w.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&w.previousElementSibling.getAttribute("data-block")==="0"&&w.tagName!=="UL"&&w.tagName!=="OL"){var $e=(0,j.im)(w,h.wysiwyg.element,m).start;if($e===0&&m.startOffset===0||$e===1&&w.innerText.startsWith(l.g.ZWSP))return yn(w.previousElementSibling.lastElementChild,h,!1),w.innerHTML.trim().replace(l.g.ZWSP,"")===""&&(w.remove(),ye(h)),d.preventDefault(),!0}var Ae=m.startOffset;if(m.toString()===""&&b.nodeType===3&&b.textContent.charAt(Ae-2)===`
`&&b.textContent.charAt(Ae-1)!==l.g.ZWSP&&["STRONG","STRIKE","S","I","EM","B"].includes(b.parentElement.tagName))return b.textContent=b.textContent.substring(0,Ae-1)+l.g.ZWSP,m.setStart(b,Ae),m.collapse(!0),ye(h),d.preventDefault(),!0;b.textContent===l.g.ZWSP&&m.startOffset===1&&!b.previousSibling&&nt(m)&&(b.textContent=""),w.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach(function(Bt){Bt.firstElementChild.style.display="inline",Bt.lastElementChild.style.display="none"}),w.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach(function(Bt){Bt.firstElementChild.style.display="inline",Bt.lastElementChild.style.display="none"})}}if((0,p.vU)()&&m.startOffset===1&&b.textContent.indexOf(l.g.ZWSP)>-1&&b.previousSibling&&b.previousSibling.nodeType!==3&&b.previousSibling.tagName==="CODE"&&(d.key==="Backspace"||d.key==="ArrowLeft"))return m.selectNodeContents(b.previousSibling),m.collapse(!1),d.preventDefault(),!0;if(QS(d,w,m))return d.preventDefault(),!0;if(Ap(m,d.key),d.key==="ArrowDown"){var Ye=b.nextSibling;Ye&&Ye.nodeType!==3&&Ye.getAttribute("data-type")==="math-inline"&&m.setStartAfter(Ye)}return w&&st(w,h,d,m)?(d.preventDefault(),!0):!1},Mt=function(h,d){if(ie("X",d)){var m=h.wysiwyg.popover.querySelector('[data-type="remove"]');return m&&m.click(),d.preventDefault(),!0}},zn=function(h){clearTimeout(h.wysiwyg.hlToolbarTimeoutId),h.wysiwyg.hlToolbarTimeoutId=window.setTimeout(function(){if(h.wysiwyg.element.getAttribute("contenteditable")!=="false"&&(0,j.Gb)(h.wysiwyg.element)){g(h.toolbar.elements,l.g.EDIT_TOOLBARS),v(h.toolbar.elements,l.g.EDIT_TOOLBARS);var d=getSelection().getRangeAt(0),m=d.startContainer;d.startContainer.nodeType===3?m=d.startContainer.parentElement:m=m.childNodes[d.startOffset>=m.childNodes.length?m.childNodes.length-1:d.startOffset];var b=(0,S.a1)(m,"data-type","footnotes-block");if(b){h.wysiwyg.popover.innerHTML="",bn(b,h),Dn(h,"footnotes-block"),kn(h,b);return}var w=(0,S.lG)(m,"LI");w?(w.classList.contains("vditor-task")?y(h.toolbar.elements,["check"]):w.parentElement.tagName==="OL"?y(h.toolbar.elements,["ordered-list"]):w.parentElement.tagName==="UL"&&y(h.toolbar.elements,["list"]),v(h.toolbar.elements,["outdent","indent"])):k(h.toolbar.elements,["outdent","indent"]),(0,S.lG)(m,"BLOCKQUOTE")&&y(h.toolbar.elements,["quote"]),((0,S.lG)(m,"B")||(0,S.lG)(m,"STRONG"))&&y(h.toolbar.elements,["bold"]),((0,S.lG)(m,"I")||(0,S.lG)(m,"EM"))&&y(h.toolbar.elements,["italic"]),((0,S.lG)(m,"STRIKE")||(0,S.lG)(m,"S"))&&y(h.toolbar.elements,["strike"]),h.wysiwyg.element.querySelectorAll(".vditor-comment--focus").forEach(function(Ne){Ne.classList.remove("vditor-comment--focus")});var C=(0,S.fb)(m,"vditor-comment");if(C){var E=C.getAttribute("data-cmtids").split(" ");if(E.length>1&&C.nextSibling.isSameNode(C.nextElementSibling)){var O=C.nextElementSibling.getAttribute("data-cmtids").split(" ");E.find(function(Ne){if(O.includes(Ne))return E=[Ne],!0})}h.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(Ne){Ne.getAttribute("data-cmtids").indexOf(E[0])>-1&&Ne.classList.add("vditor-comment--focus")})}var D=(0,S.lG)(m,"A");D&&y(h.toolbar.elements,["link"]);var L=(0,S.lG)(m,"TABLE"),P=(0,A.W)(m);(0,S.lG)(m,"CODE")?(0,S.lG)(m,"PRE")?(k(h.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),y(h.toolbar.elements,["code"])):(k(h.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),y(h.toolbar.elements,["inline-code"])):P?(k(h.toolbar.elements,["bold"]),y(h.toolbar.elements,["headings"])):L&&k(h.toolbar.elements,["table"]);var $=(0,S.fb)(m,"vditor-toc");if($){h.wysiwyg.popover.innerHTML="",bn($,h),Dn(h,"vditor-toc"),kn(h,$);return}var fe=(0,A.S)(m,"BLOCKQUOTE");if(fe&&(h.wysiwyg.popover.innerHTML="",Dr(d,fe,h),Li(d,fe,h),bn(fe,h),Dn(h,"blockquote"),kn(h,fe)),w&&(h.wysiwyg.popover.innerHTML="",Dr(d,w,h),Li(d,w,h),bn(w,h),Dn(h,"li"),kn(h,w)),L){h.options.lang,h.options,h.wysiwyg.popover.innerHTML="";var de=function(){var Ne=L.rows.length,gt=L.rows[0].cells.length,Ro=parseInt(Sn.value,10)||Ne,Po=parseInt(Gr.value,10)||gt;if(!(Ro===Ne&&gt===Po)){if(gt!==Po)for(var Qu=Po-gt,ls=0;ls<L.rows.length;ls++)if(Qu>0)for(var cx=0;cx<Qu;cx++)ls===0?L.rows[ls].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):L.rows[ls].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var Fy=gt-1;Fy>=Po;Fy--)L.rows[ls].cells[Fy].remove();if(Ne!==Ro){var ux=Ro-Ne;if(ux>0){for(var jy="<tr>",sc=0;sc<Po;sc++)jy+="<td> </td>";for(var fx=0;fx<ux;fx++)L.querySelector("tbody")?L.querySelector("tbody").insertAdjacentHTML("beforeend",jy):L.querySelector("thead").insertAdjacentHTML("afterend",jy+"</tr>")}else for(var sc=Ne-1;sc>=Ro;sc--)L.rows[sc].remove(),L.rows.length===1&&L.querySelector("tbody").remove()}typeof h.options.input=="function"&&h.options.input(c(h))}},le=function(Ne){Op(L,Ne),Ne==="right"?($e.classList.remove("vditor-icon--current"),Ae.classList.remove("vditor-icon--current"),Ye.classList.add("vditor-icon--current")):Ne==="center"?($e.classList.remove("vditor-icon--current"),Ye.classList.remove("vditor-icon--current"),Ae.classList.add("vditor-icon--current")):(Ae.classList.remove("vditor-icon--current"),Ye.classList.remove("vditor-icon--current"),$e.classList.add("vditor-icon--current")),(0,j.Hc)(d),ye(h)},Me=(0,S.lG)(m,"TD"),Ce=(0,S.lG)(m,"TH"),ae="left";Me?ae=Me.getAttribute("align")||"left":Ce&&(ae=Ce.getAttribute("align")||"center");var $e=document.createElement("button");$e.setAttribute("type","button"),$e.setAttribute("aria-label",window.VditorI18n.alignLeft+"<"+(0,p.ns)("L")+">"),$e.setAttribute("data-type","left"),$e.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',$e.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ae==="left"?" vditor-icon--current":""),$e.onclick=function(){le("left")};var Ae=document.createElement("button");Ae.setAttribute("type","button"),Ae.setAttribute("aria-label",window.VditorI18n.alignCenter+"<"+(0,p.ns)("C")+">"),Ae.setAttribute("data-type","center"),Ae.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',Ae.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ae==="center"?" vditor-icon--current":""),Ae.onclick=function(){le("center")};var Ye=document.createElement("button");Ye.setAttribute("type","button"),Ye.setAttribute("aria-label",window.VditorI18n.alignRight+"<"+(0,p.ns)("R")+">"),Ye.setAttribute("data-type","right"),Ye.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',Ye.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ae==="right"?" vditor-icon--current":""),Ye.onclick=function(){le("right")};var Bt=document.createElement("button");Bt.setAttribute("type","button"),Bt.setAttribute("aria-label",window.VditorI18n.insertRowBelow+"<"+(0,p.ns)("=")+">"),Bt.setAttribute("data-type","insertRow"),Bt.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',Bt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Bt.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,gt=(0,S.lG)(Ne,"TD")||(0,S.lG)(Ne,"TH");gt&&zS(h,d,gt)};var Dt=document.createElement("button");Dt.setAttribute("type","button"),Dt.setAttribute("aria-label",window.VditorI18n.insertRowAbove+"<"+(0,p.ns)("F")+">"),Dt.setAttribute("data-type","insertRow"),Dt.innerHTML='<svg><use xlink:href="#vditor-icon-insert-rowb"></use></svg>',Dt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Dt.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,gt=(0,S.lG)(Ne,"TD")||(0,S.lG)(Ne,"TH");gt&&WS(h,d,gt)};var qt=document.createElement("button");qt.setAttribute("type","button"),qt.setAttribute("aria-label",window.VditorI18n.insertColumnRight+"<"+(0,p.ns)("=")+">"),qt.setAttribute("data-type","insertColumn"),qt.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',qt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",qt.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,gt=(0,S.lG)(Ne,"TD")||(0,S.lG)(Ne,"TH");gt&&Lp(h,L,gt)};var Ir=document.createElement("button");Ir.setAttribute("type","button"),Ir.setAttribute("aria-label",window.VditorI18n.insertColumnLeft+"<"+(0,p.ns)("G")+">"),Ir.setAttribute("data-type","insertColumn"),Ir.innerHTML='<svg><use xlink:href="#vditor-icon-insert-columnb"></use></svg>',Ir.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Ir.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,gt=(0,S.lG)(Ne,"TD")||(0,S.lG)(Ne,"TH");gt&&Lp(h,L,gt,"beforebegin")};var Wn=document.createElement("button");Wn.setAttribute("type","button"),Wn.setAttribute("aria-label",window.VditorI18n["delete-row"]+"<"+(0,p.ns)("-")+">"),Wn.setAttribute("data-type","deleteRow"),Wn.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',Wn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Wn.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,gt=(0,S.lG)(Ne,"TD")||(0,S.lG)(Ne,"TH");gt&&qS(h,d,gt)};var Nr=document.createElement("button");Nr.setAttribute("type","button"),Nr.setAttribute("aria-label",window.VditorI18n["delete-column"]+"<"+(0,p.ns)("-")+">"),Nr.setAttribute("data-type","deleteColumn"),Nr.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',Nr.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Nr.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,gt=(0,S.lG)(Ne,"TD")||(0,S.lG)(Ne,"TH");gt&&US(h,d,L,gt)};var ot=document.createElement("span");ot.setAttribute("aria-label",window.VditorI18n.row),ot.className="vditor-tooltipped vditor-tooltipped__n";var Sn=document.createElement("input");ot.appendChild(Sn),Sn.type="number",Sn.min="1",Sn.className="vditor-input",Sn.style.width="42px",Sn.style.textAlign="center",Sn.setAttribute("placeholder",window.VditorI18n.row),Sn.value=L.rows.length.toString(),Sn.oninput=function(){de()},Sn.onkeydown=function(Ne){if(!Ne.isComposing){if(Ne.key==="Tab"){Gr.focus(),Gr.select(),Ne.preventDefault();return}Mt(h,Ne)||Cn(Ne,d)}};var Np=document.createElement("span");Np.setAttribute("aria-label",window.VditorI18n.column),Np.className="vditor-tooltipped vditor-tooltipped__n";var Gr=document.createElement("input");Np.appendChild(Gr),Gr.type="number",Gr.min="1",Gr.className="vditor-input",Gr.style.width="42px",Gr.style.textAlign="center",Gr.setAttribute("placeholder",window.VditorI18n.column),Gr.value=L.rows[0].cells.length.toString(),Gr.oninput=function(){de()},Gr.onkeydown=function(Ne){if(!Ne.isComposing){if(Ne.key==="Tab"){Sn.focus(),Sn.select(),Ne.preventDefault();return}Mt(h,Ne)||Cn(Ne,d)}},Dr(d,L,h),Li(d,L,h),bn(L,h),h.wysiwyg.popover.insertAdjacentElement("beforeend",$e),h.wysiwyg.popover.insertAdjacentElement("beforeend",Ae),h.wysiwyg.popover.insertAdjacentElement("beforeend",Ye),h.wysiwyg.popover.insertAdjacentElement("beforeend",Dt),h.wysiwyg.popover.insertAdjacentElement("beforeend",Bt),h.wysiwyg.popover.insertAdjacentElement("beforeend",Ir),h.wysiwyg.popover.insertAdjacentElement("beforeend",qt),h.wysiwyg.popover.insertAdjacentElement("beforeend",Wn),h.wysiwyg.popover.insertAdjacentElement("beforeend",Nr),h.wysiwyg.popover.insertAdjacentElement("beforeend",ot),h.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),h.wysiwyg.popover.insertAdjacentElement("beforeend",Np),Dn(h,"table"),kn(h,L)}var Vy=(0,S.a1)(m,"data-type","link-ref");Vy&&rs(h,Vy,d);var rc=(0,S.a1)(m,"data-type","footnotes-ref");if(rc){h.options.lang,h.options,h.wysiwyg.popover.innerHTML="";var ot=document.createElement("span");ot.setAttribute("aria-label",window.VditorI18n.footnoteRef+"<"+(0,p.ns)("Enter")+">"),ot.className="vditor-tooltipped vditor-tooltipped__n";var zs=document.createElement("input");ot.appendChild(zs),zs.className="vditor-input",zs.setAttribute("placeholder",window.VditorI18n.footnoteRef+"<"+(0,p.ns)("Enter")+">"),zs.style.width="120px",zs.value=rc.getAttribute("data-footnotes-label"),zs.oninput=function(){zs.value.trim()!==""&&rc.setAttribute("data-footnotes-label",zs.value),typeof h.options.input=="function"&&h.options.input(c(h))},zs.onkeydown=function(gt){gt.isComposing||Mt(h,gt)||Cn(gt,d)},bn(rc,h),h.wysiwyg.popover.insertAdjacentElement("beforeend",ot),Dn(h,"footnotes-ref"),kn(h,rc)}var Nn=(0,S.fb)(m,"vditor-wysiwyg__block"),lx=Nn?Nn.getAttribute("data-type").indexOf("block")>-1:!1;if(h.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(Ne){if(!Nn||Nn&&lx&&!Nn.contains(Ne)){var gt=Ne.previousElementSibling;gt.style.display="none"}}),Nn&&lx){if(h.wysiwyg.popover.innerHTML="",Dr(d,Nn,h),Li(d,Nn,h),bn(Nn,h),Nn.getAttribute("data-type")==="code-block"){var Rp=document.createElement("span");Rp.setAttribute("aria-label",window.VditorI18n.language+"<"+(0,p.ns)("Enter")+">"),Rp.className="vditor-tooltipped vditor-tooltipped__n";var Ii=document.createElement("input");Rp.appendChild(Ii);var Xu=Nn.firstElementChild.firstElementChild;Ii.className="vditor-input",Ii.setAttribute("placeholder",window.VditorI18n.language+"<"+(0,p.ns)("Enter")+">"),Ii.value=Xu.className.indexOf("language-")>-1?Xu.className.split("-")[1].split(" ")[0]:"",Ii.oninput=function(Ne){Ii.value.trim()!==""?Xu.className="language-".concat(Ii.value):(Xu.className="",h.hint.recentLanguage=""),Nn.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(Nn.lastElementChild.innerHTML=Nn.firstElementChild.innerHTML,He(Nn.lastElementChild,h)),ye(h),Ne.detail===1&&(d.setStart(Xu.firstChild,0),d.collapse(!0),(0,j.Hc)(d))},Ii.onkeydown=function(Ne){if(!Ne.isComposing&&!Mt(h,Ne)){if(Ne.key==="Escape"&&h.hint.element.style.display==="block"){h.hint.element.style.display="none",Ne.preventDefault();return}h.hint.select(Ne,h),Cn(Ne,d)}},Ii.onkeyup=function(Ne){var gt,Ro;if(!(Ne.isComposing||Ne.key==="Enter"||Ne.key==="ArrowUp"||Ne.key==="Escape"||Ne.key==="ArrowDown")){var Po=[],Qu=Ii.value.substring(0,Ii.selectionStart);(h.options.preview.hljs.langs||l.g.ALIAS_CODE_LANGUAGES.concat(((Ro=(gt=window.hljs)===null||gt===void 0?void 0:gt.listLanguages())!==null&&Ro!==void 0?Ro:[]).sort())).forEach(function(ls){ls.indexOf(Qu.toLowerCase())>-1&&Po.push({html:ls,value:ls})}),h.hint.genHTML(Po,Qu,h),Ne.preventDefault()}},h.wysiwyg.popover.insertAdjacentElement("beforeend",Rp),Dn(h,"code-block")}else Dn(h,"block");kn(h,Nn)}else Nn=void 0;if(P){h.wysiwyg.popover.innerHTML="";var ot=document.createElement("span");ot.setAttribute("aria-label","ID<"+(0,p.ns)("Enter")+">"),ot.className="vditor-tooltipped vditor-tooltipped__n";var No=document.createElement("input");ot.appendChild(No),No.className="vditor-input",No.setAttribute("placeholder","ID<"+(0,p.ns)("Enter")+">"),No.style.width="120px",No.value=P.getAttribute("data-id")||"",No.oninput=function(){P.setAttribute("data-id",No.value),typeof h.options.input=="function"&&h.options.input(c(h))},No.onkeydown=function(gt){gt.isComposing||Mt(h,gt)||Cn(gt,d)},Dr(d,P,h),Li(d,P,h),bn(P,h),h.wysiwyg.popover.insertAdjacentElement("beforeend",ot),Dn(h,"heading"),kn(h,P)}if(D&&Oo(h,D,d),!fe&&!w&&!L&&!Nn&&!D&&!Vy&&!rc&&!P&&!$){var ic=(0,S.a1)(m,"data-block","0");ic&&ic.parentElement.isEqualNode(h.wysiwyg.element)?(h.wysiwyg.popover.innerHTML="",Dr(d,ic,h),Li(d,ic,h),bn(ic,h),Dn(h,"block"),kn(h,ic)):h.wysiwyg.popover.style.display="none"}h.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach(function(Ne){Ne.style.display="none"});var ax=(0,S.a1)(d.startContainer,"data-type","backslash");ax&&(ax.querySelector("span").style.display="inline")}},200)},kn=function(h,d){var m=d,b=(0,S.lG)(d,"TABLE");b&&(m=b),h.wysiwyg.popover.style.left="0",h.wysiwyg.popover.style.display="block",h.wysiwyg.popover.style.top=Math.max(-8,m.offsetTop-21-h.wysiwyg.element.scrollTop)+"px",h.wysiwyg.popover.style.left=Math.min(m.offsetLeft,h.wysiwyg.element.clientWidth-h.wysiwyg.popover.clientWidth)+"px",h.wysiwyg.popover.setAttribute("data-top",(m.offsetTop-21).toString())},rs=function(h,d,m){m===void 0&&(m=getSelection().getRangeAt(0)),h.wysiwyg.popover.innerHTML="";var b=function(){C.value.trim()!==""&&(d.tagName==="IMG"?d.setAttribute("alt",C.value):d.textContent=C.value),O.value.trim()!==""&&d.setAttribute("data-link-label",O.value),typeof h.options.input=="function"&&h.options.input(c(h))},w=document.createElement("span");w.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),w.className="vditor-tooltipped vditor-tooltipped__n";var C=document.createElement("input");w.appendChild(C),C.className="vditor-input",C.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),C.style.width="120px",C.value=d.getAttribute("alt")||d.textContent,C.oninput=function(){b()},C.onkeydown=function(D){Mt(h,D)||Cn(D,m)||is(h,d,D,O)};var E=document.createElement("span");E.setAttribute("aria-label",window.VditorI18n.linkRef),E.className="vditor-tooltipped vditor-tooltipped__n";var O=document.createElement("input");E.appendChild(O),O.className="vditor-input",O.setAttribute("placeholder",window.VditorI18n.linkRef),O.value=d.getAttribute("data-link-label"),O.oninput=function(){b()},O.onkeydown=function(D){Mt(h,D)||Cn(D,m)||is(h,d,D,C)},bn(d,h),h.wysiwyg.popover.insertAdjacentElement("beforeend",w),h.wysiwyg.popover.insertAdjacentElement("beforeend",E),Dn(h,"link-ref"),kn(h,d)},Dr=function(h,d,m){var b=d.previousElementSibling;if(!(!b||!d.parentElement.isEqualNode(m.wysiwyg.element)&&d.tagName!=="LI")){var w=document.createElement("button");w.setAttribute("type","button"),w.setAttribute("data-type","up"),w.setAttribute("aria-label",window.VditorI18n.up+"<"+(0,p.ns)("U")+">"),w.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',w.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",w.onclick=function(){h.insertNode(document.createElement("wbr")),b.insertAdjacentElement("beforebegin",d),(0,j.ib)(m.wysiwyg.element,h),ye(m),zn(m),zt(m)},m.wysiwyg.popover.insertAdjacentElement("beforeend",w)}},Li=function(h,d,m){var b=d.nextElementSibling;if(!(!b||!d.parentElement.isEqualNode(m.wysiwyg.element)&&d.tagName!=="LI")){var w=document.createElement("button");w.setAttribute("type","button"),w.setAttribute("data-type","down"),w.setAttribute("aria-label",window.VditorI18n.down+"<"+(0,p.ns)("D")+">"),w.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',w.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",w.onclick=function(){h.insertNode(document.createElement("wbr")),b.insertAdjacentElement("afterend",d),(0,j.ib)(m.wysiwyg.element,h),ye(m),zn(m),zt(m)},m.wysiwyg.popover.insertAdjacentElement("beforeend",w)}},bn=function(h,d){var m=document.createElement("button");m.setAttribute("type","button"),m.setAttribute("data-type","remove"),m.setAttribute("aria-label",window.VditorI18n.remove+"<"+(0,p.ns)("X")+">"),m.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',m.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",m.onclick=function(){var b=(0,j.zh)(d);b.setStartAfter(h),(0,j.Hc)(b),h.remove(),ye(d),zn(d),["H1","H2","H3","H4","H5","H6"].includes(h.tagName)&&Ze(d)},d.wysiwyg.popover.insertAdjacentElement("beforeend",m)},is=function(h,d,m,b){if(!m.isComposing){if(m.key==="Tab"){b.focus(),b.select(),m.preventDefault();return}if(!(0,p.yl)(m)&&!m.shiftKey&&m.altKey&&m.key==="Enter"){var w=(0,j.zh)(h);d.insertAdjacentHTML("afterend",l.g.ZWSP),w.setStartAfter(d.nextSibling),w.collapse(!0),(0,j.Hc)(w),m.preventDefault()}}},Oo=function(h,d,m){h.wysiwyg.popover.innerHTML="";var b=function(){C.value.trim()!==""&&(d.innerHTML=C.value),d.setAttribute("href",O.value),d.setAttribute("title",L.value),ye(h)};d.querySelectorAll("[data-marker]").forEach(function(P){P.removeAttribute("data-marker")});var w=document.createElement("span");w.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),w.className="vditor-tooltipped vditor-tooltipped__n";var C=document.createElement("input");w.appendChild(C),C.className="vditor-input",C.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),C.style.width="120px",C.value=d.innerHTML||"",C.oninput=function(){b()},C.onkeydown=function(P){Mt(h,P)||Cn(P,m)||is(h,d,P,O)};var E=document.createElement("span");E.setAttribute("aria-label",window.VditorI18n.link),E.className="vditor-tooltipped vditor-tooltipped__n";var O=document.createElement("input");E.appendChild(O),O.className="vditor-input",O.setAttribute("placeholder",window.VditorI18n.link),O.value=d.getAttribute("href")||"",O.oninput=function(){b()},O.onkeydown=function(P){Mt(h,P)||Cn(P,m)||is(h,d,P,L)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.tooltipText),D.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");D.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.tooltipText),L.style.width="60px",L.value=d.getAttribute("title")||"",L.oninput=function(){b()},L.onkeydown=function(P){Mt(h,P)||Cn(P,m)||is(h,d,P,C)},bn(d,h),h.wysiwyg.popover.insertAdjacentElement("beforeend",w),h.wysiwyg.popover.insertAdjacentElement("beforeend",E),h.wysiwyg.popover.insertAdjacentElement("beforeend",D),Dn(h,"a"),kn(h,d)},an=function(h,d){var m=h.target;d.wysiwyg.popover.innerHTML="";var b=function(){m.setAttribute("src",C.value),m.setAttribute("alt",O.value),m.setAttribute("title",L.value),typeof d.options.input=="function"&&d.options.input(c(d))},w=document.createElement("span");w.setAttribute("aria-label",window.VditorI18n.imageURL),w.className="vditor-tooltipped vditor-tooltipped__n";var C=document.createElement("input");w.appendChild(C),C.className="vditor-input",C.setAttribute("placeholder",window.VditorI18n.imageURL),C.value=m.getAttribute("src")||"",C.oninput=function(){b()},C.onkeydown=function(P){Mt(d,P)};var E=document.createElement("span");E.setAttribute("aria-label",window.VditorI18n.alternateText),E.className="vditor-tooltipped vditor-tooltipped__n";var O=document.createElement("input");E.appendChild(O),O.className="vditor-input",O.setAttribute("placeholder",window.VditorI18n.alternateText),O.style.width="52px",O.value=m.getAttribute("alt")||"",O.oninput=function(){b()},O.onkeydown=function(P){Mt(d,P)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.title),D.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");D.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.title),L.value=m.getAttribute("title")||"",L.oninput=function(){b()},L.onkeydown=function(P){Mt(d,P)},bn(m,d),d.wysiwyg.popover.insertAdjacentElement("beforeend",w),d.wysiwyg.popover.insertAdjacentElement("beforeend",E),d.wysiwyg.popover.insertAdjacentElement("beforeend",D),Dn(d,"image"),kn(d,m)},Cn=function(h,d){if(!(0,p.yl)(h)&&!h.shiftKey&&h.key==="Enter"||h.key==="Escape")return d&&(0,j.Hc)(d),h.preventDefault(),h.stopPropagation(),!0},Dn=function(h,d){h.options.customWysiwygToolbar(d,h.wysiwyg.popover)},ui=function(h){h.currentMode==="wysiwyg"?zn(h):h.currentMode==="ir"&&_e(h)},Bs=function(h,d,m){m===void 0&&(m={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var b=h.wysiwyg.element;b.innerHTML=h.lute.Md2VditorDOM(d),b.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(w){He(w,h),w.previousElementSibling.setAttribute("style","display:none")}),ye(h,m)},El=function(h,d,m){for(var b=h.startContainer.parentElement,w=!1,C="",E="",O=Zt(h),D=O.beforeHTML,L=O.afterHTML;b&&!w;){var P=b.tagName;if(P==="STRIKE"&&(P="S"),P==="I"&&(P="EM"),P==="B"&&(P="STRONG"),P==="S"||P==="STRONG"||P==="EM"){var $="",fe="",de="";b.parentElement.getAttribute("data-block")!=="0"&&(fe=ft(b),de=vt(b)),(D||fe)&&($="".concat(fe,"<").concat(P,">").concat(D,"</").concat(P,">"),D=$),(m==="bold"&&P==="STRONG"||m==="italic"&&P==="EM"||m==="strikeThrough"&&P==="S")&&($+="".concat(C).concat(l.g.ZWSP,"<wbr>").concat(E),w=!0),(L||de)&&(L="<".concat(P,">").concat(L,"</").concat(P,">").concat(de),$+=L),b.parentElement.getAttribute("data-block")!=="0"?(b=b.parentElement,b.innerHTML=$):(b.outerHTML=$,b=b.parentElement),C="<".concat(P,">")+C,E="</".concat(P,">")+E}else w=!0}(0,j.ib)(d.wysiwyg.element,h)},Al=function(h,d,m){if(!(h.wysiwyg.composingLock&&m instanceof CustomEvent)){var b=!0,w=!0;h.wysiwyg.element.querySelector("wbr")&&h.wysiwyg.element.querySelector("wbr").remove();var C=(0,j.zh)(h),E=d.getAttribute("data-type");if(d.classList.contains("vditor-menu--current"))if(E==="strike"&&(E="strikeThrough"),E==="quote"){var O=(0,S.lG)(C.startContainer,"BLOCKQUOTE");O||(O=C.startContainer.childNodes[C.startOffset]),O&&(b=!1,d.classList.remove("vditor-menu--current"),C.insertNode(document.createElement("wbr")),O.outerHTML=O.innerHTML.trim()===""?'<p data-block="0">'.concat(O.innerHTML,"</p>"):O.innerHTML,(0,j.ib)(h.wysiwyg.element,C))}else if(E==="inline-code"){var D=(0,S.lG)(C.startContainer,"CODE");D||(D=C.startContainer.childNodes[C.startOffset]),D&&(D.outerHTML=D.innerHTML.replace(l.g.ZWSP,"")+"<wbr>",(0,j.ib)(h.wysiwyg.element,C))}else E==="link"?(C.collapsed&&C.selectNode(C.startContainer.parentElement),document.execCommand("unlink",!1,"")):E==="check"||E==="list"||E==="ordered-list"?(We(h,C,E),(0,j.ib)(h.wysiwyg.element,C),b=!1,d.classList.remove("vditor-menu--current")):(b=!1,d.classList.remove("vditor-menu--current"),C.toString()===""?El(C,h,E):document.execCommand(E,!1,""));else{h.wysiwyg.element.childNodes.length===0&&(h.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',(0,j.ib)(h.wysiwyg.element,C));var L=(0,S.F9)(C.startContainer);if(E==="quote"){if(L||(L=C.startContainer.childNodes[C.startOffset]),L){b=!1,d.classList.add("vditor-menu--current"),C.insertNode(document.createElement("wbr"));var P=(0,S.lG)(C.startContainer,"LI");P&&L.contains(P)?P.innerHTML='<blockquote data-block="0">'.concat(P.innerHTML,"</blockquote>"):L.outerHTML='<blockquote data-block="0">'.concat(L.outerHTML,"</blockquote>"),(0,j.ib)(h.wysiwyg.element,C)}}else if(E==="check"||E==="list"||E==="ordered-list")We(h,C,E,!1),(0,j.ib)(h.wysiwyg.element,C),b=!1,g(h.toolbar.elements,["check","list","ordered-list"]),d.classList.add("vditor-menu--current");else if(E==="inline-code"){if(C.toString()===""){var $=document.createElement("code");$.textContent=l.g.ZWSP,C.insertNode($),C.setStart($.firstChild,1),C.collapse(!0),(0,j.Hc)(C)}else if(C.startContainer.nodeType===3){var $=document.createElement("code");C.surroundContents($),C.insertNode($),(0,j.Hc)(C)}d.classList.add("vditor-menu--current")}else if(E==="code"){var $=document.createElement("div");$.className="vditor-wysiwyg__block",$.setAttribute("data-type","code-block"),$.setAttribute("data-block","0"),$.setAttribute("data-marker","```"),C.toString()===""?$.innerHTML=`<pre><code><wbr>
</code></pre>`:($.innerHTML="<pre><code>".concat(C.toString(),"<wbr></code></pre>"),C.deleteContents()),C.insertNode($),L&&(L.outerHTML=h.lute.SpinVditorDOM(L.outerHTML)),(0,j.ib)(h.wysiwyg.element,C),h.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(Bt){He(Bt,h)}),d.classList.add("vditor-menu--disabled")}else if(E==="link"){if(C.toString()===""){var fe=document.createElement("a");fe.innerText=l.g.ZWSP,C.insertNode(fe),C.setStart(fe.firstChild,1),C.collapse(!0),Oo(h,fe,C);var de=h.wysiwyg.popover.querySelector("input");de.value="",de.focus(),w=!1}else{var $=document.createElement("a");$.setAttribute("href",""),$.innerHTML=C.toString(),C.surroundContents($),C.insertNode($),(0,j.Hc)(C),Oo(h,$,C);var le=h.wysiwyg.popover.querySelectorAll("input");le[0].value=$.innerText,le[1].focus()}b=!1,d.classList.add("vditor-menu--current")}else if(E==="table"){var Me='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(C.toString().trim()==="")L&&L.innerHTML.trim().replace(l.g.ZWSP,"")===""?L.outerHTML=Me:document.execCommand("insertHTML",!1,Me),C.selectNode(h.wysiwyg.element.querySelector("wbr").previousSibling),h.wysiwyg.element.querySelector("wbr").remove(),(0,j.Hc)(C);else{Me='<table data-block="0"><thead><tr>';var Ce=C.toString().split(`
`),ae=Ce[0].split(",").length>Ce[0].split("	").length?",":"	";Ce.forEach(function(Ye,Bt){Bt===0?(Ye.split(ae).forEach(function(Dt,qt){qt===0?Me+="<th>".concat(Dt,"<wbr></th>"):Me+="<th>".concat(Dt,"</th>")}),Me+="</tr></thead>"):(Bt===1?Me+="<tbody><tr>":Me+="<tr>",Ye.split(ae).forEach(function(Dt){Me+="<td>".concat(Dt,"</td>")}),Me+="</tr>")}),Me+="</tbody></table>",document.execCommand("insertHTML",!1,Me),(0,j.ib)(h.wysiwyg.element,C)}b=!1,d.classList.add("vditor-menu--disabled")}else if(E==="line"){if(L){var $e=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;L.innerHTML.trim()===""?L.outerHTML=$e:L.insertAdjacentHTML("afterend",$e),(0,j.ib)(h.wysiwyg.element,C)}}else if(b=!1,d.classList.add("vditor-menu--current"),E==="strike"&&(E="strikeThrough"),C.toString()===""&&(E==="bold"||E==="italic"||E==="strikeThrough")){var Ae="strong";E==="italic"?Ae="em":E==="strikeThrough"&&(Ae="s");var $=document.createElement(Ae);$.textContent=l.g.ZWSP,C.insertNode($),$.previousSibling&&$.previousSibling.textContent===l.g.ZWSP&&($.previousSibling.textContent=""),C.setStart($.firstChild,1),C.collapse(!0),(0,j.Hc)(C)}else document.execCommand(E,!1,"")}b&&zn(h),w&&ye(h)}},Rt=function(){function h(d,m){var b,w=this;this.element=document.createElement("div"),m.className&&(b=this.element.classList).add.apply(b,m.className.split(" "));var C=m.hotkey?" <".concat((0,p.ns)(m.hotkey),">"):"";m.level===2&&(C=m.hotkey?" &lt;".concat((0,p.ns)(m.hotkey),"&gt;"):"");var E=m.tip?m.tip+C:"".concat(window.VditorI18n[m.name]).concat(C),O=m.name==="upload"?"div":"button";if(m.level===2)this.element.innerHTML="<".concat(O,' data-type="').concat(m.name,'">').concat(E,"</").concat(O,">");else{this.element.classList.add("vditor-toolbar__item");var D=document.createElement(O);D.setAttribute("data-type",m.name),D.className="vditor-tooltipped vditor-tooltipped__".concat(m.tipPosition),D.setAttribute("aria-label",E),D.innerHTML=m.icon,this.element.appendChild(D)}m.prefix&&this.element.children[0].addEventListener((0,p.Le)(),function(L){L.preventDefault(),!w.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)&&(d.currentMode==="wysiwyg"?Al(d,w.element.children[0],L):d.currentMode==="ir"?oP(d,w.element.children[0],m.prefix||"",m.suffix||""):On(d,w.element.children[0],m.prefix||"",m.suffix||""))})}return h}(),pr=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),In=function(h,d,m){var b;if(typeof m!="string"?(M(h,["subToolbar","hint"]),m.preventDefault(),b=c(h)):b=m,!(h.currentMode===d&&typeof m!="string")){if(h.devtools&&h.devtools.renderEchart(h),h.options.preview.mode==="both"&&d==="sv"?h.preview.element.style.display="block":h.preview.element.style.display="none",v(h.toolbar.elements,l.g.EDIT_TOOLBARS),g(h.toolbar.elements,l.g.EDIT_TOOLBARS),k(h.toolbar.elements,["outdent","indent"]),d==="ir")x(h.toolbar.elements,["both"]),_(h.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),h.sv.element.style.display="none",h.wysiwyg.element.parentElement.style.display="none",h.ir.element.parentElement.style.display="block",h.lute.SetVditorIR(!0),h.lute.SetVditorWYSIWYG(!1),h.lute.SetVditorSV(!1),h.currentMode="ir",h.ir.element.innerHTML=h.lute.Md2VditorIRDOM(b),$s(h,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),pe(h),h.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(C){He(C,h)}),h.ir.element.querySelectorAll(".vditor-toc").forEach(function(C){(0,ne.H)(C,{cdn:h.options.cdn,math:h.options.preview.math})});else if(d==="wysiwyg")x(h.toolbar.elements,["both"]),_(h.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),h.sv.element.style.display="none",h.wysiwyg.element.parentElement.style.display="block",h.ir.element.parentElement.style.display="none",h.lute.SetVditorIR(!1),h.lute.SetVditorWYSIWYG(!0),h.lute.SetVditorSV(!1),h.currentMode="wysiwyg",pe(h),Bs(h,b,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),h.wysiwyg.element.querySelectorAll(".vditor-toc").forEach(function(C){(0,ne.H)(C,{cdn:h.options.cdn,math:h.options.preview.math})}),h.wysiwyg.popover.style.display="none";else if(d==="sv"){_(h.toolbar.elements,["both"]),x(h.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),h.wysiwyg.element.parentElement.style.display="none",h.ir.element.parentElement.style.display="none",(h.options.preview.mode==="both"||h.options.preview.mode==="editor")&&(h.sv.element.style.display="block"),h.lute.SetVditorIR(!1),h.lute.SetVditorWYSIWYG(!1),h.lute.SetVditorSV(!0),h.currentMode="sv";var w=Pe(b,h);w==="<div data-block='0'></div>"&&(w=""),h.sv.element.innerHTML=w,N(h.sv.element),ut(h,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),pe(h)}h.undo.resetIcon(h),typeof m!="string"&&(h[h.currentMode].element.focus(),ui(h)),Ze(h),me(h),h.toolbar.elements["edit-mode"]&&(h.toolbar.elements["edit-mode"].querySelectorAll("button").forEach(function(C){C.classList.remove("vditor-menu--current")}),h.toolbar.elements["edit-mode"].querySelector('button[data-mode="'.concat(h.currentMode,'"]')).classList.add("vditor-menu--current")),h.outline.toggle(h,h.currentMode!=="sv"&&h.options.outline.enable,typeof m!="string")}},Ol=function(h){pr(d,h);function d(m,b){var w=h.call(this,m,b)||this,C=document.createElement("div");return C.className="vditor-hint".concat(b.level===2?"":" vditor-panel--arrow"),C.innerHTML='<button data-mode="wysiwyg">'.concat(window.VditorI18n.wysiwyg," &lt;").concat((0,p.ns)("7"),`></button>
<button data-mode="ir">`).concat(window.VditorI18n.instantRendering," &lt;").concat((0,p.ns)("8"),`></button>
<button data-mode="sv">`).concat(window.VditorI18n.splitView," &lt;").concat((0,p.ns)("9"),"></button>"),w.element.appendChild(C),w._bindEvent(m,C,b),w}return d.prototype._bindEvent=function(m,b,w){var C=this.element.children[0];T(m,b,C,w.level),b.children.item(0).addEventListener((0,p.Le)(),function(E){In(m,"wysiwyg",E),E.preventDefault(),E.stopPropagation()}),b.children.item(1).addEventListener((0,p.Le)(),function(E){In(m,"ir",E),E.preventDefault(),E.stopPropagation()}),b.children.item(2).addEventListener((0,p.Le)(),function(E){In(m,"sv",E),E.preventDefault(),E.stopPropagation()})},d}(Rt),Di=function(h,d){return(0,j.Gb)(h,d)?getSelection().toString():""},ss=function(h,d){d.addEventListener("focus",function(){h.options.focus&&h.options.focus(c(h)),M(h,["subToolbar","hint"])})},Lo=function(h,d){d.addEventListener("dblclick",function(m){m.target.tagName==="IMG"&&(h.options.image.preview?h.options.image.preview(m.target):h.options.image.isPreview&&(0,De.E)(m.target,h.options.lang,h.options.theme))})},nr=function(h,d){d.addEventListener("blur",function(m){if(h.currentMode==="ir"){var b=h.ir.element.querySelector(".vditor-ir__node--expand");b&&b.classList.remove("vditor-ir__node--expand")}else h.currentMode==="wysiwyg"&&!h.wysiwyg.selectPopover.contains(m.relatedTarget)&&h.wysiwyg.hideComment();h[h.currentMode].range=(0,j.zh)(h),h.options.blur&&h.options.blur(c(h))})},Hs=function(h,d){d.addEventListener("dragstart",function(m){m.dataTransfer.setData(l.g.DROP_EDITOR,l.g.DROP_EDITOR)}),d.addEventListener("drop",function(m){m.dataTransfer.getData(l.g.DROP_EDITOR)?ht(h):(m.dataTransfer.types.includes("Files")||m.dataTransfer.types.includes("text/html"))&&Dp(h,m,{pasteCode:function(b){document.execCommand("insertHTML",!1,b)}})})},Vs=function(h,d,m){d.addEventListener("copy",function(b){return m(b,h)})},Fs=function(h,d,m){d.addEventListener("cut",function(b){m(b,h),h.options.comment.enable&&h.currentMode==="wysiwyg"&&h.wysiwyg.getComments(h),document.execCommand("delete")})},zt=function(h){if(h.currentMode==="wysiwyg"&&h.options.comment.enable&&h.options.comment.adjustTop(h.wysiwyg.getComments(h,!0)),!!h.options.typewriterMode){var d=h[h.currentMode].element,m=(0,j.Ny)(d).top;h.options.height==="auto"&&!h.element.classList.contains("vditor--fullscreen")&&window.scrollTo(window.scrollX,m+h.element.offsetTop+h.toolbar.element.offsetHeight-window.innerHeight/2+10),(h.options.height!=="auto"||h.element.classList.contains("vditor--fullscreen"))&&(d.scrollTop=m+d.scrollTop-d.clientHeight/2+10)}},Do=function(h,d){d.addEventListener("keydown",function(m){if(!m.isComposing&&h.options.keydown&&h.options.keydown(m),!((h.options.hint.extend.length>1||h.toolbar.elements.emoji)&&h.hint.select(m,h))){if(h.options.comment.enable&&h.currentMode==="wysiwyg"&&(m.key==="Backspace"||ie("X",m))&&h.wysiwyg.getComments(h),h.currentMode==="sv"){if(W(h,m))return}else if(h.currentMode==="wysiwyg"){if(Yt(h,m))return}else if(h.currentMode==="ir"&&_t(h,m))return;if(h.options.ctrlEnter&&ie("Enter",m)){h.options.ctrlEnter(c(h)),m.preventDefault();return}if(ie("Z",m)&&!h.toolbar.elements.undo){h.undo.undo(h),m.preventDefault();return}if(ie("Y",m)&&!h.toolbar.elements.redo){h.undo.redo(h),m.preventDefault();return}if(m.key==="Escape"){h.hint.element.style.display==="block"?h.hint.element.style.display="none":h.options.esc&&!m.isComposing&&h.options.esc(c(h)),m.preventDefault();return}if((0,p.yl)(m)&&m.altKey&&!m.shiftKey&&/^Digit[1-6]$/.test(m.code)){if(h.currentMode==="wysiwyg"){var b=m.code.replace("Digit","H");(0,S.lG)(getSelection().getRangeAt(0).startContainer,b)?$n(h):$t(h,b),ye(h)}else h.currentMode==="sv"?Wt(h,"#".repeat(parseInt(m.code.replace("Digit",""),10))+" "):h.currentMode==="ir"&&Yu(h,"#".repeat(parseInt(m.code.replace("Digit",""),10))+" ");return m.preventDefault(),!0}if((0,p.yl)(m)&&m.altKey&&!m.shiftKey&&/^Digit[7-9]$/.test(m.code))return m.code==="Digit7"?In(h,"wysiwyg",m):m.code==="Digit8"?In(h,"ir",m):m.code==="Digit9"&&In(h,"sv",m),!0;h.options.toolbar.find(function(w){if(!w.hotkey||w.toolbar){if(w.toolbar){var C=w.toolbar.find(function(E){if(!E.hotkey)return!1;if(ie(E.hotkey,m))return h.toolbar.elements[E.name].children[0].dispatchEvent(new CustomEvent((0,p.Le)())),m.preventDefault(),!0});return!!C}return!1}if(ie(w.hotkey,m))return h.toolbar.elements[w.name].children[0].dispatchEvent(new CustomEvent((0,p.Le)())),m.preventDefault(),!0})}})},Fe=function(h,d){d.addEventListener("selectstart",function(m){d.onmouseup=function(){setTimeout(function(){var b=Di(h[h.currentMode].element);b.trim()?(h.currentMode==="wysiwyg"&&h.options.comment.enable&&(!(0,S.a1)(m.target,"data-type","footnotes-block")&&!(0,S.a1)(m.target,"data-type","link-ref-defs-block")?h.wysiwyg.showComment():h.wysiwyg.hideComment()),h.options.select&&h.options.select(b)):(h.currentMode==="wysiwyg"&&h.options.comment.enable&&h.wysiwyg.hideComment(),typeof h.options.unSelect=="function"&&h.options.unSelect())})}})},F=function(h,d){var m=(0,j.zh)(h);m.extractContents(),m.insertNode(document.createTextNode(Lute.Caret)),m.insertNode(document.createTextNode(d));var b=(0,S.a1)(m.startContainer,"data-block","0");b||(b=h.sv.element);var w=h.lute.SpinVditorSVDOM(b.textContent);w="<div data-block='0'>"+w.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",b.isEqualNode(h.sv.element)?b.innerHTML=w:b.outerHTML=w,N(h.sv.element),(0,j.ib)(h.sv.element,m),zt(h)},ue=function(h,d,m){m===void 0&&(m=!0);var b=h;for(b.nodeType===3&&(b=b.parentElement);b;){if(b.getAttribute("data-type")===d)return b;m?b=b.previousElementSibling:b=b.nextElementSibling}return!1},Pe=function(h,d){I("SpinVditorSVDOM",h,"argument",d.options.debugger);var m=d.lute.SpinVditorSVDOM(h);return h="<div data-block='0'>"+m.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",I("SpinVditorSVDOM",h,"result",d.options.debugger),h},Lt=function(h){var d=h.getAttribute("data-type"),m=h.previousElementSibling,b=d&&d!=="text"&&d!=="table"&&d!=="heading-marker"&&d!=="newline"&&d!=="yaml-front-matter-open-marker"&&d!=="yaml-front-matter-close-marker"&&d!=="code-block-info"&&d!=="code-block-close-marker"&&d!=="code-block-open-marker"?h.textContent:"",w=!1;for(d==="newline"&&(w=!0);m&&!w;){var C=m.getAttribute("data-type");if(C==="li-marker"||C==="blockquote-marker"||C==="task-marker"||C==="padding"){var E=m.textContent;if(C==="li-marker"&&(d==="code-block-open-marker"||d==="code-block-info"))b=E.replace(/\S/g," ")+b;else if(d==="code-block-close-marker"&&m.nextElementSibling.isSameNode(h)){var O=ue(h,"code-block-open-marker");O&&O.previousElementSibling&&(m=O.previousElementSibling,b=E+b)}else b=E+b}else C==="newline"&&(w=!0);m=m.previousElementSibling}return b},ut=function(h,d){d===void 0&&(d={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),d.enableHint&&h.hint.render(h),h.preview.render(h);var m=c(h);typeof h.options.input=="function"&&d.enableInput&&h.options.input(m),h.options.counter.enable&&h.counter.render(h,m),h.options.cache.enable&&(0,p.pK)()&&(localStorage.setItem(h.options.cache.id,m),h.options.cache.after&&h.options.cache.after(m)),h.devtools&&h.devtools.renderEchart(h),clearTimeout(h.sv.processTimeoutId),h.sv.processTimeoutId=window.setTimeout(function(){d.enableAddUndoStack&&!h.sv.composingLock&&h.undo.addToUndoStack(h)},h.options.undoDelay)},Wt=function(h,d){var m=(0,j.zh)(h),b=(0,A.S)(m.startContainer,"SPAN");b&&b.textContent.trim()!==""&&(d=`
`+d),m.collapse(!0),document.execCommand("insertHTML",!1,d)},On=function(h,d,m,b){var w=(0,j.zh)(h),C=d.getAttribute("data-type");h.sv.element.childNodes.length===0&&(h.sv.element.innerHTML=`<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">
</span></span>`,(0,j.ib)(h.sv.element,w));var E=(0,S.F9)(w.startContainer),O=(0,A.S)(w.startContainer,"SPAN");if(E){if(C==="link"){var D=void 0;w.toString()===""?D="".concat(m).concat(Lute.Caret).concat(b):D="".concat(m).concat(w.toString()).concat(b.replace(")",Lute.Caret+")")),document.execCommand("insertHTML",!1,D);return}else if(C==="italic"||C==="bold"||C==="strike"||C==="inline-code"||C==="code"||C==="table"||C==="line"){var D=void 0;w.toString()===""?D="".concat(m).concat(Lute.Caret).concat(C==="code"?"":b):D="".concat(m).concat(w.toString()).concat(Lute.Caret).concat(C==="code"?"":b),C==="table"||C==="code"&&O&&O.textContent!==""?D=`

`+D:C==="line"&&(D=`

`.concat(m,`
`).concat(Lute.Caret)),document.execCommand("insertHTML",!1,D);return}else if((C==="check"||C==="list"||C==="ordered-list"||C==="quote")&&O){var L="* ";C==="check"?L="* [ ] ":C==="ordered-list"?L="1. ":C==="quote"&&(L="> ");var P=ue(O,"newline");P?P.insertAdjacentText("afterend",L):E.insertAdjacentText("afterbegin",L),H(h);return}(0,j.ib)(h.sv.element,w),ut(h)}},mr=function(h){switch(h.currentMode){case"ir":return h.ir.element;case"wysiwyg":return h.wysiwyg.element;case"sv":return h.sv.element}},fi=function(h,d){h.options.upload.setHeaders&&(h.options.upload.headers=h.options.upload.setHeaders()),h.options.upload.headers&&Object.keys(h.options.upload.headers).forEach(function(m){d.setRequestHeader(m,h.options.upload.headers[m])})},Io=function(h,d,m,b){function w(C){return C instanceof m?C:new m(function(E){E(C)})}return new(m||(m=Promise))(function(C,E){function O(P){try{L(b.next(P))}catch($){E($)}}function D(P){try{L(b.throw(P))}catch($){E($)}}function L(P){P.done?C(P.value):w(P.value).then(O,D)}L((b=b.apply(h,d||[])).next())})},dn=function(h,d){var m={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},b,w,C,E;return E={next:O(0),throw:O(1),return:O(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function O(L){return function(P){return D([L,P])}}function D(L){if(b)throw new TypeError("Generator is already executing.");for(;E&&(E=0,L[0]&&(m=0)),m;)try{if(b=1,w&&(C=L[0]&2?w.return:L[0]?w.throw||((C=w.return)&&C.call(w),0):w.next)&&!(C=C.call(w,L[1])).done)return C;switch(w=0,C&&(L=[L[0]&2,C.value]),L[0]){case 0:case 1:C=L;break;case 4:return m.label++,{value:L[1],done:!1};case 5:m.label++,w=L[1],L=[0];continue;case 7:L=m.ops.pop(),m.trys.pop();continue;default:if(C=m.trys,!(C=C.length>0&&C[C.length-1])&&(L[0]===6||L[0]===2)){m=0;continue}if(L[0]===3&&(!C||L[1]>C[0]&&L[1]<C[3])){m.label=L[1];break}if(L[0]===6&&m.label<C[1]){m.label=C[1],C=L;break}if(C&&m.label<C[2]){m.label=C[2],m.ops.push(L);break}C[2]&&m.ops.pop(),m.trys.pop();continue}L=d.call(h,m)}catch(P){L=[6,P],w=0}finally{b=C=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Ll=function(){function h(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"}return h}(),Dl=function(h,d){h.tip.hide();var m=[],b="",w="";h.options.lang,h.options;for(var C=function(L,P){var $=d[P],fe=!0;$.name||(b+="<li>".concat(window.VditorI18n.nameEmpty,"</li>"),fe=!1),$.size>h.options.upload.max&&(b+="<li>".concat($.name," ").concat(window.VditorI18n.over," ").concat(h.options.upload.max/1024/1024,"M</li>"),fe=!1);var de=$.name.lastIndexOf("."),le=$.name.substr(de),Me=h.options.upload.filename($.name.substr(0,de))+le;if(h.options.upload.accept){var Ce=h.options.upload.accept.split(",").some(function(ae){var $e=ae.trim();if($e.indexOf(".")===0){if(le.toLowerCase()===$e.toLowerCase())return!0}else if($.type.split("/")[0]===$e.split("/")[0])return!0;return!1});Ce||(b+="<li>".concat($.name," ").concat(window.VditorI18n.fileTypeError,"</li>"),fe=!1)}fe&&(m.push($),w+="<li>".concat(Me," ").concat(window.VditorI18n.uploading,' <a class="vditorCancelUpload" href="javascript:void(0)">').concat(window.VditorI18n.cancelUpload,"</a></li>"))},E=d.length,O=0;O<E;O++)C(E,O);if(h.tip.show("<ul>".concat(b).concat(w,"</ul>")),h.options.upload.cancel){var D=h.tip.element.querySelector(".vditorCancelUpload");D&&D.addEventListener("click",function(){h.options.upload.cancel(m),h.tip.hide(),h.upload.isUploading=!1})}return m},Mp=function(h,d){var m=mr(d);m.focus();var b=JSON.parse(h),w="";b.code===1&&(w="".concat(b.msg)),b.data.errFiles&&b.data.errFiles.length>0&&(w="<ul><li>".concat(w,"</li>"),b.data.errFiles.forEach(function(E){var O=E.lastIndexOf("."),D=d.options.upload.filename(E.substr(0,O))+E.substr(O);w+="<li>".concat(D," ").concat(window.VditorI18n.uploadError,"</li>")}),w+="</ul>"),w?d.tip.show(w):d.tip.hide();var C="";Object.keys(b.data.succMap).forEach(function(E){var O=b.data.succMap[E],D=E.lastIndexOf("."),L=E.substr(D),P=d.options.upload.filename(E.substr(0,D))+L;L=L.toLowerCase(),L.indexOf(".wav")===0||L.indexOf(".mp3")===0||L.indexOf(".ogg")===0?d.currentMode==="wysiwyg"?C+=`<div class="vditor-wysiwyg__block" data-type="html-block"
 data-block="0"><pre><code>&lt;audio controls="controls" src="`.concat(O,'"&gt;&lt;/audio&gt;</code></pre><pre class="vditor-wysiwyg__preview" data-render="1"><audio controls="controls" src="').concat(O,`"></audio></pre></div>
`):d.currentMode==="ir"?C+='<audio controls="controls" src="'.concat(O,`"></audio>
`):C+="[".concat(P,"](").concat(O,`)
`):L.indexOf(".apng")===0||L.indexOf(".bmp")===0||L.indexOf(".gif")===0||L.indexOf(".ico")===0||L.indexOf(".cur")===0||L.indexOf(".jpg")===0||L.indexOf(".jpeg")===0||L.indexOf(".jfif")===0||L.indexOf(".pjp")===0||L.indexOf(".pjpeg")===0||L.indexOf(".png")===0||L.indexOf(".svg")===0||L.indexOf(".webp")===0?d.currentMode==="wysiwyg"?C+='<img alt="'.concat(P,'" src="').concat(O,`">
`):C+="![".concat(P,"](").concat(O,`)
`):d.currentMode==="wysiwyg"?C+='<a href="'.concat(O,'">').concat(P,`</a>
`):C+="[".concat(P,"](").concat(O,`)
`)}),(0,j.Hc)(d.upload.range),document.execCommand("insertHTML",!1,C),d.upload.range=getSelection().getRangeAt(0).cloneRange()},nc=function(h,d,m){return Io(void 0,void 0,void 0,function(){var b,w,le,C,E,E,O,D,L,P,$,fe,de,le,Me,Ce;return dn(this,function(ae){switch(ae.label){case 0:for(b=[],w=h.options.upload.multiple===!0?d.length:1,le=0;le<w;le++)C=d[le],C instanceof DataTransferItem&&(C=C.getAsFile()),b.push(C);return h.options.upload.handler?[4,h.options.upload.handler(b)]:[3,2];case 1:return E=ae.sent(),m&&(m.value=""),typeof E=="string"?(h.tip.show(E),[2]):[2];case 2:return!h.options.upload.url||!h.upload?(m&&(m.value=""),h.tip.show("please config: options.upload.url"),[2]):h.options.upload.file?[4,h.options.upload.file(b)]:[3,4];case 3:b=ae.sent(),ae.label=4;case 4:if(h.options.upload.validate&&(E=h.options.upload.validate(b),typeof E=="string"))return h.tip.show(E),[2];if(O=mr(h),h.upload.range=(0,j.zh)(h),D=Dl(h,b),D.length===0)return m&&(m.value=""),[2];for(L=new FormData,P=h.options.upload.extraData,$=0,fe=Object.keys(P);$<fe.length;$++)de=fe[$],L.append(de,P[de]);for(le=0,Me=D.length;le<Me;le++)L.append(h.options.upload.fieldName,D[le]);return Ce=new XMLHttpRequest,h.upload.xhr=Ce,Ce.open("POST",h.options.upload.url),h.options.upload.token&&Ce.setRequestHeader("X-Upload-Token",h.options.upload.token),h.options.upload.withCredentials&&(Ce.withCredentials=!0),fi(h,Ce),h.upload.isUploading=!0,O.setAttribute("contenteditable","false"),Ce.onreadystatechange=function(){if(Ce.readyState===XMLHttpRequest.DONE){if(h.upload.isUploading=!1,O.setAttribute("contenteditable","true"),Ce.status>=200&&Ce.status<300)if(h.options.upload.success)h.options.upload.success(O,Ce.responseText);else{var $e=Ce.responseText;h.options.upload.format&&($e=h.options.upload.format(d,Ce.responseText)),Mp($e,h)}else h.options.upload.error?h.options.upload.error(Ce.responseText):h.tip.show(Ce.responseText);m&&(m.value=""),h.upload.element.style.display="none",h.upload.xhr=void 0}},Ce.upload.onprogress=function($e){if($e.lengthComputable){var Ae=$e.loaded/$e.total*100;h.upload.element.style.display="block";var Ye=h.upload.element;Ye.style.width=Ae+"%"}},Ce.send(L),[2]}})})},Il=function(h,d,m){var b,w=(0,S.F9)(d.startContainer);if(w||(w=h.wysiwyg.element),m&&m.inputType!=="formatItalic"&&m.inputType!=="deleteByDrag"&&m.inputType!=="insertFromDrop"&&m.inputType!=="formatBold"&&m.inputType!=="formatRemove"&&m.inputType!=="formatStrikeThrough"&&m.inputType!=="insertUnorderedList"&&m.inputType!=="insertOrderedList"&&m.inputType!=="formatOutdent"&&m.inputType!=="formatIndent"&&m.inputType!==""||!m){var C=Ue(d.startContainer);C&&C.remove(),h.wysiwyg.element.querySelectorAll("wbr").forEach(function(Ae){Ae.remove()}),d.insertNode(document.createElement("wbr")),w.querySelectorAll("[style]").forEach(function(Ae){Ae.removeAttribute("style")}),w.querySelectorAll(".vditor-comment").forEach(function(Ae){Ae.textContent.trim()===""&&(Ae.classList.remove("vditor-comment","vditor-comment--focus"),Ae.removeAttribute("data-cmtids"))}),(b=w.previousElementSibling)===null||b===void 0||b.querySelectorAll(".vditor-comment").forEach(function(Ae){Ae.textContent.trim()===""&&(Ae.classList.remove("vditor-comment","vditor-comment--focus"),Ae.removeAttribute("data-cmtids"))});var E="";w.getAttribute("data-type")==="link-ref-defs-block"&&(w=h.wysiwyg.element);var O=w.isEqualNode(h.wysiwyg.element),D=(0,S.a1)(w,"data-type","footnotes-block");if(O)E=w.innerHTML;else{var L=(0,S.O9)(d.startContainer);if(L&&!D){var P=(0,A.S)(d.startContainer,"BLOCKQUOTE");P?w=(0,S.F9)(d.startContainer)||w:w=L}if(D&&(w=D),E=w.outerHTML,w.tagName==="UL"||w.tagName==="OL"){var $=w.previousElementSibling,fe=w.nextElementSibling;$&&($.tagName==="UL"||$.tagName==="OL")&&(E=$.outerHTML+E,$.remove()),fe&&(fe.tagName==="UL"||fe.tagName==="OL")&&(E=E+fe.outerHTML,fe.remove()),E=E.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}w.innerText.startsWith("```")||(h.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(Ae){Ae&&!w.isEqualNode(Ae)&&(E+=Ae.outerHTML,Ae.remove())}),h.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(Ae){Ae&&!w.isEqualNode(Ae)&&(E+=Ae.outerHTML,Ae.remove())}))}if(E=E.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""),E==='<p data-block="0">```<wbr></p>'&&h.hint.recentLanguage&&(E='<p data-block="0">```<wbr></p>'.replace("```","```"+h.hint.recentLanguage)),I("SpinVditorDOM",E,"argument",h.options.debugger),E=h.lute.SpinVditorDOM(E),I("SpinVditorDOM",E,"result",h.options.debugger),O)w.innerHTML=E;else if(w.outerHTML=E,D){var de=(0,S.E2)(h.wysiwyg.element.querySelector("wbr"),"LI");if(de){var le=h.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(de.getAttribute("data-marker"),'"]'));le&&le.setAttribute("aria-label",de.textContent.trim().substr(0,24))}}var Me,Ce=h.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']");Ce.forEach(function(Ae,Ye){Ye===0?Me=Ae:(Me.insertAdjacentHTML("beforeend",Ae.innerHTML),Ae.remove())}),Ce.length>0&&h.wysiwyg.element.insertAdjacentElement("beforeend",Ce[0]);var ae,$e=h.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']");$e.forEach(function(Ae,Ye){Ye===0?ae=Ae:(ae.insertAdjacentHTML("beforeend",Ae.innerHTML),Ae.remove())}),$e.length>0&&h.wysiwyg.element.insertAdjacentElement("beforeend",$e[0]),(0,j.ib)(h.wysiwyg.element,d),h.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(Ae){He(Ae,h)}),m&&(m.inputType==="deleteContentBackward"||m.inputType==="deleteContentForward")&&h.options.comment.enable&&(h.wysiwyg.triggerRemoveComment(h),h.options.comment.adjustTop(h.wysiwyg.getComments(h,!0)))}Ze(h),ye(h,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Tp=function(h,d){return Object.defineProperty?Object.defineProperty(h,"raw",{value:d}):h.raw=d,h},Ku=function(h,d,m,b){function w(C){return C instanceof m?C:new m(function(E){E(C)})}return new(m||(m=Promise))(function(C,E){function O(P){try{L(b.next(P))}catch($){E($)}}function D(P){try{L(b.throw(P))}catch($){E($)}}function L(P){P.done?C(P.value):w(P.value).then(O,D)}L((b=b.apply(h,d||[])).next())})},Gu=function(h,d){var m={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},b,w,C,E;return E={next:O(0),throw:O(1),return:O(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function O(L){return function(P){return D([L,P])}}function D(L){if(b)throw new TypeError("Generator is already executing.");for(;E&&(E=0,L[0]&&(m=0)),m;)try{if(b=1,w&&(C=L[0]&2?w.return:L[0]?w.throw||((C=w.return)&&C.call(w),0):w.next)&&!(C=C.call(w,L[1])).done)return C;switch(w=0,C&&(L=[L[0]&2,C.value]),L[0]){case 0:case 1:C=L;break;case 4:return m.label++,{value:L[1],done:!1};case 5:m.label++,w=L[1],L=[0];continue;case 7:L=m.ops.pop(),m.trys.pop();continue;default:if(C=m.trys,!(C=C.length>0&&C[C.length-1])&&(L[0]===6||L[0]===2)){m=0;continue}if(L[0]===3&&(!C||L[1]>C[0]&&L[1]<C[3])){m.label=L[1];break}if(L[0]===6&&m.label<C[1]){m.label=C[1],C=L;break}if(C&&m.label<C[2]){m.label=C[2],m.ops.push(L);break}C[2]&&m.ops.pop(),m.trys.pop();continue}L=d.call(h,m)}catch(P){L=[6,P],w=0}finally{b=C=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},js=function(h,d,m){if(h.keyCode===229&&h.code===""&&h.key==="Unidentified"&&d.currentMode!=="sv"){var b=(0,S.F9)(m);if(b&&b.textContent.trim()==="")return d[d.currentMode].composingLock=!0,!1}return!0},Ep=function(h,d,m){if(!(m.key==="Enter"||m.key==="Tab"||m.key==="Backspace"||m.key.indexOf("Arrow")>-1||(0,p.yl)(m)||m.key==="Escape"||m.shiftKey||m.altKey)){var b=(0,S.lG)(h.startContainer,"P")||(0,S.lG)(h.startContainer,"LI");if(b&&(0,j.im)(b,d[d.currentMode].element,h).start===0){b.nodeValue&&(b.nodeValue=b.nodeValue.replace(/\u2006/g,""));var w=document.createTextNode(l.g.ZWSP);h.insertNode(w),h.setStartAfter(w)}}},Ap=function(h,d){if(d==="ArrowDown"||d==="ArrowUp"){var m=(0,S.a1)(h.startContainer,"data-type","math-inline")||(0,S.a1)(h.startContainer,"data-type","html-entity")||(0,S.a1)(h.startContainer,"data-type","html-inline");m&&(d==="ArrowDown"&&h.setStartAfter(m.parentElement),d==="ArrowUp"&&h.setStartBefore(m.parentElement))}},Nl=function(h,d){var m=(0,j.zh)(h),b=(0,S.F9)(m.startContainer);b&&(b.insertAdjacentHTML(d,'<p data-block="0">'.concat(l.g.ZWSP,`<wbr>
</p>`)),(0,j.ib)(h[h.currentMode].element,m),ui(h),ht(h))},Rl=function(h){var d=(0,S.lG)(h,"TABLE");return d&&d.rows[0].cells[0].isSameNode(h)?d:!1},Pl=function(h){var d=(0,S.lG)(h,"TABLE");return d&&d.lastElementChild.lastElementChild.lastElementChild.isSameNode(h)?d:!1},Ju=function(h,d,m){m===void 0&&(m=!0);var b=h.previousElementSibling;return b||(h.parentElement.previousElementSibling?b=h.parentElement.previousElementSibling.lastElementChild:h.parentElement.parentElement.tagName==="TBODY"&&h.parentElement.parentElement.previousElementSibling?b=h.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:b=null),b&&(d.selectNodeContents(b),m||d.collapse(!1),(0,j.Hc)(d)),b},bt=function(h,d,m,b,w){var C=(0,j.im)(b,h[h.currentMode].element,m);if(d.key==="ArrowDown"&&b.textContent.trimRight().substr(C.start).indexOf(`
`)===-1||d.key==="ArrowRight"&&C.start>=b.textContent.trimRight().length){var E=w.nextElementSibling;return!E||E&&(E.tagName==="TABLE"||E.getAttribute("data-type"))?(w.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(l.g.ZWSP,"<wbr></p>")),(0,j.ib)(h[h.currentMode].element,m)):(m.selectNodeContents(E),m.collapse(!0),(0,j.Hc)(m)),d.preventDefault(),!0}return!1},je=function(h,d,m,b,w){var C=(0,j.im)(b,h[h.currentMode].element,m);if(d.key==="ArrowUp"&&b.textContent.substr(0,C.start).indexOf(`
`)===-1||(d.key==="ArrowLeft"||d.key==="Backspace"&&m.toString()==="")&&C.start===0){var E=w.previousElementSibling;return!E||E&&(E.tagName==="TABLE"||E.getAttribute("data-type"))?(w.insertAdjacentHTML("beforebegin",'<p data-block="0">'.concat(l.g.ZWSP,"<wbr></p>")),(0,j.ib)(h[h.currentMode].element,m)):(m.selectNodeContents(E),m.collapse(!1),(0,j.Hc)(m)),d.preventDefault(),!0}return!1},We=function(h,d,m,b){b===void 0&&(b=!0);var w=(0,S.lG)(d.startContainer,"LI");if(h[h.currentMode].element.querySelectorAll("wbr").forEach(function(P){P.remove()}),d.insertNode(document.createElement("wbr")),b&&w){for(var C="",E=0;E<w.parentElement.childElementCount;E++){var O=w.parentElement.children[E].querySelector("input");O&&O.remove(),C+='<p data-block="0">'.concat(w.parentElement.children[E].innerHTML.trimLeft(),"</p>")}w.parentElement.insertAdjacentHTML("beforebegin",C),w.parentElement.remove()}else if(w)if(m==="check")w.parentElement.querySelectorAll("li").forEach(function(P){P.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'.concat(P.textContent.indexOf(" ")===0?"":" ")),P.classList.add("vditor-task")});else{w.querySelector("input")&&w.parentElement.querySelectorAll("li").forEach(function(P){P.querySelector("input").remove(),P.classList.remove("vditor-task")});var L=void 0;m==="list"?(L=document.createElement("ul"),L.setAttribute("data-marker","*")):(L=document.createElement("ol"),L.setAttribute("data-marker","1.")),L.setAttribute("data-block","0"),L.setAttribute("data-tight",w.parentElement.getAttribute("data-tight")),L.innerHTML=w.parentElement.innerHTML,w.parentElement.parentNode.replaceChild(L,w.parentElement)}else{var D=(0,S.a1)(d.startContainer,"data-block","0");D||(h[h.currentMode].element.querySelector("wbr").remove(),D=h[h.currentMode].element.querySelector("p"),D.innerHTML="<wbr>"),m==="check"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '.concat(D.innerHTML,"</li></ul>")),D.remove()):m==="list"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'.concat(D.innerHTML,"</li></ul>")),D.remove()):m==="ordered-list"&&(D.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'.concat(D.innerHTML,"</li></ol>")),D.remove())}},kt=function(h,d,m){var b=d.previousElementSibling;if(d&&b){var w=[d];Array.from(m.cloneContents().children).forEach(function(D,L){D.nodeType!==3&&d&&D.textContent.trim()!==""&&d.getAttribute("data-node-id")===D.getAttribute("data-node-id")&&(L!==0&&w.push(d),d=d.nextElementSibling)}),h[h.currentMode].element.querySelectorAll("wbr").forEach(function(D){D.remove()}),m.insertNode(document.createElement("wbr"));var C=b.parentElement,E="";w.forEach(function(D){var L=D.getAttribute("data-marker");L.length!==1&&(L="1".concat(L.slice(-1))),E+='<li data-node-id="'.concat(D.getAttribute("data-node-id"),'" data-marker="').concat(L,'">').concat(D.innerHTML,"</li>"),D.remove()}),b.insertAdjacentHTML("beforeend","<".concat(C.tagName,' data-block="0">').concat(E,"</").concat(C.tagName,">")),h.currentMode==="wysiwyg"?C.outerHTML=h.lute.SpinVditorDOM(C.outerHTML):C.outerHTML=h.lute.SpinVditorIRDOM(C.outerHTML),(0,j.ib)(h[h.currentMode].element,m);var O=(0,S.O9)(m.startContainer);O&&O.querySelectorAll(".vditor-".concat(h.currentMode,"__preview[data-render='2']")).forEach(function(D){He(D,h),h.currentMode==="wysiwyg"&&D.previousElementSibling.setAttribute("style","display:none")}),ht(h),ui(h)}else h[h.currentMode].element.focus()},Zu=function(h,d,m,b){var w=(0,S.lG)(d.parentElement,"LI");if(w){h[h.currentMode].element.querySelectorAll("wbr").forEach(function($){$.remove()}),m.insertNode(document.createElement("wbr"));var C=d.parentElement,E=C.cloneNode(),O=[d];Array.from(m.cloneContents().children).forEach(function($,fe){$.nodeType!==3&&d&&$.textContent.trim()!==""&&d.getAttribute("data-node-id")===$.getAttribute("data-node-id")&&(fe!==0&&O.push(d),d=d.nextElementSibling)});var D=!1,L="";C.querySelectorAll("li").forEach(function($){D&&(L+=$.outerHTML,!$.nextElementSibling&&!$.previousElementSibling?$.parentElement.remove():$.remove()),$.isSameNode(O[O.length-1])&&(D=!0)}),O.reverse().forEach(function($){w.insertAdjacentElement("afterend",$)}),L&&(E.innerHTML=L,O[0].insertAdjacentElement("beforeend",E)),h.currentMode==="wysiwyg"?b.outerHTML=h.lute.SpinVditorDOM(b.outerHTML):b.outerHTML=h.lute.SpinVditorIRDOM(b.outerHTML),(0,j.ib)(h[h.currentMode].element,m);var P=(0,S.O9)(m.startContainer);P&&P.querySelectorAll(".vditor-".concat(h.currentMode,"__preview[data-render='2']")).forEach(function($){He($,h),h.currentMode==="wysiwyg"&&$.previousElementSibling.setAttribute("style","display:none")}),ht(h),ui(h)}else h[h.currentMode].element.focus()},Op=function(h,d){for(var m=getSelection().getRangeAt(0).startContainer.parentElement,b=h.rows[0].cells.length,w=h.rows.length,C=0,E=0;E<w;E++)for(var O=0;O<b;O++)if(h.rows[E].cells[O].isSameNode(m)){C=O;break}for(var D=0;D<w;D++)h.rows[D].cells[C].setAttribute("align",d)},Ny=function(h){var d=h.trimRight().split(`
`).pop();return d===""?!1:(d.replace(/ |-/g,"")===""||d.replace(/ |_/g,"")===""||d.replace(/ |\*/g,"")==="")&&d.replace(/ /g,"").length>2?!(d.indexOf("-")>-1&&d.trimLeft().indexOf(" ")===-1&&h.trimRight().split(`
`).length>1||d.indexOf("    ")===0||d.indexOf("	")===0):!1},Ry=function(h){var d=h.trimRight().split(`
`);return h=d.pop(),h.indexOf("    ")===0||h.indexOf("	")===0||(h=h.trimLeft(),h===""||d.length===0)?!1:h.replace(/-/g,"")===""||h.replace(/=/g,"")===""},ht=function(h,d){d===void 0&&(d={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),h.currentMode==="wysiwyg"?ye(h,d):h.currentMode==="ir"?$s(h,d):h.currentMode==="sv"&&ut(h,d)},jS=function(h,d,m,b){var w,C=h.startContainer,E=(0,S.lG)(C,"LI");if(E){if(!(0,p.yl)(b)&&!b.altKey&&b.key==="Enter"&&!b.shiftKey&&m&&E.contains(m)&&m.nextElementSibling)return E&&!E.textContent.endsWith(`
`)&&E.insertAdjacentText("beforeend",`
`),h.insertNode(document.createTextNode(`

`)),h.collapse(!1),ht(d),b.preventDefault(),!0;if(!(0,p.yl)(b)&&!b.shiftKey&&!b.altKey&&b.key==="Backspace"&&!E.previousElementSibling&&h.toString()===""&&(0,j.im)(E,d[d.currentMode].element,h).start===0)return E.nextElementSibling?(E.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(E.innerHTML,"</p>")),E.remove()):E.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(E.innerHTML,"</p>"),(0,j.ib)(d[d.currentMode].element,h),ht(d),b.preventDefault(),!0;if(!(0,p.yl)(b)&&!b.shiftKey&&!b.altKey&&b.key==="Backspace"&&E.textContent.trim().replace(l.g.ZWSP,"")===""&&h.toString()===""&&((w=E.previousElementSibling)===null||w===void 0?void 0:w.tagName)==="LI")return E.previousElementSibling.insertAdjacentText("beforeend",`

`),h.selectNodeContents(E.previousElementSibling),h.collapse(!1),E.remove(),(0,j.ib)(d[d.currentMode].element,h),ht(d),b.preventDefault(),!0;if(!(0,p.yl)(b)&&!b.altKey&&b.key==="Tab"){var O=!1;if((h.startOffset===0&&(C.nodeType===3&&!C.previousSibling||C.nodeType!==3&&C.nodeName==="LI")||E.classList.contains("vditor-task")&&h.startOffset===1&&C.previousSibling.nodeType!==3&&C.previousSibling.tagName==="INPUT")&&(O=!0),O||h.toString()!=="")return b.shiftKey?Zu(d,E,h,E.parentElement):kt(d,E,h),b.preventDefault(),!0}}return!1},Py=function(h,d,m){if(h.options.tab&&m.key==="Tab")return m.shiftKey||(d.toString()===""?(d.insertNode(document.createTextNode(h.options.tab)),d.collapse(!1)):(d.extractContents(),d.insertNode(document.createTextNode(h.options.tab)),d.collapse(!1))),(0,j.Hc)(d),ht(h),m.preventDefault(),!0},$S=function(h,d,m,b){if(m){if(!(0,p.yl)(h)&&!h.altKey&&h.key==="Enter"){var w=String.raw(ex||(ex=Tp(["",""],["",""])),m.textContent).replace(/\\\|/g,"").trim(),C=w.split("|");if(w.startsWith("|")&&w.endsWith("|")&&C.length>3){var E=C.map(function(){return"---"}).join("|");return E=m.textContent+`
`+E.substring(3,E.length-3)+`
|<wbr>`,m.outerHTML=d.lute.SpinVditorDOM(E),(0,j.ib)(d[d.currentMode].element,b),ht(d),zt(d),h.preventDefault(),!0}if(Ny(m.innerHTML)&&m.previousElementSibling){var O="",D=m.innerHTML.trimRight().split(`
`);return D.length>1&&(D.pop(),O='<p data-block="0">'.concat(D.join(`
`),"</p>")),m.insertAdjacentHTML("afterend","".concat(O,`<hr data-block="0"><p data-block="0"><wbr>
</p>`)),m.remove(),(0,j.ib)(d[d.currentMode].element,b),ht(d),zt(d),h.preventDefault(),!0}if(Ry(m.innerHTML))return d.currentMode==="wysiwyg"?m.outerHTML=d.lute.SpinVditorDOM(m.innerHTML+`<p data-block="0"><wbr>
</p>`):m.outerHTML=d.lute.SpinVditorIRDOM(m.innerHTML+`<p data-block="0"><wbr>
</p>`),(0,j.ib)(d[d.currentMode].element,b),ht(d),zt(d),h.preventDefault(),!0}if(b.collapsed&&m.previousElementSibling&&h.key==="Backspace"&&!(0,p.yl)(h)&&!h.altKey&&!h.shiftKey&&m.textContent.trimRight().split(`
`).length>1&&(0,j.im)(m,d[d.currentMode].element,b).start===0){var L=(0,S.DX)(m.previousElementSibling);return L.textContent.endsWith(`
`)||(L.textContent=L.textContent+`
`),L.parentElement.insertAdjacentHTML("beforeend","<wbr>".concat(m.innerHTML)),m.remove(),(0,j.ib)(d[d.currentMode].element,b),!1}return!1}},zS=function(h,d,m){for(var b="",w=0;w<m.parentElement.childElementCount;w++)b+='<td align="'.concat(m.parentElement.children[w].getAttribute("align"),'"> </td>');m.tagName==="TH"?m.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>".concat(b,"</tr></tbody>")):m.parentElement.insertAdjacentHTML("afterend","<tr>".concat(b,"</tr>")),ht(h)},WS=function(h,d,m){for(var b="",w=0;w<m.parentElement.childElementCount;w++)m.tagName==="TH"?b+='<th align="'.concat(m.parentElement.children[w].getAttribute("align"),'"> </th>'):b+='<td align="'.concat(m.parentElement.children[w].getAttribute("align"),'"> </td>');if(m.tagName==="TH"){m.parentElement.parentElement.insertAdjacentHTML("beforebegin","<thead><tr>".concat(b,"</tr></thead>")),d.insertNode(document.createElement("wbr"));var C=m.parentElement.innerHTML.replace(/<th>/g,"<td>").replace(/<\/th>/g,"</td>");m.parentElement.parentElement.nextElementSibling.insertAdjacentHTML("afterbegin",C),m.parentElement.parentElement.remove(),(0,j.ib)(h.ir.element,d)}else m.parentElement.insertAdjacentHTML("beforebegin","<tr>".concat(b,"</tr>"));ht(h)},Lp=function(h,d,m,b){b===void 0&&(b="afterend");for(var w=0,C=m.previousElementSibling;C;)w++,C=C.previousElementSibling;for(var E=0;E<d.rows.length;E++)E===0?d.rows[E].cells[w].insertAdjacentHTML(b,"<th> </th>"):d.rows[E].cells[w].insertAdjacentHTML(b,"<td> </td>");ht(h)},qS=function(h,d,m){if(m.tagName==="TD"){var b=m.parentElement.parentElement;m.parentElement.previousElementSibling?d.selectNodeContents(m.parentElement.previousElementSibling.lastElementChild):d.selectNodeContents(b.previousElementSibling.lastElementChild.lastElementChild),b.childElementCount===1?b.remove():m.parentElement.remove(),d.collapse(!1),(0,j.Hc)(d),ht(h)}},US=function(h,d,m,b){for(var w=0,C=b.previousElementSibling;C;)w++,C=C.previousElementSibling;(b.previousElementSibling||b.nextElementSibling)&&(d.selectNodeContents(b.previousElementSibling||b.nextElementSibling),d.collapse(!0));for(var E=0;E<m.rows.length;E++){var O=m.rows[E].cells;if(O.length===1){m.remove(),ui(h);break}O[w].remove()}(0,j.Hc)(d),ht(h)},KS=function(h,d,m){var b=m.startContainer,w=(0,S.lG)(b,"TD")||(0,S.lG)(b,"TH");if(w){if(!(0,p.yl)(d)&&!d.altKey&&d.key==="Enter"){(!w.lastElementChild||w.lastElementChild&&(!w.lastElementChild.isSameNode(w.lastChild)||w.lastElementChild.tagName!=="BR"))&&w.insertAdjacentHTML("beforeend","<br>");var C=document.createElement("br");return m.insertNode(C),m.setStartAfter(C),ht(h),zt(h),d.preventDefault(),!0}if(d.key==="Tab"){if(d.shiftKey)return Ju(w,m),d.preventDefault(),!0;var E=w.nextElementSibling;return E||(w.parentElement.nextElementSibling?E=w.parentElement.nextElementSibling.firstElementChild:w.parentElement.parentElement.tagName==="THEAD"&&w.parentElement.parentElement.nextElementSibling?E=w.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:E=null),E&&(m.selectNodeContents(E),(0,j.Hc)(m)),d.preventDefault(),!0}var O=w.parentElement.parentElement.parentElement;if(d.key==="ArrowUp"){if(d.preventDefault(),w.tagName==="TH")return O.previousElementSibling?(m.selectNodeContents(O.previousElementSibling),m.collapse(!1),(0,j.Hc)(m)):Nl(h,"beforebegin"),!0;for(var D=0,L=w.parentElement;D<L.cells.length&&!L.cells[D].isSameNode(w);D++);var P=L.previousElementSibling;return P||(P=L.parentElement.previousElementSibling.firstChild),m.selectNodeContents(P.cells[D]),m.collapse(!1),(0,j.Hc)(m),!0}if(d.key==="ArrowDown"){d.preventDefault();var L=w.parentElement;if(!L.nextElementSibling&&w.tagName==="TD")return O.nextElementSibling?(m.selectNodeContents(O.nextElementSibling),m.collapse(!0),(0,j.Hc)(m)):Nl(h,"afterend"),!0;for(var D=0;D<L.cells.length&&!L.cells[D].isSameNode(w);D++);var E=L.nextElementSibling;return E||(E=L.parentElement.nextElementSibling.firstChild),m.selectNodeContents(E.cells[D]),m.collapse(!0),(0,j.Hc)(m),!0}if(h.currentMode==="wysiwyg"&&!(0,p.yl)(d)&&d.key==="Enter"&&!d.shiftKey&&d.altKey){var $=h.wysiwyg.popover.querySelector(".vditor-input");return $.focus(),$.select(),d.preventDefault(),!0}if(!(0,p.yl)(d)&&!d.shiftKey&&!d.altKey&&d.key==="Backspace"&&m.startOffset===0&&m.toString()===""){var fe=Ju(w,m,!1);return!fe&&O&&(O.textContent.trim()===""?(O.outerHTML=`<p data-block="0"><wbr>
</p>`,(0,j.ib)(h[h.currentMode].element,m)):(m.setStartBefore(O),m.collapse(!0)),ht(h)),d.preventDefault(),!0}if(ie("F",d))return WS(h,m,w),d.preventDefault(),!0;if(ie("=",d))return zS(h,m,w),d.preventDefault(),!0;if(ie("G",d))return Lp(h,O,w,"beforebegin"),d.preventDefault(),!0;if(ie("=",d))return Lp(h,O,w),d.preventDefault(),!0;if(ie("-",d))return qS(h,m,w),d.preventDefault(),!0;if(ie("-",d))return US(h,m,O,w),d.preventDefault(),!0;if(ie("L",d)){if(h.currentMode==="ir")return Op(O,"left"),ht(h),d.preventDefault(),!0;var de=h.wysiwyg.popover.querySelector('[data-type="left"]');if(de)return de.click(),d.preventDefault(),!0}if(ie("C",d)){if(h.currentMode==="ir")return Op(O,"center"),ht(h),d.preventDefault(),!0;var de=h.wysiwyg.popover.querySelector('[data-type="center"]');if(de)return de.click(),d.preventDefault(),!0}if(ie("R",d)){if(h.currentMode==="ir")return Op(O,"right"),ht(h),d.preventDefault(),!0;var de=h.wysiwyg.popover.querySelector('[data-type="right"]');if(de)return de.click(),d.preventDefault(),!0}}return!1},GS=function(h,d,m,b){if(m.tagName==="PRE"&&ie("A",d))return b.selectNodeContents(m.firstElementChild),d.preventDefault(),!0;if(h.options.tab&&d.key==="Tab"&&!d.shiftKey&&b.toString()==="")return b.insertNode(document.createTextNode(h.options.tab)),b.collapse(!1),ht(h),d.preventDefault(),!0;if(d.key==="Backspace"&&!(0,p.yl)(d)&&!d.shiftKey&&!d.altKey){var w=(0,j.im)(m,h[h.currentMode].element,b);if((w.start===0||w.start===1&&m.innerText===`
`)&&b.toString()==="")return m.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(m.firstElementChild.innerHTML,"</p>"),(0,j.ib)(h[h.currentMode].element,b),ht(h),d.preventDefault(),!0}return!(0,p.yl)(d)&&!d.altKey&&d.key==="Enter"?(m.firstElementChild.textContent.endsWith(`
`)||m.firstElementChild.insertAdjacentText("beforeend",`
`),b.extractContents(),b.insertNode(document.createTextNode(`
`)),b.collapse(!1),(0,j.Hc)(b),(0,p.vU)()||(h.currentMode==="wysiwyg"?Il(h,b):Nt(h,b)),zt(h),d.preventDefault(),!0):!1},JS=function(h,d,m,b){var w=d.startContainer,C=(0,S.lG)(w,"BLOCKQUOTE");if(C&&d.toString()===""){if(m.key==="Backspace"&&!(0,p.yl)(m)&&!m.shiftKey&&!m.altKey&&(0,j.im)(C,h[h.currentMode].element,d).start===0)return d.insertNode(document.createElement("wbr")),C.outerHTML=C.innerHTML,(0,j.ib)(h[h.currentMode].element,d),ht(h),m.preventDefault(),!0;if(b&&m.key==="Enter"&&!(0,p.yl)(m)&&!m.shiftKey&&!m.altKey&&b.parentElement.tagName==="BLOCKQUOTE"){var E=!1;if(b.innerHTML.replace(l.g.ZWSP,"")===`
`||b.innerHTML.replace(l.g.ZWSP,"")===""?(E=!0,b.remove()):b.innerHTML.endsWith(`

`)&&(0,j.im)(b,h[h.currentMode].element,d).start===b.textContent.length-1&&(b.innerHTML=b.innerHTML.substr(0,b.innerHTML.length-2),E=!0),E)return C.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(l.g.ZWSP,`<wbr>
</p>`)),(0,j.ib)(h[h.currentMode].element,d),ht(h),m.preventDefault(),!0}var O=(0,S.F9)(w);if(h.currentMode==="wysiwyg"&&O&&ie(";",m))return d.insertNode(document.createElement("wbr")),O.outerHTML='<blockquote data-block="0">'.concat(O.outerHTML,"</blockquote>"),(0,j.ib)(h.wysiwyg.element,d),ye(h),m.preventDefault(),!0;if(bt(h,m,d,C,C)||je(h,m,d,C,C))return!0}return!1},ZS=function(h,d,m){var b=d.startContainer,w=(0,S.lG)(b,"LI");if(w&&w.classList.contains("vditor-task")){if(ie("J",m)){var C=w.firstElementChild;return C.checked?C.removeAttribute("checked"):C.setAttribute("checked","checked"),ht(h),m.preventDefault(),!0}if(m.key==="Backspace"&&!(0,p.yl)(m)&&!m.shiftKey&&!m.altKey&&d.toString()===""&&d.startOffset===1&&(b.nodeType===3&&b.previousSibling&&b.previousSibling.tagName==="INPUT"||b.nodeType!==3)){var E=w.previousElementSibling;if(w.querySelector("input").remove(),E){var O=(0,S.DX)(E);O.parentElement.insertAdjacentHTML("beforeend","<wbr>"+w.innerHTML.trim()),w.remove()}else w.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(w.innerHTML.trim()||`
`,"</p>")),w.nextElementSibling?w.remove():w.parentElement.remove();return(0,j.ib)(h[h.currentMode].element,d),ht(h),m.preventDefault(),!0}if(m.key==="Enter"&&!(0,p.yl)(m)&&!m.shiftKey&&!m.altKey){if(w.textContent.trim()==="")if((0,S.fb)(w.parentElement,"vditor-task")){var D=(0,S.O9)(b);D&&Zu(h,w,d,D)}else if(w.nextElementSibling){var L="",P="",$=!1;Array.from(w.parentElement.children).forEach(function(Me){w.isSameNode(Me)?$=!0:$?L+=Me.outerHTML:P+=Me.outerHTML});var fe=w.parentElement.tagName,de=w.parentElement.tagName==="OL"?"":' data-marker="'.concat(w.parentElement.getAttribute("data-marker"),'"'),le="";P&&(le=w.parentElement.tagName==="UL"?"":' start="1"',P="<".concat(fe,' data-tight="true"').concat(de,' data-block="0">').concat(P,"</").concat(fe,">")),w.parentElement.outerHTML="".concat(P,`<p data-block="0"><wbr>
</p><`).concat(fe,`
 data-tight="true"`).concat(de,' data-block="0"').concat(le,">").concat(L,"</").concat(fe,">")}else w.parentElement.insertAdjacentHTML("afterend",`<p data-block="0"><wbr>
</p>`),w.parentElement.querySelectorAll("li").length===1?w.parentElement.remove():w.remove();else b.nodeType!==3&&d.startOffset===0&&b.firstChild.tagName==="INPUT"?d.setStart(b.childNodes[1],1):(d.setEndAfter(w.lastChild),w.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'.concat(w.getAttribute("data-marker"),'"><input type="checkbox"> <wbr></li>')),document.querySelector("wbr").after(d.extractContents()));return(0,j.ib)(h[h.currentMode].element,d),ht(h),zt(h),m.preventDefault(),!0}}return!1},YS=function(h,d,m,b){if(d.startContainer.nodeType!==3){var w=d.startContainer.children[d.startOffset];if(w&&w.tagName==="HR")return d.selectNodeContents(w.previousElementSibling),d.collapse(!1),m.preventDefault(),!0}if(b){var C=b.previousElementSibling;if(C&&(0,j.im)(b,h[h.currentMode].element,d).start===0&&((0,p.vU)()&&C.tagName==="HR"||C.tagName==="TABLE")){if(C.tagName==="TABLE"){var E=C.lastElementChild.lastElementChild.lastElementChild;E.innerHTML=E.innerHTML.trimLeft()+"<wbr>"+b.textContent.trim(),b.remove()}else C.remove();return(0,j.ib)(h[h.currentMode].element,d),ht(h),m.preventDefault(),!0}}return!1},XS=function(h){(0,p.vU)()&&h.startContainer.nodeType!==3&&h.startContainer.tagName==="HR"&&h.setStartBefore(h.startContainer)},QS=function(h,d,m){var b,w;if(!(0,p.vU)())return!1;if(h.key==="ArrowUp"&&d&&((b=d.previousElementSibling)===null||b===void 0?void 0:b.tagName)==="TABLE"){var C=d.previousElementSibling;return m.selectNodeContents(C.rows[C.rows.length-1].lastElementChild),m.collapse(!1),h.preventDefault(),!0}return h.key==="ArrowDown"&&d&&((w=d.nextElementSibling)===null||w===void 0?void 0:w.tagName)==="TABLE"?(m.selectNodeContents(d.nextElementSibling.rows[0].cells[0]),m.collapse(!0),h.preventDefault(),!0):!1},Dp=function(h,d,m){return Ku(void 0,void 0,void 0,function(){var b,w,C,E,O,D,L,P,$,fe,de,le,Me,ae,Ce,ae,$e;return Gu(this,function(Ae){switch(Ae.label){case 0:return h[h.currentMode].element.getAttribute("contenteditable")!=="true"?[2]:(d.stopPropagation(),d.preventDefault(),"clipboardData"in d?(b=d.clipboardData.getData("text/html"),w=d.clipboardData.getData("text/plain"),C=d.clipboardData.files):(b=d.dataTransfer.getData("text/html"),w=d.dataTransfer.getData("text/plain"),d.dataTransfer.types.includes("Files")&&(C=d.dataTransfer.items)),E={},O=function(Ye,Bt){if(!Bt)return["",Lute.WalkContinue];if(h.options.upload.renderLinkDest)return h.options.upload.renderLinkDest(h,Ye,Bt);var Dt=Ye.TokensStr();if(Ye.__internal_object__.Parent.Type===34&&Dt&&Dt.indexOf("file://")===-1&&h.options.upload.linkToImgUrl){var qt=new XMLHttpRequest;qt.open("POST",h.options.upload.linkToImgUrl),h.options.upload.token&&qt.setRequestHeader("X-Upload-Token",h.options.upload.token),h.options.upload.withCredentials&&(qt.withCredentials=!0),fi(h,qt),qt.setRequestHeader("Content-Type","application/json; charset=utf-8"),qt.onreadystatechange=function(){if(qt.readyState===XMLHttpRequest.DONE){if(qt.status===200){var Ir=qt.responseText;h.options.upload.linkToImgFormat&&(Ir=h.options.upload.linkToImgFormat(qt.responseText));var Wn=JSON.parse(Ir);if(Wn.code!==0){h.tip.show(Wn.msg);return}var Nr=Wn.data.originalURL;if(h.currentMode==="sv")h.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach(function(Sn){Sn.textContent===Nr&&(Sn.textContent=Wn.data.url)});else{var ot=h[h.currentMode].element.querySelector('img[src="'.concat(Nr,'"]'));ot.src=Wn.data.url,h.currentMode==="ir"&&(ot.previousElementSibling.previousElementSibling.innerHTML=Wn.data.url)}ht(h)}else h.tip.show(qt.responseText);h.options.upload.linkToImgCallback&&h.options.upload.linkToImgCallback(qt.responseText)}},qt.send(JSON.stringify({url:Dt}))}return h.currentMode==="ir"?['<span class="vditor-ir__marker vditor-ir__marker--link">'.concat(Lute.EscapeHTMLStr(Dt),"</span>"),Lute.WalkContinue]:h.currentMode==="wysiwyg"?["",Lute.WalkContinue]:['<span class="vditor-sv__marker--link">'.concat(Lute.EscapeHTMLStr(Dt),"</span>"),Lute.WalkContinue]},(b.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<a href="'.concat(w,'">').concat(w,"</a>")||b.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<!--StartFragment--><a href="'.concat(w,'">').concat(w,"</a><!--EndFragment-->"))&&(b=""),D=new DOMParser().parseFromString(b,"text/html"),D.body&&(b=D.body.innerHTML),b=Lute.Sanitize(b),h.wysiwyg.getComments(h),L=h[h.currentMode].element.scrollHeight,P=Xe(b,w,h.currentMode),$=h.currentMode==="sv"?(0,S.a1)(d.target,"data-type","code-block"):(0,S.lG)(d.target,"CODE"),$?(h.currentMode==="sv"?document.execCommand("insertHTML",!1,w.replace(/&/g,"&amp;").replace(/</g,"&lt;")):(fe=(0,j.im)(d.target,h[h.currentMode].element),$.parentElement.tagName!=="PRE"&&(w+=l.g.ZWSP),$.textContent=$.textContent.substring(0,fe.start)+w+$.textContent.substring(fe.end),(0,j.$j)(fe.start+w.length,fe.start+w.length,$.parentElement),!(($e=$.parentElement)===null||$e===void 0)&&$e.nextElementSibling.classList.contains("vditor-".concat(h.currentMode,"__preview"))&&($.parentElement.nextElementSibling.innerHTML=$.outerHTML,He($.parentElement.nextElementSibling,h))),[3,10]):[3,1]);case 1:return P?(m.pasteCode(P),[3,10]):[3,2];case 2:return b.trim()===""?[3,5]:(de=document.createElement("div"),de.innerHTML=b,h.options.upload.base64ToLink?[3,4]:[4,sP(h,de,("clipboardData"in d?d.clipboardData:d.dataTransfer).getData("text/rtf"))]);case 3:Ae.sent(),Ae.label=4;case 4:return de.querySelectorAll("[style]").forEach(function(Ye){Ye.removeAttribute("style")}),de.querySelectorAll(".vditor-copy").forEach(function(Ye){Ye.remove()}),h.currentMode==="ir"?(E.HTML2VditorIRDOM={renderLinkDest:O},h.lute.SetJSRenderers({renderers:E}),(0,j.oC)(h.lute.HTML2VditorIRDOM(de.innerHTML),h)):h.currentMode==="wysiwyg"?(E.HTML2VditorDOM={renderLinkDest:O},h.lute.SetJSRenderers({renderers:E}),(0,j.oC)(h.lute.HTML2VditorDOM(de.innerHTML),h)):(E.Md2VditorSVDOM={renderLinkDest:O},h.lute.SetJSRenderers({renderers:E}),F(h,h.lute.HTML2Md(de.innerHTML).trimRight())),h.outline.render(h),[3,10];case 5:return C.length>0?h.options.upload.url||h.options.upload.handler?[4,nc(h,C)]:[3,7]:[3,9];case 6:return Ae.sent(),[3,8];case 7:le=new FileReader,"clipboardData"in d?(C=d.clipboardData.files,Me=C[0]):d.dataTransfer.types.includes("Files")&&(C=d.dataTransfer.items,Me=C[0].getAsFile()),Me&&Me.type.startsWith("image")&&(le.readAsDataURL(Me),le.onload=function(){var Ye="";h.currentMode==="wysiwyg"?Ye+='<img alt="'.concat(Me.name,'" src="').concat(le.result.toString(),`">
`):Ye+="![".concat(Me.name,"](").concat(le.result.toString(),`)
`),document.execCommand("insertHTML",!1,Ye)}),Ae.label=8;case 8:return[3,10];case 9:w.trim()!==""&&C.length===0&&(ae=(0,j.zh)(h),ae.toString()!==""&&h.lute.IsValidLinkDest(w)&&(w="[".concat(ae.toString(),"](").concat(w,")")),h.currentMode==="ir"?(E.Md2VditorIRDOM={renderLinkDest:O},h.lute.SetJSRenderers({renderers:E}),(0,j.oC)(Lute.Sanitize(h.lute.Md2VditorIRDOM(w)),h)):h.currentMode==="wysiwyg"?(E.Md2VditorDOM={renderLinkDest:O},h.lute.SetJSRenderers({renderers:E}),(0,j.oC)(Lute.Sanitize(h.lute.Md2VditorDOM(w)),h)):(E.Md2VditorSVDOM={renderLinkDest:O},h.lute.SetJSRenderers({renderers:E}),F(h,w)),h.outline.render(h)),Ae.label=10;case 10:return h.currentMode!=="sv"&&(Ce=(0,S.F9)((0,j.zh)(h).startContainer),Ce&&(ae=(0,j.zh)(h),h[h.currentMode].element.querySelectorAll("wbr").forEach(function(Ye){Ye.remove()}),ae.insertNode(document.createElement("wbr")),h.currentMode==="wysiwyg"?Ce.outerHTML=h.lute.SpinVditorDOM(Ce.outerHTML):Ce.outerHTML=h.lute.SpinVditorIRDOM(Ce.outerHTML),(0,j.ib)(h[h.currentMode].element,ae)),h[h.currentMode].element.querySelectorAll(".vditor-".concat(h.currentMode,"__preview[data-render='2']")).forEach(function(Ye){He(Ye,h)})),h.wysiwyg.triggerRemoveComment(h),ht(h),h[h.currentMode].element.scrollHeight-L>Math.min(h[h.currentMode].element.clientHeight,window.innerHeight)/2&&zt(h),[2]}})})},sP=function(h,d,m){return Ku(void 0,void 0,void 0,function(){var b,w,C,E,O,D,L,P,$,Me,fe,de,le,Me,Ce,ae;return Gu(this,function($e){switch($e.label){case 0:if(!m)return[2];if(b=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,w=new RegExp("(?:("+b.source+"))([\\da-fA-F\\s]+)\\}","g"),C=m.match(w),E=[],C)for(O=0,D=C;O<D.length;O++)L=D[O],P=void 0,L.includes("\\pngblip")?P="image/png":L.includes("\\jpegblip")&&(P="image/jpeg"),P&&E.push({hex:L.replace(b,"").replace(/[^\da-fA-F]/g,""),type:P});for($=[],By(d,function(Ae){if(Ae.tagName==="V:SHAPE")return By(Ae,function(Ye){Ye.tagName==="V:IMAGEDATA"&&$.push({shape:Ae,img:Ye})}),!1}),Me=0;Me<$.length;Me++)fe=document.createElement("img"),de="data:"+E[Me].type+";base64,"+btoa((E[Me].hex.match(/\w{2}/g)||[]).map(function(Ae){return String.fromCharCode(parseInt(Ae,16))}).join("")),fe.src=de,fe.title=$[Me].img.getAttribute("title"),$[Me].shape.parentNode.replaceChild(fe,$[Me].shape);le=d.querySelectorAll("img"),Me=0,$e.label=1;case 1:return Me<le.length?(Ce=le[Me].src||"",Ce?(ae=le[Me],[4,h.options.upload.base64ToLink(Ce)]):[3,3]):[3,4];case 2:ae.src=$e.sent(),$e.label=3;case 3:return Me++,[3,1];case 4:return[2]}})})},By=function(h,d){var m=d(h);if(m!==!1)for(var b=0;b<h.children.length;b++)By(h.children[b],d)},ex,tx=function(h){var d,m;h.hint.render(h);var b=(0,j.zh)(h).startContainer,w=(0,S.a1)(b,"data-type","code-block-info");if(w)if(w.textContent.replace(l.g.ZWSP,"")===""&&h.hint.recentLanguage){w.textContent=l.g.ZWSP+h.hint.recentLanguage;var C=(0,j.zh)(h);C.selectNodeContents(w)}else{var E=[],O=w.textContent.substring(0,(0,j.im)(w,h.ir.element).start).replace(l.g.ZWSP,"");(h.options.preview.hljs.langs||l.g.ALIAS_CODE_LANGUAGES.concat(((m=(d=window.hljs)===null||d===void 0?void 0:d.listLanguages())!==null&&m!==void 0?m:[]).sort())).forEach(function(D){D.indexOf(O.toLowerCase())>-1&&E.push({html:D,value:D})}),h.hint.genHTML(E,O,h)}},$s=function(h,d){d===void 0&&(d={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),d.enableHint&&tx(h),clearTimeout(h.ir.processTimeoutId),h.ir.processTimeoutId=window.setTimeout(function(){if(!h.ir.composingLock){var m=c(h);typeof h.options.input=="function"&&d.enableInput&&h.options.input(m),h.options.counter.enable&&h.counter.render(h,m),h.options.cache.enable&&(0,p.pK)()&&(localStorage.setItem(h.options.cache.id,m),h.options.cache.after&&h.options.cache.after(m)),h.devtools&&h.devtools.renderEchart(h),d.enableAddUndoStack&&h.undo.addToUndoStack(h)}},h.options.undoDelay)},Yu=function(h,d){var m=(0,j.zh)(h),b=(0,S.F9)(m.startContainer)||m.startContainer;if(b){var w=b.querySelector(".vditor-ir__marker--heading");w?w.innerHTML=d:(b.insertAdjacentText("afterbegin",d),m.selectNodeContents(b),m.collapse(!1)),Nt(h,m.cloneRange()),_e(h)}},Ip=function(h,d,m){var b=(0,S.a1)(h.startContainer,"data-type",m);if(b){b.firstElementChild.remove(),b.lastElementChild.remove(),h.insertNode(document.createElement("wbr"));var w=document.createElement("div");w.innerHTML=d.lute.SpinVditorIRDOM(b.outerHTML),b.outerHTML=w.firstElementChild.innerHTML.trim()}},oP=function(h,d,m,b){var w=(0,j.zh)(h),C=d.getAttribute("data-type"),E=w.startContainer;E.nodeType===3&&(E=E.parentElement);var O=!0;if(d.classList.contains("vditor-menu--current"))if(C==="quote"){var D=(0,S.lG)(E,"BLOCKQUOTE");D&&(w.insertNode(document.createElement("wbr")),D.outerHTML=D.innerHTML.trim()===""?'<p data-block="0">'.concat(D.innerHTML,"</p>"):D.innerHTML)}else if(C==="link"){var L=(0,S.a1)(w.startContainer,"data-type","a");if(L){var P=(0,S.fb)(w.startContainer,"vditor-ir__link");P?(w.insertNode(document.createElement("wbr")),L.outerHTML=P.innerHTML):L.outerHTML=L.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else C==="italic"?Ip(w,h,"em"):C==="bold"?Ip(w,h,"strong"):C==="strike"?Ip(w,h,"s"):C==="inline-code"?Ip(w,h,"code"):(C==="check"||C==="list"||C==="ordered-list")&&(We(h,w,C),O=!1,d.classList.remove("vditor-menu--current"));else{h.ir.element.childNodes.length===0&&(h.ir.element.innerHTML='<p data-block="0"><wbr></p>',(0,j.ib)(h.ir.element,w));var $=(0,S.F9)(w.startContainer);if(C==="line"){if($){var fe=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;$.innerHTML.trim()===""?$.outerHTML=fe:$.insertAdjacentHTML("afterend",fe)}}else if(C==="quote")$&&(w.insertNode(document.createElement("wbr")),$.outerHTML='<blockquote data-block="0">'.concat($.outerHTML,"</blockquote>"),O=!1,d.classList.add("vditor-menu--current"));else if(C==="link"){var de=void 0;w.toString()===""?de="".concat(m,"<wbr>").concat(b):de="".concat(m).concat(w.toString()).concat(b.replace(")","<wbr>)")),document.execCommand("insertHTML",!1,de),O=!1,d.classList.add("vditor-menu--current")}else if(C==="italic"||C==="bold"||C==="strike"||C==="inline-code"||C==="code"||C==="table"){var de=void 0;w.toString()===""?de="".concat(m,"<wbr>").concat(b):(C==="code"?de="".concat(m,`
`).concat(w.toString(),"<wbr>").concat(b):C==="table"?de="".concat(m).concat(w.toString(),"<wbr>").concat(b):de="".concat(m).concat(w.toString()).concat(b,"<wbr>"),w.deleteContents()),(C==="table"||C==="code")&&(de=`
`+de+`

`);var le=document.createElement("span");le.innerHTML=de,w.insertNode(le),Nt(h,w),C==="table"&&(w.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),(0,j.Hc)(w))}else(C==="check"||C==="list"||C==="ordered-list")&&(We(h,w,C,!1),O=!1,g(h.toolbar.elements,["check","list","ordered-list"]),d.classList.add("vditor-menu--current"))}(0,j.ib)(h.ir.element,w),$s(h),O&&_e(h)},lP=function(h,d,m,b){function w(C){return C instanceof m?C:new m(function(E){E(C)})}return new(m||(m=Promise))(function(C,E){function O(P){try{L(b.next(P))}catch($){E($)}}function D(P){try{L(b.throw(P))}catch($){E($)}}function L(P){P.done?C(P.value):w(P.value).then(O,D)}L((b=b.apply(h,d||[])).next())})},aP=function(h,d){var m={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},b,w,C,E;return E={next:O(0),throw:O(1),return:O(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function O(L){return function(P){return D([L,P])}}function D(L){if(b)throw new TypeError("Generator is already executing.");for(;E&&(E=0,L[0]&&(m=0)),m;)try{if(b=1,w&&(C=L[0]&2?w.return:L[0]?w.throw||((C=w.return)&&C.call(w),0):w.next)&&!(C=C.call(w,L[1])).done)return C;switch(w=0,C&&(L=[L[0]&2,C.value]),L[0]){case 0:case 1:C=L;break;case 4:return m.label++,{value:L[1],done:!1};case 5:m.label++,w=L[1],L=[0];continue;case 7:L=m.ops.pop(),m.trys.pop();continue;default:if(C=m.trys,!(C=C.length>0&&C[C.length-1])&&(L[0]===6||L[0]===2)){m=0;continue}if(L[0]===3&&(!C||L[1]>C[0]&&L[1]<C[3])){m.label=L[1];break}if(L[0]===6&&m.label<C[1]){m.label=C[1],C=L;break}if(C&&m.label<C[2]){m.label=C[2],m.ops.push(L);break}C[2]&&m.ops.pop(),m.trys.pop();continue}L=d.call(h,m)}catch(P){L=[6,P],w=0}finally{b=C=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},cP=function(){function h(d){var m=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(b,w){m.element.style.display="none";var C=decodeURIComponent(b.getAttribute("data-value")),E=window.getSelection().getRangeAt(0);if(w.currentMode==="ir"){var O=(0,S.a1)(E.startContainer,"data-type","code-block-info");if(O){O.textContent=l.g.ZWSP+C.trimRight(),E.selectNodeContents(O),E.collapse(!1),$s(w),O.parentElement.querySelectorAll("code").forEach(function($){$.className="language-"+C.trimRight()}),He(O.parentElement.querySelector(".vditor-ir__preview"),w),m.recentLanguage=C.trimRight();return}}if(w.currentMode==="wysiwyg"&&E.startContainer.nodeType!==3){var D=E.startContainer,L=void 0;if(D.classList.contains("vditor-input")?L=D:L=D.firstElementChild,L&&L.classList.contains("vditor-input")){L.value=C.trimRight(),E.selectNodeContents(L),E.collapse(!1),L.dispatchEvent(new CustomEvent("input",{detail:1})),m.recentLanguage=C.trimRight();return}}if(E.setStart(E.startContainer,m.lastIndex),E.deleteContents(),w.options.hint.parse?w.currentMode==="sv"?(0,j.oC)(w.lute.SpinVditorSVDOM(C),w):w.currentMode==="wysiwyg"?(0,j.oC)(w.lute.SpinVditorDOM(C),w):(0,j.oC)(w.lute.SpinVditorIRDOM(C),w):(0,j.oC)(C,w),m.splitChar===":"&&C.indexOf(":")>-1&&w.currentMode!=="sv"&&E.insertNode(document.createTextNode(" ")),E.collapse(!1),(0,j.Hc)(E),w.currentMode==="wysiwyg"){var P=(0,S.fb)(E.startContainer,"vditor-wysiwyg__block");P&&P.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(P.lastElementChild.innerHTML=P.firstElementChild.innerHTML,He(P.lastElementChild,w))}else if(w.currentMode==="ir"){var P=(0,S.fb)(E.startContainer,"vditor-ir__marker--pre");P&&P.nextElementSibling.classList.contains("vditor-ir__preview")&&(P.nextElementSibling.innerHTML=P.innerHTML,He(P.nextElementSibling,w))}ht(w)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",d.push({key:":"})}return h.prototype.render=function(d){var m=this;if(window.getSelection().focusNode){var b,w=getSelection().getRangeAt(0);b=w.startContainer.textContent.substring(0,w.startOffset)||"";var C=this.getKey(b,d.options.hint.extend);if(typeof C>"u")this.element.style.display="none",clearTimeout(this.timeId);else if(this.splitChar===":"){var E=C===""?d.options.hint.emoji:d.lute.GetEmojis(),O=[];Object.keys(E).forEach(function(D){D.indexOf(C.toLowerCase())===0&&(E[D].indexOf(".")>-1?O.push({html:'<img src="'.concat(E[D],'" title=":').concat(D,':"/> :').concat(D,":"),value:":".concat(D,":")}):O.push({html:'<span class="vditor-hint__emoji">'.concat(E[D],"</span>").concat(D),value:E[D]}))}),this.genHTML(O,C,d)}else d.options.hint.extend.forEach(function(D){D.key===m.splitChar&&(clearTimeout(m.timeId),m.timeId=window.setTimeout(function(){return lP(m,void 0,void 0,function(){var L;return aP(this,function(P){switch(P.label){case 0:return L=this.genHTML,[4,D.hint(C)];case 1:return L.apply(this,[P.sent(),C,d]),[2]}})})},d.options.hint.delay))})}},h.prototype.genHTML=function(d,m,b){var w=this;if(d.length===0){this.element.style.display="none";return}var C=b[b.currentMode].element,E=(0,j.Ny)(C),O=E.left+(b.options.outline.position==="left"?b.outline.element.offsetWidth:0),D=E.top,L="";d.forEach(function($,fe){if(!(fe>7)){var de=$.html;if(m!==""){var le=de.lastIndexOf(">")+1,Me=de.substr(le),Ce=Me.toLowerCase().indexOf(m.toLowerCase());Ce>-1&&(Me=Me.substring(0,Ce)+"<b>"+Me.substring(Ce,Ce+m.length)+"</b>"+Me.substring(Ce+m.length),de=de.substr(0,le)+Me)}L+='<button type="button" data-value="'.concat(encodeURIComponent($.value),` "
`).concat(fe===0?"class='vditor-hint--current'":"","> ").concat(de,"</button>")}}),this.element.innerHTML=L;var P=parseInt(document.defaultView.getComputedStyle(C,null).getPropertyValue("line-height"),10);this.element.style.top="".concat(D+(P||22),"px"),this.element.style.left="".concat(O,"px"),this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach(function($){$.addEventListener("click",function(fe){w.fillEmoji($,b),fe.preventDefault()})}),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top="".concat(D-this.element.offsetHeight,"px")),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")},h.prototype.select=function(d,m){if(this.element.querySelectorAll("button").length===0||this.element.style.display==="none")return!1;var b=this.element.querySelector(".vditor-hint--current");if(d.key==="ArrowDown")return d.preventDefault(),d.stopPropagation(),b.removeAttribute("class"),b.nextElementSibling?b.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if(d.key==="ArrowUp"){if(d.preventDefault(),d.stopPropagation(),b.removeAttribute("class"),b.previousElementSibling)b.previousElementSibling.className="vditor-hint--current";else{var w=this.element.children.length;this.element.children[w-1].className="vditor-hint--current"}return!0}else if(!(0,p.yl)(d)&&!d.shiftKey&&!d.altKey&&d.key==="Enter"&&!d.isComposing)return d.preventDefault(),d.stopPropagation(),this.fillEmoji(b,m),!0;return!1},h.prototype.getKey=function(d,m){var b=this;this.lastIndex=-1,this.splitChar="",m.forEach(function(L){var P=d.lastIndexOf(L.key);b.lastIndex<P&&(b.splitChar=L.key,b.lastIndex=P)});var w;if(this.lastIndex===-1)return w;var C=d.split(this.splitChar),E=C[C.length-1],O=32;if(C.length>1&&E.trim()===E)if(C.length===2&&C[0]===""&&C[1].length<O)w=C[1];else{var D=C[C.length-2].slice(-1);(0,a.X)(D)===" "&&E.length<O&&(w=E)}return w},h}(),uP=function(){function h(d){this.composingLock=!1;var m=document.createElement("div");m.className="vditor-ir",m.innerHTML='<pre class="vditor-reset" placeholder="'.concat(d.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>`),this.element=m.firstElementChild,this.bindEvent(d),ss(d,this.element),Lo(d,this.element),nr(d,this.element),Do(d,this.element),Fe(d,this.element),Hs(d,this.element),Vs(d,this.element,this.copy),Fs(d,this.element,this.copy)}return h.prototype.copy=function(d,m){var b=getSelection().getRangeAt(0);if(b.toString()!==""){d.stopPropagation(),d.preventDefault();var w=document.createElement("div");w.appendChild(b.cloneContents()),d.clipboardData.setData("text/plain",m.lute.VditorIRDOM2Md(w.innerHTML).trim()),d.clipboardData.setData("text/html","")}},h.prototype.bindEvent=function(d){var m=this;this.element.addEventListener("paste",function(b){Dp(d,b,{pasteCode:function(w){document.execCommand("insertHTML",!1,w)}})}),this.element.addEventListener("scroll",function(){M(d,["hint"])}),this.element.addEventListener("compositionstart",function(b){m.composingLock=!0}),this.element.addEventListener("compositionend",function(b){(0,p.vU)()||Nt(d,getSelection().getRangeAt(0).cloneRange()),m.composingLock=!1}),this.element.addEventListener("input",function(b){if(!(b.inputType==="deleteByDrag"||b.inputType==="insertFromDrop")){if(m.preventInput){m.preventInput=!1,$s(d,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}m.composingLock||b.data===""||b.data===""||b.data===""||Nt(d,getSelection().getRangeAt(0).cloneRange(),!1,b)}}),this.element.addEventListener("click",function(b){if(b.target.tagName==="INPUT"){b.target.checked?b.target.setAttribute("checked","checked"):b.target.removeAttribute("checked"),m.preventInput=!0,$s(d);return}var w=(0,j.zh)(d),C=(0,S.fb)(b.target,"vditor-ir__preview");if(C||(C=(0,S.fb)(w.startContainer,"vditor-ir__preview")),C&&(C.previousElementSibling.firstElementChild?w.selectNodeContents(C.previousElementSibling.firstElementChild):w.selectNodeContents(C.previousElementSibling),w.collapse(!0),(0,j.Hc)(w),zt(d)),b.target.tagName==="IMG"){var E=b.target.parentElement.querySelector(".vditor-ir__marker--link");E&&(w.selectNode(E),(0,j.Hc)(w))}var O=(0,S.a1)(b.target,"data-type","a");if(O&&!O.classList.contains("vditor-ir__node--expand")){d.options.link.click?d.options.link.click(O.querySelector(":scope > .vditor-ir__marker--link")):d.options.link.isOpen&&window.open(O.querySelector(":scope > .vditor-ir__marker--link").textContent);return}if(b.target.isEqualNode(m.element)&&m.element.lastElementChild&&w.collapsed){var D=m.element.lastElementChild.getBoundingClientRect();b.y>D.top+D.height&&(m.element.lastElementChild.tagName==="P"&&m.element.lastElementChild.textContent.trim().replace(l.g.ZWSP,"")===""?(w.selectNodeContents(m.element.lastElementChild),w.collapse(!1)):(m.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(l.g.ZWSP,"<wbr></p>")),(0,j.ib)(m.element,w)))}w.toString()===""?he(w,d):setTimeout(function(){he((0,j.zh)(d),d)}),sn(b,d),_e(d)}),this.element.addEventListener("keyup",function(b){if(!(b.isComposing||(0,p.yl)(b))){if(b.key==="Enter"&&zt(d),_e(d),(b.key==="Backspace"||b.key==="Delete")&&d.ir.element.innerHTML!==""&&d.ir.element.childNodes.length===1&&d.ir.element.firstElementChild&&d.ir.element.firstElementChild.tagName==="P"&&d.ir.element.firstElementChild.childElementCount===0&&(d.ir.element.textContent===""||d.ir.element.textContent===`
`)){d.ir.element.innerHTML="";return}var w=(0,j.zh)(d);b.key==="Backspace"?((0,p.vU)()&&w.startContainer.textContent===`
`&&w.startOffset===1&&(w.startContainer.textContent="",he(w,d)),m.element.querySelectorAll(".language-math").forEach(function(E){var O=E.querySelector("br");O&&O.remove()})):b.key.indexOf("Arrow")>-1?((b.key==="ArrowLeft"||b.key==="ArrowRight")&&tx(d),he(w,d)):b.keyCode===229&&b.code===""&&b.key==="Unidentified"&&he(w,d);var C=(0,S.fb)(w.startContainer,"vditor-ir__preview");if(C){if(b.key==="ArrowUp"||b.key==="ArrowLeft")return C.previousElementSibling.firstElementChild?w.selectNodeContents(C.previousElementSibling.firstElementChild):w.selectNodeContents(C.previousElementSibling),w.collapse(!1),b.preventDefault(),!0;if(C.tagName==="SPAN"&&(b.key==="ArrowDown"||b.key==="ArrowRight"))return C.parentElement.getAttribute("data-type")==="html-entity"?(C.parentElement.insertAdjacentText("afterend",l.g.ZWSP),w.setStart(C.parentElement.nextSibling,1)):w.selectNodeContents(C.parentElement.lastElementChild),w.collapse(!1),b.preventDefault(),!0}}})},h}(),nx=function(h){if(h.currentMode==="sv")return h.lute.Md2HTML(c(h));if(h.currentMode==="wysiwyg")return h.lute.VditorDOM2HTML(h.wysiwyg.element.innerHTML);if(h.currentMode==="ir")return h.lute.VditorIRDOM2HTML(h.ir.element.innerHTML)},fP=i(214),rx=i(436),hP=function(){function h(d){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'.concat(d,`</div>
<div class="vditor-outline__content"></div>`)}return h.prototype.render=function(d){var m="";return d.preview.element.style.display==="block"?m=(0,rx.k)(d.preview.previewElement,this.element.lastElementChild,d):m=(0,rx.k)(d[d.currentMode].element,this.element.lastElementChild,d),m},h.prototype.toggle=function(d,m,b){var w;m===void 0&&(m=!0),b===void 0&&(b=!0);var C=(w=d.toolbar.elements.outline)===null||w===void 0?void 0:w.firstElementChild;if(m&&window.innerWidth>=l.g.MOBILE_WIDTH?(this.element.style.display="block",this.render(d),C==null||C.classList.add("vditor-menu--current")):(this.element.style.display="none",C==null||C.classList.remove("vditor-menu--current")),b&&getSelection().rangeCount>0){var E=getSelection().getRangeAt(0);d[d.currentMode].element.contains(E.startContainer)&&(0,j.Hc)(E)}pe(d)},h}(),dP=i(280),pP=function(){function h(d){var m=this;this.element=document.createElement("div"),this.element.className="vditor-preview",this.previewElement=document.createElement("div"),this.previewElement.className="vditor-reset",d.options.classes.preview&&this.previewElement.classList.add(d.options.classes.preview),this.previewElement.style.maxWidth=d.options.preview.maxWidth+"px",this.previewElement.addEventListener("copy",function(D){if(D.target.tagName!=="TEXTAREA"){var L=document.createElement("div");L.className="vditor-reset",L.appendChild(getSelection().getRangeAt(0).cloneContents()),m.copyToX(d,L,"default"),D.preventDefault()}}),this.previewElement.addEventListener("click",function(D){var L=(0,S.lG)(D.target,"SPAN");if(L&&(0,S.fb)(L,"vditor-toc")){var P=m.previewElement.querySelector("#"+L.getAttribute("data-target-id"));P&&(m.element.scrollTop=P.offsetTop);return}if(D.target.tagName==="A"){d.options.link.click?d.options.link.click(D.target):d.options.link.isOpen&&window.open(D.target.getAttribute("href")),D.preventDefault();return}D.target.tagName==="IMG"&&(d.options.image.preview?d.options.image.preview(D.target):d.options.image.isPreview&&(0,De.E)(D.target,d.options.lang,d.options.theme))}),this.element.appendChild(this.previewElement);var b=d.options.preview.actions;if(b.length!==0){var w=document.createElement("div");w.className="vditor-preview__action";for(var C=[],E=0;E<b.length;E++){var O=b[E];if(typeof O=="object"){C.push('<button type="button" data-type="'.concat(O.key,'" class="').concat(O.className,'"').concat(O.tooltip?' aria-label="'.concat(O.tooltip,'"'):"",'">').concat(O.text,"</button>"));continue}switch(O){case"desktop":C.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":C.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":C.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":C.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label=""><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":C.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label=""><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>');break}}w.innerHTML=C.join(""),w.addEventListener((0,p.Le)(),function(D){var L=(0,A.S)(D.target,"BUTTON");if(L){var P=L.getAttribute("data-type"),$=b.find(function(fe){return(fe==null?void 0:fe.key)===P});if($){$.click(P);return}if(P==="mp-wechat"||P==="zhihu"){m.copyToX(d,m.previewElement.cloneNode(!0),P);return}P==="desktop"?m.previewElement.style.width="auto":P==="tablet"?m.previewElement.style.width="780px":m.previewElement.style.width="360px",m.previewElement.scrollWidth>m.previewElement.parentElement.clientWidth&&(m.previewElement.style.width="auto"),m.render(d),w.querySelectorAll("button").forEach(function(fe){fe.classList.remove("vditor-preview__action--current")}),L.classList.add("vditor-preview__action--current")}}),this.element.insertBefore(w,this.previewElement)}}return h.prototype.render=function(d,m){var b=this;if(clearTimeout(this.mdTimeoutId),this.element.style.display==="none"){this.element.getAttribute("data-type")==="renderPerformance"&&d.tip.hide();return}if(m){this.previewElement.innerHTML=m;return}if(c(d).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")===""){this.previewElement.innerHTML="";return}var w=new Date().getTime(),C=c(d);this.mdTimeoutId=window.setTimeout(function(){if(d.options.preview.url){var E=new XMLHttpRequest;E.open("POST",d.options.preview.url),E.setRequestHeader("Content-Type","application/json;charset=UTF-8"),E.onreadystatechange=function(){if(E.readyState===XMLHttpRequest.DONE)if(E.status===200){var D=JSON.parse(E.responseText);if(D.code!==0){d.tip.show(D.msg);return}d.options.preview.transform&&(D.data=d.options.preview.transform(D.data)),b.previewElement.innerHTML=D.data,b.afterRender(d,w)}else{var L=d.lute.Md2HTML(C);d.options.preview.transform&&(L=d.options.preview.transform(L)),b.previewElement.innerHTML=L,b.afterRender(d,w)}},E.send(JSON.stringify({markdownText:C}))}else{var O=d.lute.Md2HTML(C);d.options.preview.transform&&(O=d.options.preview.transform(O)),b.previewElement.innerHTML=O,b.afterRender(d,w)}},d.options.preview.delay)},h.prototype.afterRender=function(d,m){d.options.preview.parse&&d.options.preview.parse(this.element);var b=new Date().getTime()-m;new Date().getTime()-m>2600?(d.tip.show(window.VditorI18n.performanceTip.replace("${x}",b.toString())),d.preview.element.setAttribute("data-type","renderPerformance")):d.preview.element.getAttribute("data-type")==="renderPerformance"&&(d.tip.hide(),d.preview.element.removeAttribute("data-type"));var w=d.preview.element.querySelector(".vditor-comment--focus");w&&w.classList.remove("vditor-comment--focus"),(0,K.O)(d.preview.previewElement,d.options.preview.hljs),(0,oe.s)(d.options.preview.hljs,d.preview.previewElement,d.options.cdn),(0,ve.i)(d.preview.previewElement,d.options.cdn,d.options.theme),(0,ke.K)(d.preview.previewElement,d.options.cdn),(0,Ge.J)(d.preview.previewElement,d.options.cdn,d.options.theme),(0,U.P)(d.preview.previewElement,d.options.cdn),(0,z.v)(d.preview.previewElement,d.options.cdn),(0,R.p)(d.preview.previewElement,d.options.cdn,d.options.theme),(0,Se.P)(d.preview.previewElement,d.options.cdn,d.options.theme),(0,Te.B)(d.preview.previewElement,d.options.cdn),(0,B.Q)(d.preview.previewElement,d.options.cdn),d.options.preview.render.media.enable&&(0,dP.Y)(d.preview.previewElement),d.options.customRenders.forEach(function(O){O.render(d.preview.previewElement,d)});var C=d.preview.element,E=d.outline.render(d);E===""&&(E="[ToC]"),C.querySelectorAll('[data-type="toc-block"]').forEach(function(O){O.innerHTML=E,(0,ne.H)(O,{cdn:d.options.cdn,math:d.options.preview.math})}),(0,ne.H)(d.preview.previewElement,{cdn:d.options.cdn,math:d.options.preview.math})},h.prototype.copyToX=function(d,m,b){b===void 0&&(b="mp-wechat"),b!=="zhihu"?m.querySelectorAll(".katex-html .base").forEach(function(C){C.style.display="initial"}):m.querySelectorAll(".language-math").forEach(function(C){C.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'.concat(C.getAttribute("data-math"),'\\" style="display: block; margin: 0 auto; max-width: 100%;">')}),m.style.backgroundColor="#fff",m.querySelectorAll("code").forEach(function(C){C.style.backgroundImage="none"}),this.element.append(m);var w=m.ownerDocument.createRange();w.selectNode(m),(0,j.Hc)(w),document.execCommand("copy"),m.remove(),d.tip.show(["zhihu","mp-wechat"].includes(b)?"".concat(b==="zhihu"?"":"",""):"")},h}(),mP=function(){function h(d){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--".concat(d.options.resize.position),this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(d)}return h.prototype.bindEvent=function(d){var m=this;this.element.addEventListener("mousedown",function(b){var w=document,C=b.clientY,E=d.element.offsetHeight,O=63+d.element.querySelector(".vditor-toolbar").clientHeight;w.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),m.element.classList.add("vditor-resize--selected"),w.onmousemove=function(D){d.options.resize.position==="top"?d.element.style.height=Math.max(O,E+(C-D.clientY))+"px":d.element.style.height=Math.max(O,E+(D.clientY-C))+"px",d.options.typewriterMode&&(d.sv.element.style.paddingBottom=d.sv.element.parentElement.offsetHeight/2+"px")},w.onmouseup=function(){d.options.resize.after&&d.options.resize.after(d.element.offsetHeight-E),window.captureEvents&&window.captureEvents(),w.onmousemove=null,w.onmouseup=null,w.ondragstart=null,w.onselectstart=null,w.onselect=null,m.element.classList.remove("vditor-resize--selected")}})},h}(),gP=function(){function h(d){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",d.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(d),ss(d,this.element),nr(d,this.element),Do(d,this.element),Fe(d,this.element),Hs(d,this.element),Vs(d,this.element,this.copy),Fs(d,this.element,this.copy)}return h.prototype.copy=function(d,m){d.stopPropagation(),d.preventDefault(),d.clipboardData.setData("text/plain",Di(m[m.currentMode].element))},h.prototype.bindEvent=function(d){var m=this;this.element.addEventListener("paste",function(b){Dp(d,b,{pasteCode:function(w){document.execCommand("insertHTML",!1,w)}})}),this.element.addEventListener("scroll",function(){if(d.preview.element.style.display==="block"){var b=m.element.scrollTop,w=m.element.clientHeight,C=m.element.scrollHeight-parseFloat(m.element.style.paddingBottom||"0"),E=d.preview.element;b/w>.5?E.scrollTop=(b+w)*E.scrollHeight/C-w:E.scrollTop=b*E.scrollHeight/C}}),this.element.addEventListener("compositionstart",function(b){m.composingLock=!0}),this.element.addEventListener("compositionend",function(b){(0,p.vU)()||H(d,b),m.composingLock=!1}),this.element.addEventListener("input",function(b){if(!(b.inputType==="deleteByDrag"||b.inputType==="insertFromDrop")&&!(m.composingLock||b.data===""||b.data===""||b.data==="")){if(m.preventInput){m.preventInput=!1,ut(d,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}H(d,b)}}),this.element.addEventListener("keyup",function(b){if(!(b.isComposing||(0,p.yl)(b))){if((b.key==="Backspace"||b.key==="Delete")&&d.sv.element.innerHTML!==""&&d.sv.element.childNodes.length===1&&d.sv.element.firstElementChild&&d.sv.element.firstElementChild.tagName==="DIV"&&d.sv.element.firstElementChild.childElementCount===2&&(d.sv.element.firstElementChild.textContent===""||d.sv.element.textContent===`
`)){d.sv.element.innerHTML="";return}b.key==="Enter"&&zt(d)}})},h}(),ix=function(){function h(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return h.prototype.show=function(d,m){var b=this;m===void 0&&(m=6e3),this.element.className="vditor-tip vditor-tip--show",m===0?(this.element.innerHTML='<div class="vditor-tip__content">'.concat(d,`
<div class="vditor-tip__close">X</div></div>`),this.element.querySelector(".vditor-tip__close").addEventListener("click",function(){b.hide()})):(this.element.innerHTML='<div class="vditor-tip__content">'.concat(d,"</div>"),setTimeout(function(){b.hide()},m)),this.element.removeAttribute("style"),setTimeout(function(){var w=b.element.getBoundingClientRect();w.top<46&&(b.element.style.position="fixed",b.element.style.top="46px")},150)},h.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},h}(),Hy=function(h,d){if(d.options.preview.mode!==h){switch(d.options.preview.mode=h,h){case"both":d.sv.element.style.display="block",d.preview.element.style.display="block",d.preview.render(d),y(d.toolbar.elements,["both"]);break;case"editor":d.sv.element.style.display="block",d.preview.element.style.display="none",g(d.toolbar.elements,["both"]);break}d.devtools&&d.devtools.renderEchart(d)}},yP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),bP=function(h){yP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return m.options.preview.mode==="both"&&w.element.children[0].classList.add("vditor-menu--current"),w.element.children[0].addEventListener((0,p.Le)(),function(C){var E=w.element.firstElementChild;E.classList.contains(l.g.CLASS_MENU_DISABLED)||(C.preventDefault(),m.currentMode==="sv"&&(m.options.preview.mode==="both"?Hy("editor",m):Hy("both",m)))}),w}return d}(Rt),wP=function(){function h(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"}return h}(),sx=i(580),vP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),kP=function(h){vP(d,h);function d(m,b){var w=h.call(this,m,b)||this,C=w.element.children[0],E=document.createElement("div");E.className="vditor-hint".concat(b.level===2?"":" vditor-panel--arrow");var O="";return l.g.CODE_THEME.forEach(function(D){O+="<button>".concat(D,"</button>")}),E.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(O,"</div>"),E.addEventListener((0,p.Le)(),function(D){D.target.tagName==="BUTTON"&&(M(m,["subToolbar"]),m.options.preview.hljs.style=D.target.textContent,(0,sx.Y)(D.target.textContent,m.options.cdn),D.preventDefault(),D.stopPropagation())}),w.element.appendChild(E),T(m,E,C,b.level),w}return d}(Rt),CP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),SP=function(h){CP(d,h);function d(m,b){var w=h.call(this,m,b)||this,C=w.element.children[0],E=document.createElement("div");E.className="vditor-hint".concat(b.level===2?"":" vditor-panel--arrow");var O="";return Object.keys(m.options.preview.theme.list).forEach(function(D){O+='<button data-type="'.concat(D,'">').concat(m.options.preview.theme.list[D],"</button>")}),E.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(O,"</div>"),E.addEventListener((0,p.Le)(),function(D){D.target.tagName==="BUTTON"&&(M(m,["subToolbar"]),m.options.preview.theme.current=D.target.getAttribute("data-type"),(0,q.Z)(m.options.preview.theme.current,m.options.preview.theme.path),D.preventDefault(),D.stopPropagation())}),w.element.appendChild(E),T(m,E,C,b.level),w}return d}(Rt),xP=function(){function h(d){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(d,"")}return h.prototype.render=function(d,m){var b=m.endsWith(`
`)?m.length-1:m.length;if(d.options.counter.type==="text"&&d[d.currentMode]){var w=d[d.currentMode].element.cloneNode(!0);w.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(C){C.remove()}),b=w.textContent.length}typeof d.options.counter.max=="number"?(b>d.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML="".concat(b,"/").concat(d.options.counter.max)):this.element.innerHTML="".concat(b),this.element.setAttribute("aria-label",d.options.counter.type),d.options.counter.after&&d.options.counter.after(b,{enable:d.options.counter.enable,max:d.options.counter.max,type:d.options.counter.type})},h}(),_P=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),MP=function(h){_P(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w.element.children[0].innerHTML=b.icon,w.element.children[0].addEventListener((0,p.Le)(),function(C){C.preventDefault(),!C.currentTarget.classList.contains(l.g.CLASS_MENU_DISABLED)&&b.click(C,m)}),w}return d}(Rt),TP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),EP=function(h){TP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w.element.firstElementChild.addEventListener((0,p.Le)(),function(C){var E=w.element.firstElementChild;E.classList.contains(l.g.CLASS_MENU_DISABLED)||(C.preventDefault(),E.classList.contains("vditor-menu--current")?(E.classList.remove("vditor-menu--current"),m.devtools.element.style.display="none",pe(m)):(E.classList.add("vditor-menu--current"),m.devtools.element.style.display="block",pe(m),m.devtools.renderEchart(m)))}),w}return d}(Rt),AP=function(){function h(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"}return h}(),OP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),LP=function(h){OP(d,h);function d(m,b){var w=h.call(this,m,b)||this,C=document.createElement("div");C.className="vditor-panel vditor-panel--arrow";var E="";return Object.keys(m.options.hint.emoji).forEach(function(O){var D=m.options.hint.emoji[O];D.indexOf(".")>-1?E+='<button data-value=":'.concat(O,': " data-key=":').concat(O,`:"><img
data-value=":`).concat(O,': " data-key=":').concat(O,':" class="vditor-emojis__icon" src="').concat(D,'"/></button>'):E+='<button data-value="'.concat(D,` "
 data-key="`).concat(O,'"><span class="vditor-emojis__icon">').concat(D,"</span></button>")}),C.innerHTML='<div class="vditor-emojis" style="max-height: '.concat(m.options.height==="auto"?"auto":m.options.height-80,'px">').concat(E,`</div><div class="vditor-emojis__tail">
    <span class="vditor-emojis__tip"></span><span>`).concat(m.options.hint.emojiTail||"",`</span>
</div>`),w.element.appendChild(C),T(m,C,w.element.firstElementChild,b.level),w.bindEvent(m),w}return d.prototype.bindEvent=function(m){var b=this;this.element.lastElementChild.addEventListener((0,p.Le)(),function(w){var C=(0,A.S)(w.target,"BUTTON");if(C){w.preventDefault();var E=C.getAttribute("data-value"),O=(0,j.zh)(m),D=E;if(m.currentMode==="wysiwyg"?D=m.lute.SpinVditorDOM(E):m.currentMode==="ir"&&(D=m.lute.SpinVditorIRDOM(E)),E.indexOf(":")>-1&&m.currentMode!=="sv"){var L=document.createElement("div");L.innerHTML=D,D=L.firstElementChild.firstElementChild.outerHTML+" ",(0,j.oC)(D,m)}else O.extractContents(),O.insertNode(document.createTextNode(E)),(0,S.F9)(O.startContainer)||gn(m,O);O.collapse(!1),(0,j.Hc)(O),b.element.lastElementChild.style.display="none",ht(m)}}),this.element.lastElementChild.addEventListener("mouseover",function(w){var C=(0,A.S)(w.target,"BUTTON");C&&(b.element.querySelector(".vditor-emojis__tip").innerHTML=C.getAttribute("data-key"))})},d}(Rt),ox=function(h,d,m){var b=document.createElement("a");"download"in b?(b.download=m,b.style.display="none",b.href=URL.createObjectURL(new Blob([d])),document.body.appendChild(b),b.click(),b.remove()):h.tip.show(window.VditorI18n.downloadTip,0)},DP=function(h){var d=c(h);ox(h,d,d.substr(0,10)+".md")},IP=function(h){h.tip.show(window.VditorI18n.generate,3800);var d=document.querySelector("#vditorExportIframe");d.contentDocument.open(),d.contentDocument.write('<link rel="stylesheet" href="'.concat(h.options.cdn,`/dist/index.css"/>
<script src="`).concat(h.options.cdn,`/dist/method.min.js"><\/script>
<div id="preview" style="width: 800px"></div>
<script>
window.addEventListener("message", (e) => {
  if(!e.data) {
    return;
  }
  Vditor.preview(document.getElementById('preview'), e.data, {
    cdn: "`).concat(h.options.cdn,`",
    markdown: {
      theme: `).concat(JSON.stringify(h.options.preview.theme),`
    },
    hljs: {
      style: "`).concat(h.options.preview.hljs.style,`"
    }
  });
  setTimeout(() => {
        window.print();
    }, 3600);
}, false);
<\/script>`)),d.contentDocument.close(),setTimeout(function(){d.contentWindow.postMessage(c(h),"*")},200)},NP=function(h){var d=nx(h),m='<html><head><link rel="stylesheet" type="text/css" href="'.concat(h.options.cdn,`/dist/index.css"/>
<script src="`).concat(h.options.cdn,"/dist/js/i18n/").concat(h.options.lang,`.js"><\/script>
<script src="`).concat(h.options.cdn,`/dist/method.min.js"><\/script></head>
<body><div class="vditor-reset" id="preview">`).concat(d,`</div>
<script>
    const previewElement = document.getElementById('preview')
    Vditor.setContentTheme('`).concat(h.options.preview.theme.current,"', '").concat(h.options.preview.theme.path,`');
    Vditor.codeRender(previewElement);
    Vditor.highlightRender(`).concat(JSON.stringify(h.options.preview.hljs),", previewElement, '").concat(h.options.cdn,`');
    Vditor.mathRender(previewElement, {
        cdn: '`).concat(h.options.cdn,`',
        math: `).concat(JSON.stringify(h.options.preview.math),`,
    });
    Vditor.mermaidRender(previewElement, '`).concat(h.options.cdn,"', '").concat(h.options.theme,`');
    Vditor.SMILESRender(previewElement, '`).concat(h.options.cdn,"', '").concat(h.options.theme,`');
    Vditor.markmapRender(previewElement, '`).concat(h.options.cdn,`');
    Vditor.flowchartRender(previewElement, '`).concat(h.options.cdn,`');
    Vditor.graphvizRender(previewElement, '`).concat(h.options.cdn,`');
    Vditor.chartRender(previewElement, '`).concat(h.options.cdn,"', '").concat(h.options.theme,`');
    Vditor.mindmapRender(previewElement, '`).concat(h.options.cdn,"', '").concat(h.options.theme,`');
    Vditor.abcRender(previewElement, '`).concat(h.options.cdn,`');
    `).concat(h.options.preview.render.media.enable?"Vditor.mediaRender(previewElement);":"",`
    Vditor.speechRender(previewElement);
<\/script>
<script src="`).concat(h.options.cdn,"/dist/js/icons/").concat(h.options.icon,'.js"><\/script></body></html>');ox(h,m,d.substr(0,10)+".html")},RP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),PP=function(h){RP(d,h);function d(m,b){var w=h.call(this,m,b)||this,C=w.element.children[0],E=document.createElement("div");return E.className="vditor-hint".concat(b.level===2?"":" vditor-panel--arrow"),E.innerHTML=`<button data-type="markdown">Markdown</button>
<button data-type="pdf">PDF</button>
<button data-type="html">HTML</button>`,E.addEventListener((0,p.Le)(),function(O){var D=O.target;if(D.tagName==="BUTTON"){switch(D.getAttribute("data-type")){case"markdown":DP(m);break;case"pdf":IP(m);break;case"html":NP(m);break}M(m,["subToolbar"]),O.preventDefault(),O.stopPropagation()}}),w.element.appendChild(E),T(m,E,C,b.level),w}return d}(Rt),BP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),HP=function(h){BP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w._bindEvent(m,b),w}return d.prototype._bindEvent=function(m,b){this.element.children[0].addEventListener((0,p.Le)(),function(w){w.preventDefault(),m.element.className.includes("vditor--fullscreen")?(b.level||(this.innerHTML=b.icon),m.element.style.zIndex="",document.body.style.overflow="",m.element.classList.remove("vditor--fullscreen"),Object.keys(m.toolbar.elements).forEach(function(C){var E=m.toolbar.elements[C].firstChild;E&&(E.className=E.className.replace("__s","__n"),m.options.toolbar.forEach(function(O){typeof O!="string"&&O.tipPosition&&O.name===E.dataset.type&&(E.className="vditor-tooltipped vditor-tooltipped__".concat(O.tipPosition))}))}),m.counter&&(m.counter.element.className=m.counter.element.className.replace("__s","__n"))):(b.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),m.element.style.zIndex=m.options.fullscreen.index.toString(),document.body.style.overflow="hidden",m.element.classList.add("vditor--fullscreen"),Object.keys(m.toolbar.elements).forEach(function(C){var E=m.toolbar.elements[C].firstChild;E&&(E.className=E.className.replace("__n","__s"))}),m.counter&&(m.counter.element.className=m.counter.element.className.replace("__n","__s"))),m.devtools&&m.devtools.renderEchart(m),b.click&&b.click(w,m),pe(m),me(m)})},d}(Rt),VP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),FP=function(h){VP(d,h);function d(m,b){var w=h.call(this,m,b)||this,C=document.createElement("div");return C.className="vditor-hint vditor-panel--arrow",C.innerHTML='<button data-tag="h1" data-value="# ">'.concat(window.VditorI18n.heading1," ").concat((0,p.ns)("&lt;1>"),`</button>
<button data-tag="h2" data-value="## ">`).concat(window.VditorI18n.heading2," &lt;").concat((0,p.ns)("2"),`></button>
<button data-tag="h3" data-value="### ">`).concat(window.VditorI18n.heading3," &lt;").concat((0,p.ns)("3"),`></button>
<button data-tag="h4" data-value="#### ">`).concat(window.VditorI18n.heading4," &lt;").concat((0,p.ns)("4"),`></button>
<button data-tag="h5" data-value="##### ">`).concat(window.VditorI18n.heading5," &lt;").concat((0,p.ns)("5"),`></button>
<button data-tag="h6" data-value="###### ">`).concat(window.VditorI18n.heading6," &lt;").concat((0,p.ns)("6"),"></button>"),w.element.appendChild(C),w._bindEvent(m,C),w}return d.prototype._bindEvent=function(m,b){var w=this.element.children[0];w.addEventListener((0,p.Le)(),function(E){E.preventDefault(),clearTimeout(m.wysiwyg.afterRenderTimeoutId),clearTimeout(m.ir.processTimeoutId),clearTimeout(m.sv.processTimeoutId),!w.classList.contains(l.g.CLASS_MENU_DISABLED)&&(w.blur(),w.classList.contains("vditor-menu--current")?(m.currentMode==="wysiwyg"?($n(m),ye(m)):m.currentMode==="ir"&&Yu(m,""),w.classList.remove("vditor-menu--current")):(M(m,["subToolbar"]),b.style.display="block"))});for(var C=0;C<6;C++)b.children.item(C).addEventListener((0,p.Le)(),function(E){E.preventDefault(),m.currentMode==="wysiwyg"?($t(m,E.target.getAttribute("data-tag")),ye(m),w.classList.add("vditor-menu--current")):m.currentMode==="ir"?(Yu(m,E.target.getAttribute("data-value")),w.classList.add("vditor-menu--current")):Wt(m,E.target.getAttribute("data-value")),b.style.display="none"})},d}(Rt),jP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),$P=function(h){jP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w.element.children[0].addEventListener((0,p.Le)(),function(C){C.preventDefault(),m.tip.show(`<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">
<div style="margin-top: 14px;flex: 1">
    <div>Markdown </div>
    <ul style="list-style: none">
        <li><a href="https://ld246.com/article/1583308420519" target="_blank"></a></li>
        <li><a href="https://ld246.com/article/1583129520165" target="_blank"></a></li>
        <li><a href="https://ld246.com/article/1583305480675" target="_blank"></a></li>
        <li><a href="https://ld246.com/article/1582778815353" target="_blank"></a></li>
    </ul>
</div>
<div style="margin-top: 14px;flex: 1">
    <div>Vditor </div>
    <ul style="list-style: none">
        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>
        <li><a href="https://ld246.com/tag/vditor" target="_blank"></a></li>
        <li><a href="https://ld246.com/article/1549638745630" target="_blank"></a></li>
        <li><a href="https://ld246.com/guide/markdown" target="_blank"></a></li>
    </ul>
</div></div>`,0)}),w}return d}(Rt),zP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),WP=function(h){zP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w.element.children[0].addEventListener((0,p.Le)(),function(C){if(C.preventDefault(),!(w.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)||m.currentMode==="sv")){var E=(0,j.zh)(m),O=(0,S.lG)(E.startContainer,"LI");O&&kt(m,O,E)}}),w}return d}(Rt),qP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),UP=function(h){qP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w.element.children[0].addEventListener((0,p.Le)(),function(C){C.preventDefault(),m.tip.show(`<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">
<p style="text-align: center;margin: 14px 0">
    <em> Markdown </em>
</p>
<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">
    <img src="https://unpkg.com/vditor/dist/images/logo.png" style="margin: 0 auto;height: 68px"/>
    <div>&nbsp;&nbsp;</div>
    <div style="flex: 1;min-width: 250px">
        Vditor  Markdown  Typora
         TypeScript  JavaScript  VueReactAngular  Svelte 
    </div>
</div>
<div style="display: flex;flex-wrap: wrap;">
    <ul style="list-style: none;flex: 1;min-width:148px">
        <li>
        <a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>
        </li>
        <li>
        MIT
        </li>
    </ul>
    <ul style="list-style: none;margin-right: 18px">
        <li>
        Vditor v`.concat(l.H," / Lute v").concat(Lute.Version,`
        </li>
        <li>
        <a href="https://ld246.com/sponsor" target="_blank">https://ld246.com/sponsor</a>
        </li>
    </ul>
</div>
</div>`),0)}),w}return d}(Rt),KP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),GP=function(h){KP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w.element.children[0].addEventListener((0,p.Le)(),function(C){C.preventDefault(),!(w.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)||m.currentMode==="sv")&&Nl(m,"afterend")}),w}return d}(Rt),JP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),ZP=function(h){JP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w.element.children[0].addEventListener((0,p.Le)(),function(C){C.preventDefault(),!(w.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)||m.currentMode==="sv")&&Nl(m,"beforebegin")}),w}return d}(Rt),YP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),XP=function(h){YP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w.element.children[0].addEventListener((0,p.Le)(),function(C){if(C.preventDefault(),!(w.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)||m.currentMode==="sv")){var E=(0,j.zh)(m),O=(0,S.lG)(E.startContainer,"LI");O&&Zu(m,O,E,O.parentElement)}}),w}return d}(Rt),QP=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),e3=function(h){QP(d,h);function d(m,b){var w=h.call(this,m,b)||this;return m.options.outline&&w.element.firstElementChild.classList.add("vditor-menu--current"),w.element.children[0].addEventListener((0,p.Le)(),function(C){C.preventDefault();var E=m.toolbar.elements.outline.firstElementChild;E.classList.contains(l.g.CLASS_MENU_DISABLED)||(m.options.outline.enable=!w.element.firstElementChild.classList.contains("vditor-menu--current"),m.outline.toggle(m,m.options.outline.enable))}),w}return d}(Rt),t3=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),n3=function(h){t3(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w._bindEvent(m),w}return d.prototype._bindEvent=function(m){var b=this;this.element.children[0].addEventListener((0,p.Le)(),function(w){w.preventDefault();var C=b.element.firstElementChild;if(!C.classList.contains(l.g.CLASS_MENU_DISABLED)){var E=l.g.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);C.classList.contains("vditor-menu--current")?(C.classList.remove("vditor-menu--current"),m.currentMode==="sv"?(m.sv.element.style.display="block",m.options.preview.mode==="both"?m.preview.element.style.display="block":m.preview.element.style.display="none"):(m[m.currentMode].element.parentElement.style.display="block",m.preview.element.style.display="none"),v(m.toolbar.elements,E),m.outline.render(m)):(k(m.toolbar.elements,E),m.preview.element.style.display="block",m.currentMode==="sv"?m.sv.element.style.display="none":m[m.currentMode].element.parentElement.style.display="none",m.preview.render(m),C.classList.add("vditor-menu--current"),M(m,["subToolbar","hint","popover"]),setTimeout(function(){m.outline.render(m)},m.options.preview.delay+10)),pe(m)}})},d}(Rt),r3=function(){function h(d){this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0;var m;if(typeof AudioContext<"u")m=new AudioContext;else if(webkitAudioContext)m=new webkitAudioContext;else return;this.DEFAULT_SAMPLE_RATE=m.sampleRate;var b=m.createGain(),w=m.createMediaStreamSource(d);w.connect(b),this.recorder=m.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,b.connect(this.recorder),this.recorder.connect(m.destination),this.readyFlag=!0}return h.prototype.cloneChannelData=function(d,m){this.leftChannel.push(new Float32Array(d)),this.rightChannel.push(new Float32Array(m)),this.recordingLength+=2048},h.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},h.prototype.stopRecording=function(){this.isRecording=!1},h.prototype.buildWavFileBlob=function(){for(var d=this.mergeBuffers(this.leftChannel),m=this.mergeBuffers(this.rightChannel),b=new Float32Array(d.length),w=0;w<d.length;++w)b[w]=.5*(d[w]+m[w]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(b=this.downSampleBuffer(b,this.SAMPLE_RATE));var C=44+b.length*2,E=new ArrayBuffer(C),O=new DataView(E);this.writeUTFBytes(O,0,"RIFF"),O.setUint32(4,C,!0),this.writeUTFBytes(O,8,"WAVE"),this.writeUTFBytes(O,12,"fmt "),O.setUint32(16,16,!0),O.setUint16(20,1,!0),O.setUint16(22,1,!0),O.setUint32(24,this.SAMPLE_RATE,!0),O.setUint32(28,this.SAMPLE_RATE*2,!0),O.setUint16(32,2,!0),O.setUint16(34,16,!0);var D=b.length*2;this.writeUTFBytes(O,36,"data"),O.setUint32(40,D,!0);for(var L=b.length,P=44,$=1,fe=0;fe<L;fe++)O.setInt16(P,b[fe]*(32767*$),!0),P+=2;return new Blob([O],{type:"audio/wav"})},h.prototype.downSampleBuffer=function(d,m){if(m===this.DEFAULT_SAMPLE_RATE||m>this.DEFAULT_SAMPLE_RATE)return d;for(var b=this.DEFAULT_SAMPLE_RATE/m,w=Math.round(d.length/b),C=new Float32Array(w),E=0,O=0;E<C.length;){for(var D=Math.round((E+1)*b),L=0,P=0,$=O;$<D&&$<d.length;$++)L+=d[$],P++;C[E]=L/P,E++,O=D}return C},h.prototype.mergeBuffers=function(d){for(var m=new Float32Array(this.recordingLength),b=0,w=d.length,C=0;C<w;++C){var E=d[C];m.set(E,b),b+=E.length}return m},h.prototype.writeUTFBytes=function(d,m,b){for(var w=b.length,C=0;C<w;C++)d.setUint8(m+C,b.charCodeAt(C))},h}(),i3=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),s3=function(h){i3(d,h);function d(m,b){var w=h.call(this,m,b)||this;return w._bindEvent(m),w}return d.prototype._bindEvent=function(m){var b=this,w;this.element.children[0].addEventListener((0,p.Le)(),function(C){if(C.preventDefault(),!b.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)){var E=m[m.currentMode].element;if(!w){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(D){w=new r3(D),w.recorder.onaudioprocess=function(L){if(w.isRecording){var P=L.inputBuffer.getChannelData(0),$=L.inputBuffer.getChannelData(1);w.cloneChannelData(P,$)}},w.startRecordingNewWavFile(),m.tip.show(window.VditorI18n.recording),E.setAttribute("contenteditable","false"),b.element.children[0].classList.add("vditor-menu--current")}).catch(function(){m.tip.show(window.VditorI18n["record-tip"])});return}if(w.isRecording){w.stopRecording(),m.tip.hide();var O=new File([w.buildWavFileBlob()],"record".concat(new Date().getTime(),".wav"),{type:"video/webm"});nc(m,[O]),b.element.children[0].classList.remove("vditor-menu--current")}else m.tip.show(window.VditorI18n.recording),E.setAttribute("contenteditable","false"),w.startRecordingNewWavFile(),b.element.children[0].classList.add("vditor-menu--current")}})},d}(Rt),o3=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),l3=function(h){o3(d,h);function d(m,b){var w=h.call(this,m,b)||this;return k({redo:w.element},["redo"]),w.element.children[0].addEventListener((0,p.Le)(),function(C){C.preventDefault(),!w.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)&&m.undo.redo(m)}),w}return d}(Rt),a3=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),c3=function(h){a3(d,h);function d(m,b){var w=h.call(this,m,b)||this;return k({undo:w.element},["undo"]),w.element.children[0].addEventListener((0,p.Le)(),function(C){C.preventDefault(),!w.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)&&m.undo.undo(m)}),w}return d}(Rt),u3=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),f3=function(h){u3(d,h);function d(m,b){var w=h.call(this,m,b)||this,C='<input type="file"';return m.options.upload.multiple&&(C+=' multiple="multiple"'),m.options.upload.accept&&(C+=' accept="'.concat(m.options.upload.accept,'"')),w.element.children[0].innerHTML="".concat(b.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>').concat(C,">"),w._bindEvent(m),w}return d.prototype._bindEvent=function(m){var b=this;this.element.children[0].addEventListener((0,p.Le)(),function(w){if(b.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)){w.stopPropagation(),w.preventDefault();return}}),this.element.querySelector("input").addEventListener("change",function(w){if(b.element.firstElementChild.classList.contains(l.g.CLASS_MENU_DISABLED)){w.stopPropagation(),w.preventDefault();return}w.target.files.length!==0&&nc(m,w.target.files,w.target)})},d}(Rt),h3=function(){function h(d){var m=this,b=d.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",b.toolbar.forEach(function(w,C){var E=m.genItem(d,w,C);if(m.element.appendChild(E),w.toolbar){var O=document.createElement("div");O.className="vditor-hint vditor-panel--arrow",O.addEventListener((0,p.Le)(),function(D){O.style.display="none"}),w.toolbar.forEach(function(D,L){D.level=2,O.appendChild(m.genItem(d,D,C+L))}),E.appendChild(O),T(d,O,E.children[0])}}),d.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),d.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),d.options.counter.enable&&(d.counter=new xP(d),this.element.appendChild(d.counter.element))}return h.prototype.updateConfig=function(d,m){d.options.toolbarConfig=Object.assign({hide:!1,pin:!1},m),d.options.toolbarConfig.hide?this.element.classList.add("vditor-toolbar--hide"):this.element.classList.remove("vditor-toolbar--hide"),d.options.toolbarConfig.pin?this.element.classList.add("vditor-toolbar--pin"):this.element.classList.remove("vditor-toolbar--pin")},h.prototype.genItem=function(d,m,b){var w;switch(m.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":w=new Rt(d,m);break;case"emoji":w=new LP(d,m);break;case"headings":w=new FP(d,m);break;case"|":w=new AP;break;case"br":w=new wP;break;case"undo":w=new c3(d,m);break;case"redo":w=new l3(d,m);break;case"help":w=new $P(d,m);break;case"both":w=new bP(d,m);break;case"preview":w=new n3(d,m);break;case"fullscreen":w=new HP(d,m);break;case"upload":w=new f3(d,m);break;case"record":w=new s3(d,m);break;case"info":w=new UP(d,m);break;case"edit-mode":w=new Ol(d,m);break;case"devtools":w=new EP(d,m);break;case"outdent":w=new XP(d,m);break;case"indent":w=new WP(d,m);break;case"outline":w=new e3(d,m);break;case"insert-after":w=new GP(d,m);break;case"insert-before":w=new ZP(d,m);break;case"code-theme":w=new kP(d,m);break;case"content-theme":w=new SP(d,m);break;case"export":w=new PP(d,m);break;default:w=new MP(d,m);break}if(w){var C=m.name;return(C==="br"||C==="|")&&(C=C+b),this.elements[C]=w.element,w.element}},h}(),d3=i(173),p3=function(){function h(){this.stackSize=50,this.resetStack(),this.dmp=new d3}return h.prototype.clearStack=function(d){this.resetStack(),this.resetIcon(d)},h.prototype.resetIcon=function(d){d.toolbar&&(this[d.currentMode].undoStack.length>1?v(d.toolbar.elements,["undo"]):k(d.toolbar.elements,["undo"]),this[d.currentMode].redoStack.length!==0?v(d.toolbar.elements,["redo"]):k(d.toolbar.elements,["redo"]))},h.prototype.undo=function(d){if(d[d.currentMode].element.getAttribute("contenteditable")!=="false"&&!(this[d.currentMode].undoStack.length<2)){var m=this[d.currentMode].undoStack.pop();m&&(this[d.currentMode].redoStack.push(m),this.renderDiff(m,d),this[d.currentMode].hasUndo=!0,M(d,["hint"]))}},h.prototype.redo=function(d){if(d[d.currentMode].element.getAttribute("contenteditable")!=="false"){var m=this[d.currentMode].redoStack.pop();m&&(this[d.currentMode].undoStack.push(m),this.renderDiff(m,d,!0))}},h.prototype.recordFirstPosition=function(d,m){if(getSelection().rangeCount!==0&&!(this[d.currentMode].undoStack.length!==1||this[d.currentMode].undoStack[0].length===0||this[d.currentMode].redoStack.length>0)&&!((0,p.vU)()&&m.key==="Backspace")&&!(0,p.G6)()){var b=this.addCaret(d);b.replace("<wbr>","").replace(" vditor-ir__node--expand","")===this[d.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[d.currentMode].undoStack[0][0].diffs[0][1]=b,this[d.currentMode].lastText=b)}},h.prototype.addToUndoStack=function(d){var m=this.addCaret(d,!0),b=this.dmp.diff_main(m,this[d.currentMode].lastText,!0),w=this.dmp.patch_make(m,this[d.currentMode].lastText,b);w.length===0&&this[d.currentMode].undoStack.length>0||(this[d.currentMode].lastText=m,this[d.currentMode].undoStack.push(w),this[d.currentMode].undoStack.length>this.stackSize&&this[d.currentMode].undoStack.shift(),this[d.currentMode].hasUndo&&(this[d.currentMode].redoStack=[],this[d.currentMode].hasUndo=!1,k(d.toolbar.elements,["redo"])),this[d.currentMode].undoStack.length>1&&v(d.toolbar.elements,["undo"]))},h.prototype.renderDiff=function(d,m,b){b===void 0&&(b=!1);var w;if(b){var C=this.dmp.patch_deepCopy(d).reverse();C.forEach(function(O){O.diffs.forEach(function(D){D[0]=-D[0]})}),w=this.dmp.patch_apply(C,this[m.currentMode].lastText)[0]}else w=this.dmp.patch_apply(d,this[m.currentMode].lastText)[0];if(this[m.currentMode].lastText=w,m[m.currentMode].element.innerHTML=w,m.currentMode!=="sv"&&(m[m.currentMode].element.querySelectorAll(".vditor-".concat(m.currentMode,"__preview")).forEach(function(O){O.parentElement.querySelector(".language-echarts")&&(m.currentMode==="ir"?O.parentElement.outerHTML=m.lute.SpinVditorIRDOM(O.parentElement.outerHTML):O.parentElement.outerHTML=m.lute.SpinVditorDOM(O.parentElement.outerHTML))}),m[m.currentMode].element.querySelectorAll(".vditor-".concat(m.currentMode,"__preview[data-render='2']")).forEach(function(O){He(O,m)})),m[m.currentMode].element.querySelector("wbr"))(0,j.ib)(m[m.currentMode].element,m[m.currentMode].element.ownerDocument.createRange()),zt(m);else{var E=getSelection().getRangeAt(0);E.setEndBefore(m[m.currentMode].element),E.collapse(!1)}Ze(m),ht(m,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),ui(m),m[m.currentMode].element.querySelectorAll(".vditor-".concat(m.currentMode,"__preview[data-render='2']")).forEach(function(O){He(O,m)}),this[m.currentMode].undoStack.length>1?v(m.toolbar.elements,["undo"]):k(m.toolbar.elements,["undo"]),this[m.currentMode].redoStack.length!==0?v(m.toolbar.elements,["redo"]):k(m.toolbar.elements,["redo"])},h.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},h.prototype.addCaret=function(d,m){m===void 0&&(m=!1);var b;if(getSelection().rangeCount!==0&&!d[d.currentMode].element.querySelector("wbr")){var w=getSelection().getRangeAt(0);if(d[d.currentMode].element.contains(w.startContainer)){b=w.cloneRange();var C=document.createElement("span");C.className="vditor-wbr",w.insertNode(C)}}var E=d[d.currentMode].element.cloneNode(!0);E.querySelectorAll(".vditor-".concat(d.currentMode,"__preview[data-render='1']")).forEach(function(D){D.firstElementChild&&(D.firstElementChild.classList.contains("language-echarts")||D.firstElementChild.classList.contains("language-plantuml")||D.firstElementChild.classList.contains("language-mindmap")?(D.firstElementChild.removeAttribute("_echarts_instance_"),D.firstElementChild.removeAttribute("data-processed"),D.firstElementChild.innerHTML=D.previousElementSibling.firstElementChild.innerHTML,D.setAttribute("data-render","2")):D.firstElementChild.classList.contains("language-math")&&(D.setAttribute("data-render","2"),D.firstElementChild.textContent=D.firstElementChild.getAttribute("data-math"),D.firstElementChild.removeAttribute("data-math")))});var O=E.innerHTML;return d[d.currentMode].element.querySelectorAll(".vditor-wbr").forEach(function(D){D.remove()}),m&&b&&(0,j.Hc)(b),O.replace('<span class="vditor-wbr"></span>',"<wbr>")},h}(),m3=i(673),g3=function(){function h(d){this.defaultOptions={rtl:!1,after:void 0,cache:{enable:!0},cdn:l.g.CDN,classes:{preview:""},comment:{enable:!1},counter:{enable:!1,type:"markdown"},customRenders:[],debugger:!1,fullscreen:{index:90},height:"auto",hint:{delay:200,emoji:{"+1":"","-1":"",confused:"",eyes:"",heart:"",rocket:"",smile:"",tada:""},emojiPath:"".concat(l.g.CDN,"/dist/images/emoji"),extend:[],parse:!0},icon:"ant",lang:"zh_CN",mode:"ir",outline:{enable:!1,position:"left"},placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:l.g.HLJS_OPTIONS,markdown:l.g.MARKDOWN_OPTIONS,math:l.g.MATH_OPTIONS,maxWidth:800,mode:"both",theme:l.g.THEME_OPTIONS,render:{media:{enable:!0}}},link:{isOpen:!0},image:{isPreview:!0},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,undoDelay:800,upload:{extraData:{},fieldName:"file[]",filename:function(m){return m.replace(/\W/g,"")},linkToImgUrl:"",max:10*1024*1024,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=d}return h.prototype.merge=function(){var d,m,b,w,C,E,O,D,L;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),!((m=(d=this.options.preview)===null||d===void 0?void 0:d.theme)===null||m===void 0)&&m.list&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),!((C=(w=(b=this.options.preview)===null||b===void 0?void 0:b.render)===null||w===void 0?void 0:w.media)===null||C===void 0)&&C.enable&&(this.defaultOptions.preview.render.media.enable=this.options.preview.render.media.enable),!((E=this.options.hint)===null||E===void 0)&&E.emoji&&(this.defaultOptions.hint.emoji=this.options.hint.emoji),this.options.comment&&(this.defaultOptions.comment=this.options.comment),this.options.cdn&&(!((D=(O=this.options.preview)===null||O===void 0?void 0:O.theme)===null||D===void 0)&&D.path||(this.defaultOptions.preview.theme.path="".concat(this.options.cdn,"/dist/css/content-theme")),!((L=this.options.hint)===null||L===void 0)&&L.emojiPath||(this.defaultOptions.hint.emojiPath="".concat(this.options.cdn,"/dist/images/emoji"))));var P=(0,m3.T)(this.defaultOptions,this.options);if(P.cache.enable&&!P.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");return P},h.prototype.mergeToolbar=function(d){var m=this,b=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:";",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:` | col2 | col3 |
| --- | --- | --- |
|  |  |  |
|  |  |  |`,tipPosition:"n"},{name:"|"},{hotkey:"Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],w=[];return d.forEach(function(C){var E=C;b.forEach(function(O){typeof C=="string"&&O.name===C&&(E=O),typeof C=="object"&&O.name===C.name&&(E=Object.assign({},O,C))}),C.toolbar&&(E.toolbar=m.mergeToolbar(C.toolbar)),w.push(E)}),w},h}(),y3=function(){function h(d){var m=this;this.composingLock=!1,this.commentIds=[];var b=document.createElement("div");b.className="vditor-wysiwyg",b.innerHTML='<pre class="vditor-reset" placeholder="'.concat(d.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>
<div class="vditor-panel vditor-panel--none"></div>
<div class="vditor-panel vditor-panel--none">
    <button type="button" aria-label="`).concat(window.VditorI18n.comment,`" class="vditor-icon vditor-tooltipped vditor-tooltipped__n">
        <svg><use xlink:href="#vditor-icon-comment"></use></svg>
    </button>
</div>`),this.element=b.firstElementChild,this.popover=b.firstElementChild.nextElementSibling,this.selectPopover=b.lastElementChild,this.bindEvent(d),ss(d,this.element),Lo(d,this.element),nr(d,this.element),Do(d,this.element),Fe(d,this.element),Hs(d,this.element),Vs(d,this.element,this.copy),Fs(d,this.element,this.copy),d.options.comment.enable&&(this.selectPopover.querySelector("button").onclick=function(){var w=Lute.NewNodeID(),C=getSelection().getRangeAt(0),E=C.cloneRange(),O=C.extractContents(),D,L,P=!1,$=!1;O.childNodes.forEach(function(le,Me){var Ce=!1;if(le.nodeType===3?Ce=!0:le.classList.contains("vditor-comment")?le.classList.contains("vditor-comment")&&le.setAttribute("data-cmtids",le.getAttribute("data-cmtids")+" "+w):Ce=!0,Ce)if(le.nodeType!==3&&le.getAttribute("data-block")==="0"&&Me===0&&E.startOffset>0)le.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(w,'">').concat(le.innerHTML,"</span>"),D=le;else if(le.nodeType!==3&&le.getAttribute("data-block")==="0"&&Me===O.childNodes.length-1&&E.endOffset<E.endContainer.textContent.length)le.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(w,'">').concat(le.innerHTML,"</span>"),L=le;else if(le.nodeType!==3&&le.getAttribute("data-block")==="0")Me===0?P=!0:Me===O.childNodes.length-1&&($=!0),le.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(w,'">').concat(le.innerHTML,"</span>");else{var ae=document.createElement("span");ae.classList.add("vditor-comment"),ae.setAttribute("data-cmtids",w),le.parentNode.insertBefore(ae,le),ae.appendChild(le)}});var fe=(0,S.F9)(E.startContainer);fe&&(D?(fe.insertAdjacentHTML("beforeend",D.innerHTML),D.remove()):fe.textContent.trim().replace(l.g.ZWSP,"")===""&&P&&fe.remove());var de=(0,S.F9)(E.endContainer);de&&(L?(de.insertAdjacentHTML("afterbegin",L.innerHTML),L.remove()):de.textContent.trim().replace(l.g.ZWSP,"")===""&&$&&de.remove()),C.insertNode(O),d.options.comment.add(w,C.toString(),m.getComments(d,!0)),ye(d,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),m.hideComment()})}return h.prototype.getComments=function(d,m){var b=this;if(m===void 0&&(m=!1),d.currentMode==="wysiwyg"&&d.options.comment.enable){this.commentIds=[],this.element.querySelectorAll(".vditor-comment").forEach(function(C){b.commentIds=b.commentIds.concat(C.getAttribute("data-cmtids").split(" "))}),this.commentIds=Array.from(new Set(this.commentIds));var w=[];if(m)return this.commentIds.forEach(function(C){w.push({id:C,top:b.element.querySelector('.vditor-comment[data-cmtids="'.concat(C,'"]')).offsetTop})}),w}else return[]},h.prototype.triggerRemoveComment=function(d){var m=function(C,E){var O=new Set(E);return C.filter(function(D){return!O.has(D)})};if(d.currentMode==="wysiwyg"&&d.options.comment.enable&&d.wysiwyg.commentIds.length>0){var b=JSON.parse(JSON.stringify(this.commentIds));this.getComments(d);var w=m(b,this.commentIds);w.length>0&&d.options.comment.remove(w)}},h.prototype.showComment=function(){var d=(0,j.Ny)(this.element);this.selectPopover.setAttribute("style","left:".concat(d.left,"px;display:block;top:").concat(Math.max(-8,d.top-21),"px"))},h.prototype.hideComment=function(){this.selectPopover.setAttribute("style","display:none")},h.prototype.unbindListener=function(){window.removeEventListener("scroll",this.scrollListener)},h.prototype.copy=function(d,m){var b=getSelection().getRangeAt(0);if(b.toString()!==""){d.stopPropagation(),d.preventDefault();var w=(0,S.lG)(b.startContainer,"CODE"),C=(0,S.lG)(b.endContainer,"CODE");if(w&&C&&C.isSameNode(w)){var E="";w.parentElement.tagName==="PRE"?E=b.toString():E="`"+b.toString()+"`",d.clipboardData.setData("text/plain",E),d.clipboardData.setData("text/html","");return}var O=(0,S.lG)(b.startContainer,"A"),D=(0,S.lG)(b.endContainer,"A");if(O&&D&&D.isSameNode(O)){var L=O.getAttribute("title")||"";L&&(L=' "'.concat(L,'"')),d.clipboardData.setData("text/plain","[".concat(b.toString(),"](").concat(O.getAttribute("href")).concat(L,")")),d.clipboardData.setData("text/html","");return}var P=document.createElement("div");P.appendChild(b.cloneContents()),d.clipboardData.setData("text/plain",m.lute.VditorDOM2Md(P.innerHTML).trim()),d.clipboardData.setData("text/html","")}},h.prototype.bindEvent=function(d){var m=this;this.unbindListener(),window.addEventListener("scroll",this.scrollListener=function(){if(M(d,["hint"]),!(m.popover.style.display!=="block"||m.selectPopover.style.display!=="block")){var b=parseInt(m.popover.getAttribute("data-top"),10);if(d.options.height!=="auto"){if(d.options.toolbarConfig.pin&&d.toolbar.element.getBoundingClientRect().top===0){var w=Math.max(window.scrollY-d.element.offsetTop-8,Math.min(b-d.wysiwyg.element.scrollTop,m.element.clientHeight-21))+"px";m.popover.style.display==="block"&&(m.popover.style.top=w),m.selectPopover.style.display==="block"&&(m.selectPopover.style.top=w)}return}else if(!d.options.toolbarConfig.pin)return;var C=Math.max(b,window.scrollY-d.element.offsetTop-8)+"px";m.popover.style.display==="block"&&(m.popover.style.top=C),m.selectPopover.style.display==="block"&&(m.selectPopover.style.top=C)}}),this.element.addEventListener("scroll",function(){if(M(d,["hint"]),d.options.comment&&d.options.comment.enable&&d.options.comment.scroll&&d.options.comment.scroll(d.wysiwyg.element.scrollTop),m.popover.style.display==="block"){var b=parseInt(m.popover.getAttribute("data-top"),10)-d.wysiwyg.element.scrollTop,w=-8;d.options.toolbarConfig.pin&&d.toolbar.element.getBoundingClientRect().top===0&&(w=window.scrollY-d.element.offsetTop+w);var C=Math.max(w,Math.min(b,m.element.clientHeight-21))+"px";m.popover.style.top=C,m.selectPopover.style.top=C}}),this.element.addEventListener("paste",function(b){Dp(d,b,{pasteCode:function(w){var C=(0,j.zh)(d),E=document.createElement("template");E.innerHTML=w,C.insertNode(E.content.cloneNode(!0));var O=(0,S.a1)(C.startContainer,"data-block","0");O?O.outerHTML=d.lute.SpinVditorDOM(O.outerHTML):d.wysiwyg.element.innerHTML=d.lute.SpinVditorDOM(d.wysiwyg.element.innerHTML),(0,j.ib)(d.wysiwyg.element,C)}})}),this.element.addEventListener("compositionstart",function(){m.composingLock=!0}),this.element.addEventListener("compositionend",function(b){var w=(0,A.W)(getSelection().getRangeAt(0).startContainer);if(w&&w.textContent===""){Ze(d);return}(0,p.vU)()||Il(d,getSelection().getRangeAt(0).cloneRange(),b),m.composingLock=!1}),this.element.addEventListener("input",function(b){if(!(b.inputType==="deleteByDrag"||b.inputType==="insertFromDrop")){if(m.preventInput){m.preventInput=!1,ye(d);return}if(m.composingLock||b.data===""||b.data===""||b.data===""){ye(d);return}var w=getSelection().getRangeAt(0),C=(0,S.F9)(w.startContainer);if(C||(gn(d,w),C=(0,S.F9)(w.startContainer)),!!C){for(var E=(0,j.im)(C,d.wysiwyg.element,w).start,O=!0,D=E-1;D>C.textContent.substr(0,E).lastIndexOf(`
`);D--)if(C.textContent.charAt(D)!==" "&&C.textContent.charAt(D)!=="	"){O=!1;break}E===0&&(O=!1);for(var L=!0,D=E-1;D<C.textContent.length;D++)if(C.textContent.charAt(D)!==" "&&C.textContent.charAt(D)!==`
`){L=!1;break}L&&/^#{1,6} $/.test(C.textContent)&&(L=!1);var P=(0,A.W)(getSelection().getRangeAt(0).startContainer);if(P&&P.textContent===""&&(Ze(d),P.remove()),O&&C.getAttribute("data-type")!=="code-block"||L||Ry(C.innerHTML)||Ny(C.innerHTML)&&C.previousElementSibling){typeof d.options.input=="function"&&d.options.input(c(d));return}b.inputType==="insertParagraph"&&m.element.innerHTML==="<p><br></p><p><br></p>"&&C.previousElementSibling.remove(),Il(d,w,b)}}}),this.element.addEventListener("click",function(b){if(b.target.tagName==="INPUT"){var w=b.target;w.checked?w.setAttribute("checked","checked"):w.removeAttribute("checked"),m.preventInput=!0,getSelection().rangeCount>0&&(0,j.Hc)(getSelection().getRangeAt(0)),ye(d);return}if(b.target.tagName==="IMG"&&!b.target.parentElement.classList.contains("vditor-wysiwyg__preview")){b.target.getAttribute("data-type")==="link-ref"?rs(d,b.target):an(b,d);return}var C=(0,S.lG)(b.target,"A");if(C){d.options.link.click?d.options.link.click(C):d.options.link.isOpen&&window.open(C.getAttribute("href")),b.preventDefault();return}var E=(0,j.zh)(d);if(b.target.isEqualNode(m.element)&&m.element.lastElementChild&&E.collapsed){var O=m.element.lastElementChild.getBoundingClientRect();b.y>O.top+O.height&&(m.element.lastElementChild.tagName==="P"&&m.element.lastElementChild.textContent.trim().replace(l.g.ZWSP,"")===""?(E.selectNodeContents(m.element.lastElementChild),E.collapse(!1)):(m.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(l.g.ZWSP,"<wbr></p>")),(0,j.ib)(m.element,E)))}zn(d);var D=(0,S.fb)(b.target,"vditor-wysiwyg__preview");D||(D=(0,S.fb)((0,j.zh)(d).startContainer,"vditor-wysiwyg__preview")),D&&yn(D,d),sn(b,d)}),this.element.addEventListener("keyup",function(b){if(!(b.isComposing||(0,p.yl)(b))){b.key==="Enter"&&zt(d),(b.key==="Backspace"||b.key==="Delete")&&d.wysiwyg.element.innerHTML!==""&&d.wysiwyg.element.childNodes.length===1&&d.wysiwyg.element.firstElementChild&&d.wysiwyg.element.firstElementChild.tagName==="P"&&d.wysiwyg.element.firstElementChild.childElementCount===0&&(d.wysiwyg.element.textContent===""||d.wysiwyg.element.textContent===`
`)&&(d.wysiwyg.element.innerHTML="");var w=(0,j.zh)(d);if(b.key==="Backspace"&&(0,p.vU)()&&w.startContainer.textContent===`
`&&w.startOffset===1&&(w.startContainer.textContent=""),gn(d,w),zn(d),!(b.key!=="ArrowDown"&&b.key!=="ArrowRight"&&b.key!=="Backspace"&&b.key!=="ArrowLeft"&&b.key!=="ArrowUp")){(b.key==="ArrowLeft"||b.key==="ArrowRight")&&d.hint.render(d);var C=(0,S.fb)(w.startContainer,"vditor-wysiwyg__preview");if(!C&&w.startContainer.nodeType!==3&&w.startOffset>0){var E=w.startContainer;E.classList.contains("vditor-wysiwyg__block")&&(C=E.lastElementChild)}if(C){var O=C.previousElementSibling;if(O.style.display==="none"){b.key==="ArrowDown"||b.key==="ArrowRight"?yn(C,d):yn(C,d,!1);return}var D=C.previousElementSibling;if(D.tagName==="PRE"&&(D=D.firstElementChild),b.key==="ArrowDown"||b.key==="ArrowRight"){var E=C.parentElement,L=hn(E);if(L&&L.nodeType!==3){var P=L.querySelector(".vditor-wysiwyg__preview");if(P){yn(P,d);return}}if(L.nodeType===3){for(;L.textContent.length===0&&L.nextSibling;)L=L.nextSibling;w.setStart(L,1)}else w.setStart(L.firstChild,0)}else w.selectNodeContents(D),w.collapse(!1)}}}})},h}(),b3=function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(b[C]=w[C])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function b(){this.constructor=d}d.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}}(),w3=function(h){b3(d,h);function d(m,b){var w=h.call(this)||this;if(w.isDestroyed=!1,w.version=l.H,typeof m=="string"){if(b?b.cache?b.cache.id||(b.cache.id="vditor".concat(m)):b.cache={id:"vditor".concat(m)}:b={cache:{id:"vditor".concat(m)}},!document.getElementById(m))return w.showErrorTip("Failed to get element by id: ".concat(m)),w;m=document.getElementById(m)}var C=new g3(b),E=C.merge();if(E.i18n)window.VditorI18n=E.i18n,w.init(m,E);else if(["de_DE","en_US","es_ES","fr_FR","ja_JP","ko_KR","pt_BR","ru_RU","sv_SE","vi_VN","zh_CN","zh_TW"].includes(E.lang)){var O="vditorI18nScript",D=O+E.lang;document.querySelectorAll('head script[id^="'.concat(O,'"]')).forEach(function(L){L.id!==D&&document.head.removeChild(L)}),(0,u.G)("".concat(E.cdn,"/dist/js/i18n/").concat(E.lang,".js"),D).then(function(){w.init(m,E)}).catch(function(L){w.showErrorTip("GET ".concat(E.cdn,"/dist/js/i18n/").concat(E.lang,".js net::ERR_ABORTED 404 (Not Found)"))})}else throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");return w}return d.prototype.showErrorTip=function(m){var b=new ix;document.body.appendChild(b.element),b.show(m,0)},d.prototype.updateToolbarConfig=function(m){this.vditor.toolbar.updateConfig(this.vditor,m)},d.prototype.setTheme=function(m,b,w,C){this.vditor.options.theme=m,Y(this.vditor),b&&(this.vditor.options.preview.theme.current=b,(0,q.Z)(b,C||this.vditor.options.preview.theme.path)),w&&(this.vditor.options.preview.hljs.style=w,(0,sx.Y)(w,this.vditor.options.cdn))},d.prototype.getValue=function(){return c(this.vditor)},d.prototype.getCurrentMode=function(){return this.vditor.currentMode},d.prototype.focus=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.focus():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.focus():this.vditor.currentMode==="ir"&&this.vditor.ir.element.focus()},d.prototype.blur=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.blur():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.blur():this.vditor.currentMode==="ir"&&this.vditor.ir.element.blur()},d.prototype.disabled=function(){M(this.vditor,["subToolbar","hint","popover"]),k(this.vditor.toolbar.elements,l.g.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},d.prototype.enable=function(){v(this.vditor.toolbar.elements,l.g.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},d.prototype.getSelection=function(){if(this.vditor.currentMode==="wysiwyg")return Di(this.vditor.wysiwyg.element);if(this.vditor.currentMode==="sv")return Di(this.vditor.sv.element);if(this.vditor.currentMode==="ir")return Di(this.vditor.ir.element)},d.prototype.renderPreview=function(m){this.vditor.preview.render(this.vditor,m)},d.prototype.getCursorPosition=function(){return(0,j.Ny)(this.vditor[this.vditor.currentMode].element)},d.prototype.isUploading=function(){return this.vditor.upload.isUploading},d.prototype.clearCache=function(){this.vditor.options.cache.enable&&(0,p.pK)()&&localStorage.removeItem(this.vditor.options.cache.id)},d.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},d.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},d.prototype.html2md=function(m){return this.vditor.lute.HTML2Md(m)},d.prototype.exportJSON=function(m){return this.vditor.lute.RenderJSON(m)},d.prototype.getHTML=function(){return nx(this.vditor)},d.prototype.tip=function(m,b){this.vditor.tip.show(m,b)},d.prototype.setPreviewMode=function(m){Hy(m,this.vditor)},d.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},d.prototype.updateValue=function(m){document.execCommand("insertHTML",!1,m)},d.prototype.insertValue=function(m,b){b===void 0&&(b=!0);var w=(0,j.zh)(this.vditor);w.collapse(!0);var C=document.createElement("template");C.innerHTML=m,w.insertNode(C.content.cloneNode(!0)),w.collapse(!1),this.vditor.currentMode==="sv"?(this.vditor.sv.preventInput=!0,b&&H(this.vditor)):this.vditor.currentMode==="wysiwyg"?b&&Il(this.vditor,getSelection().getRangeAt(0)):this.vditor.currentMode==="ir"&&(this.vditor.ir.preventInput=!0,b&&Nt(this.vditor,getSelection().getRangeAt(0),!0))},d.prototype.insertMD=function(m){this.vditor.currentMode==="ir"?(0,j.oC)(this.vditor.lute.Md2VditorIRDOM(m),this.vditor):this.vditor.currentMode==="wysiwyg"?(0,j.oC)(this.vditor.lute.Md2VditorDOM(m),this.vditor):F(this.vditor,m),this.vditor.outline.render(this.vditor),ht(this.vditor)},d.prototype.setValue=function(m,b){var w=this;b===void 0&&(b=!1),this.vditor.currentMode==="sv"?(this.vditor.sv.element.innerHTML="<div data-block='0'>".concat(this.vditor.lute.SpinVditorSVDOM(m),"</div>"),ut(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})):this.vditor.currentMode==="wysiwyg"?Bs(this.vditor,m,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(m),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(C){He(C,w.vditor)}),$s(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),m||(M(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),b&&this.clearStack()},d.prototype.insertEmptyBlock=function(m){Nl(this.vditor,m)},d.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},d.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style");var m=document.getElementById("vditorIconScript");m&&m.remove(),this.clearCache(),ce(),this.vditor.wysiwyg.unbindListener(),this.vditor.options.after=void 0,this.isDestroyed=!0},d.prototype.getCommentIds=function(){return this.vditor.currentMode!=="wysiwyg"?[]:this.vditor.wysiwyg.getComments(this.vditor,!0)},d.prototype.hlCommentIds=function(m){if(this.vditor.currentMode==="wysiwyg"){var b=function(w){w.classList.remove("vditor-comment--hover"),m.forEach(function(C){w.getAttribute("data-cmtids").indexOf(C)>-1&&w.classList.add("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(w){b(w)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(w){b(w)})}},d.prototype.unHlCommentIds=function(m){if(this.vditor.currentMode==="wysiwyg"){var b=function(w){m.forEach(function(C){w.getAttribute("data-cmtids").indexOf(C)>-1&&w.classList.remove("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(w){b(w)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(w){b(w)})}},d.prototype.removeCommentIds=function(m){var b=this;if(this.vditor.currentMode==="wysiwyg"){var w=function(C,E){var O=C.getAttribute("data-cmtids").split(" ");O.find(function(D,L){if(D===E)return O.splice(L,1),!0}),O.length===0?(C.outerHTML=C.innerHTML,(0,j.zh)(b.vditor).collapse(!0)):C.setAttribute("data-cmtids",O.join(" "))};m.forEach(function(C){b.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(E){w(E,C)}),b.vditor.preview.element.style.display!=="none"&&b.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(E){w(E,C)})}),ye(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})}},d.prototype.init=function(m,b){var w=this;this.isDestroyed||(this.vditor={currentMode:b.mode,element:m,hint:new cP(b.hint.extend),lute:void 0,options:b,originalInnerHTML:m.innerHTML,outline:new hP(window.VditorI18n.outline),tip:new ix},this.vditor.sv=new gP(this.vditor),this.vditor.undo=new p3,this.vditor.wysiwyg=new y3(this.vditor),this.vditor.ir=new uP(this.vditor),this.vditor.toolbar=new h3(this.vditor),b.resize.enable&&(this.vditor.resize=new mP(this.vditor)),this.vditor.toolbar.elements.devtools&&(this.vditor.devtools=new f),(b.upload.url||b.upload.handler)&&(this.vditor.upload=new Ll),(0,u.G)(b._lutePath||"".concat(b.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){w.vditor.lute=(0,fP.X)({autoSpace:w.vditor.options.preview.markdown.autoSpace,gfmAutoLink:w.vditor.options.preview.markdown.gfmAutoLink,codeBlockPreview:w.vditor.options.preview.markdown.codeBlockPreview,emojiSite:w.vditor.options.hint.emojiPath,emojis:w.vditor.options.hint.emoji,fixTermTypo:w.vditor.options.preview.markdown.fixTermTypo,footnotes:w.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:w.vditor.options.preview.math.inlineDigit,linkBase:w.vditor.options.preview.markdown.linkBase,linkPrefix:w.vditor.options.preview.markdown.linkPrefix,listStyle:w.vditor.options.preview.markdown.listStyle,mark:w.vditor.options.preview.markdown.mark,mathBlockPreview:w.vditor.options.preview.markdown.mathBlockPreview,paragraphBeginningSpace:w.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:w.vditor.options.preview.markdown.sanitize,toc:w.vditor.options.preview.markdown.toc}),w.vditor.preview=new pP(w.vditor),Q(w.vditor),b.after&&b.after(),b.icon&&(0,u.J)("".concat(b.cdn,"/dist/js/icons/").concat(b.icon,".js"),"vditorIconScript")}))},d}(o.default);const v3=w3})(),s=s.default,s})()})})(rP);var Vte=rP.exports;const Fte=_3(Vte),iP=un.forwardRef(({note:n,onClose:e,onSave:t,isSaving:r=!1,showToolbar:i=!0,toolbarTitle:s,toolbarButtons:o,editorId:l="note-editor",className:a="",vditorToolbar:c="full"},u)=>{const{t:f}=M3(),{auth:p}=T3(),[g,y]=un.useState(),v=un.useRef(null),[k,x]=un.useState(!1),[_,M]=un.useState((n==null?void 0:n.title)||""),T=un.useRef(null);un.useEffect(()=>{M((n==null?void 0:n.title)||"")},[n==null?void 0:n.title]);const S=()=>{switch(c){case"simple":return["headings","bold","italic","list","quote","|","link","code","upload","|","undo","redo"];case"minimal":return["bold","italic","upload","|","undo","redo"];case"full":default:return}},A=()=>({delay:200,extend:[{key:"#",hint:async oe=>{if(oe.length<1)return[];try{return(await Hte({keyword:oe,rows:10})).map(ve=>{var Te;let ke=ve.tag_path;for(;ke.length>0&&(ke[0]==="/"||ke[0]==="#");)ke=ke.substring(1);ke===""&&(ke="");const Se=ke===""?ve.tag_name:ke+"/"+ve.tag_name;return{value:`#${Se}  `,html:`<span style="color: ${((Te=ve.ext_data)==null?void 0:Te.color)||"#1890ff"}">#${Se}</span>`}})}catch(ne){return console.error(":",ne),[]}}}]});un.useEffect(()=>{const oe=setTimeout(()=>{const ne=S(),ve=A(),ke={height:"100%",placeholder:f("notes.noteContentPlaceholder"),hint:ve,upload:{url:"/api/v1/utils/upload/files",accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.zip,.rar",fieldName:"files",max:50*1024*1024,multiple:!0,withCredentials:!0,headers:p.accessToken?{Authorization:`Bearer ${p.accessToken}`}:{},filename:Te=>Te.replace(/[\\/:*?"<>|]/g,""),format:(Te,Ge)=>{try{const Xe=JSON.parse(Ge);if(console.log(" :",Xe),Xe.code!==201&&Xe.code!==200)return console.error(" :",Xe.message||Xe.msg),JSON.stringify({msg:Xe.message||Xe.msg||"",code:1,data:{errFiles:Te.map(Ze=>Ze.name),succMap:{}}});const He={};Array.isArray(Xe.data)&&Xe.data.forEach(Ze=>{const sn=Ze.file_path||Ze.oss_url,st=Ze.original_filename;console.log(" :",{original_filename:st,file_path:Ze.file_path,oss_url:Ze.oss_url,fileUrl:sn}),sn&&st&&(He[st]=sn)}),console.log("  succMap:",He);const j=JSON.stringify({msg:"",code:0,data:{errFiles:[],succMap:He}});return console.log("  Vditor :",j),j}catch(Xe){return console.error(" :",Xe),JSON.stringify({msg:"",code:1,data:{errFiles:Te.map(He=>He.name),succMap:{}}})}},error:Te=>{console.error(" :",Te)}},after:()=>{Se.setValue((n==null?void 0:n.content)||""),y(Se)}};ne&&(ke.toolbar=ne);const Se=new Fte(l,ke)},0);return()=>{clearTimeout(oe),g&&(g.destroy(),y(void 0))}},[n==null?void 0:n.content,f,l,c,p.accessToken]);const I=()=>{x(!0),setTimeout(()=>{var oe,ne;(oe=T.current)==null||oe.focus(),(ne=T.current)==null||ne.select()},0)},B=()=>{x(!1)},R=oe=>{var ne;oe.key==="Enter"&&(oe.preventDefault(),(ne=T.current)==null||ne.blur())},K=()=>{const oe=(g==null?void 0:g.getValue())||"";oe.trim()&&(t==null||t(oe.trim(),_))},U=()=>{e==null||e()};un.useImperativeHandle(u,()=>({getContent:()=>(g==null?void 0:g.getValue())||"",setContent:oe=>g==null?void 0:g.setValue(oe),getTitle:()=>_}),[g,_]);const z=wt.jsxs(wt.Fragment,{children:[wt.jsxs(Eg,{onClick:K,disabled:r,size:"sm",children:[r?wt.jsx(yA,{className:"h-4 w-4 animate-spin"}):wt.jsx(xA,{className:"h-4 w-4"}),""]}),wt.jsxs(Eg,{onClick:U,variant:"ghost",size:"sm",children:[wt.jsx(bA,{className:"h-4 w-4"}),""]})]});return wt.jsxs("div",{className:`h-full w-full flex flex-col ${a}`,children:[i&&wt.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-background",children:[wt.jsx("div",{className:"flex items-center space-x-2 flex-1 mr-4 min-w-0",children:k?wt.jsx(gA,{ref:T,value:_,onChange:oe=>M(oe.target.value),onBlur:B,onKeyDown:R,className:"text-sm font-semibold h-6 max-w-xs border-0 shadow-none focus-visible:ring-0 px-1",placeholder:""}):wt.jsxs("div",{className:"flex items-center space-x-2 group cursor-pointer min-w-0",onClick:I,children:[wt.jsx("h3",{className:"text-lg font-semibold truncate max-w-md",children:s||_||(n?"":"")}),wt.jsx(SA,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"})]})}),wt.jsx("div",{className:"flex items-center space-x-2",children:o||z})]}),wt.jsx("div",{className:"flex-1 overflow-hidden",children:wt.jsx("div",{ref:v,id:l,className:"vditor h-full",style:{border:"none",boxShadow:"none"}})})]})});iP.displayName="VditorEditor";const jte=un.forwardRef(({editorType:n="milkdown",mode:e,...t},r)=>n==="vditor"?wt.jsx(iP,{ref:r,...t}):wt.jsx(nP,{ref:r,mode:e,...t}));jte.displayName="NoteEditor";export{Iu as A,HN as B,Ute as C,O8 as D,Re as E,ln as F,aH as G,bi as H,fn as I,N0 as J,ta as K,aw as L,G as M,jte as N,cw as O,GA as P,Jt as T,XB as a,cne as b,ine as c,gY as d,er as e,cH as f,fne as g,Iv as h,OO as i,ai as j,pt as k,rne as l,nne as m,sne as n,Gte as o,une as p,Jte as q,re as r,WB as s,ee as t,IH as u,JB as v,EO as w,mi as x,Du as y,Cl as z};

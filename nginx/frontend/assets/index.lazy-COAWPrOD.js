import{c as C,ap as Q,u as je,a as ge,r as x,b as J,j as e,H as He,s as Re,t as qe,E as h,B as b,C as Ae,v as Ie,J as Ke,S as Be,I as Qe,i as ue,$ as he,D as Je,d as Ze,e as Ge,f as Xe,M as Ye,w as Ue}from"./index-CTPVv2qI.js";import{M as We}from"./main-CdabfA0i.js";import{u as es,a as ss}from"./use-infinite-scroll-BdHXd_Cp.js";import{g as as,V as ts,s as ns}from"./notes-view-storage-izKA1eKT.js";import{T as rs,a as is,b as pe,c as y,d as ls,e as w}from"./table-Pbk4v1eF.js";import{f as F}from"./time-format-B1EfeAID.js";import{C as Z}from"./checkbox-B8lOC6Cy.js";import{C as cs}from"./calendar-ODBYeOZb.js";import{D as os}from"./download-DUCZcQ95.js";import{E as _}from"./eye-CrEdTXEF.js";import{S as q,a as A,b as I,c as K,d as B}from"./select-BxdJP45j.js";import{P as ds,a as ms,b as xs}from"./popover-CbUg7TCx.js";import{R as us,a as fe,b as hs}from"./resizable-uvdkuyco.js";import{N as ps}from"./NoteEditor-eXmSlbk5.js";import{S as fs}from"./sticky-note-gfnjJFSD.js";import{E as js}from"./external-link-BTxRf4N8.js";import{C as gs}from"./clock-DWJkb9W8.js";import"./index-DOFEKLPp.js";import"./chevron-down-B6oOayy8.js";import"./index-CagKKcNF.js";import"./save-CysiHy1C.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=C("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=C("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=C("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=C("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=C("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=C("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]),we=20,be={getPage:async t=>{const l=Object.fromEntries(Object.entries(t).filter(([i,n])=>n!==void 0));return(await Q.post("/note/collect/page",l)).data},update:async(t,l)=>(await Q.post(`/note/collect/update/${t}`,l)).data},ys=async({pageParam:t=1,keyword:l,platform:o,contentType:i,status:n,categories:d})=>{const v={page:t,rows:we,...(l==null?void 0:l.trim())&&{keyword:l.trim()},...o&&o!=="all"&&{platform:o},...i&&i!=="all"&&{content_type:i},...n&&n!=="all"&&{status:n},...d&&d.length>0&&{categories:d}},{data:p}=await Q.post("/note/collect/page",v);return{data:p.items,count:p.pagination.total}};function _e({collect:t,children:l}){const o=je(),{toast:i}=ge(),n=["收藏","优质","选题","无效"],[d,v]=x.useState(()=>{var r;return((r=t.category)==null?void 0:r.main)||[]});x.useEffect(()=>{var s;const r=((s=t.category)==null?void 0:s.main)||[];v(r)},[t.category]);const p=J({mutationFn:r=>be.update(t.uuid,r),onSuccess:()=>{o.invalidateQueries({predicate:r=>r.queryKey[0]==="collects-infinite"}),i({title:"保存成功",description:"分类已更新"})},onError:()=>{i({title:"保存失败",description:"分类更新失败，请重试",variant:"destructive"})}}),$=(r,s)=>{const S=s?[...d,r]:d.filter(z=>z!==r);v(S),p.mutate({category:{main:S}})},f=r=>r?r>=1e4?`${(r/1e4).toFixed(1)}万`:r>=1e3?`${(r/1e3).toFixed(1)}K`:r.toString():"0",D={douyin:"抖音",youtube:"YouTube",xiaohongshu:"小红书",weixin:"微信","x.com":"X.com",other:"其他"},M={video:"视频",article:"文章",image:"图片",audio:"音频",card:"卡片"};return e.jsxs(He,{children:[e.jsx(Re,{asChild:!0,children:l}),e.jsx(qe,{className:"w-80 max-h-96 overflow-y-auto",side:"left",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.author_name&&e.jsx(h,{variant:"secondary",className:"text-xs",children:t.author_name}),e.jsx(h,{variant:"secondary",className:"text-xs",children:D[t.platform]||t.platform}),t.content_type&&e.jsx(h,{variant:"secondary",className:"text-xs",children:M[t.content_type]||t.content_type}),t.source_url&&e.jsx("a",{href:t.source_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline ml-auto",onClick:r=>r.stopPropagation(),children:"查看原文 →"})]}),e.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 rounded p-2",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(cs,{className:"h-3 w-3"}),e.jsx("span",{children:t.publish_time?F(t.publish_time):"-"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(os,{className:"h-3 w-3"}),e.jsx("span",{children:F(t.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ns,{className:"h-3 w-3"}),e.jsx("span",{children:F(t.updated_at)})]}),e.jsx("span",{children:t.status==="active"?"正常":t.status})]})}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[t.view_count!==null&&t.view_count!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-3 w-3"}),e.jsx("span",{children:f(t.view_count)})]}),t.like_count!==null&&t.like_count!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"h-3 w-3"}),e.jsx("span",{children:f(t.like_count)})]}),t.comment_count!==null&&t.comment_count!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{children:f(t.comment_count)})]}),t.share_count!==null&&t.share_count!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsx("span",{children:f(t.share_count)})]}),t.collect_count!==null&&t.collect_count!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"h-3 w-3"}),e.jsx("span",{children:f(t.collect_count)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",onClick:r=>r.stopPropagation(),children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"分类:"}),e.jsx("div",{className:"flex items-center gap-2",children:n.map(r=>e.jsxs("div",{className:"flex items-center gap-1",onClick:s=>s.stopPropagation(),children:[e.jsx(Z,{id:`category-${t.uuid}-${r}`,checked:d.includes(r),onCheckedChange:s=>$(r,!!s),disabled:p.isPending}),e.jsx("label",{htmlFor:`category-${t.uuid}-${r}`,className:"text-xs text-gray-600 cursor-pointer select-none",onClick:s=>s.stopPropagation(),children:r})]},r))})]}),t.title&&e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:t.title}),t.description&&e.jsx("p",{className:"text-sm text-gray-700",children:t.description}),t.cn_content&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("div",{className:"font-medium mb-1",children:"中文内容:"}),e.jsx("p",{className:"whitespace-pre-wrap",children:t.cn_content})]}),e.jsxs("div",{className:"pt-3 border-t space-y-2",children:[t.category&&Object.keys(t.category).length>0&&e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"分类: "}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Object.entries(t.category).map(([r,s])=>e.jsxs(h,{variant:"outline",className:"text-xs",children:[r,": ",String(s)]},r))})]}),t.tags&&Object.keys(t.tags).length>0&&e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"标签: "}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Object.entries(t.tags).map(([r,s])=>e.jsxs(h,{variant:"secondary",className:"text-xs",children:[r,": ",String(s)]},r))})]})]})]})})]})}function ws({collects:t,onCollectClick:l}){const o=n=>n?n>=1e4?`${(n/1e4).toFixed(1)}万`:n>=1e3?`${(n/1e3).toFixed(1)}K`:n.toString():"0",i={douyin:"抖音",youtube:"YouTube",xiaohongshu:"小红书",weixin:"微信","x.com":"X.com",other:"其他"};return e.jsx("div",{className:"w-full",children:e.jsxs(rs,{children:[e.jsx(is,{children:e.jsxs(pe,{children:[e.jsx(y,{className:"w-[55%]",children:"标题"}),e.jsx(y,{className:"w-[8%] min-w-[80px]",children:"作者"}),e.jsx(y,{className:"w-[8%] text-center min-w-[80px]",children:"平台"}),e.jsx(y,{className:"w-[19%] text-center min-w-[140px]",children:"互动数据"}),e.jsx(y,{className:"w-[10%] text-center min-w-[100px]",children:"发布时间"}),e.jsx(y,{className:"w-[5%] text-center min-w-[60px]"})]})}),e.jsx(ls,{children:t.map(n=>e.jsxs(pe,{className:"cursor-pointer hover:bg-muted/50 group",onClick:()=>{l&&l(n)},children:[e.jsx(w,{className:"w-[55%]",children:n.title?e.jsx("div",{className:"line-clamp-2 text-sm text-foreground/90 hover:text-primary",children:n.title}):n.description?e.jsx("div",{className:"line-clamp-2 text-sm text-muted-foreground hover:text-primary",children:n.description}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"-"})}),e.jsx(w,{className:"w-[8%] min-w-[80px]",children:e.jsx("div",{className:"text-sm text-muted-foreground truncate",children:n.author_name||"-"})}),e.jsx(w,{className:"w-[8%] text-center min-w-[80px]",onClick:d=>d.stopPropagation(),children:e.jsx(h,{variant:"secondary",className:"text-xs",children:i[n.platform]||n.platform})}),e.jsx(w,{className:"w-[19%] text-center min-w-[140px]",onClick:d=>d.stopPropagation(),children:e.jsxs("div",{className:"flex items-center justify-center gap-3 text-xs text-muted-foreground",children:[n.view_count!==null&&n.view_count!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-3 w-3"}),e.jsx("span",{children:o(n.view_count)})]}),n.like_count!==null&&n.like_count!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"h-3 w-3"}),e.jsx("span",{children:o(n.like_count)})]}),n.comment_count!==null&&n.comment_count!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{children:o(n.comment_count)})]})]})}),e.jsx(w,{className:"text-sm text-muted-foreground w-[10%] text-center min-w-[100px] whitespace-nowrap",onClick:d=>d.stopPropagation(),children:n.publish_time?F(n.publish_time):"-"}),e.jsx(w,{className:"w-[5%] min-w-[60px]",onClick:d=>d.stopPropagation(),children:e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1",children:e.jsx(_e,{collect:n,children:e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:d=>{d.stopPropagation(),l&&l(n)},children:e.jsx(_,{className:"h-4 w-4"})})})})})]},n.uuid))})]})})}function bs({collects:t,onCollectClick:l}){const o=i=>i?i>=1e4?`${(i/1e4).toFixed(1)}万`:i>=1e3?`${(i/1e3).toFixed(1)}K`:i.toString():"0";return e.jsx("div",{className:"grid gap-3 grid-cols-5",children:t.map(i=>e.jsxs(Ae,{className:"group cursor-pointer hover:shadow-md transition-all duration-200 hover:border-gray-300 flex flex-col h-[260px] bg-white border border-gray-200 rounded-lg overflow-hidden relative",onClick:()=>{l&&l(i)},children:[e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:e.jsx(_e,{collect:i,children:e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:n=>{n.stopPropagation(),l&&l(i)},children:e.jsx(_,{className:"h-4 w-4"})})})}),e.jsxs(Ie,{className:"p-4 flex-1 flex flex-col overflow-hidden",children:[i.title&&e.jsx("h3",{className:"font-medium text-sm mb-2 line-clamp-2 text-gray-900 hover:text-primary",children:i.title}),i.description&&e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2 mb-3 flex-1",children:i.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mt-2 rounded-md px-2 py-1",children:[e.jsx("div",{children:F(i.created_at)}),e.jsxs("div",{className:"flex items-center gap-3",children:[i.platform&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{children:i.platform})}),i.view_count!==null&&i.view_count!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-3 w-3"}),e.jsx("span",{children:o(i.view_count)})]})]})]})]})]},i.uuid))})}function P(t,l){const[o,i]=x.useState(t);return x.useEffect(()=>{const n=setTimeout(()=>{i(t)},l);return()=>{clearTimeout(n)}},[t,l]),o}function _s(){var me,xe;const{t}=Ke(),l=je(),{toast:o}=ge(),[i,n]=x.useState(""),[d,v]=x.useState("all"),[p,$]=x.useState("all"),[f,D]=x.useState("all"),[M,r]=x.useState("card"),[s,S]=x.useState(null),[z,X]=x.useState(!1),[L,V]=x.useState(!1),Ce=x.useRef(null),[Se,H]=x.useState(!1),ke=["收藏","优质","选题","无效"],[j,R]=x.useState([]),Te=["收藏","优质","选题","无效"],[E,Y]=x.useState([]),g=P(i,500),U=P(d,300),W=P(p,300),ee=P(f,300),se=P(j,300);x.useEffect(()=>{const a=as("card");r(a)},[]);const Pe=a=>{r(a),ns(a)},{data:u,isLoading:ae,error:Cs,fetchNextPage:te,hasNextPage:ne,isFetchingNextPage:re}=es({queryKey:["collects-infinite",g,U,W,ee,se],queryFn:({pageParam:a=1})=>ys({pageParam:a,keyword:g,platform:U,contentType:W,status:ee,categories:se}),initialPageParam:1,getNextPageParam:(a,c)=>{if(a.data.length===we)return c.length+1},staleTime:0,refetchOnMount:!0,refetchOnWindowFocus:!0}),k=x.useMemo(()=>(u==null?void 0:u.pages.flatMap(a=>a.data))||[],[u]),{loadMoreRef:Fe}=ss({hasNextPage:ne,isFetchingNextPage:re,fetchNextPage:te,threshold:200}),ie=a=>{var c;S(a),X(!0),V(!1),Y(((c=a.category)==null?void 0:c.main)||[])},Me=()=>{V(!L)},Ee=a=>{X(a),a||V(!1)},Oe=J({mutationFn:Ye.create,onSuccess:()=>{l.invalidateQueries({predicate:a=>{const c=a.queryKey[0];return c==="notes"||c==="notes-infinite"}}),H(!1),o({title:"保存成功",description:"笔记已成功保存"})},onError:()=>{H(!1),o({title:"保存失败",description:"笔记保存失败，请重试",variant:"destructive"})}}),le=J({mutationFn:async a=>{const c=await be.update(a.uuid,{category:a.category});return{...a,result:c}},onSuccess:()=>{l.invalidateQueries({predicate:a=>a.queryKey[0]==="collects-infinite"}),s&&S({...s,category:{...s.category,main:E}}),o({title:"保存成功",description:"分类已更新"})},onError:()=>{o({title:"保存失败",description:"分类更新失败，请重试",variant:"destructive"})}}),$e=(a,c)=>{const m=c?[...E,a]:E.filter(N=>N!==a);Y(m),s&&le.mutate({uuid:s.uuid,category:{main:m}})},De=a=>{a.trim()&&(H(!0),Oe.mutate({title:"",content:a.trim(),status:1}))},ce=[{value:"all",label:"全部平台"},{value:"douyin",label:"抖音"},{value:"youtube",label:"YouTube"},{value:"xiaohongshu",label:"小红书"},{value:"weixin",label:"微信"},{value:"x.com",label:"X.com"},{value:"other",label:"其他"}],oe=[{value:"all",label:"全部类型"},{value:"video",label:"视频"},{value:"article",label:"文章"},{value:"image",label:"图片"},{value:"audio",label:"音频"},{value:"card",label:"卡片"}],ze=[{value:"all",label:"全部状态"},{value:"original-fetch",label:"original-fetch"},{value:"ai-first-filter",label:"ai-first-filter"},{value:"ai-second-filter",label:"ai-second-filter"},{value:"human-review",label:"human-review"},{value:"meaningless-content",label:"meaningless-content"},{value:"topic-selection",label:"topic-selection"},{value:"final-draft",label:"final-draft"}],Le=a=>{if(!a)return null;const c=[];Array.isArray(a)?c.push(...a):Object.entries(a).forEach(([N,O])=>{Array.isArray(O)&&O.forEach(Ve=>{c.push(Ve)})});const m=Array.from(new Set(c));return m.length===0?null:e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map((N,O)=>e.jsx(h,{variant:"outline",children:N},O))})},T=a=>a?a>=1e4?`${(a/1e4).toFixed(1)}万`:a>=1e3?`${(a/1e3).toFixed(1)}K`:a.toString():"0",de=()=>{var a,c;return e.jsxs("div",{className:"h-full overflow-y-auto px-6 pb-6 space-y-6",translate:"yes",children:[(s==null?void 0:s.cover_url)&&e.jsxs("div",{translate:"no",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"封面图"}),e.jsx("img",{src:s.cover_url,alt:s.title,className:"w-full max-h-96 object-contain rounded-lg border"})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",translate:"yes",children:[e.jsx(h,{variant:"secondary",children:((a=ce.find(m=>m.value===s.platform))==null?void 0:a.label)||s.platform}),e.jsx(h,{variant:"outline",children:((c=oe.find(m=>m.value===s.content_type))==null?void 0:c.label)||s.content_type}),e.jsxs(h,{variant:"outline",children:["状态: ",s.status]}),s.author_name&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["作者: ",s.author_name]}),s.author_id&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["作者ID: ",s.author_id]}),s.publish_time&&e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(s.publish_time).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}),s.source_url&&e.jsx("a",{href:s.source_url,target:"_blank",rel:"noopener noreferrer",className:"text-muted-foreground hover:text-primary transition-colors",title:"原文链接",children:e.jsx(js,{className:"h-4 w-4"})})]}),(s==null?void 0:s.description)&&e.jsxs("div",{translate:"yes",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"描述"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs("div",{translate:"yes",className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"分类:"}),e.jsx("div",{className:"flex items-center gap-2",children:Te.map(m=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{id:`category-detail-${s==null?void 0:s.uuid}-${m}`,checked:E.includes(m),onCheckedChange:N=>$e(m,!!N),disabled:le.isPending}),e.jsx("label",{htmlFor:`category-detail-${s==null?void 0:s.uuid}-${m}`,className:"text-sm text-muted-foreground cursor-pointer select-none",children:m})]},m))})]}),(s==null?void 0:s.tags)&&e.jsxs("div",{translate:"yes",className:"flex items-start gap-2 flex-wrap",children:[e.jsx("span",{className:"text-sm font-semibold whitespace-nowrap",children:"标签:"}),Le(s.tags)]}),s&&e.jsxs("div",{translate:"yes",className:"flex items-start gap-2 flex-wrap",children:[e.jsx("span",{className:"text-sm font-semibold whitespace-nowrap",children:"互动数据:"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm",children:[s.view_count!==null&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(_,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:T(s.view_count)})]}),s.like_count!==null&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(vs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:T(s.like_count)})]}),s.comment_count!==null&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(G,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:T(s.comment_count)})]}),s.share_count!==null&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:T(s.share_count)})]}),s.collect_count!==null&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:T(s.collect_count)})]}),s.duration!==null&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(gs,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[s.duration,"秒"]})]}),s.word_count!==null&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(he,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.word_count})]})]})]}),(s==null?void 0:s.cn_content)&&e.jsxs("div",{translate:"yes",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"中文内容"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:s.cn_content})]}),(s==null?void 0:s.en_content)&&e.jsxs("div",{translate:"yes",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"英文内容"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:s.en_content})]}),(s==null?void 0:s.media_urls)&&e.jsxs("div",{translate:"no",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"媒体链接"}),e.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-auto max-h-40",translate:"no",children:JSON.stringify(s.media_urls,null,2)})]}),(s==null?void 0:s.platform_data)&&e.jsxs("div",{translate:"no",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"平台数据"}),e.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-auto max-h-40",translate:"no",children:JSON.stringify(s.platform_data,null,2)})]}),(s==null?void 0:s.metadata)&&e.jsxs("div",{translate:"no",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"元数据"}),e.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-auto max-h-40",translate:"no",children:JSON.stringify(s.metadata,null,2)})]}),s&&e.jsxs("div",{className:"border-t pt-4 space-y-2 text-sm",translate:"yes",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"时间信息"}),s.crawl_time&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"采集时间:"})," ",new Date(s.crawl_time).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"创建时间:"})," ",new Date(s.created_at).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"更新时间:"})," ",new Date(s.updated_at).toLocaleString()]})]}),s&&e.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 text-sm",translate:"yes",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"创建者:"})," ",s.created_by]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"更新者:"})," ",s.updated_by]})]})]})};return e.jsx(e.Fragment,{children:e.jsxs(We,{className:"h-screen",children:[e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex-shrink-0 border-b bg-background",children:e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("h3",{className:"text-2xl font-bold",children:t("collect.title")}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(q,{value:d,onValueChange:v,children:[e.jsx(A,{className:"w-32 h-8 text-sm",children:e.jsx(I,{placeholder:"平台"})}),e.jsx(K,{children:ce.map(a=>e.jsx(B,{value:a.value,children:a.label},a.value))})]}),e.jsxs(q,{value:p,onValueChange:$,children:[e.jsx(A,{className:"w-32 h-8 text-sm",children:e.jsx(I,{placeholder:"类型"})}),e.jsx(K,{children:oe.map(a=>e.jsx(B,{value:a.value,children:a.label},a.value))})]}),e.jsxs(q,{value:f,onValueChange:D,children:[e.jsx(A,{className:"w-32 h-8 text-sm",children:e.jsx(I,{placeholder:"状态"})}),e.jsx(K,{children:ze.map(a=>e.jsx(B,{value:a.value,children:a.label},a.value))})]}),e.jsxs(ds,{children:[e.jsx(ms,{asChild:!0,children:e.jsx(b,{variant:"outline",size:"sm",className:"h-8 text-sm whitespace-nowrap",children:j.length>0?`分类(${j.length})`:"分类"})}),e.jsx(xs,{className:"w-[200px] p-2",align:"start",children:e.jsxs("div",{className:"space-y-2",children:[ke.map(a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{id:`filter-category-${a}`,checked:j.includes(a),onCheckedChange:c=>{R(c?[...j,a]:j.filter(m=>m!==a))}}),e.jsx("label",{htmlFor:`filter-category-${a}`,className:"text-sm cursor-pointer select-none flex-1",children:a})]},a)),j.length>0&&e.jsx("div",{className:"pt-2 border-t",children:e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-full text-xs",onClick:()=>R([]),children:"清除筛选"})})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Qe,{placeholder:t("collect.searchPlaceholder"),value:i,onChange:a=>n(a.target.value),className:"pl-8 h-8 w-48 bg-transparent text-sm"})]}),e.jsx(ts,{currentView:M,onViewChange:Pe})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto pt-0 px-6 pt-6 pb-6",children:[!ae&&e.jsx("div",{className:"mb-6 text-sm text-muted-foreground",children:((xe=(me=u==null?void 0:u.pages)==null?void 0:me[0])==null?void 0:xe.count)&&u.pages[0].count>0&&(g?e.jsxs(e.Fragment,{children:["找到 ",u.pages[0].count,' 个匹配 "',g,'" 的采集']}):e.jsxs(e.Fragment,{children:["共 ",u.pages[0].count," 个采集"]}))}),ae&&k.length===0?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(ue,{className:"h-8 w-8 animate-spin text-gray-400"})}):k.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[e.jsx(he,{className:"h-12 w-12 mb-2"}),e.jsx("p",{className:"text-sm",children:g?`没有找到匹配 "${g}" 的采集`:t("collect.noCollects")})]}):e.jsxs(e.Fragment,{children:[M==="card"?e.jsx(bs,{collects:k,onCollectClick:ie}):e.jsx(ws,{collects:k,onCollectClick:ie}),e.jsx("div",{ref:Fe,className:"mt-8 flex justify-center",children:re?e.jsxs("div",{className:"flex items-center gap-2 py-4",children:[e.jsx(ue,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"加载更多..."})]}):ne?e.jsx("div",{className:"py-4",children:e.jsx(b,{variant:"outline",onClick:()=>te(),className:"text-sm",children:g?"点击加载更多搜索结果":"点击加载更多"})}):k.length>0?e.jsx("div",{className:"py-4 text-center",children:e.jsx("span",{className:"text-sm text-muted-foreground",children:"已到底啦"})}):null})]})]})})]}),e.jsx(Je,{open:z,onOpenChange:Ee,children:e.jsx(Ze,{className:"max-w-[85vw] lg:max-w-2xl max-h-[95vh] flex flex-col p-0",lang:"auto",children:s&&e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"flex-shrink-0 px-6 pt-6 pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xe,{children:s.title||"采集详情"}),e.jsxs(b,{variant:"outline",size:"sm",onClick:Me,className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-4 w-4"}),L?"关闭笔记":"记笔记"]})]})}),L?e.jsxs(us,{direction:"horizontal",className:"flex-1",children:[e.jsx(fe,{defaultSize:50,minSize:30,children:de()}),e.jsx(hs,{withHandle:!0}),e.jsx(fe,{defaultSize:50,minSize:30,children:e.jsx("div",{className:"h-full",children:e.jsx(ps,{ref:Ce,note:null,toolbarTitle:"新建笔记",editorId:"collect-note-editor",className:"h-full",onSave:De,isSaving:Se,vditorToolbar:"simple"})})})]}):de()]})})})]})})}const Js=Ue("/_authenticated_notes/collect/")({component:_s});export{Js as Route};

import{c as Fn,ag as pc,r as g,bf as gh,bg as vh,bh as yh,j as m,bi as Ir,ar as C,bj as xh,bk as wh,bl as on,ai as gc,aj as vc,ak as yc,B as me,Y as je,al as xc,ba as wc,X as bt,C as bc,bm as bh,bn as Eh,bo as Ec,bp as Sc,ae as tn,bq as Sh,v as _c,br as Tc,a9 as Cc,S as Nc,I as gs,i as vs,bs as _h,bt as Js,bu as Lo,V as Th,W as Ch,Z as Nh,$ as vn,a0 as yn,a1 as Bt,a2 as xn,a$ as Ft,a3 as Qs,P as Ac,a as Pc,ad as wt,T as Ah,D as ys,d as xs,e as ws,f as bs,g as Ph,bv as jh,am as jc,an as Rc,ao as kc,aV as Mr,ap as Kt,E as Rh,U as kh,ah as Ih,bw as Mh,L as Do,bx as $h,aq as Lh,w as Dh}from"./index-QCM3tg6T.js";import{C as Vh}from"./chevron-left-DpsKFaBi.js";import{P as Oh}from"./pencil-DNI9aBCu.js";import{C as Bh}from"./copy-CJ7BnBjG.js";import{M as Fh}from"./markdown-text-BgLqbmVy.js";import{P as Hh}from"./play-CYCt0xb0.js";import{C as Uh}from"./chevron-down-BGPTkRL1.js";import{T as $r}from"./textarea-BRLhZEOX.js";import{F as Vo}from"./file-DwiOQTNT.js";import{S as Lr}from"./switch-Dx-NYZfn.js";import{m as Oo,M as zh}from"./model-management-dialog-CRSlihk4.js";import{u as Gh,g as Wh}from"./agent.service-C0eZ1lHN.js";import{a as Kh}from"./use-infinite-scroll-Hevnk5Sy.js";import{T as Xh}from"./tag--qDdG-Qw.js";import{S as Ic}from"./square-pen-BEuFlBVg.js";import{c as Oe,u as Yh,a as Zh,s as Ie,z as Jh,b as Mc,i as nn,p as Qh,d as qh,e as Bo}from"./index-BjuAFcqM.js";import{H as em}from"./header-BrQ_ZiF7.js";import"./setPrototypeOf-BNw_nwy-.js";import"./index-CZ42OGo5.js";import"./eye-5ZjLGcoG.js";import"./checkbox-BToW39pY.js";import"./circle-check-big-OsbAB31v.js";import"./index-DRmllNVT.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=Fn("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Fn("CopyCheck",[["path",{d:"m12 15 2 2 4-4",key:"2c609p"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=Fn("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=Fn("SendHorizontal",[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=Fn("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]),om=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function am(e){return typeof e=="string"&&om.test(e)}const Ae=[];for(let e=0;e<256;++e)Ae.push((e+256).toString(16).slice(1));function lm(e,t=0){return(Ae[e[t+0]]+Ae[e[t+1]]+Ae[e[t+2]]+Ae[e[t+3]]+"-"+Ae[e[t+4]]+Ae[e[t+5]]+"-"+Ae[e[t+6]]+Ae[e[t+7]]+"-"+Ae[e[t+8]]+Ae[e[t+9]]+"-"+Ae[e[t+10]]+Ae[e[t+11]]+Ae[e[t+12]]+Ae[e[t+13]]+Ae[e[t+14]]+Ae[e[t+15]]).toLowerCase()}let qs;const cm=new Uint8Array(16);function um(){if(!qs){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");qs=crypto.getRandomValues.bind(crypto)}return qs(cm)}const dm=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Fo={randomUUID:dm};function fm(e,t,n){var r;e=e||{};const s=e.random??((r=e.rng)==null?void 0:r.call(e))??um();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,lm(s)}function $c(e,t,n){return Fo.randomUUID&&!t&&!e?Fo.randomUUID():fm(e)}function hm(e){return[...new Set(e)]}function mm(e,t){for(let n=e.length-1;n>=0;n-=1)if(t(e[n]))return e[n]}class Dr extends Error{constructor(t){super(t.message),this.name=t.name??t.error??"StreamError"}static isStructuredError(t){return typeof t=="object"&&t!=null&&"message"in t}}function pm(e){var c,d;const t=new Set,n={};if(e.length<=1)return{rootSequence:{type:"sequence",items:e.map(u=>({type:"node",value:u,path:[]}))},paths:[]};e.forEach(u=>{var f,p;const h=((f=u.parent_checkpoint)==null?void 0:f.checkpoint_id)??"$";n[h]??(n[h]=[]),n[h].push(u),((p=u.checkpoint)==null?void 0:p.checkpoint_id)!=null&&t.add(u.checkpoint.checkpoint_id)});const s=(...u)=>u.filter(h=>h!=null).sort((h,f)=>h.localeCompare(f)).at(-1),r=n.$==null?(c=Object.keys(n).filter(u=>!t.has(u)).map(u=>{const h=[u],f=new Set;let p=u;for(;h.length>0;){const v=h.shift();if(f.has(v))continue;f.add(v);const y=(n[v]??[]).flatMap(b=>{var x;return((x=b.checkpoint)==null?void 0:x.checkpoint_id)??[]});p=s(p,...y),h.push(...y)}return{parentId:u,lastId:p}}).sort((u,h)=>u.lastId.localeCompare(h.lastId)).at(-1))==null?void 0:c.parentId:void 0;r!=null&&(n.$=n[r]);const i={type:"sequence",items:[]},o=[{id:"$",sequence:i,path:[]}],a=[],l=new Set;for(;o.length>0;){const u=o.shift();if(l.has(u.id))continue;l.add(u.id);const h=n[u.id];if(h==null||h.length===0)continue;let f;h.length>1&&(f={type:"fork",items:[]},u.sequence.items.push(f));for(const p of h){const v=(d=p.checkpoint)==null?void 0:d.checkpoint_id;if(v==null)continue;let{sequence:y}=u,{path:b}=u;f!=null&&(y={type:"sequence",items:[]},f.items.unshift(y),b=b.slice(),b.push(v),a.push(b)),y.items.push({type:"node",value:p,path:b}),o.push({id:v,sequence:y,path:b})}}return{rootSequence:i,paths:a}}const er=">",Ho="$";function gm(e,t,n){var c,d;const s=n.split(er),r={};for(const u of t){const h=u.at(-2)??Ho;r[h]??(r[h]=[]),r[h].unshift(u)}const i=[],o={},a=s.slice(),l=[...e.items];for(;l.length>0;){const u=l.shift();if(u.type==="node"){i.push(u.value);const h=(c=u.value.checkpoint)==null?void 0:c.checkpoint_id;if(h==null)continue;o[h]={branch:u.path.join(er),branchOptions:(u.path.length>0?r[u.path.at(-2)??Ho]??[]:[]).map(f=>f.join(er))}}if(u.type==="fork"){const h=a.shift(),f=h!=null?u.items.findIndex(v=>{var b;const y=v.items.at(0);return!y||y.type!=="node"?!1:((b=y.value.checkpoint)==null?void 0:b.checkpoint_id)===h}):-1,p=((d=u.items.at(f))==null?void 0:d.items)??[];l.push(...p)}}return{history:i,branchByCheckpoint:o}}function vm(e,t){const{rootSequence:n,paths:s}=pm(t??[]),{history:r,branchByCheckpoint:i}=gm(n,s,e);return{branchTree:n,flatHistory:r,branchByCheckpoint:i,threadHead:r.at(-1)}}function Lc(e){if(typeof e>"u")return null;try{return JSON.parse(e)}catch{}let t="";const n=[];let s=!1,r=!1;for(let i of e){if(s)i==='"'&&!r?s=!1:i===`
`&&!r?i="\\n":i==="\\"?r=!r:r=!1;else if(i==='"')s=!0,r=!1;else if(i==="{")n.push("}");else if(i==="[")n.push("]");else if(i==="}"||i==="]")if(n&&n[n.length-1]===i)n.pop();else return null;t+=i}s&&(t+='"');for(let i=n.length-1;i>=0;i-=1)t+=n[i];try{return JSON.parse(t)}catch{return null}}var ym=function(e,t){if(typeof e!="string")throw new TypeError("Expected a string");return t=typeof t>"u"?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()};const xm=pc(ym);var Dc={exports:{}};const wm=/[\p{Lu}]/u,bm=/[\p{Ll}]/u,Uo=/^[\p{Lu}](?![\p{Lu}])/gu,Vc=/([\p{Alpha}\p{N}_]|$)/u,Oc=/[_.\- ]+/,Em=new RegExp("^"+Oc.source),zo=new RegExp(Oc.source+Vc.source,"gu"),Go=new RegExp("\\d+"+Vc.source,"gu"),Sm=(e,t,n)=>{let s=!1,r=!1,i=!1;for(let o=0;o<e.length;o++){const a=e[o];s&&wm.test(a)?(e=e.slice(0,o)+"-"+e.slice(o),s=!1,i=r,r=!0,o++):r&&i&&bm.test(a)?(e=e.slice(0,o-1)+"-"+e.slice(o-1),i=r,r=!1,s=!0):(s=t(a)===a&&n(a)!==a,i=r,r=n(a)===a&&t(a)!==a)}return e},_m=(e,t)=>(Uo.lastIndex=0,e.replace(Uo,n=>t(n))),Tm=(e,t)=>(zo.lastIndex=0,Go.lastIndex=0,e.replace(zo,(n,s)=>t(s)).replace(Go,n=>t(n))),Bc=(e,t)=>{if(!(typeof e=="string"||Array.isArray(e)))throw new TypeError("Expected the input to be `string | string[]`");if(t={pascalCase:!1,preserveConsecutiveUppercase:!1,...t},Array.isArray(e)?e=e.map(i=>i.trim()).filter(i=>i.length).join("-"):e=e.trim(),e.length===0)return"";const n=t.locale===!1?i=>i.toLowerCase():i=>i.toLocaleLowerCase(t.locale),s=t.locale===!1?i=>i.toUpperCase():i=>i.toLocaleUpperCase(t.locale);return e.length===1?t.pascalCase?s(e):n(e):(e!==n(e)&&(e=Sm(e,n,s)),e=e.replace(Em,""),t.preserveConsecutiveUppercase?e=_m(e,n):e=n(e),t.pascalCase&&(e=s(e.charAt(0))+e.slice(1)),Tm(e,s))};Dc.exports=Bc;Dc.exports.default=Bc;function Cm(e,t){return(t==null?void 0:t[e])||xm(e)}function Nm(e,t,n){const s={};for(const r in e)Object.hasOwn(e,r)&&(s[t(r,n)]=e[r]);return s}function Wo(e){return Array.isArray(e)?[...e]:{...e}}function Am(e,t){const n=Wo(e);for(const[s,r]of Object.entries(t)){const[i,...o]=s.split(".").reverse();let a=n;for(const l of o.reverse()){if(a[l]===void 0)break;a[l]=Wo(a[l]),a=a[l]}a[i]!==void 0&&(a[i]={lc:1,type:"secret",id:[r]})}return n}function Pm(e){const t=Object.getPrototypeOf(e);return typeof e.lc_name=="function"&&(typeof t.lc_name!="function"||e.lc_name()!==t.lc_name())?e.lc_name():e.name}class gi{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,Pm(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(t,...n){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(t||{}).filter(([s])=>{var r;return(r=this.lc_serializable_keys)==null?void 0:r.includes(s)})):this.lc_kwargs=t??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof gi||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const t={},n={},s=Object.keys(this.lc_kwargs).reduce((r,i)=>(r[i]=i in this?this[i]:this.lc_kwargs[i],r),{});for(let r=Object.getPrototypeOf(this);r;r=Object.getPrototypeOf(r))Object.assign(t,Reflect.get(r,"lc_aliases",this)),Object.assign(n,Reflect.get(r,"lc_secrets",this)),Object.assign(s,Reflect.get(r,"lc_attributes",this));return Object.keys(n).forEach(r=>{let i=this,o=s;const[a,...l]=r.split(".").reverse();for(const c of l.reverse()){if(!(c in i)||i[c]===void 0)return;(!(c in o)||o[c]===void 0)&&(typeof i[c]=="object"&&i[c]!=null?o[c]={}:Array.isArray(i[c])&&(o[c]=[])),i=i[c],o=o[c]}a in i&&i[a]!==void 0&&(o[a]=o[a]||i[a])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:Nm(Object.keys(n).length?Am(s,n):s,Cm,t)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function Ko(e){return typeof e=="object"&&e!==null&&"type"in e&&typeof e.type=="string"&&"source_type"in e&&(e.source_type==="url"||e.source_type==="base64"||e.source_type==="text"||e.source_type==="id")}function Hn(e,t){return typeof e=="string"?e===""?t:typeof t=="string"?e+t:Array.isArray(t)&&t.some(n=>Ko(n))?[{type:"text",source_type:"text",text:e},...t]:[{type:"text",text:e},...t]:Array.isArray(t)?vi(e,t)??[...e,...t]:t===""?e:Array.isArray(e)&&e.some(n=>Ko(n))?[...e,{type:"file",source_type:"text",text:t}]:[...e,{type:"text",text:t}]}function jm(e,t){function n(s,r){if(typeof s!="object"||s===null||s===void 0)return s;if(r>=t)return Array.isArray(s)?"[Array]":"[Object]";if(Array.isArray(s))return s.map(o=>n(o,r+1));const i={};for(const o of Object.keys(s))i[o]=n(s[o],r+1);return i}return JSON.stringify(n(e,0),null,2)}class Lt extends gi{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(t=>typeof t=="string"?t:t.type==="text"?t.text:"").join(""):""}getType(){return this._getType()}constructor(t,n){typeof t=="string"&&(t={content:t,additional_kwargs:n,response_metadata:{}}),t.additional_kwargs||(t.additional_kwargs={}),t.response_metadata||(t.response_metadata={}),super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=t.name,this.content=t.content,this.additional_kwargs=t.additional_kwargs,this.response_metadata=t.response_metadata,this.id=t.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(t){this.id=t,this.lc_kwargs.id=t}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](t){if(t===null)return this;const n=jm(this._printableFields,Math.max(4,t));return`${this.constructor.lc_name()} ${n}`}}function Je(e,t){const n={...e};for(const[s,r]of Object.entries(t))if(n[s]==null)n[s]=r;else{if(r==null)continue;if(typeof n[s]!=typeof r||Array.isArray(n[s])!==Array.isArray(r))throw new Error(`field[${s}] already exists in the message chunk, but with a different type.`);if(typeof n[s]=="string"){if(s==="type")continue;["id","name","output_version","model_provider"].includes(s)?n[s]=r:n[s]+=r}else if(typeof n[s]=="object"&&!Array.isArray(n[s]))n[s]=Je(n[s],r);else if(Array.isArray(n[s]))n[s]=vi(n[s],r);else{if(n[s]===r)continue;console.warn(`field[${s}] already exists in this message chunk and value has unsupported type.`)}}return n}function vi(e,t){if(!(e===void 0&&t===void 0)){if(e===void 0||t===void 0)return e||t;{const n=[...e];for(const s of t)if(typeof s=="object"&&s!==null&&"index"in s&&typeof s.index=="number"){const r=n.findIndex(i=>{const o=typeof i=="object",a="index"in i&&i.index===s.index,l="id"in i&&"id"in s&&(i==null?void 0:i.id)===(s==null?void 0:s.id),c=!("id"in i)||!(i!=null&&i.id)||!("id"in s)||!(s!=null&&s.id);return o&&a&&(l||c)});r!==-1&&typeof n[r]=="object"&&n[r]!==null?n[r]=Je(n[r],s):n.push(s)}else{if(typeof s=="object"&&s!==null&&"text"in s&&s.text==="")continue;n.push(s)}return n}}}class Un extends Lt{}function Rm(e){return typeof e.role=="string"}function Fc(e){return typeof(e==null?void 0:e._getType)=="function"}function km(e){return Fc(e)&&typeof e.concat=="function"}class Im extends Lt{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(t,n,s){typeof t=="string"&&(t={content:t,name:s,tool_call_id:n}),super(t),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=t.tool_call_id,this.artifact=t.artifact,this.status=t.status,this.metadata=t.metadata}_getType(){return"tool"}static isInstance(t){return t._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function Mm(e){const t=[],n=[];for(const s of e)if(s.function){const r=s.function.name;try{const i=JSON.parse(s.function.arguments),o={name:r||"",args:i||{},id:s.id};t.push(o)}catch{n.push({name:r,args:s.function.arguments,id:s.id,error:"Malformed args."})}}else continue;return[t,n]}class Xo extends Lt{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(t,n){var r;let s;if(typeof t=="string")s={content:t,tool_calls:[],invalid_tool_calls:[],additional_kwargs:n??{}};else{s=t;const i=(r=s.additional_kwargs)==null?void 0:r.tool_calls,o=s.tool_calls;i!=null&&i.length>0&&(o===void 0||o.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(i!=null&&o===void 0){const[a,l]=Mm(i);s.tool_calls=a??[],s.invalid_tool_calls=l??[]}else s.tool_calls=s.tool_calls??[],s.invalid_tool_calls=s.invalid_tool_calls??[]}catch{s.tool_calls=[],s.invalid_tool_calls=[]}}super(s),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof s!="string"&&(this.tool_calls=s.tool_calls??this.tool_calls,this.invalid_tool_calls=s.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=s.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}class yi extends Un{constructor(t){var s,r;let n;if(typeof t=="string")n={content:t,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(t.tool_call_chunks===void 0)n={...t,tool_calls:t.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:t.usage_metadata!==void 0?t.usage_metadata:void 0};else{const i=t.tool_call_chunks.reduce((l,c)=>{const d=l.findIndex(([u])=>"id"in c&&c.id&&"index"in c&&c.index!==void 0?c.id===u.id&&c.index===u.index:"id"in c&&c.id?c.id===u.id:"index"in c&&c.index!==void 0?c.index===u.index:!1);return d!==-1?l[d].push(c):l.push([c]),l},[]),o=[],a=[];for(const l of i){let c={};const d=((s=l[0])==null?void 0:s.name)??"",u=l.map(p=>p.args||"").join(""),h=u.length?u:"{}",f=(r=l[0])==null?void 0:r.id;try{if(c=Lc(h),!f||c===null||typeof c!="object"||Array.isArray(c))throw new Error("Malformed tool call chunk args.");o.push({name:d,args:c,id:f,type:"tool_call"})}catch{a.push({name:d,args:h,id:f,error:"Malformed args.",type:"invalid_tool_call"})}}n={...t,tool_calls:o,invalid_tool_calls:a,usage_metadata:t.usage_metadata!==void 0?t.usage_metadata:void 0}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=n.tool_call_chunks??this.tool_call_chunks,this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=n.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(t){var s,r,i,o,a,l,c,d,u,h,f,p,v,y,b,x,w,E,_,j,D,R,P,M,L,$,U,T,N,B,I,F,S,O,z,k,H,V,A,G;const n={content:Hn(this.content,t.content),additional_kwargs:Je(this.additional_kwargs,t.additional_kwargs),response_metadata:Je(this.response_metadata,t.response_metadata),tool_call_chunks:[],id:this.id??t.id};if(this.tool_call_chunks!==void 0||t.tool_call_chunks!==void 0){const K=vi(this.tool_call_chunks,t.tool_call_chunks);K!==void 0&&K.length>0&&(n.tool_call_chunks=K)}if(this.usage_metadata!==void 0||t.usage_metadata!==void 0){const K={...(((r=(s=this.usage_metadata)==null?void 0:s.input_token_details)==null?void 0:r.audio)!==void 0||((o=(i=t.usage_metadata)==null?void 0:i.input_token_details)==null?void 0:o.audio)!==void 0)&&{audio:(((l=(a=this.usage_metadata)==null?void 0:a.input_token_details)==null?void 0:l.audio)??0)+(((d=(c=t.usage_metadata)==null?void 0:c.input_token_details)==null?void 0:d.audio)??0)},...(((h=(u=this.usage_metadata)==null?void 0:u.input_token_details)==null?void 0:h.cache_read)!==void 0||((p=(f=t.usage_metadata)==null?void 0:f.input_token_details)==null?void 0:p.cache_read)!==void 0)&&{cache_read:(((y=(v=this.usage_metadata)==null?void 0:v.input_token_details)==null?void 0:y.cache_read)??0)+(((x=(b=t.usage_metadata)==null?void 0:b.input_token_details)==null?void 0:x.cache_read)??0)},...(((E=(w=this.usage_metadata)==null?void 0:w.input_token_details)==null?void 0:E.cache_creation)!==void 0||((j=(_=t.usage_metadata)==null?void 0:_.input_token_details)==null?void 0:j.cache_creation)!==void 0)&&{cache_creation:(((R=(D=this.usage_metadata)==null?void 0:D.input_token_details)==null?void 0:R.cache_creation)??0)+(((M=(P=t.usage_metadata)==null?void 0:P.input_token_details)==null?void 0:M.cache_creation)??0)}},Y={...((($=(L=this.usage_metadata)==null?void 0:L.output_token_details)==null?void 0:$.audio)!==void 0||((T=(U=t.usage_metadata)==null?void 0:U.output_token_details)==null?void 0:T.audio)!==void 0)&&{audio:(((B=(N=this.usage_metadata)==null?void 0:N.output_token_details)==null?void 0:B.audio)??0)+(((F=(I=t.usage_metadata)==null?void 0:I.output_token_details)==null?void 0:F.audio)??0)},...(((O=(S=this.usage_metadata)==null?void 0:S.output_token_details)==null?void 0:O.reasoning)!==void 0||((k=(z=t.usage_metadata)==null?void 0:z.output_token_details)==null?void 0:k.reasoning)!==void 0)&&{reasoning:(((V=(H=this.usage_metadata)==null?void 0:H.output_token_details)==null?void 0:V.reasoning)??0)+(((G=(A=t.usage_metadata)==null?void 0:A.output_token_details)==null?void 0:G.reasoning)??0)}},Q=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},X=t.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},ae={input_tokens:Q.input_tokens+X.input_tokens,output_tokens:Q.output_tokens+X.output_tokens,total_tokens:Q.total_tokens+X.total_tokens,...Object.keys(K).length>0&&{input_token_details:K},...Object.keys(Y).length>0&&{output_token_details:Y}};n.usage_metadata=ae}return new yi(n)}}class xi extends Lt{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return xi}constructor(t,n){typeof t=="string"&&(t={content:t,role:n}),super(t),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=t.role}_getType(){return"generic"}static isInstance(t){return t._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class wi extends Un{static lc_name(){return"ChatMessageChunk"}constructor(t,n){typeof t=="string"&&(t={content:t,role:n}),super(t),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=t.role}_getType(){return"generic"}concat(t){return new wi({content:Hn(this.content,t.content),additional_kwargs:Je(this.additional_kwargs,t.additional_kwargs),response_metadata:Je(this.response_metadata,t.response_metadata),role:this.role,id:this.id??t.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class bi extends Un{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(t){return new bi({content:Hn(this.content,t.content),additional_kwargs:Je(this.additional_kwargs,t.additional_kwargs),response_metadata:Je(this.response_metadata,t.response_metadata),name:this.name??"",id:this.id??t.id})}}let Hc=class extends Lt{static lc_name(){return"HumanMessage"}_getType(){return"human"}constructor(t,n){super(t,n)}};class Ei extends Un{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}constructor(t,n){super(t,n)}concat(t){return new Ei({content:Hn(this.content,t.content),additional_kwargs:Je(this.additional_kwargs,t.additional_kwargs),response_metadata:Je(this.response_metadata,t.response_metadata),id:this.id??t.id})}}class Yo extends Lt{static lc_name(){return"SystemMessage"}_getType(){return"system"}constructor(t,n){super(t,n)}}class Si extends Un{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}constructor(t,n){super(t,n)}concat(t){return new Si({content:Hn(this.content,t.content),additional_kwargs:Je(this.additional_kwargs,t.additional_kwargs),response_metadata:Je(this.response_metadata,t.response_metadata),id:this.id??t.id})}}function $m(e,t){return e.lc_error_code=t,e.message=`${e.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/
`,e}function Lm(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="tool_call")}class Uc extends Lt{constructor(t){super({...t,content:""}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=t.id}_getType(){return"remove"}get _printableFields(){return{...super._printableFields,id:this.id}}}function Dm(e){return Lm(e)?e:typeof e.id=="string"&&e.type==="function"&&typeof e.function=="object"&&e.function!==null&&"arguments"in e.function&&typeof e.function.arguments=="string"&&"name"in e.function&&typeof e.function.name=="string"?{id:e.id,args:JSON.parse(e.function.arguments),name:e.function.name,type:"tool_call"}:e}function Vm(e){return typeof e=="object"&&e!=null&&e.lc===1&&Array.isArray(e.id)&&e.kwargs!=null&&typeof e.kwargs=="object"}function tr(e){let t,n;if(Vm(e)){const s=e.id.at(-1);s==="HumanMessage"||s==="HumanMessageChunk"?t="user":s==="AIMessage"||s==="AIMessageChunk"?t="assistant":s==="SystemMessage"||s==="SystemMessageChunk"?t="system":s==="FunctionMessage"||s==="FunctionMessageChunk"?t="function":s==="ToolMessage"||s==="ToolMessageChunk"?t="tool":t="unknown",n=e.kwargs}else{const{type:s,...r}=e;t=s,n=r}if(t==="human"||t==="user")return new Hc(n);if(t==="ai"||t==="assistant"){const{tool_calls:s,...r}=n;if(!Array.isArray(s))return new Xo(n);const i=s.map(Dm);return new Xo({...r,tool_calls:i})}else{if(t==="system")return new Yo(n);if(t==="developer")return new Yo({...n,additional_kwargs:{...n.additional_kwargs,__openai_role__:"developer"}});if(t==="tool"&&"tool_call_id"in n)return new Im({...n,content:n.content,tool_call_id:n.tool_call_id,name:n.name});if(t==="remove"&&"id"in n&&typeof n.id=="string")return new Uc({...n,id:n.id});throw $m(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(e,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function Om(e){if(typeof e=="string")return new Hc(e);if(Fc(e))return e;if(Array.isArray(e)){const[t,n]=e;return tr({type:t,content:n})}else if(Rm(e)){const{role:t,...n}=e;return tr({...n,type:t})}else return tr(e)}function Bm(e){var n;const t=e._getType();if(t==="human")return new Ei({...e});if(t==="ai"){let s={...e};return"tool_calls"in s&&(s={...s,tool_call_chunks:(n=s.tool_calls)==null?void 0:n.map(r=>({...r,type:"tool_call_chunk",index:void 0,args:JSON.stringify(r.args)}))}),new yi({...s})}else{if(t==="system")return new Si({...e});if(t==="function")return new bi({...e});if(xi.isInstance(e))return new wi({...e});throw new Error("Unknown message type.")}}var ks={exports:{}},zc={};function Qe(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var Fm=Qe;Qe.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Qe.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Qe.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},n),this._options.unref&&this._timer.unref(),!0};Qe.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Qe.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)};Qe.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)};Qe.prototype.start=Qe.prototype.try;Qe.prototype.errors=function(){return this._errors};Qe.prototype.attempts=function(){return this._attempts};Qe.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,n=0,s=0;s<this._errors.length;s++){var r=this._errors[s],i=r.message,o=(e[i]||0)+1;e[i]=o,o>=n&&(t=r,n=o)}return t};(function(e){var t=Fm;e.operation=function(n){var s=e.timeouts(n);return new t(s,{forever:n&&(n.forever||n.retries===1/0),unref:n&&n.unref,maxRetryTime:n&&n.maxRetryTime})},e.timeouts=function(n){if(n instanceof Array)return[].concat(n);var s={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in n)s[r]=n[r];if(s.minTimeout>s.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],o=0;o<s.retries;o++)i.push(this.createTimeout(o,s));return n&&n.forever&&!i.length&&i.push(this.createTimeout(o,s)),i.sort(function(a,l){return a-l}),i},e.createTimeout=function(n,s){var r=s.randomize?Math.random()+1:1,i=Math.round(r*Math.max(s.minTimeout,1)*Math.pow(s.factor,n));return i=Math.min(i,s.maxTimeout),i},e.wrap=function(n,s,r){if(s instanceof Array&&(r=s,s=null),!r){r=[];for(var i in n)typeof n[i]=="function"&&r.push(i)}for(var o=0;o<r.length;o++){var a=r[o],l=n[a];n[a]=(function(d){var u=e.operation(s),h=Array.prototype.slice.call(arguments,1),f=h.pop();h.push(function(p){u.retry(p)||(p&&(arguments[0]=u.mainError()),f.apply(this,arguments))}),u.attempt(function(){d.apply(n,h)})}).bind(n,l),n[a].options=s}}})(zc);var Hm=zc;const Um=Hm,zm=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class Gc extends Error{constructor(t){super(),t instanceof Error?(this.originalError=t,{message:t}=t):(this.originalError=new Error(t),this.originalError.stack=this.stack),this.name="AbortError",this.message=t}}const Gm=(e,t,n)=>{const s=n.retries-(t-1);return e.attemptNumber=t,e.retriesLeft=s,e},Wm=e=>zm.includes(e),Wc=(e,t)=>new Promise((n,s)=>{t={onFailedAttempt:()=>{},retries:10,...t};const r=Um.operation(t);r.attempt(async i=>{try{n(await e(i))}catch(o){if(!(o instanceof Error)){s(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof Gc)r.stop(),s(o.originalError);else if(o instanceof TypeError&&!Wm(o.message))r.stop(),s(o);else{Gm(o,i,t);try{await t.onFailedAttempt(o)}catch(a){s(a);return}r.retry(o)||s(r.mainError())}}})});ks.exports=Wc;ks.exports.default=Wc;ks.exports.AbortError=Gc;var Km=ks.exports;const Xm=pc(Km);var Kc={},Xc={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function r(l,c,d){this.fn=l,this.context=c,this.once=d||!1}function i(l,c,d,u,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var f=new r(d,u||l,h),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new s:delete l._events[c]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],d,u;if(this._eventsCount===0)return c;for(u in d=this._events)t.call(d,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(d)):c},a.prototype.listeners=function(c){var d=n?n+c:c,u=this._events[d];if(!u)return[];if(u.fn)return[u.fn];for(var h=0,f=u.length,p=new Array(f);h<f;h++)p[h]=u[h].fn;return p},a.prototype.listenerCount=function(c){var d=n?n+c:c,u=this._events[d];return u?u.fn?1:u.length:0},a.prototype.emit=function(c,d,u,h,f,p){var v=n?n+c:c;if(!this._events[v])return!1;var y=this._events[v],b=arguments.length,x,w;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,u),!0;case 4:return y.fn.call(y.context,d,u,h),!0;case 5:return y.fn.call(y.context,d,u,h,f),!0;case 6:return y.fn.call(y.context,d,u,h,f,p),!0}for(w=1,x=new Array(b-1);w<b;w++)x[w-1]=arguments[w];y.fn.apply(y.context,x)}else{var E=y.length,_;for(w=0;w<E;w++)switch(y[w].once&&this.removeListener(c,y[w].fn,void 0,!0),b){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,d);break;case 3:y[w].fn.call(y[w].context,d,u);break;case 4:y[w].fn.call(y[w].context,d,u,h);break;default:if(!x)for(_=1,x=new Array(b-1);_<b;_++)x[_-1]=arguments[_];y[w].fn.apply(y[w].context,x)}}return!0},a.prototype.on=function(c,d,u){return i(this,c,d,u,!1)},a.prototype.once=function(c,d,u){return i(this,c,d,u,!0)},a.prototype.removeListener=function(c,d,u,h){var f=n?n+c:c;if(!this._events[f])return this;if(!d)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===d&&(!h||p.once)&&(!u||p.context===u)&&o(this,f);else{for(var v=0,y=[],b=p.length;v<b;v++)(p[v].fn!==d||h&&!p[v].once||u&&p[v].context!==u)&&y.push(p[v]);y.length?this._events[f]=y.length===1?y[0]:y:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var d;return c?(d=n?n+c:c,this._events[d]&&o(this,d)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(Xc);var Ym=Xc.exports,Is={exports:{}},Zm=(e,t)=>(t=t||(()=>{}),e.then(n=>new Promise(s=>{s(t())}).then(()=>n),n=>new Promise(s=>{s(t())}).then(()=>{throw n})));const Jm=Zm;class Yc extends Error{constructor(t){super(t),this.name="TimeoutError"}}const Zc=(e,t,n)=>new Promise((s,r)=>{if(typeof t!="number"||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0){s(e);return}const i=setTimeout(()=>{if(typeof n=="function"){try{s(n())}catch(l){r(l)}return}const o=typeof n=="string"?n:`Promise timed out after ${t} milliseconds`,a=n instanceof Error?n:new Yc(o);typeof e.cancel=="function"&&e.cancel(),r(a)},t);Jm(e.then(s,r),()=>{clearTimeout(i)})});Is.exports=Zc;Is.exports.default=Zc;Is.exports.TimeoutError=Yc;var Qm=Is.exports,_i={},Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});function qm(e,t,n){let s=0,r=e.length;for(;r>0;){const i=r/2|0;let o=s+i;n(e[o],t)<=0?(s=++o,r-=i+1):r=i}return s}Ti.default=qm;Object.defineProperty(_i,"__esModule",{value:!0});const ep=Ti;class tp{constructor(){this._queue=[]}enqueue(t,n){n=Object.assign({priority:0},n);const s={priority:n.priority,run:t};if(this.size&&this._queue[this.size-1].priority>=n.priority){this._queue.push(s);return}const r=ep.default(this._queue,s,(i,o)=>o.priority-i.priority);this._queue.splice(r,0,s)}dequeue(){const t=this._queue.shift();return t==null?void 0:t.run}filter(t){return this._queue.filter(n=>n.priority===t.priority).map(n=>n.run)}get size(){return this._queue.length}}_i.default=tp;Object.defineProperty(Kc,"__esModule",{value:!0});const np=Ym,Jc=Qm,sp=_i,Jn=()=>{},rp=new Jc.TimeoutError;class ip extends np{constructor(t){var n,s,r,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Jn,this._resolveIdle=Jn,t=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:sp.default},t),!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(s=(n=t.intervalCap)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof t.intervalCap})`);if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(r=t.interval)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""}\` (${typeof t.interval})`);this._carryoverConcurrencyCount=t.carryoverConcurrencyCount,this._isIntervalIgnored=t.intervalCap===1/0||t.interval===0,this._intervalCap=t.intervalCap,this._interval=t.interval,this._queue=new t.queueClass,this._queueClass=t.queueClass,this.concurrency=t.concurrency,this._timeout=t.timeout,this._throwOnTimeout=t.throwOnTimeout===!0,this._isPaused=t.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Jn,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Jn,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const t=Date.now();if(this._intervalId===void 0){const n=this._intervalEnd-t;if(n<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},n)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const t=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const n=this._queue.dequeue();return n?(this.emit("active"),n(),t&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);this._concurrency=t,this._processQueue()}async add(t,n={}){return new Promise((s,r)=>{const i=async()=>{this._pendingCount++,this._intervalCount++;try{const o=this._timeout===void 0&&n.timeout===void 0?t():Jc.default(Promise.resolve(t()),n.timeout===void 0?this._timeout:n.timeout,()=>{(n.throwOnTimeout===void 0?this._throwOnTimeout:n.throwOnTimeout)&&r(rp)});s(await o)}catch(o){r(o)}this._next()};this._queue.enqueue(i,n),this._tryToStartAnother(),this.emit("add")})}async addAll(t,n){return Promise.all(t.map(async s=>this.add(s,n)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(t=>{const n=this._resolveEmpty;this._resolveEmpty=()=>{n(),t()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(t=>{const n=this._resolveIdle;this._resolveIdle=()=>{n(),t()}})}get size(){return this._queue.size}sizeBy(t){return this._queue.filter(t).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(t){this._timeout=t}}var nr=Kc.default=ip,Vr={exports:{}};const op="2.0.0",Qc=256,ap=Number.MAX_SAFE_INTEGER||9007199254740991,lp=16,cp=Qc-6,up=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Ms={MAX_LENGTH:Qc,MAX_SAFE_COMPONENT_LENGTH:lp,MAX_SAFE_BUILD_LENGTH:cp,MAX_SAFE_INTEGER:ap,RELEASE_TYPES:up,SEMVER_SPEC_VERSION:op,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},sr={};const dp=typeof process=="object"&&sr&&sr.NODE_DEBUG&&/\bsemver\b/i.test(sr.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var $s=dp;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:s,MAX_LENGTH:r}=Ms,i=$s;t=e.exports={};const o=t.re=[],a=t.safeRe=[],l=t.src=[],c=t.t={};let d=0;const u="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",r],[u,s]],f=v=>{for(const[y,b]of h)v=v.split(`${y}*`).join(`${y}{0,${b}}`).split(`${y}+`).join(`${y}{1,${b}}`);return v},p=(v,y,b)=>{const x=f(y),w=d++;i(v,w,y),c[v]=w,l[w]=y,o[w]=new RegExp(y,b?"g":void 0),a[w]=new RegExp(x,b?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${u}*`),p("MAINVERSION",`(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${l[c.NUMERICIDENTIFIER]}|${l[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${l[c.NUMERICIDENTIFIERLOOSE]}|${l[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${l[c.PRERELEASEIDENTIFIER]}(?:\\.${l[c.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${l[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[c.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${u}+`),p("BUILD",`(?:\\+(${l[c.BUILDIDENTIFIER]}(?:\\.${l[c.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${l[c.MAINVERSION]}${l[c.PRERELEASE]}?${l[c.BUILD]}?`),p("FULL",`^${l[c.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${l[c.MAINVERSIONLOOSE]}${l[c.PRERELEASELOOSE]}?${l[c.BUILD]}?`),p("LOOSE",`^${l[c.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${l[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${l[c.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:${l[c.PRERELEASE]})?${l[c.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:${l[c.PRERELEASELOOSE]})?${l[c.BUILD]}?)?)?`),p("XRANGE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),p("COERCE",`${l[c.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",l[c.COERCEPLAIN]+`(?:${l[c.PRERELEASE]})?(?:${l[c.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",l[c.COERCE],!0),p("COERCERTLFULL",l[c.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${l[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${l[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${l[c.LONECARET]}${l[c.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${l[c.LONECARET]}${l[c.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${l[c.GTLT]}\\s*(${l[c.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]}|${l[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${l[c.XRANGEPLAIN]})\\s+-\\s+(${l[c.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${l[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[c.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Vr,Vr.exports);var zn=Vr.exports;const fp=Object.freeze({loose:!0}),hp=Object.freeze({}),mp=e=>e?typeof e!="object"?fp:e:hp;var Ci=mp;const Zo=/^[0-9]+$/,qc=(e,t)=>{const n=Zo.test(e),s=Zo.test(t);return n&&s&&(e=+e,t=+t),e===t?0:n&&!s?-1:s&&!n?1:e<t?-1:1},pp=(e,t)=>qc(t,e);var eu={compareIdentifiers:qc,rcompareIdentifiers:pp};const Qn=$s,{MAX_LENGTH:Jo,MAX_SAFE_INTEGER:qn}=Ms,{safeRe:Qo,t:qo}=zn,gp=Ci,{compareIdentifiers:Ht}=eu;let vp=class at{constructor(t,n){if(n=gp(n),t instanceof at){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>Jo)throw new TypeError(`version is longer than ${Jo} characters`);Qn("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const s=t.trim().match(n.loose?Qo[qo.LOOSE]:Qo[qo.FULL]);if(!s)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>qn||this.major<0)throw new TypeError("Invalid major version");if(this.minor>qn||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>qn||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){const i=+r;if(i>=0&&i<qn)return i}return r}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Qn("SemVer.compare",this.version,this.options,t),!(t instanceof at)){if(typeof t=="string"&&t===this.version)return 0;t=new at(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof at||(t=new at(t,this.options)),Ht(this.major,t.major)||Ht(this.minor,t.minor)||Ht(this.patch,t.patch)}comparePre(t){if(t instanceof at||(t=new at(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const s=this.prerelease[n],r=t.prerelease[n];if(Qn("prerelease compare",n,s,r),s===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(s===void 0)return-1;if(s===r)continue;return Ht(s,r)}while(++n)}compareBuild(t){t instanceof at||(t=new at(t,this.options));let n=0;do{const s=this.build[n],r=t.build[n];if(Qn("build compare",n,s,r),s===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(s===void 0)return-1;if(s===r)continue;return Ht(s,r)}while(++n)}inc(t,n,s){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,s);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,s);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,s),this.inc("pre",n,s);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,s),this.inc("pre",n,s);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const r=Number(s)?1:0;if(!n&&s===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[r];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(n===this.prerelease.join(".")&&s===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(r)}}if(n){let i=[n,r];s===!1&&(i=[n]),Ht(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var De=vp;const ea=De,yp=(e,t,n=!1)=>{if(e instanceof ea)return e;try{return new ea(e,t)}catch(s){if(!n)return null;throw s}};var mn=yp;const xp=mn,wp=(e,t)=>{const n=xp(e,t);return n?n.version:null};var bp=wp;const Ep=mn,Sp=(e,t)=>{const n=Ep(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var _p=Sp;const ta=De,Tp=(e,t,n,s,r)=>{typeof n=="string"&&(r=s,s=n,n=void 0);try{return new ta(e instanceof ta?e.version:e,n).inc(t,s,r).version}catch{return null}};var Cp=Tp;const na=mn,Np=(e,t)=>{const n=na(e,null,!0),s=na(t,null,!0),r=n.compare(s);if(r===0)return null;const i=r>0,o=i?n:s,a=i?s:n,l=!!o.prerelease.length;if(!!a.prerelease.length&&!l)return!a.patch&&!a.minor?"major":o.patch?"patch":o.minor?"minor":"major";const d=l?"pre":"";return n.major!==s.major?d+"major":n.minor!==s.minor?d+"minor":n.patch!==s.patch?d+"patch":"prerelease"};var Ap=Np;const Pp=De,jp=(e,t)=>new Pp(e,t).major;var Rp=jp;const kp=De,Ip=(e,t)=>new kp(e,t).minor;var Mp=Ip;const $p=De,Lp=(e,t)=>new $p(e,t).patch;var Dp=Lp;const Vp=mn,Op=(e,t)=>{const n=Vp(e,t);return n&&n.prerelease.length?n.prerelease:null};var Bp=Op;const sa=De,Fp=(e,t,n)=>new sa(e,n).compare(new sa(t,n));var tt=Fp;const Hp=tt,Up=(e,t,n)=>Hp(t,e,n);var zp=Up;const Gp=tt,Wp=(e,t)=>Gp(e,t,!0);var Kp=Wp;const ra=De,Xp=(e,t,n)=>{const s=new ra(e,n),r=new ra(t,n);return s.compare(r)||s.compareBuild(r)};var Ni=Xp;const Yp=Ni,Zp=(e,t)=>e.sort((n,s)=>Yp(n,s,t));var Jp=Zp;const Qp=Ni,qp=(e,t)=>e.sort((n,s)=>Qp(s,n,t));var eg=qp;const tg=tt,ng=(e,t,n)=>tg(e,t,n)>0;var Ls=ng;const sg=tt,rg=(e,t,n)=>sg(e,t,n)<0;var Ai=rg;const ig=tt,og=(e,t,n)=>ig(e,t,n)===0;var tu=og;const ag=tt,lg=(e,t,n)=>ag(e,t,n)!==0;var nu=lg;const cg=tt,ug=(e,t,n)=>cg(e,t,n)>=0;var Pi=ug;const dg=tt,fg=(e,t,n)=>dg(e,t,n)<=0;var ji=fg;const hg=tu,mg=nu,pg=Ls,gg=Pi,vg=Ai,yg=ji,xg=(e,t,n,s)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return hg(e,n,s);case"!=":return mg(e,n,s);case">":return pg(e,n,s);case">=":return gg(e,n,s);case"<":return vg(e,n,s);case"<=":return yg(e,n,s);default:throw new TypeError(`Invalid operator: ${t}`)}};var su=xg;const wg=De,bg=mn,{safeRe:es,t:ts}=zn,Eg=(e,t)=>{if(e instanceof wg)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(t.includePrerelease?es[ts.COERCEFULL]:es[ts.COERCE]);else{const l=t.includePrerelease?es[ts.COERCERTLFULL]:es[ts.COERCERTL];let c;for(;(c=l.exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||c.index+c[0].length!==n.index+n[0].length)&&(n=c),l.lastIndex=c.index+c[1].length+c[2].length;l.lastIndex=-1}if(n===null)return null;const s=n[2],r=n[3]||"0",i=n[4]||"0",o=t.includePrerelease&&n[5]?`-${n[5]}`:"",a=t.includePrerelease&&n[6]?`+${n[6]}`:"";return bg(`${s}.${r}.${i}${o}${a}`,t)};var Sg=Eg;class _g{constructor(){this.max=1e3,this.map=new Map}get(t){const n=this.map.get(t);if(n!==void 0)return this.map.delete(t),this.map.set(t,n),n}delete(t){return this.map.delete(t)}set(t,n){if(!this.delete(t)&&n!==void 0){if(this.map.size>=this.max){const r=this.map.keys().next().value;this.delete(r)}this.map.set(t,n)}return this}}var Tg=_g,rr,ia;function nt(){if(ia)return rr;ia=1;const e=/\s+/g;class t{constructor(N,B){if(B=r(B),N instanceof t)return N.loose===!!B.loose&&N.includePrerelease===!!B.includePrerelease?N:new t(N.raw,B);if(N instanceof i)return this.raw=N.value,this.set=[[N]],this.formatted=void 0,this;if(this.options=B,this.loose=!!B.loose,this.includePrerelease=!!B.includePrerelease,this.raw=N.trim().replace(e," "),this.set=this.raw.split("||").map(I=>this.parseRange(I.trim())).filter(I=>I.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const I=this.set[0];if(this.set=this.set.filter(F=>!v(F[0])),this.set.length===0)this.set=[I];else if(this.set.length>1){for(const F of this.set)if(F.length===1&&y(F[0])){this.set=[F];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let N=0;N<this.set.length;N++){N>0&&(this.formatted+="||");const B=this.set[N];for(let I=0;I<B.length;I++)I>0&&(this.formatted+=" "),this.formatted+=B[I].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(N){const I=((this.options.includePrerelease&&f)|(this.options.loose&&p))+":"+N,F=s.get(I);if(F)return F;const S=this.options.loose,O=S?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];N=N.replace(O,$(this.options.includePrerelease)),o("hyphen replace",N),N=N.replace(l[c.COMPARATORTRIM],d),o("comparator trim",N),N=N.replace(l[c.TILDETRIM],u),o("tilde trim",N),N=N.replace(l[c.CARETTRIM],h),o("caret trim",N);let z=N.split(" ").map(A=>x(A,this.options)).join(" ").split(/\s+/).map(A=>L(A,this.options));S&&(z=z.filter(A=>(o("loose invalid filter",A,this.options),!!A.match(l[c.COMPARATORLOOSE])))),o("range list",z);const k=new Map,H=z.map(A=>new i(A,this.options));for(const A of H){if(v(A))return[A];k.set(A.value,A)}k.size>1&&k.has("")&&k.delete("");const V=[...k.values()];return s.set(I,V),V}intersects(N,B){if(!(N instanceof t))throw new TypeError("a Range is required");return this.set.some(I=>b(I,B)&&N.set.some(F=>b(F,B)&&I.every(S=>F.every(O=>S.intersects(O,B)))))}test(N){if(!N)return!1;if(typeof N=="string")try{N=new a(N,this.options)}catch{return!1}for(let B=0;B<this.set.length;B++)if(U(this.set[B],N,this.options))return!0;return!1}}rr=t;const n=Tg,s=new n,r=Ci,i=Ds(),o=$s,a=De,{safeRe:l,t:c,comparatorTrimReplace:d,tildeTrimReplace:u,caretTrimReplace:h}=zn,{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:p}=Ms,v=T=>T.value==="<0.0.0-0",y=T=>T.value==="",b=(T,N)=>{let B=!0;const I=T.slice();let F=I.pop();for(;B&&I.length;)B=I.every(S=>F.intersects(S,N)),F=I.pop();return B},x=(T,N)=>(o("comp",T,N),T=j(T,N),o("caret",T),T=E(T,N),o("tildes",T),T=R(T,N),o("xrange",T),T=M(T,N),o("stars",T),T),w=T=>!T||T.toLowerCase()==="x"||T==="*",E=(T,N)=>T.trim().split(/\s+/).map(B=>_(B,N)).join(" "),_=(T,N)=>{const B=N.loose?l[c.TILDELOOSE]:l[c.TILDE];return T.replace(B,(I,F,S,O,z)=>{o("tilde",T,I,F,S,O,z);let k;return w(F)?k="":w(S)?k=`>=${F}.0.0 <${+F+1}.0.0-0`:w(O)?k=`>=${F}.${S}.0 <${F}.${+S+1}.0-0`:z?(o("replaceTilde pr",z),k=`>=${F}.${S}.${O}-${z} <${F}.${+S+1}.0-0`):k=`>=${F}.${S}.${O} <${F}.${+S+1}.0-0`,o("tilde return",k),k})},j=(T,N)=>T.trim().split(/\s+/).map(B=>D(B,N)).join(" "),D=(T,N)=>{o("caret",T,N);const B=N.loose?l[c.CARETLOOSE]:l[c.CARET],I=N.includePrerelease?"-0":"";return T.replace(B,(F,S,O,z,k)=>{o("caret",T,F,S,O,z,k);let H;return w(S)?H="":w(O)?H=`>=${S}.0.0${I} <${+S+1}.0.0-0`:w(z)?S==="0"?H=`>=${S}.${O}.0${I} <${S}.${+O+1}.0-0`:H=`>=${S}.${O}.0${I} <${+S+1}.0.0-0`:k?(o("replaceCaret pr",k),S==="0"?O==="0"?H=`>=${S}.${O}.${z}-${k} <${S}.${O}.${+z+1}-0`:H=`>=${S}.${O}.${z}-${k} <${S}.${+O+1}.0-0`:H=`>=${S}.${O}.${z}-${k} <${+S+1}.0.0-0`):(o("no pr"),S==="0"?O==="0"?H=`>=${S}.${O}.${z}${I} <${S}.${O}.${+z+1}-0`:H=`>=${S}.${O}.${z}${I} <${S}.${+O+1}.0-0`:H=`>=${S}.${O}.${z} <${+S+1}.0.0-0`),o("caret return",H),H})},R=(T,N)=>(o("replaceXRanges",T,N),T.split(/\s+/).map(B=>P(B,N)).join(" ")),P=(T,N)=>{T=T.trim();const B=N.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return T.replace(B,(I,F,S,O,z,k)=>{o("xRange",T,I,F,S,O,z,k);const H=w(S),V=H||w(O),A=V||w(z),G=A;return F==="="&&G&&(F=""),k=N.includePrerelease?"-0":"",H?F===">"||F==="<"?I="<0.0.0-0":I="*":F&&G?(V&&(O=0),z=0,F===">"?(F=">=",V?(S=+S+1,O=0,z=0):(O=+O+1,z=0)):F==="<="&&(F="<",V?S=+S+1:O=+O+1),F==="<"&&(k="-0"),I=`${F+S}.${O}.${z}${k}`):V?I=`>=${S}.0.0${k} <${+S+1}.0.0-0`:A&&(I=`>=${S}.${O}.0${k} <${S}.${+O+1}.0-0`),o("xRange return",I),I})},M=(T,N)=>(o("replaceStars",T,N),T.trim().replace(l[c.STAR],"")),L=(T,N)=>(o("replaceGTE0",T,N),T.trim().replace(l[N.includePrerelease?c.GTE0PRE:c.GTE0],"")),$=T=>(N,B,I,F,S,O,z,k,H,V,A,G)=>(w(I)?B="":w(F)?B=`>=${I}.0.0${T?"-0":""}`:w(S)?B=`>=${I}.${F}.0${T?"-0":""}`:O?B=`>=${B}`:B=`>=${B}${T?"-0":""}`,w(H)?k="":w(V)?k=`<${+H+1}.0.0-0`:w(A)?k=`<${H}.${+V+1}.0-0`:G?k=`<=${H}.${V}.${A}-${G}`:T?k=`<${H}.${V}.${+A+1}-0`:k=`<=${k}`,`${B} ${k}`.trim()),U=(T,N,B)=>{for(let I=0;I<T.length;I++)if(!T[I].test(N))return!1;if(N.prerelease.length&&!B.includePrerelease){for(let I=0;I<T.length;I++)if(o(T[I].semver),T[I].semver!==i.ANY&&T[I].semver.prerelease.length>0){const F=T[I].semver;if(F.major===N.major&&F.minor===N.minor&&F.patch===N.patch)return!0}return!1}return!0};return rr}var ir,oa;function Ds(){if(oa)return ir;oa=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(d,u){if(u=n(u),d instanceof t){if(d.loose===!!u.loose)return d;d=d.value}d=d.trim().split(/\s+/).join(" "),o("comparator",d,u),this.options=u,this.loose=!!u.loose,this.parse(d),this.semver===e?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(d){const u=this.options.loose?s[r.COMPARATORLOOSE]:s[r.COMPARATOR],h=d.match(u);if(!h)throw new TypeError(`Invalid comparator: ${d}`);this.operator=h[1]!==void 0?h[1]:"",this.operator==="="&&(this.operator=""),h[2]?this.semver=new a(h[2],this.options.loose):this.semver=e}toString(){return this.value}test(d){if(o("Comparator.test",d,this.options.loose),this.semver===e||d===e)return!0;if(typeof d=="string")try{d=new a(d,this.options)}catch{return!1}return i(d,this.operator,this.semver,this.options)}intersects(d,u){if(!(d instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(d.value,u).test(this.value):d.operator===""?d.value===""?!0:new l(this.value,u).test(d.semver):(u=n(u),u.includePrerelease&&(this.value==="<0.0.0-0"||d.value==="<0.0.0-0")||!u.includePrerelease&&(this.value.startsWith("<0.0.0")||d.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&d.operator.startsWith(">")||this.operator.startsWith("<")&&d.operator.startsWith("<")||this.semver.version===d.semver.version&&this.operator.includes("=")&&d.operator.includes("=")||i(this.semver,"<",d.semver,u)&&this.operator.startsWith(">")&&d.operator.startsWith("<")||i(this.semver,">",d.semver,u)&&this.operator.startsWith("<")&&d.operator.startsWith(">")))}}ir=t;const n=Ci,{safeRe:s,t:r}=zn,i=su,o=$s,a=De,l=nt();return ir}const Cg=nt(),Ng=(e,t,n)=>{try{t=new Cg(t,n)}catch{return!1}return t.test(e)};var Vs=Ng;const Ag=nt(),Pg=(e,t)=>new Ag(e,t).set.map(n=>n.map(s=>s.value).join(" ").trim().split(" "));var jg=Pg;const Rg=De,kg=nt(),Ig=(e,t,n)=>{let s=null,r=null,i=null;try{i=new kg(t,n)}catch{return null}return e.forEach(o=>{i.test(o)&&(!s||r.compare(o)===-1)&&(s=o,r=new Rg(s,n))}),s};var Mg=Ig;const $g=De,Lg=nt(),Dg=(e,t,n)=>{let s=null,r=null,i=null;try{i=new Lg(t,n)}catch{return null}return e.forEach(o=>{i.test(o)&&(!s||r.compare(o)===1)&&(s=o,r=new $g(s,n))}),s};var Vg=Dg;const or=De,Og=nt(),aa=Ls,Bg=(e,t)=>{e=new Og(e,t);let n=new or("0.0.0");if(e.test(n)||(n=new or("0.0.0-0"),e.test(n)))return n;n=null;for(let s=0;s<e.set.length;++s){const r=e.set[s];let i=null;r.forEach(o=>{const a=new or(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||aa(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!n||aa(n,i))&&(n=i)}return n&&e.test(n)?n:null};var Fg=Bg;const Hg=nt(),Ug=(e,t)=>{try{return new Hg(e,t).range||"*"}catch{return null}};var zg=Ug;const Gg=De,ru=Ds(),{ANY:Wg}=ru,Kg=nt(),Xg=Vs,la=Ls,ca=Ai,Yg=ji,Zg=Pi,Jg=(e,t,n,s)=>{e=new Gg(e,s),t=new Kg(t,s);let r,i,o,a,l;switch(n){case">":r=la,i=Yg,o=ca,a=">",l=">=";break;case"<":r=ca,i=Zg,o=la,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Xg(e,t,s))return!1;for(let c=0;c<t.set.length;++c){const d=t.set[c];let u=null,h=null;if(d.forEach(f=>{f.semver===Wg&&(f=new ru(">=0.0.0")),u=u||f,h=h||f,r(f.semver,u.semver,s)?u=f:o(f.semver,h.semver,s)&&(h=f)}),u.operator===a||u.operator===l||(!h.operator||h.operator===a)&&i(e,h.semver))return!1;if(h.operator===l&&o(e,h.semver))return!1}return!0};var Ri=Jg;const Qg=Ri,qg=(e,t,n)=>Qg(e,t,">",n);var e0=qg;const t0=Ri,n0=(e,t,n)=>t0(e,t,"<",n);var s0=n0;const ua=nt(),r0=(e,t,n)=>(e=new ua(e,n),t=new ua(t,n),e.intersects(t,n));var i0=r0;const o0=Vs,a0=tt;var l0=(e,t,n)=>{const s=[];let r=null,i=null;const o=e.sort((d,u)=>a0(d,u,n));for(const d of o)o0(d,t,n)?(i=d,r||(r=d)):(i&&s.push([r,i]),i=null,r=null);r&&s.push([r,null]);const a=[];for(const[d,u]of s)d===u?a.push(d):!u&&d===o[0]?a.push("*"):u?d===o[0]?a.push(`<=${u}`):a.push(`${d} - ${u}`):a.push(`>=${d}`);const l=a.join(" || "),c=typeof t.raw=="string"?t.raw:String(t);return l.length<c.length?l:t};const da=nt(),ki=Ds(),{ANY:ar}=ki,wn=Vs,Ii=tt,c0=(e,t,n={})=>{if(e===t)return!0;e=new da(e,n),t=new da(t,n);let s=!1;e:for(const r of e.set){for(const i of t.set){const o=d0(r,i,n);if(s=s||o!==null,o)continue e}if(s)return!1}return!0},u0=[new ki(">=0.0.0-0")],fa=[new ki(">=0.0.0")],d0=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===ar){if(t.length===1&&t[0].semver===ar)return!0;n.includePrerelease?e=u0:e=fa}if(t.length===1&&t[0].semver===ar){if(n.includePrerelease)return!0;t=fa}const s=new Set;let r,i;for(const f of e)f.operator===">"||f.operator===">="?r=ha(r,f,n):f.operator==="<"||f.operator==="<="?i=ma(i,f,n):s.add(f.semver);if(s.size>1)return null;let o;if(r&&i){if(o=Ii(r.semver,i.semver,n),o>0)return null;if(o===0&&(r.operator!==">="||i.operator!=="<="))return null}for(const f of s){if(r&&!wn(f,String(r),n)||i&&!wn(f,String(i),n))return null;for(const p of t)if(!wn(f,String(p),n))return!1;return!0}let a,l,c,d,u=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1,h=r&&!n.includePrerelease&&r.semver.prerelease.length?r.semver:!1;u&&u.prerelease.length===1&&i.operator==="<"&&u.prerelease[0]===0&&(u=!1);for(const f of t){if(d=d||f.operator===">"||f.operator===">=",c=c||f.operator==="<"||f.operator==="<=",r){if(h&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===h.major&&f.semver.minor===h.minor&&f.semver.patch===h.patch&&(h=!1),f.operator===">"||f.operator===">="){if(a=ha(r,f,n),a===f&&a!==r)return!1}else if(r.operator===">="&&!wn(r.semver,String(f),n))return!1}if(i){if(u&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===u.major&&f.semver.minor===u.minor&&f.semver.patch===u.patch&&(u=!1),f.operator==="<"||f.operator==="<="){if(l=ma(i,f,n),l===f&&l!==i)return!1}else if(i.operator==="<="&&!wn(i.semver,String(f),n))return!1}if(!f.operator&&(i||r)&&o!==0)return!1}return!(r&&c&&!i&&o!==0||i&&d&&!r&&o!==0||h||u)},ha=(e,t,n)=>{if(!e)return t;const s=Ii(e.semver,t.semver,n);return s>0?e:s<0||t.operator===">"&&e.operator===">="?t:e},ma=(e,t,n)=>{if(!e)return t;const s=Ii(e.semver,t.semver,n);return s<0?e:s>0||t.operator==="<"&&e.operator==="<="?t:e};var f0=c0;const lr=zn,pa=Ms,h0=De,ga=eu,m0=mn,p0=bp,g0=_p,v0=Cp,y0=Ap,x0=Rp,w0=Mp,b0=Dp,E0=Bp,S0=tt,_0=zp,T0=Kp,C0=Ni,N0=Jp,A0=eg,P0=Ls,j0=Ai,R0=tu,k0=nu,I0=Pi,M0=ji,$0=su,L0=Sg,D0=Ds(),V0=nt(),O0=Vs,B0=jg,F0=Mg,H0=Vg,U0=Fg,z0=zg,G0=Ri,W0=e0,K0=s0,X0=i0,Y0=l0,Z0=f0;lr.re,lr.src,lr.t,pa.SEMVER_SPEC_VERSION,pa.RELEASE_TYPES,ga.compareIdentifiers,ga.rcompareIdentifiers;new TextEncoder;var Mi={exports:{}};Mi.exports;(function(e){const n=(i=0)=>o=>`\x1B[${38+i};5;${o}m`,s=(i=0)=>(o,a,l)=>`\x1B[${38+i};2;${o};${a};${l}m`;function r(){const i=new Map,o={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};o.color.gray=o.color.blackBright,o.bgColor.bgGray=o.bgColor.bgBlackBright,o.color.grey=o.color.blackBright,o.bgColor.bgGrey=o.bgColor.bgBlackBright;for(const[a,l]of Object.entries(o)){for(const[c,d]of Object.entries(l))o[c]={open:`\x1B[${d[0]}m`,close:`\x1B[${d[1]}m`},l[c]=o[c],i.set(d[0],d[1]);Object.defineProperty(o,a,{value:l,enumerable:!1})}return Object.defineProperty(o,"codes",{value:i,enumerable:!1}),o.color.close="\x1B[39m",o.bgColor.close="\x1B[49m",o.color.ansi256=n(),o.color.ansi16m=s(),o.bgColor.ansi256=n(10),o.bgColor.ansi16m=s(10),Object.defineProperties(o,{rgbToAnsi256:{value:(a,l,c)=>a===l&&l===c?a<8?16:a>248?231:Math.round((a-8)/247*24)+232:16+36*Math.round(a/255*5)+6*Math.round(l/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:a=>{const l=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(a.toString(16));if(!l)return[0,0,0];let{colorString:c}=l.groups;c.length===3&&(c=c.split("").map(u=>u+u).join(""));const d=Number.parseInt(c,16);return[d>>16&255,d>>8&255,d&255]},enumerable:!1},hexToAnsi256:{value:a=>o.rgbToAnsi256(...o.hexToRgb(a)),enumerable:!1}}),o}Object.defineProperty(e,"exports",{enumerable:!0,get:r})})(Mi);Mi.exports;new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function J0(e){try{return Bm(e)}catch{return null}}function Q0(e){return e.type==="remove"&&e.id!=null?new Uc({...e,id:e.id}):Om(e)}class iu{constructor(){Object.defineProperty(this,"chunks",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this.chunks={}}add(t,n){var o,a;t.type.endsWith("MessageChunk")&&(t.type=t.type.slice(0,-12).toLowerCase());const s=Q0(t),r=J0(s),{id:i}=r??s;if(!i)return console.warn("No message ID found for chunk, ignoring in state",t),null;if((o=this.chunks)[i]??(o[i]={}),this.chunks[i].metadata=n??this.chunks[i].metadata,r){const l=this.chunks[i].chunk;this.chunks[i].chunk=((a=km(l)?l:null)==null?void 0:a.concat(r))??r}else this.chunks[i].chunk=s;return i}clear(){this.chunks={}}get(t,n){var s;return t==null||this.chunks[t]==null?null:(n!=null&&((s=this.chunks[t]).index??(s.index=n)),this.chunks[t])}}const q0=e=>{const{type:t,data:n}=e.toDict();return{...n,type:t}};class ou{constructor(t){Object.defineProperty(this,"abortRef",{enumerable:!0,configurable:!0,writable:!0,value:new AbortController}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"listeners",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setState",{enumerable:!0,configurable:!0,writable:!0,value:n=>{this.state={...this.state,...n},this.notifyListeners()}}),Object.defineProperty(this,"notifyListeners",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.listeners.forEach(n=>n())}}),Object.defineProperty(this,"subscribe",{enumerable:!0,configurable:!0,writable:!0,value:n=>(this.listeners.add(n),()=>this.listeners.delete(n))}),Object.defineProperty(this,"getSnapshot",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.state}),Object.defineProperty(this,"setStreamValues",{enumerable:!0,configurable:!0,writable:!0,value:(n,s="stream")=>{if(typeof n=="function"){const[r,i]=this.state.values??[null,"stream"],o=n(r,i);this.setState({values:o!=null?[o,s]:null})}else{const r=n!=null?[n,s]:null;this.setState({values:r})}}}),Object.defineProperty(this,"getMutateFn",{enumerable:!0,configurable:!0,writable:!0,value:(n,s)=>r=>{const i={...s,...(this.state.values??[null,"stream"])[0]},o=typeof r=="function"?r(i):r;this.setStreamValues({...i,...o},n)}}),Object.defineProperty(this,"matchEventType",{enumerable:!0,configurable:!0,writable:!0,value:(n,s,r)=>n===s||s.startsWith(`${n}|`)}),Object.defineProperty(this,"start",{enumerable:!0,configurable:!0,writable:!0,value:async(n,s)=>{var r,i,o,a,l,c,d,u,h,f,p,v,y,b,x,w,E;if(!this.state.isLoading)try{this.setState({isLoading:!0,error:void 0}),this.abortRef=new AbortController;const _=await n(this.abortRef.signal);let j;for await(const{event:R,data:P}of _){if(R==="error"){j=new Dr(P);break}const M=R.includes("|")?R.split("|").slice(1):void 0,L=this.getMutateFn("stream",s.initialValues);if(R==="metadata"&&((i=(r=s.callbacks).onMetadataEvent)==null||i.call(r,P)),R==="events"&&((a=(o=s.callbacks).onLangChainEvent)==null||a.call(o,P)),this.matchEventType("updates",R,P)&&((c=(l=s.callbacks).onUpdateEvent)==null||c.call(l,P,{namespace:M,mutate:L})),this.matchEventType("custom",R,P)&&((u=(d=s.callbacks).onCustomEvent)==null||u.call(d,P,{namespace:M,mutate:L})),this.matchEventType("checkpoints",R,P)&&((f=(h=s.callbacks).onCheckpointEvent)==null||f.call(h,P,{namespace:M})),this.matchEventType("tasks",R,P)&&((v=(p=s.callbacks).onTaskEvent)==null||v.call(p,P,{namespace:M})),this.matchEventType("debug",R,P)&&((b=(y=s.callbacks).onDebugEvent)==null||b.call(y,P,{namespace:M})),R==="values"&&("__interrupt__"in P?this.setStreamValues($=>({...$,...P})):this.setStreamValues(P)),this.matchEventType("messages",R,P)){const[$,U]=P,T=this.messages.add($,U);if(!T){console.warn("Failed to add message to manager, no message ID found");continue}this.setStreamValues(N=>{const B={...s.initialValues,...N},I=s.getMessages(B).slice(),{chunk:F,index:S}=this.messages.get(T,I.length)??{};return!F||S==null?B:(F.getType()==="remove"?I.splice(S,1):I[S]=q0(F),s.setMessages(B,I))})}}if(j!=null)throw j;const D=await((x=s.onSuccess)==null?void 0:x.call(s));typeof D<"u"&&this.setStreamValues(D)}catch(_){_ instanceof Error&&(_.name==="AbortError"||_.name==="TimeoutError")||(console.error(_),this.setState({error:_}),await((w=s.onError)==null?void 0:w.call(s,_)))}finally{this.setState({isLoading:!1}),this.abortRef=new AbortController,(E=s.onFinish)==null||E.call(s)}}}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:async(n,s)=>{var r;this.abortRef.abort(),this.abortRef=new AbortController,(r=s.onStop)==null||r.call(s,{mutate:this.getMutateFn("stop",n)})}}),Object.defineProperty(this,"clear",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.abortRef.abort(),this.abortRef=new AbortController,this.setState({error:void 0,values:null}),this.messages.clear()}}),this.messages=t,this.state={isLoading:!1,values:null,error:void 0}}get isLoading(){return this.state.isLoading}get values(){var t;return((t=this.state.values)==null?void 0:t[0])??null}get error(){return this.state.error}}const ev=(...e)=>fetch(...e),tv=Symbol.for("lg:fetch_implementation"),nv=()=>globalThis[tv]??ev,sv=[400,401,402,403,404,405,406,407,408,409,422];function rv(e){return e==null||typeof e!="object"?!1:"status"in e&&"statusText"in e&&"text"in e}class Mn extends Error{constructor(t,n,s){super(`HTTP ${t}: ${n}`),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.status=t,this.text=n,this.response=s}static async fromResponse(t,n){try{return new Mn(t.status,await t.text(),n!=null&&n.includeResponse?t:void 0)}catch{return new Mn(t.status,t.statusText,n!=null&&n.includeResponse?t:void 0)}}}class iv{constructor(t){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"customFetch",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=t.maxConcurrency??1/0,this.maxRetries=t.maxRetries??4,"default"in nr?this.queue=new nr.default({concurrency:this.maxConcurrency}):this.queue=new nr({concurrency:this.maxConcurrency}),this.onFailedResponseHook=t==null?void 0:t.onFailedResponseHook,this.customFetch=t.fetch}call(t,...n){const{onFailedResponseHook:s}=this;return this.queue.add(()=>Xm(()=>t(...n).catch(async r=>{throw r instanceof Error?r:rv(r)?await Mn.fromResponse(r,{includeResponse:!!s}):new Error(r)}),{async onFailedAttempt(r){if(r.message.startsWith("Cancel")||r.message.startsWith("TimeoutError")||r.message.startsWith("AbortError")||(r==null?void 0:r.code)==="ECONNABORTED")throw r;if(r instanceof Mn){if(sv.includes(r.status))throw r;s&&r.response&&await s(r.response)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(t,n,...s){return t.signal?Promise.race([this.call(n,...s),new Promise((r,i)=>{var o;(o=t.signal)==null||o.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(n,...s)}fetch(...t){const n=this.customFetch??nv();return this.call(()=>n(...t).then(s=>s.ok?s:Promise.reject(s)))}}var cr={};function ov(e){try{return typeof process<"u"?cr==null?void 0:cr[e]:void 0}catch{return}}function av(...e){const t=e.filter(s=>s!=null);if(t.length===0)return;if(t.length===1)return t[0];const n=new AbortController;for(const s of e){if(s!=null&&s.aborted)return n.abort(s.reason),n.signal;s==null||s.addEventListener("abort",()=>n.abort(s.reason),{once:!0})}return n.signal}const Tn=13,Or=10,lv=0,va=58,cv=32,uv=[Tn,Or];function Br(){let e=[],t=!1;return new TransformStream({start(){e=[],t=!1},transform(n,s){let r=n;if(t&&(r=fs([[Tn],r]),t=!1),r.length>0&&r.at(-1)===Tn&&(t=!0,r=r.subarray(0,-1)),!r.length)return;const i=uv.includes(r.at(-1)),o=r.length-1,{lines:a}=r.reduce((l,c,d)=>(l.from>d||((c===Tn||c===Or)&&(l.lines.push(r.subarray(l.from,d)),c===Tn&&r[d+1]===Or?l.from=d+2:l.from=d+1),d===o&&l.from<=o&&l.lines.push(r.subarray(l.from))),l),{lines:[],from:0});if(a.length===1&&!i){e.push(a[0]);return}e.length&&(e.push(a[0]),a[0]=fs(e),e=[]),i||a.length&&(e=[a.pop()]);for(const l of a)s.enqueue(l)},flush(n){e.length&&n.enqueue(fs(e))}})}function Fr(){let e="",t=[],n="",s=null;const r=new TextDecoder;return new TransformStream({transform(i,o){if(!i.length){if(!e&&!t.length&&!n&&s==null)return;const d={id:n||void 0,event:e,data:t.length?ya(r,t):null};e="",t=[],s=null,o.enqueue(d);return}if(i[0]===va)return;const a=i.indexOf(va);if(a===-1)return;const l=r.decode(i.subarray(0,a));let c=i.subarray(a+1);if(c[0]===cv&&(c=c.subarray(1)),l==="event")e=r.decode(c);else if(l==="data")t.push(c);else if(l==="id")c.indexOf(lv)===-1&&(n=r.decode(c));else if(l==="retry"){const d=Number.parseInt(r.decode(c),10);Number.isNaN(d)||(s=d)}},flush(i){e&&i.enqueue({id:n||void 0,event:e,data:t.length?ya(r,t):null})}})}function fs(e){const t=e.reduce((r,i)=>r+i.length,0),n=new Uint8Array(t);let s=0;for(const r of e)n.set(r,s),s+=r.length;return n}function ya(e,t){return JSON.parse(e.decode(fs(t)))}class an extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const t=await this.reader.read();return t.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:t.value}}catch(t){throw this.reader.releaseLock(),t}}async return(){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}return{done:!0,value:void 0}}async throw(t){if(this.ensureReader(),this.locked){const n=this.reader.cancel();this.reader.releaseLock(),await n}throw t}async[Symbol.asyncDispose](){await this.return()}[Symbol.asyncIterator](){return this}static fromReadableStream(t){const n=t.getReader();return new an({start(s){return r();function r(){return n.read().then(({done:i,value:o})=>{if(i){s.close();return}return s.enqueue(o),r()})}},cancel(){n.releaseLock()}})}static fromAsyncGenerator(t){return new an({async pull(n){const{value:s,done:r}=await t.next();r&&n.close(),n.enqueue(s)},async cancel(n){await t.return(n)}})}}function*dv(e){let t,n=!1;if(e instanceof Headers){const s=[];e.forEach((r,i)=>{s.push([i,r])}),t=s}else Array.isArray(e)?t=e:(n=!0,t=Object.entries(e??{}));for(const s of t){const r=s[0];if(typeof r!="string")throw new TypeError(`Expected header name to be a string, got ${typeof r}`);const i=Array.isArray(s[1])?s[1]:[s[1]];let o=!1;for(const a of i)a!==void 0&&(n&&!o&&(o=!0,yield[r,null]),yield[r,a])}}function xa(...e){const t=new Headers;for(const s of e)if(s)for(const[r,i]of dv(s))i===null?t.delete(r):t.append(r,i);const n=[];return t.forEach((s,r)=>{n.push([r,s])}),Object.fromEntries(n)}function fv(e){if(e)return e;const t=["LANGGRAPH","LANGSMITH","LANGCHAIN"];for(const n of t){const s=ov(`${n}_API_KEY`);if(s)return s.trim().replace(/^["']|["']$/g,"")}}const hv=/(\/threads\/(?<thread_id>.+))?\/runs\/(?<run_id>.+)/;function ur(e){var s;const t=e.headers.get("Content-Location");if(!t)return;const n=hv.exec(t);if((s=n==null?void 0:n.groups)!=null&&s.run_id)return{run_id:n.groups.run_id,thread_id:n.groups.thread_id||void 0}}class pn{constructor(t){var i;Object.defineProperty(this,"asyncCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeoutMs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultHeaders",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onRequest",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n={maxRetries:4,maxConcurrency:4,...t==null?void 0:t.callerOptions};let s="http://localhost:8123";if(!(t!=null&&t.apiUrl)&&typeof globalThis=="object"&&globalThis!=null){const o=Symbol.for("langgraph_api:fetch"),a=Symbol.for("langgraph_api:url"),l=globalThis;l[o]&&(n.fetch??(n.fetch=l[o])),l[a]&&(s=l[a])}this.asyncCaller=new iv(n),this.timeoutMs=t==null?void 0:t.timeoutMs,this.apiUrl=((i=t==null?void 0:t.apiUrl)==null?void 0:i.replace(/\/$/,""))||s,this.defaultHeaders=(t==null?void 0:t.defaultHeaders)||{},this.onRequest=t==null?void 0:t.onRequest;const r=fv(t==null?void 0:t.apiKey);r&&(this.defaultHeaders["x-api-key"]=r)}prepareFetchOptions(t,n){const s={...n,headers:xa(this.defaultHeaders,n==null?void 0:n.headers)};s.json&&(s.body=JSON.stringify(s.json),s.headers=xa(s.headers,{"content-type":"application/json"}),delete s.json),s.withResponse&&delete s.withResponse;let r=null;typeof(n==null?void 0:n.timeoutMs)<"u"?n.timeoutMs!=null&&(r=AbortSignal.timeout(n.timeoutMs)):this.timeoutMs!=null&&(r=AbortSignal.timeout(this.timeoutMs)),s.signal=av(r,s.signal);const i=new URL(`${this.apiUrl}${t}`);if(s.params){for(const[o,a]of Object.entries(s.params)){if(a==null)continue;const l=typeof a=="string"||typeof a=="number"?a.toString():JSON.stringify(a);i.searchParams.append(o,l)}delete s.params}return[i,s]}async fetch(t,n){const[s,r]=this.prepareFetchOptions(t,n);let i=r;this.onRequest&&(i=await this.onRequest(s,r));const o=await this.asyncCaller.fetch(s,i),a=(()=>{if(!(o.status===202||o.status===204))return o.json()})();return n!=null&&n.withResponse?[await a,o]:a}}class mv extends pn{async createForThread(t,n,s){const r={schedule:s==null?void 0:s.schedule,input:s==null?void 0:s.input,config:s==null?void 0:s.config,context:s==null?void 0:s.context,metadata:s==null?void 0:s.metadata,assistant_id:n,interrupt_before:s==null?void 0:s.interruptBefore,interrupt_after:s==null?void 0:s.interruptAfter,webhook:s==null?void 0:s.webhook,multitask_strategy:s==null?void 0:s.multitaskStrategy,if_not_exists:s==null?void 0:s.ifNotExists,checkpoint_during:s==null?void 0:s.checkpointDuring,durability:s==null?void 0:s.durability};return this.fetch(`/threads/${t}/runs/crons`,{method:"POST",json:r})}async create(t,n){const s={schedule:n==null?void 0:n.schedule,input:n==null?void 0:n.input,config:n==null?void 0:n.config,context:n==null?void 0:n.context,metadata:n==null?void 0:n.metadata,assistant_id:t,interrupt_before:n==null?void 0:n.interruptBefore,interrupt_after:n==null?void 0:n.interruptAfter,webhook:n==null?void 0:n.webhook,multitask_strategy:n==null?void 0:n.multitaskStrategy,if_not_exists:n==null?void 0:n.ifNotExists,checkpoint_during:n==null?void 0:n.checkpointDuring,durability:n==null?void 0:n.durability};return this.fetch("/runs/crons",{method:"POST",json:s})}async delete(t){await this.fetch(`/runs/crons/${t}`,{method:"DELETE"})}async search(t){return this.fetch("/runs/crons/search",{method:"POST",json:{assistant_id:(t==null?void 0:t.assistantId)??void 0,thread_id:(t==null?void 0:t.threadId)??void 0,limit:(t==null?void 0:t.limit)??10,offset:(t==null?void 0:t.offset)??0,sort_by:(t==null?void 0:t.sortBy)??void 0,sort_order:(t==null?void 0:t.sortOrder)??void 0,select:(t==null?void 0:t.select)??void 0}})}async count(t){return this.fetch("/runs/crons/count",{method:"POST",json:{assistant_id:(t==null?void 0:t.assistantId)??void 0,thread_id:(t==null?void 0:t.threadId)??void 0}})}}class pv extends pn{async get(t){return this.fetch(`/assistants/${t}`)}async getGraph(t,n){return this.fetch(`/assistants/${t}/graph`,{params:{xray:n==null?void 0:n.xray}})}async getSchemas(t){return this.fetch(`/assistants/${t}/schemas`)}async getSubgraphs(t,n){return n!=null&&n.namespace?this.fetch(`/assistants/${t}/subgraphs/${n.namespace}`,{params:{recurse:n==null?void 0:n.recurse}}):this.fetch(`/assistants/${t}/subgraphs`,{params:{recurse:n==null?void 0:n.recurse}})}async create(t){return this.fetch("/assistants",{method:"POST",json:{graph_id:t.graphId,config:t.config,context:t.context,metadata:t.metadata,assistant_id:t.assistantId,if_exists:t.ifExists,name:t.name,description:t.description}})}async update(t,n){return this.fetch(`/assistants/${t}`,{method:"PATCH",json:{graph_id:n.graphId,config:n.config,context:n.context,metadata:n.metadata,name:n.name,description:n.description}})}async delete(t){return this.fetch(`/assistants/${t}`,{method:"DELETE"})}async search(t){return this.fetch("/assistants/search",{method:"POST",json:{graph_id:(t==null?void 0:t.graphId)??void 0,metadata:(t==null?void 0:t.metadata)??void 0,limit:(t==null?void 0:t.limit)??10,offset:(t==null?void 0:t.offset)??0,sort_by:(t==null?void 0:t.sortBy)??void 0,sort_order:(t==null?void 0:t.sortOrder)??void 0,select:(t==null?void 0:t.select)??void 0}})}async count(t){return this.fetch("/assistants/count",{method:"POST",json:{metadata:(t==null?void 0:t.metadata)??void 0,graph_id:(t==null?void 0:t.graphId)??void 0}})}async getVersions(t,n){return this.fetch(`/assistants/${t}/versions`,{method:"POST",json:{metadata:(n==null?void 0:n.metadata)??void 0,limit:(n==null?void 0:n.limit)??10,offset:(n==null?void 0:n.offset)??0}})}async setLatest(t,n){return this.fetch(`/assistants/${t}/latest`,{method:"POST",json:{version:n}})}}class gv extends pn{async get(t){return this.fetch(`/threads/${t}`)}async create(t){var s;const n=typeof(t==null?void 0:t.ttl)=="number"?{ttl:t.ttl,strategy:"delete"}:t==null?void 0:t.ttl;return this.fetch("/threads",{method:"POST",json:{metadata:{...t==null?void 0:t.metadata,graph_id:t==null?void 0:t.graphId},thread_id:t==null?void 0:t.threadId,if_exists:t==null?void 0:t.ifExists,supersteps:(s=t==null?void 0:t.supersteps)==null?void 0:s.map(r=>({updates:r.updates.map(i=>({values:i.values,command:i.command,as_node:i.asNode}))})),ttl:n}})}async copy(t){return this.fetch(`/threads/${t}/copy`,{method:"POST"})}async update(t,n){const s=typeof(n==null?void 0:n.ttl)=="number"?{ttl:n.ttl,strategy:"delete"}:n==null?void 0:n.ttl;return this.fetch(`/threads/${t}`,{method:"PATCH",json:{metadata:n==null?void 0:n.metadata,ttl:s}})}async delete(t){return this.fetch(`/threads/${t}`,{method:"DELETE"})}async search(t){return this.fetch("/threads/search",{method:"POST",json:{metadata:(t==null?void 0:t.metadata)??void 0,ids:(t==null?void 0:t.ids)??void 0,limit:(t==null?void 0:t.limit)??10,offset:(t==null?void 0:t.offset)??0,status:t==null?void 0:t.status,sort_by:t==null?void 0:t.sortBy,sort_order:t==null?void 0:t.sortOrder,select:(t==null?void 0:t.select)??void 0}})}async count(t){return this.fetch("/threads/count",{method:"POST",json:{metadata:(t==null?void 0:t.metadata)??void 0,values:(t==null?void 0:t.values)??void 0,status:(t==null?void 0:t.status)??void 0}})}async getState(t,n,s){return n!=null?typeof n!="string"?this.fetch(`/threads/${t}/state/checkpoint`,{method:"POST",json:{checkpoint:n,subgraphs:s==null?void 0:s.subgraphs}}):this.fetch(`/threads/${t}/state/${n}`,{params:{subgraphs:s==null?void 0:s.subgraphs}}):this.fetch(`/threads/${t}/state`,{params:{subgraphs:s==null?void 0:s.subgraphs}})}async updateState(t,n){return this.fetch(`/threads/${t}/state`,{method:"POST",json:{values:n.values,checkpoint_id:n.checkpointId,checkpoint:n.checkpoint,as_node:n==null?void 0:n.asNode}})}async patchState(t,n){var r;let s;if(typeof t!="string"){if(typeof((r=t.configurable)==null?void 0:r.thread_id)!="string")throw new Error("Thread ID is required when updating state with a config.");s=t.configurable.thread_id}else s=t;return this.fetch(`/threads/${s}/state`,{method:"PATCH",json:{metadata:n}})}async getHistory(t,n){return this.fetch(`/threads/${t}/history`,{method:"POST",json:{limit:(n==null?void 0:n.limit)??10,before:n==null?void 0:n.before,metadata:n==null?void 0:n.metadata,checkpoint:n==null?void 0:n.checkpoint}})}async*joinStream(t,n){let[s,r]=this.prepareFetchOptions(`/threads/${t}/stream`,{method:"GET",headers:n!=null&&n.lastEventId?{"Last-Event-ID":n.lastEventId}:void 0,params:n!=null&&n.streamMode?{stream_mode:n.streamMode}:void 0});this.onRequest!=null&&(r=await this.onRequest(s,r));const o=((await this.asyncCaller.fetch(s,r)).body||new ReadableStream({start:a=>a.close()})).pipeThrough(Br()).pipeThrough(Fr());yield*an.fromReadableStream(o)}}class vv extends pn{async*stream(t,n,s){var u;const r={input:s==null?void 0:s.input,command:s==null?void 0:s.command,config:s==null?void 0:s.config,context:s==null?void 0:s.context,metadata:s==null?void 0:s.metadata,stream_mode:s==null?void 0:s.streamMode,stream_subgraphs:s==null?void 0:s.streamSubgraphs,stream_resumable:s==null?void 0:s.streamResumable,feedback_keys:s==null?void 0:s.feedbackKeys,assistant_id:n,interrupt_before:s==null?void 0:s.interruptBefore,interrupt_after:s==null?void 0:s.interruptAfter,checkpoint:s==null?void 0:s.checkpoint,checkpoint_id:s==null?void 0:s.checkpointId,webhook:s==null?void 0:s.webhook,multitask_strategy:s==null?void 0:s.multitaskStrategy,on_completion:s==null?void 0:s.onCompletion,on_disconnect:s==null?void 0:s.onDisconnect,after_seconds:s==null?void 0:s.afterSeconds,if_not_exists:s==null?void 0:s.ifNotExists,checkpoint_during:s==null?void 0:s.checkpointDuring,durability:s==null?void 0:s.durability},i=t==null?"/runs/stream":`/threads/${t}/runs/stream`;let[o,a]=this.prepareFetchOptions(i,{method:"POST",json:r,timeoutMs:null,signal:s==null?void 0:s.signal});this.onRequest!=null&&(a=await this.onRequest(o,a));const l=await this.asyncCaller.fetch(o,a),c=ur(l);c&&((u=s==null?void 0:s.onRunCreated)==null||u.call(s,c));const d=(l.body||new ReadableStream({start:h=>h.close()})).pipeThrough(Br()).pipeThrough(Fr());yield*an.fromReadableStream(d)}async create(t,n,s){var l,c,d;const r={input:s==null?void 0:s.input,command:s==null?void 0:s.command,config:s==null?void 0:s.config,context:s==null?void 0:s.context,metadata:s==null?void 0:s.metadata,stream_mode:s==null?void 0:s.streamMode,stream_subgraphs:s==null?void 0:s.streamSubgraphs,stream_resumable:s==null?void 0:s.streamResumable,assistant_id:n,interrupt_before:s==null?void 0:s.interruptBefore,interrupt_after:s==null?void 0:s.interruptAfter,webhook:s==null?void 0:s.webhook,checkpoint:s==null?void 0:s.checkpoint,checkpoint_id:s==null?void 0:s.checkpointId,multitask_strategy:s==null?void 0:s.multitaskStrategy,after_seconds:s==null?void 0:s.afterSeconds,if_not_exists:s==null?void 0:s.ifNotExists,checkpoint_during:s==null?void 0:s.checkpointDuring,durability:s==null?void 0:s.durability,langsmith_tracer:s!=null&&s._langsmithTracer?{project_name:(l=s==null?void 0:s._langsmithTracer)==null?void 0:l.projectName,example_id:(c=s==null?void 0:s._langsmithTracer)==null?void 0:c.exampleId}:void 0},[i,o]=await this.fetch(`/threads/${t}/runs`,{method:"POST",json:r,signal:s==null?void 0:s.signal,withResponse:!0}),a=ur(o);return a&&((d=s==null?void 0:s.onRunCreated)==null||d.call(s,a)),i}async createBatch(t){const n=t.map(s=>({...s,assistant_id:s.assistantId})).map(s=>Object.fromEntries(Object.entries(s).filter(([r,i])=>i!==void 0)));return this.fetch("/runs/batch",{method:"POST",json:n})}async wait(t,n,s){var d,u,h,f,p;const r={input:s==null?void 0:s.input,command:s==null?void 0:s.command,config:s==null?void 0:s.config,context:s==null?void 0:s.context,metadata:s==null?void 0:s.metadata,assistant_id:n,interrupt_before:s==null?void 0:s.interruptBefore,interrupt_after:s==null?void 0:s.interruptAfter,checkpoint:s==null?void 0:s.checkpoint,checkpoint_id:s==null?void 0:s.checkpointId,webhook:s==null?void 0:s.webhook,multitask_strategy:s==null?void 0:s.multitaskStrategy,on_completion:s==null?void 0:s.onCompletion,on_disconnect:s==null?void 0:s.onDisconnect,after_seconds:s==null?void 0:s.afterSeconds,if_not_exists:s==null?void 0:s.ifNotExists,checkpoint_during:s==null?void 0:s.checkpointDuring,durability:s==null?void 0:s.durability,langsmith_tracer:s!=null&&s._langsmithTracer?{project_name:(d=s==null?void 0:s._langsmithTracer)==null?void 0:d.projectName,example_id:(u=s==null?void 0:s._langsmithTracer)==null?void 0:u.exampleId}:void 0},i=t==null?"/runs/wait":`/threads/${t}/runs/wait`,[o,a]=await this.fetch(i,{method:"POST",json:r,timeoutMs:null,signal:s==null?void 0:s.signal,withResponse:!0}),l=ur(a);if(l&&((h=s==null?void 0:s.onRunCreated)==null||h.call(s,l)),((s==null?void 0:s.raiseError)!==void 0?s.raiseError:!0)&&"__error__"in o&&typeof o.__error__=="object"&&o.__error__&&"error"in o.__error__&&"message"in o.__error__)throw new Error(`${(f=o.__error__)==null?void 0:f.error}: ${(p=o.__error__)==null?void 0:p.message}`);return o}async list(t,n){return this.fetch(`/threads/${t}/runs`,{params:{limit:(n==null?void 0:n.limit)??10,offset:(n==null?void 0:n.offset)??0,status:(n==null?void 0:n.status)??void 0,select:(n==null?void 0:n.select)??void 0}})}async get(t,n){return this.fetch(`/threads/${t}/runs/${n}`)}async cancel(t,n,s=!1,r="interrupt"){return this.fetch(`/threads/${t}/runs/${n}/cancel`,{method:"POST",params:{wait:s?"1":"0",action:r}})}async join(t,n,s){return this.fetch(`/threads/${t}/runs/${n}/join`,{timeoutMs:null,signal:s==null?void 0:s.signal})}async*joinStream(t,n,s){const r=typeof s=="object"&&s!=null&&s instanceof AbortSignal?{signal:s}:s;let[i,o]=this.prepareFetchOptions(t!=null?`/threads/${t}/runs/${n}/stream`:`/runs/${n}/stream`,{method:"GET",timeoutMs:null,signal:r==null?void 0:r.signal,headers:r!=null&&r.lastEventId?{"Last-Event-ID":r.lastEventId}:void 0,params:{cancel_on_disconnect:r!=null&&r.cancelOnDisconnect?"1":"0",stream_mode:r==null?void 0:r.streamMode}});this.onRequest!=null&&(o=await this.onRequest(i,o));const l=((await this.asyncCaller.fetch(i,o)).body||new ReadableStream({start:c=>c.close()})).pipeThrough(Br()).pipeThrough(Fr());yield*an.fromReadableStream(l)}async delete(t,n){return this.fetch(`/threads/${t}/runs/${n}`,{method:"DELETE"})}}class yv extends pn{async putItem(t,n,s,r){t.forEach(o=>{if(o.includes("."))throw new Error(`Invalid namespace label '${o}'. Namespace labels cannot contain periods ('.')`)});const i={namespace:t,key:n,value:s,index:r==null?void 0:r.index,ttl:r==null?void 0:r.ttl};return this.fetch("/store/items",{method:"PUT",json:i})}async getItem(t,n,s){t.forEach(o=>{if(o.includes("."))throw new Error(`Invalid namespace label '${o}'. Namespace labels cannot contain periods ('.')`)});const r={namespace:t.join("."),key:n};(s==null?void 0:s.refreshTtl)!==void 0&&(r.refresh_ttl=s.refreshTtl);const i=await this.fetch("/store/items",{params:r});return i?{...i,createdAt:i.created_at,updatedAt:i.updated_at}:null}async deleteItem(t,n){return t.forEach(s=>{if(s.includes("."))throw new Error(`Invalid namespace label '${s}'. Namespace labels cannot contain periods ('.')`)}),this.fetch("/store/items",{method:"DELETE",json:{namespace:t,key:n}})}async searchItems(t,n){const s={namespace_prefix:t,filter:n==null?void 0:n.filter,limit:(n==null?void 0:n.limit)??10,offset:(n==null?void 0:n.offset)??0,query:n==null?void 0:n.query,refresh_ttl:n==null?void 0:n.refreshTtl};return{items:(await this.fetch("/store/items/search",{method:"POST",json:s})).items.map(i=>({...i,createdAt:i.created_at,updatedAt:i.updated_at}))}}async listNamespaces(t){const n={prefix:t==null?void 0:t.prefix,suffix:t==null?void 0:t.suffix,max_depth:t==null?void 0:t.maxDepth,limit:(t==null?void 0:t.limit)??100,offset:(t==null?void 0:t.offset)??0};return this.fetch("/store/namespaces",{method:"POST",json:n})}}class Rt extends pn{static getOrCached(t,n){if(Rt.promiseCache[t]!=null)return Rt.promiseCache[t];const s=n();return Rt.promiseCache[t]=s,s}async getComponent(t,n){return Rt.getOrCached(`${this.apiUrl}-${t}-${n}`,async()=>{let[s,r]=this.prepareFetchOptions(`/ui/${t}`,{headers:{Accept:"text/html","Content-Type":"application/json"},method:"POST",json:{name:n}});return this.onRequest!=null&&(r=await this.onRequest(s,r)),(await this.asyncCaller.fetch(s,r)).text()})}}Object.defineProperty(Rt,"promiseCache",{enumerable:!0,configurable:!0,writable:!0,value:{}});class au{constructor(t){Object.defineProperty(this,"assistants",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"threads",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"crons",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"~ui",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"~configHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this["~configHash"]=(()=>{var n,s,r,i;return JSON.stringify({apiUrl:t==null?void 0:t.apiUrl,apiKey:t==null?void 0:t.apiKey,timeoutMs:t==null?void 0:t.timeoutMs,defaultHeaders:t==null?void 0:t.defaultHeaders,maxConcurrency:(n=t==null?void 0:t.callerOptions)==null?void 0:n.maxConcurrency,maxRetries:(s=t==null?void 0:t.callerOptions)==null?void 0:s.maxRetries,callbacks:{onFailedResponseHook:((r=t==null?void 0:t.callerOptions)==null?void 0:r.onFailedResponseHook)!=null,onRequest:(t==null?void 0:t.onRequest)!=null,fetch:((i=t==null?void 0:t.callerOptions)==null?void 0:i.fetch)!=null}})})(),this.assistants=new pv(t),this.threads=new gv(t),this.runs=new vv(t),this.crons=new mv(t),this.store=new yv(t),this["~ui"]=new Rt(t)}}function xv(e){return e["~configHash"]}const lu=e=>{const[t,n]=g.useState((e==null?void 0:e.threadId)??null),s=g.useRef(e==null?void 0:e.onThreadId);s.current=e==null?void 0:e.onThreadId;const r=g.useCallback(i=>{var o;n(i),(o=s.current)==null||o.call(s,i)},[]);return!e||!("threadId"in e)?[t,r]:[e.threadId??null,r]};function wv(e,t,n){return[xv(e),t,n].join(":")}function bv(e,t,n){if((n==null?void 0:n.limit)===!1)return e.threads.getState(t).then(r=>r.checkpoint==null?[]:[r]);const s=typeof(n==null?void 0:n.limit)=="number"?n.limit:10;return e.threads.getHistory(t,{limit:s})}function Ev(e,t,n,s){const r=wv(e,t,n),[i,o]=g.useState(()=>({data:void 0,error:void 0,isLoading:t!=null})),a=g.useRef(e);a.current=e;const l=g.useRef(s==null?void 0:s.onError);l.current=s==null?void 0:s.onError;const c=g.useCallback((d,u)=>{if(d!=null){const h=a.current;return o(f=>({...f,isLoading:!0})),bv(h,d,{limit:u}).then(f=>(o({data:f,error:void 0,isLoading:!1}),f),f=>{var p;return o(({data:v})=>({data:v,error:f,isLoading:!1})),(p=l.current)==null||p.call(l,f),Promise.reject(f)})}return o({data:void 0,error:void 0,isLoading:!1}),Promise.resolve([])},[]);return g.useEffect(()=>{s.submittingRef.current!=null&&s.submittingRef.current===t||c(t,n)},[c,r]),{data:i.data,error:i.error,isLoading:i.isLoading,mutate:d=>c(d??t,n)}}function Sv(e){var H;const t=g.useRef(e.reconnectOnMount),n=g.useMemo(()=>{if(typeof window>"u")return null;const V=t.current;return V===!0?window.sessionStorage:typeof V=="function"?V():null},[]),s=g.useMemo(()=>e.client??new au({apiUrl:e.apiUrl,apiKey:e.apiKey,callerOptions:e.callerOptions,defaultHeaders:e.defaultHeaders}),[e.client,e.apiKey,e.apiUrl,e.callerOptions,e.defaultHeaders]),[r]=g.useState(()=>new iu),[i]=g.useState(()=>new ou(r));g.useSyncExternalStore(i.subscribe,i.getSnapshot,i.getSnapshot);const[o,a]=lu(e),l=g.useRef([]),c=g.useCallback((...V)=>{const A=l.current;for(const G of V)A.includes(G)||A.push(G)},[]),d=e.onUpdateEvent!=null,u=e.onCustomEvent!=null,h=e.onLangChainEvent!=null,f=e.onDebugEvent!=null,p=e.onCheckpointEvent!=null,v=e.onTaskEvent!=null,y=g.useMemo(()=>{const V=[];return d&&V.push("updates"),u&&V.push("custom"),h&&V.push("events"),f&&V.push("debug"),p&&V.push("checkpoints"),v&&V.push("tasks"),V},[d,u,h,f,p,v]),b=g.useRef(null);b.current=i.clear;const x=g.useRef(o),w=g.useRef(null);g.useEffect(()=>{x.current!==o&&(x.current=o,i.clear())},[o,i]);const E=typeof e.fetchStateHistory=="object"&&e.fetchStateHistory!=null?e.fetchStateHistory.limit??!1:e.fetchStateHistory??!1,_=Ev(s,o,E,{submittingRef:w,onError:e.onError}),j=V=>{const A=e.messagesKey??"messages";return Array.isArray(V[A])?V[A]:[]},D=(V,A)=>{const G=e.messagesKey??"messages";return{...V,[G]:A}},[R,P]=g.useState(""),M=vm(R,_.data),L=((H=M.threadHead)==null?void 0:H.values)??e.initialValues??{},$=(()=>{var A,G,K;const V=(K=(G=(A=M.threadHead)==null?void 0:A.tasks)==null?void 0:G.at(-1))==null?void 0:K.error;if(V!=null){try{const Y=JSON.parse(V);return Dr.isStructuredError(Y)?new Dr(Y):Y}catch{}return V}})(),U=(()=>{const V=new Set;return j(L).map((A,G)=>{var de,he,ce;const K=A.id??G,Y=mm(_.data??[],ie=>j(ie.values).map((ve,re)=>ve.id??re).includes(K)),Q=(de=Y==null?void 0:Y.checkpoint)==null?void 0:de.checkpoint_id;let X=Q!=null?M.branchByCheckpoint[Q]:void 0;(he=X==null?void 0:X.branch)!=null&&he.length||(X=void 0);const ae=(ce=X==null?void 0:X.branchOptions)==null?void 0:ce.flat(2).join(",");return ae&&(V.has(ae)&&(X=void 0),V.add(ae)),{messageId:K.toString(),firstSeenState:Y,branch:X==null?void 0:X.branch,branchOptions:X==null?void 0:X.branchOptions}})})(),T=()=>i.stop(L,{onStop:V=>{var A;if(n&&o){const G=n.getItem(`lg:stream:${o}`);G&&s.runs.cancel(o,G),n.removeItem(`lg:stream:${o}`)}(A=e.onStop)==null||A.call(e,V)}}),N=async(V,A)=>{var ae,de;const G=(ae=A==null?void 0:A.checkpoint)==null?void 0:ae.checkpoint_id;P(G!=null?((de=M.branchByCheckpoint[G])==null?void 0:de.branch)??"":""),i.setStreamValues(()=>(A==null?void 0:A.optimisticValues)!=null?{...L,...typeof A.optimisticValues=="function"?A.optimisticValues(L):A.optimisticValues}:{...L});const K=E===!0||typeof E=="number";let Y,Q,X=o;await i.start(async he=>{var re;if(X||(X=(await s.threads.create({threadId:A==null?void 0:A.threadId,metadata:A==null?void 0:A.metadata})).thread_id,x.current=X,w.current=X,a(X)),!X)throw new Error("Failed to obtain valid thread ID.");w.current=X;const ce=hm([...(A==null?void 0:A.streamMode)??[],...l.current,...y]);let ie=(A==null?void 0:A.checkpoint)??(K?(re=M.threadHead)==null?void 0:re.checkpoint:void 0)??void 0;(A==null?void 0:A.checkpoint)===null&&(ie=void 0),ie!=null&&delete ie.thread_id;const ve=(A==null?void 0:A.streamResumable)??!!n;return s.runs.stream(X,e.assistantId,{input:V,config:A==null?void 0:A.config,context:A==null?void 0:A.context,command:A==null?void 0:A.command,interruptBefore:A==null?void 0:A.interruptBefore,interruptAfter:A==null?void 0:A.interruptAfter,metadata:A==null?void 0:A.metadata,multitaskStrategy:A==null?void 0:A.multitaskStrategy,onCompletion:A==null?void 0:A.onCompletion,onDisconnect:(A==null?void 0:A.onDisconnect)??(ve?"continue":"cancel"),signal:he,checkpoint:ie,streamMode:ce,streamSubgraphs:A==null?void 0:A.streamSubgraphs,streamResumable:ve,durability:A==null?void 0:A.durability,onRunCreated(Z){var we;Y={run_id:Z.run_id,thread_id:Z.thread_id??X},n&&(Q=`lg:stream:${X}`,n.setItem(Q,Y.run_id)),(we=e.onCreated)==null||we.call(e,Y)}})},{getMessages:j,setMessages:D,initialValues:L,callbacks:e,async onSuccess(){var ce;if(Q&&(n==null||n.removeItem(Q)),e.onFinish!=null||K){const ve=(await _.mutate(X)).at(0);if(ve)return(ce=e.onFinish)==null||ce.call(e,ve,Y),null}},onError(he){var ce;(ce=e.onError)==null||ce.call(e,he,Y)},onFinish(){w.current=null}})},B=async(V,A,G)=>{if(A??(A="-1"),!o)return;const K={thread_id:o,run_id:V};await i.start(async Y=>(w.current=o,s.runs.joinStream(o,V,{signal:Y,lastEventId:A,streamMode:G==null?void 0:G.streamMode})),{getMessages:j,setMessages:D,initialValues:L,callbacks:e,async onSuccess(){var X;n==null||n.removeItem(`lg:stream:${o}`);const Q=(await _.mutate(o)).at(0);Q&&((X=e.onFinish)==null||X.call(e,Q,K))},onError(Y){var Q;(Q=e.onError)==null||Q.call(e,Y,K)},onFinish(){w.current=null}})},I=g.useMemo(()=>{if(!n||i.isLoading||typeof window>"u")return;const V=n==null?void 0:n.getItem(`lg:stream:${o}`);if(V)return{runId:V,threadId:o}},[n,i.isLoading,o]),F=!!n,S=g.useRef({threadId:o,shouldReconnect:F}),O=g.useRef(B);O.current=B,g.useEffect(()=>{S.current.threadId!==o&&(S.current={threadId:o,shouldReconnect:F})},[o,F]),g.useEffect(()=>{var V;I&&S.current.shouldReconnect&&(S.current.shouldReconnect=!1,(V=O.current)==null||V.call(O,I.runId))},[I]);const z=i.error??$??_.error,k=i.values??L;return{get values(){return c("values"),k},client:s,assistantId:e.assistantId,error:z,isLoading:i.isLoading,stop:T,submit:N,joinStream:B,branch:R,setBranch:P,get history(){if(E===!1)throw new Error("`fetchStateHistory` must be set to `true` to use `history`");return M.flatHistory},isThreadLoading:_.isLoading&&_.data==null,get experimental_branchTree(){if(E===!1)throw new Error("`fetchStateHistory` must be set to `true` to use `experimental_branchTree`");return M.branchTree},get interrupt(){var A,G,K,Y;if(k!=null&&"__interrupt__"in k&&Array.isArray(k.__interrupt__)){const Q=k.__interrupt__;return Q.length===0?{when:"breakpoint"}:Q.length===1?Q[0]:Q}if(i.isLoading)return;const V=(K=(G=(A=M.threadHead)==null?void 0:A.tasks)==null?void 0:G.at(-1))==null?void 0:K.interrupts;return V==null||V.length===0?!(((Y=M.threadHead)==null?void 0:Y.next)??[]).length||z!=null?void 0:{when:"breakpoint"}:V.at(-1)},get messages(){return c("messages-tuple","values"),j(k)},getMessagesMetadata(V,A){var Y;c("values");const G=(Y=r.get(V.id))==null?void 0:Y.metadata,K=U==null?void 0:U.find(Q=>Q.messageId===(V.id??A));if(G!=null||K!=null)return{...K,streamMetadata:G}}}}function _v(e){const[t]=g.useState(()=>new iu),[n]=g.useState(()=>new ou(t));g.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getSnapshot);const[s,r]=lu(e),i=g.useRef(s);g.useEffect(()=>{i.current!==s&&(i.current=s,n.clear())},[s,n]);const o=u=>{const h=e.messagesKey??"messages";return Array.isArray(u[h])?u[h]:[]},a=(u,h)=>{const f=e.messagesKey??"messages";return{...u,[f]:h}},l=e.initialValues??{},c=()=>n.stop(l,{onStop:e.onStop}),d=async(u,h)=>{let f,p=s;n.setStreamValues(()=>(h==null?void 0:h.optimisticValues)!=null?{...l,...typeof h.optimisticValues=="function"?h.optimisticValues(l):h.optimisticValues}:{...l}),await n.start(async v=>{var y;if(p||(p=crypto.randomUUID(),i.current=p,r(p)),!p)throw new Error("Failed to obtain valid thread ID.");return e.transport.stream({input:u,context:h==null?void 0:h.context,command:h==null?void 0:h.command,signal:v,config:{...h==null?void 0:h.config,configurable:{thread_id:p,...(y=h==null?void 0:h.config)==null?void 0:y.configurable}}})},{getMessages:o,setMessages:a,initialValues:{},callbacks:e,onSuccess:()=>{},onError(v){var y;(y=e.onError)==null||y.call(e,v,f)}})};return{get values(){return n.values??{}},error:n.error,isLoading:n.isLoading,stop:c,submit:d,get interrupt(){if(n.values!=null&&"__interrupt__"in n.values&&Array.isArray(n.values.__interrupt__)){const u=n.values.__interrupt__;return u.length===0?{when:"breakpoint"}:u.length===1?u[0]:u}},get messages(){return n.values?o(n.values):[]}}}function Tv(e){return"transport"in e}function cu(e){const[t]=g.useState(Tv(e));return t?_v(e):Sv(e)}const Hr=g.createContext(null);function Cv(){const e=g.useContext(Hr);if(!e)throw new Error("useStreamContext must be used within a LoadExternalComponent");return new Proxy(e,{get(t,n){return n==="meta"?t.meta:t.stream[n]}})}class Nv{constructor(){Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"boundCache",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}})}respond(t,n,s){var r;this.cache[t]={comp:n,target:s},(r=this.callbacks[t])==null||r.forEach(i=>i(n,s))}getBoundStore(t){var n;return(n=this.boundCache)[t]??(n[t]={subscribe:s=>{var r;return(r=this.callbacks)[t]??(r[t]=[]),this.callbacks[t].push(s),()=>{this.callbacks[t]=this.callbacks[t].filter(i=>i!==s)}},getSnapshot:()=>this.cache[t]}),this.boundCache[t]}}const uu=new Nv,Av=Symbol.for("LGUI_EXT_STORE"),Pv=Symbol.for("LGUI_REQUIRE"),ns=Symbol.for("LGUI_REQUIRE_EXTRA"),jv=e=>e!=null&&typeof e=="object"&&Symbol.iterator in e,Rv=e=>e!=null&&typeof e=="object"&&"then"in e&&typeof e.then=="function",kv=e=>!!(g.isValidElement(e)||e==null||typeof e=="string"||typeof e=="number"||typeof e=="bigint"||typeof e=="boolean"||jv(e)||Rv(e));function Iv({stream:e,namespace:t,message:n,meta:s,fallback:r,components:i,...o}){const a=g.useRef(null),c=`child-shadow-${g.useId()}`,d=g.useMemo(()=>uu.getBoundStore(c),[c]),u=g.useSyncExternalStore(d.subscribe,d.getSnapshot),h=i==null?void 0:i[n.name],f=h!=null;let p=null;kv(r)?p=r:typeof r=="object"&&r!=null&&(p=r==null?void 0:r[n.name]);const v=t??e.assistantId,y=e.client["~ui"];return g.useEffect(()=>{f||y.getComponent(v,n.name).then(b=>{const x=a.current;if(!x)return;const w=x.shadowRoot??x.attachShadow({mode:"open"}),E=document.createRange().createContextualFragment(b.replace("{{shadowRootId}}",c));w.appendChild(E)})},[y,v,n.name,c,f]),f?m.jsx(Hr.Provider,{value:{stream:e,meta:s},children:g.createElement(h,n.props)}):m.jsxs(m.Fragment,{children:[m.jsx("div",{id:c,ref:a,...o}),m.jsx(Hr.Provider,{value:{stream:e,meta:s},children:(u==null?void 0:u.target)!=null?Ir.createPortal(g.createElement(u.comp,n.props),u.target):p})]})}function Mv(){typeof window>"u"||(window[Av]=uu,window[Pv]=e=>{if(e==="react")return gh;if(e==="react-dom")return vh;if(e==="react/jsx-runtime")return yh;if(e==="@langchain/langgraph-sdk/react")return{useStream:cu};if(e==="@langchain/langgraph-sdk/react-ui")return{useStreamContext:Cv,LoadExternalComponent:()=>{throw new Error("Nesting LoadExternalComponent is not supported")}};if(window[ns]!=null&&typeof window[ns]=="object"&&e in window[ns])return window[ns][e];throw new Error(`Unknown module...: ${e}`)})}function $v(e){return typeof e!="object"||e==null||!("type"in e)?!1:e.type==="ui"}function Lv(e){return typeof e!="object"||e==null||!("type"in e)?!1:e.type==="remove-ui"}function Dv(e,t){const n=Array.isArray(t)?t:[t];let s=e.slice();for(const r of n){if(r.type==="remove-ui"){s=s.filter(o=>o.id!==r.id);continue}const i=e.findIndex(o=>o.id===r.id);i!==-1?s[i]=typeof r.metadata=="object"&&r.metadata!=null&&r.metadata.merge?{...r,props:{...e[i].props,...r.props}}:r:s.push(r)}return s}Mv();var Vv=e=>{switch(e){case"success":return Fv;case"info":return Uv;case"warning":return Hv;case"error":return zv;default:return null}},Ov=Array(12).fill(0),Bv=({visible:e,className:t})=>C.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},C.createElement("div",{className:"sonner-spinner"},Ov.map((n,s)=>C.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),Fv=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},C.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Hv=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},C.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Uv=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},C.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),zv=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},C.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Gv=C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},C.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),C.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Wv=()=>{let[e,t]=C.useState(document.hidden);return C.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},Ur=1,Kv=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...s}=e,r=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Ur++,i=this.toasts.find(a=>a.id===r),o=e.dismissible===void 0?!0:e.dismissible;return i?this.toasts=this.toasts.map(a=>a.id===r?(this.publish({...a,...e,id:r,title:n}),{...a,...e,id:r,dismissible:o,title:n}):a):this.addToast({title:n,...s,dismissible:o,id:r}),r},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let s=e instanceof Promise?e:e(),r=n!==void 0,i,o=s.then(async l=>{if(i=["resolve",l],C.isValidElement(l))r=!1,this.create({id:n,type:"default",message:l});else if(Yv(l)&&!l.ok){r=!1;let c=typeof t.error=="function"?await t.error(`HTTP error! status: ${l.status}`):t.error,d=typeof t.description=="function"?await t.description(`HTTP error! status: ${l.status}`):t.description;this.create({id:n,type:"error",message:c,description:d})}else if(t.success!==void 0){r=!1;let c=typeof t.success=="function"?await t.success(l):t.success,d=typeof t.description=="function"?await t.description(l):t.description;this.create({id:n,type:"success",message:c,description:d})}}).catch(async l=>{if(i=["reject",l],t.error!==void 0){r=!1;let c=typeof t.error=="function"?await t.error(l):t.error,d=typeof t.description=="function"?await t.description(l):t.description;this.create({id:n,type:"error",message:c,description:d})}}).finally(()=>{var l;r&&(this.dismiss(n),n=void 0),(l=t.finally)==null||l.call(t)}),a=()=>new Promise((l,c)=>o.then(()=>i[0]==="reject"?c(i[1]):l(i[1])).catch(c));return typeof n!="string"&&typeof n!="number"?{unwrap:a}:Object.assign(n,{unwrap:a})},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||Ur++;return this.create({jsx:e(n),id:n,...t}),n},this.subscribers=[],this.toasts=[]}},Fe=new Kv,Xv=(e,t)=>{let n=(t==null?void 0:t.id)||Ur++;return Fe.addToast({title:e,...t,id:n}),n},Yv=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Zv=Xv,Jv=()=>Fe.toasts,Nt=Object.assign(Zv,{success:Fe.success,info:Fe.info,warning:Fe.warning,error:Fe.error,custom:Fe.custom,message:Fe.message,promise:Fe.promise,dismiss:Fe.dismiss,loading:Fe.loading},{getHistory:Jv});function Qv(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}Qv(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function ss(e){return e.label!==void 0}var qv=3,ey="32px",wa=4e3,ty=356,ny=14,sy=20,ry=200;function iy(...e){return e.filter(Boolean).join(" ")}var oy=e=>{var t,n,s,r,i,o,a,l,c,d,u;let{invert:h,toast:f,unstyled:p,interacting:v,setHeights:y,visibleToasts:b,heights:x,index:w,toasts:E,expanded:_,removeToast:j,defaultRichColors:D,closeButton:R,style:P,cancelButtonStyle:M,actionButtonStyle:L,className:$="",descriptionClassName:U="",duration:T,position:N,gap:B,loadingIcon:I,expandByDefault:F,classNames:S,icons:O,closeButtonAriaLabel:z="Close toast",pauseWhenPageIsHidden:k,cn:H}=e,[V,A]=C.useState(!1),[G,K]=C.useState(!1),[Y,Q]=C.useState(!1),[X,ae]=C.useState(!1),[de,he]=C.useState(!1),[ce,ie]=C.useState(0),[ve,re]=C.useState(0),Z=C.useRef(f.duration||T||wa),we=C.useRef(null),Ne=C.useRef(null),ut=w===0,st=w+1<=b,be=f.type,_e=f.dismissible!==!1,rt=f.className||"",qe=f.descriptionClassName||"",Ve=C.useMemo(()=>x.findIndex(te=>te.toastId===f.id)||0,[x,f.id]),it=C.useMemo(()=>{var te;return(te=f.closeButton)!=null?te:R},[f.closeButton,R]);C.useMemo(()=>f.duration||T||wa,[f.duration,T]);let ze=C.useRef(0),Me=C.useRef(0),ue=C.useRef(0),Te=C.useRef(null),[W,ee]=N.split("-"),le=C.useMemo(()=>x.reduce((te,oe,se)=>se>=Ve?te:te+oe.height,0),[x,Ve]),Ee=Wv(),$e=f.invert||h,Ge=be==="loading";Me.current=C.useMemo(()=>Ve*B+le,[Ve,le]),C.useEffect(()=>{A(!0)},[]),C.useEffect(()=>{let te=Ne.current;if(te){let oe=te.getBoundingClientRect().height;return re(oe),y(se=>[{toastId:f.id,height:oe,position:f.position},...se]),()=>y(se=>se.filter(Be=>Be.toastId!==f.id))}},[y,f.id]),C.useLayoutEffect(()=>{if(!V)return;let te=Ne.current,oe=te.style.height;te.style.height="auto";let se=te.getBoundingClientRect().height;te.style.height=oe,re(se),y(Be=>Be.find(We=>We.toastId===f.id)?Be.map(We=>We.toastId===f.id?{...We,height:se}:We):[{toastId:f.id,height:se,position:f.position},...Be])},[V,f.title,f.description,y,f.id]);let Le=C.useCallback(()=>{K(!0),ie(Me.current),y(te=>te.filter(oe=>oe.toastId!==f.id)),setTimeout(()=>{j(f)},ry)},[f,j,y,Me]);C.useEffect(()=>{if(f.promise&&be==="loading"||f.duration===1/0||f.type==="loading")return;let te;return _||v||k&&Ee?(()=>{if(ue.current<ze.current){let oe=new Date().getTime()-ze.current;Z.current=Z.current-oe}ue.current=new Date().getTime()})():Z.current!==1/0&&(ze.current=new Date().getTime(),te=setTimeout(()=>{var oe;(oe=f.onAutoClose)==null||oe.call(f,f),Le()},Z.current)),()=>clearTimeout(te)},[_,v,f,be,k,Ee,Le]),C.useEffect(()=>{f.delete&&Le()},[Le,f.delete]);function ot(){var te,oe,se;return O!=null&&O.loading?C.createElement("div",{className:H(S==null?void 0:S.loader,(te=f==null?void 0:f.classNames)==null?void 0:te.loader,"sonner-loader"),"data-visible":be==="loading"},O.loading):I?C.createElement("div",{className:H(S==null?void 0:S.loader,(oe=f==null?void 0:f.classNames)==null?void 0:oe.loader,"sonner-loader"),"data-visible":be==="loading"},I):C.createElement(Bv,{className:H(S==null?void 0:S.loader,(se=f==null?void 0:f.classNames)==null?void 0:se.loader),visible:be==="loading"})}return C.createElement("li",{tabIndex:0,ref:Ne,className:H($,rt,S==null?void 0:S.toast,(t=f==null?void 0:f.classNames)==null?void 0:t.toast,S==null?void 0:S.default,S==null?void 0:S[be],(n=f==null?void 0:f.classNames)==null?void 0:n[be]),"data-sonner-toast":"","data-rich-colors":(s=f.richColors)!=null?s:D,"data-styled":!(f.jsx||f.unstyled||p),"data-mounted":V,"data-promise":!!f.promise,"data-swiped":de,"data-removed":G,"data-visible":st,"data-y-position":W,"data-x-position":ee,"data-index":w,"data-front":ut,"data-swiping":Y,"data-dismissible":_e,"data-type":be,"data-invert":$e,"data-swipe-out":X,"data-expanded":!!(_||F&&V),style:{"--index":w,"--toasts-before":w,"--z-index":E.length-w,"--offset":`${G?ce:Me.current}px`,"--initial-height":F?"auto":`${ve}px`,...P,...f.style},onPointerDown:te=>{Ge||!_e||(we.current=new Date,ie(Me.current),te.target.setPointerCapture(te.pointerId),te.target.tagName!=="BUTTON"&&(Q(!0),Te.current={x:te.clientX,y:te.clientY}))},onPointerUp:()=>{var te,oe,se,Be;if(X||!_e)return;Te.current=null;let We=Number(((te=Ne.current)==null?void 0:te.style.getPropertyValue("--swipe-amount").replace("px",""))||0),Ot=new Date().getTime()-((oe=we.current)==null?void 0:oe.getTime()),Ys=Math.abs(We)/Ot;if(Math.abs(We)>=sy||Ys>.11){ie(Me.current),(se=f.onDismiss)==null||se.call(f,f),Le(),ae(!0),he(!1);return}(Be=Ne.current)==null||Be.style.setProperty("--swipe-amount","0px"),Q(!1)},onPointerMove:te=>{var oe,se;if(!Te.current||!_e)return;let Be=te.clientY-Te.current.y,We=((oe=window.getSelection())==null?void 0:oe.toString().length)>0,Ot=W==="top"?Math.min(0,Be):Math.max(0,Be);Math.abs(Ot)>0&&he(!0),!We&&((se=Ne.current)==null||se.style.setProperty("--swipe-amount",`${Ot}px`))}},it&&!f.jsx?C.createElement("button",{"aria-label":z,"data-disabled":Ge,"data-close-button":!0,onClick:Ge||!_e?()=>{}:()=>{var te;Le(),(te=f.onDismiss)==null||te.call(f,f)},className:H(S==null?void 0:S.closeButton,(r=f==null?void 0:f.classNames)==null?void 0:r.closeButton)},(i=O==null?void 0:O.close)!=null?i:Gv):null,f.jsx||C.isValidElement(f.title)?f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title:C.createElement(C.Fragment,null,be||f.icon||f.promise?C.createElement("div",{"data-icon":"",className:H(S==null?void 0:S.icon,(o=f==null?void 0:f.classNames)==null?void 0:o.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||ot():null,f.type!=="loading"?f.icon||(O==null?void 0:O[be])||Vv(be):null):null,C.createElement("div",{"data-content":"",className:H(S==null?void 0:S.content,(a=f==null?void 0:f.classNames)==null?void 0:a.content)},C.createElement("div",{"data-title":"",className:H(S==null?void 0:S.title,(l=f==null?void 0:f.classNames)==null?void 0:l.title)},typeof f.title=="function"?f.title():f.title),f.description?C.createElement("div",{"data-description":"",className:H(U,qe,S==null?void 0:S.description,(c=f==null?void 0:f.classNames)==null?void 0:c.description)},typeof f.description=="function"?f.description():f.description):null),C.isValidElement(f.cancel)?f.cancel:f.cancel&&ss(f.cancel)?C.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||M,onClick:te=>{var oe,se;ss(f.cancel)&&_e&&((se=(oe=f.cancel).onClick)==null||se.call(oe,te),Le())},className:H(S==null?void 0:S.cancelButton,(d=f==null?void 0:f.classNames)==null?void 0:d.cancelButton)},f.cancel.label):null,C.isValidElement(f.action)?f.action:f.action&&ss(f.action)?C.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||L,onClick:te=>{var oe,se;ss(f.action)&&((se=(oe=f.action).onClick)==null||se.call(oe,te),!te.defaultPrevented&&Le())},className:H(S==null?void 0:S.actionButton,(u=f==null?void 0:f.classNames)==null?void 0:u.actionButton)},f.action.label):null))};function ba(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var ay=g.forwardRef(function(e,t){let{invert:n,position:s="bottom-right",hotkey:r=["altKey","KeyT"],expand:i,closeButton:o,className:a,offset:l,theme:c="light",richColors:d,duration:u,style:h,visibleToasts:f=qv,toastOptions:p,dir:v=ba(),gap:y=ny,loadingIcon:b,icons:x,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:E,cn:_=iy}=e,[j,D]=C.useState([]),R=C.useMemo(()=>Array.from(new Set([s].concat(j.filter(k=>k.position).map(k=>k.position)))),[j,s]),[P,M]=C.useState([]),[L,$]=C.useState(!1),[U,T]=C.useState(!1),[N,B]=C.useState(c!=="system"?c:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),I=C.useRef(null),F=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),S=C.useRef(null),O=C.useRef(!1),z=C.useCallback(k=>{D(H=>{var V;return(V=H.find(A=>A.id===k.id))!=null&&V.delete||Fe.dismiss(k.id),H.filter(({id:A})=>A!==k.id)})},[]);return C.useEffect(()=>Fe.subscribe(k=>{if(k.dismiss){D(H=>H.map(V=>V.id===k.id?{...V,delete:!0}:V));return}setTimeout(()=>{xh.flushSync(()=>{D(H=>{let V=H.findIndex(A=>A.id===k.id);return V!==-1?[...H.slice(0,V),{...H[V],...k},...H.slice(V+1)]:[k,...H]})})})}),[]),C.useEffect(()=>{if(c!=="system"){B(c);return}if(c==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?B("dark"):B("light")),typeof window>"u")return;let k=window.matchMedia("(prefers-color-scheme: dark)");try{k.addEventListener("change",({matches:H})=>{B(H?"dark":"light")})}catch{k.addListener(({matches:V})=>{try{B(V?"dark":"light")}catch(A){console.error(A)}})}},[c]),C.useEffect(()=>{j.length<=1&&$(!1)},[j]),C.useEffect(()=>{let k=H=>{var V,A;r.every(G=>H[G]||H.code===G)&&($(!0),(V=I.current)==null||V.focus()),H.code==="Escape"&&(document.activeElement===I.current||(A=I.current)!=null&&A.contains(document.activeElement))&&$(!1)};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[r]),C.useEffect(()=>{if(I.current)return()=>{S.current&&(S.current.focus({preventScroll:!0}),S.current=null,O.current=!1)}},[I.current]),C.createElement("section",{"aria-label":`${w} ${F}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false"},R.map((k,H)=>{var V;let[A,G]=k.split("-");return j.length?C.createElement("ol",{key:k,dir:v==="auto"?ba():v,tabIndex:-1,ref:I,className:a,"data-sonner-toaster":!0,"data-theme":N,"data-y-position":A,"data-lifted":L&&j.length>1&&!i,"data-x-position":G,style:{"--front-toast-height":`${((V=P[0])==null?void 0:V.height)||0}px`,"--offset":typeof l=="number"?`${l}px`:l||ey,"--width":`${ty}px`,"--gap":`${y}px`,...h},onBlur:K=>{O.current&&!K.currentTarget.contains(K.relatedTarget)&&(O.current=!1,S.current&&(S.current.focus({preventScroll:!0}),S.current=null))},onFocus:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||O.current||(O.current=!0,S.current=K.relatedTarget)},onMouseEnter:()=>$(!0),onMouseMove:()=>$(!0),onMouseLeave:()=>{U||$(!1)},onPointerDown:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||T(!0)},onPointerUp:()=>T(!1)},j.filter(K=>!K.position&&H===0||K.position===k).map((K,Y)=>{var Q,X;return C.createElement(oy,{key:K.id,icons:x,index:Y,toast:K,defaultRichColors:d,duration:(Q=p==null?void 0:p.duration)!=null?Q:u,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:n,visibleToasts:f,closeButton:(X=p==null?void 0:p.closeButton)!=null?X:o,interacting:U,position:k,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:z,toasts:j.filter(ae=>ae.position==K.position),heights:P.filter(ae=>ae.position==K.position),setHeights:M,expandByDefault:i,gap:y,loadingIcon:b,expanded:L,pauseWhenPageIsHidden:E,cn:_})})):null}))});function ly(e,t){return new au({apiUrl:e,...t})}const du=wh("/qagent/qagent"),cy="agent",fu=g.createContext(void 0);function uy(e){return am(e)?{assistant_id:e}:{graph_id:e}}function dy({children:e}){const[t]=on("apiUrl",{defaultValue:du}),[n]=on("assistantId",{defaultValue:"agent"}),[s,r]=g.useState([]),[i,o]=g.useState(!1),l={getThreads:g.useCallback(async()=>!t||!n?[]:await ly(t,void 0).threads.search({metadata:{...uy(n)},limit:100}),[t,n]),threads:s,setThreads:r,threadsLoading:i,setThreadsLoading:o};return m.jsx(fu.Provider,{value:l,children:e})}function fy(){const e=g.useContext(fu);if(e===void 0)throw new Error("useThreads must be used within a ThreadProvider");return e}const hy=cu,hu=g.createContext(void 0);async function my(e=4e3){return new Promise(t=>setTimeout(t,e))}async function py(e,t){try{return(await fetch(`${e}/info`,{...t&&{headers:{"X-Api-Key":t}}})).ok}catch(n){return console.error(n),!1}}const gy=({children:e,apiKey:t,apiUrl:n,assistantId:s})=>{const[r,i]=on("threadId"),{getThreads:o,setThreads:a}=fy(),l=hy({apiUrl:n,apiKey:t??void 0,assistantId:s,threadId:r??null,fetchStateHistory:!0,onCustomEvent:(c,d)=>{($v(c)||Lv(c))&&d.mutate(u=>{const h=Dv(u.ui??[],c);return{...u,ui:h}})},onThreadId:c=>{i(c),my().then(()=>o().then(a).catch(console.error))}});return g.useEffect(()=>{py(n,t).then(c=>{c||Nt.error("Failed to connect to LangGraph server",{description:`Please ensure your graph is running at ${n}`,duration:1e4})})},[t,n]),m.jsx(hu.Provider,{value:l,children:e})},vy=({children:e})=>{const t=du,n=cy;return m.jsx(gy,{apiKey:null,apiUrl:t,assistantId:n,children:e})},Os=()=>{const e=g.useContext(hu);if(e===void 0)throw new Error("useStreamContext must be used within a StreamProvider");return e};function $i(e){return typeof e=="string"?e:e.filter(n=>n.type==="text").map(n=>n.text).join(" ")}const Xt=g.forwardRef(({children:e,tooltip:t,side:n="bottom",className:s,...r},i)=>m.jsx(gc,{children:m.jsxs(vc,{children:[m.jsx(yc,{asChild:!0,children:m.jsxs(me,{variant:"ghost",size:"icon",...r,className:je("size-6 p-1",s),ref:i,children:[e,m.jsx("span",{className:"sr-only",children:t})]})}),m.jsx(xc,{side:n,children:t})]})}));Xt.displayName="TooltipIconButton";function yy(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...s)=>e(...s);return new Proxy(n,{get:(s,r)=>r==="create"?e:(t.has(r)||t.set(r,e(r)),t.get(r))})}function Bs(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const zr=e=>Array.isArray(e);function mu(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let s=0;s<n;s++)if(t[s]!==e[s])return!1;return!0}function $n(e){return typeof e=="string"||Array.isArray(e)}function Ea(e){const t=[{},{}];return e==null||e.values.forEach((n,s)=>{t[0][s]=n.get(),t[1][s]=n.getVelocity()}),t}function Li(e,t,n,s){if(typeof t=="function"){const[r,i]=Ea(s);t=t(n!==void 0?n:e.custom,r,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[r,i]=Ea(s);t=t(n!==void 0?n:e.custom,r,i)}return t}function Fs(e,t,n){const s=e.getProps();return Li(s,t,n!==void 0?n:s.custom,e)}const Di=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Vi=["initial",...Di],Gn=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Dt=new Set(Gn),ft=e=>e*1e3,ht=e=>e/1e3,xy={type:"spring",stiffness:500,damping:25,restSpeed:10},wy=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),by={type:"keyframes",duration:.8},Ey={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Sy=(e,{keyframes:t})=>t.length>2?by:Dt.has(e)?e.startsWith("scale")?wy(t[1]):xy:Ey;function Oi(e,t){return e?e[t]||e.default||e:void 0}const _y={skipAnimations:!1,useManualTiming:!1},Ty=e=>e!==null;function Hs(e,{repeat:t,repeatType:n="loop"},s){const r=e.filter(Ty),i=t&&n!=="loop"&&t%2===1?0:r.length-1;return!i||s===void 0?r[i]:s}const He=e=>e;let Gr=He;function Cy(e){let t=new Set,n=new Set,s=!1,r=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){i.has(c)&&(l.schedule(c),e()),c(o)}const l={schedule:(c,d=!1,u=!1)=>{const f=u&&s?t:n;return d&&i.add(c),f.has(c)||f.add(c),c},cancel:c=>{n.delete(c),i.delete(c)},process:c=>{if(o=c,s){r=!0;return}s=!0,[t,n]=[n,t],t.forEach(a),t.clear(),s=!1,r&&(r=!1,l.process(c))}};return l}const rs=["read","resolveKeyframes","update","preRender","render","postRender"],Ny=40;function pu(e,t){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=rs.reduce((b,x)=>(b[x]=Cy(i),b),{}),{read:a,resolveKeyframes:l,update:c,preRender:d,render:u,postRender:h}=o,f=()=>{const b=performance.now();n=!1,r.delta=s?1e3/60:Math.max(Math.min(b-r.timestamp,Ny),1),r.timestamp=b,r.isProcessing=!0,a.process(r),l.process(r),c.process(r),d.process(r),u.process(r),h.process(r),r.isProcessing=!1,n&&t&&(s=!1,e(f))},p=()=>{n=!0,s=!0,r.isProcessing||e(f)};return{schedule:rs.reduce((b,x)=>{const w=o[x];return b[x]=(E,_=!1,j=!1)=>(n||p(),w.schedule(E,_,j)),b},{}),cancel:b=>{for(let x=0;x<rs.length;x++)o[rs[x]].cancel(b)},state:r,steps:o}}const{schedule:fe,cancel:St,state:Pe,steps:dr}=pu(typeof requestAnimationFrame<"u"?requestAnimationFrame:He,!0),gu=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,Ay=1e-7,Py=12;function jy(e,t,n,s,r){let i,o,a=0;do o=t+(n-t)/2,i=gu(o,s,r)-e,i>0?n=o:t=o;while(Math.abs(i)>Ay&&++a<Py);return o}function Wn(e,t,n,s){if(e===t&&n===s)return He;const r=i=>jy(i,0,1,e,n);return i=>i===0||i===1?i:gu(r(i),t,s)}const vu=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,yu=e=>t=>1-e(1-t),xu=Wn(.33,1.53,.69,.99),Bi=yu(xu),wu=vu(Bi),bu=e=>(e*=2)<1?.5*Bi(e):.5*(2-Math.pow(2,-10*(e-1))),Fi=e=>1-Math.sin(Math.acos(e)),Eu=yu(Fi),Su=vu(Fi),_u=e=>/^0[^.\s]+$/u.test(e);function Ry(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||_u(e):!0}const Tu=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),Cu=e=>t=>typeof t=="string"&&t.startsWith(e),Nu=Cu("--"),ky=Cu("var(--"),Hi=e=>ky(e)?Iy.test(e.split("/*")[0].trim()):!1,Iy=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,My=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function $y(e){const t=My.exec(e);if(!t)return[,];const[,n,s,r]=t;return[`--${n??s}`,r]}function Au(e,t,n=1){const[s,r]=$y(e);if(!s)return;const i=window.getComputedStyle(t).getPropertyValue(s);if(i){const o=i.trim();return Tu(o)?parseFloat(o):o}return Hi(r)?Au(r,t,n+1):r}const mt=(e,t,n)=>n>t?t:n<e?e:n,gn={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ln={...gn,transform:e=>mt(0,1,e)},is={...gn,default:1},Kn=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),yt=Kn("deg"),lt=Kn("%"),q=Kn("px"),Ly=Kn("vh"),Dy=Kn("vw"),Sa={...lt,parse:e=>lt.parse(e)/100,transform:e=>lt.transform(e*100)},Vy=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),_a=e=>e===gn||e===q,Ta=(e,t)=>parseFloat(e.split(", ")[t]),Ca=(e,t)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const r=s.match(/^matrix3d\((.+)\)$/u);if(r)return Ta(r[1],t);{const i=s.match(/^matrix\((.+)\)$/u);return i?Ta(i[1],e):0}},Oy=new Set(["x","y","z"]),By=Gn.filter(e=>!Oy.has(e));function Fy(e){const t=[];return By.forEach(n=>{const s=e.getValue(n);s!==void 0&&(t.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),t}const ln={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:Ca(4,13),y:Ca(5,14)};ln.translateX=ln.x;ln.translateY=ln.y;const Pu=e=>t=>t.test(e),Hy={test:e=>e==="auto",parse:e=>e},ju=[gn,q,lt,yt,Dy,Ly,Hy],Na=e=>ju.find(Pu(e)),Mt=new Set;let Wr=!1,Kr=!1;function Ru(){if(Kr){const e=Array.from(Mt).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),n=new Map;t.forEach(s=>{const r=Fy(s);r.length&&(n.set(s,r),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([i,o])=>{var a;(a=s.getValue(i))===null||a===void 0||a.set(o)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Kr=!1,Wr=!1,Mt.forEach(e=>e.complete()),Mt.clear()}function ku(){Mt.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Kr=!0)})}function Uy(){ku(),Ru()}class Ui{constructor(t,n,s,r,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=s,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Mt.add(this),Wr||(Wr=!0,fe.read(ku),fe.resolveKeyframes(Ru))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:s,motionValue:r}=this;for(let i=0;i<t.length;i++)if(t[i]===null)if(i===0){const o=r==null?void 0:r.get(),a=t[t.length-1];if(o!==void 0)t[0]=o;else if(s&&n){const l=s.readValue(n,a);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=a),r&&o===void 0&&r.set(t[0])}else t[i]=t[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Mt.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Mt.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const jn=e=>Math.round(e*1e5)/1e5,zi=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function zy(e){return e==null}const Gy=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Gi=(e,t)=>n=>!!(typeof n=="string"&&Gy.test(n)&&n.startsWith(e)||t&&!zy(n)&&Object.prototype.hasOwnProperty.call(n,t)),Iu=(e,t,n)=>s=>{if(typeof s!="string")return s;const[r,i,o,a]=s.match(zi);return{[e]:parseFloat(r),[t]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Wy=e=>mt(0,255,e),fr={...gn,transform:e=>Math.round(Wy(e))},kt={test:Gi("rgb","red"),parse:Iu("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:s=1})=>"rgba("+fr.transform(e)+", "+fr.transform(t)+", "+fr.transform(n)+", "+jn(Ln.transform(s))+")"};function Ky(e){let t="",n="",s="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),s=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),s=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,s+=s,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const Xr={test:Gi("#"),parse:Ky,transform:kt.transform},Yt={test:Gi("hsl","hue"),parse:Iu("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:s=1})=>"hsla("+Math.round(e)+", "+lt.transform(jn(t))+", "+lt.transform(jn(n))+", "+jn(Ln.transform(s))+")"},Re={test:e=>kt.test(e)||Xr.test(e)||Yt.test(e),parse:e=>kt.test(e)?kt.parse(e):Yt.test(e)?Yt.parse(e):Xr.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?kt.transform(e):Yt.transform(e)},Xy=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Yy(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(zi))===null||t===void 0?void 0:t.length)||0)+(((n=e.match(Xy))===null||n===void 0?void 0:n.length)||0)>0}const Mu="number",$u="color",Zy="var",Jy="var(",Aa="${}",Qy=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Dn(e){const t=e.toString(),n=[],s={color:[],number:[],var:[]},r=[];let i=0;const a=t.replace(Qy,l=>(Re.test(l)?(s.color.push(i),r.push($u),n.push(Re.parse(l))):l.startsWith(Jy)?(s.var.push(i),r.push(Zy),n.push(l)):(s.number.push(i),r.push(Mu),n.push(parseFloat(l))),++i,Aa)).split(Aa);return{values:n,split:a,indexes:s,types:r}}function Lu(e){return Dn(e).values}function Du(e){const{split:t,types:n}=Dn(e),s=t.length;return r=>{let i="";for(let o=0;o<s;o++)if(i+=t[o],r[o]!==void 0){const a=n[o];a===Mu?i+=jn(r[o]):a===$u?i+=Re.transform(r[o]):i+=r[o]}return i}}const qy=e=>typeof e=="number"?0:e;function ex(e){const t=Lu(e);return Du(e)(t.map(qy))}const _t={test:Yy,parse:Lu,createTransformer:Du,getAnimatableNone:ex},tx=new Set(["brightness","contrast","saturate","opacity"]);function nx(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=n.match(zi)||[];if(!s)return e;const r=n.replace(s,"");let i=tx.has(t)?1:0;return s!==n&&(i*=100),t+"("+i+r+")"}const sx=/\b([a-z-]*)\(.*?\)/gu,Yr={..._t,getAnimatableNone:e=>{const t=e.match(sx);return t?t.map(nx).join(" "):e}},rx={borderWidth:q,borderTopWidth:q,borderRightWidth:q,borderBottomWidth:q,borderLeftWidth:q,borderRadius:q,radius:q,borderTopLeftRadius:q,borderTopRightRadius:q,borderBottomRightRadius:q,borderBottomLeftRadius:q,width:q,maxWidth:q,height:q,maxHeight:q,top:q,right:q,bottom:q,left:q,padding:q,paddingTop:q,paddingRight:q,paddingBottom:q,paddingLeft:q,margin:q,marginTop:q,marginRight:q,marginBottom:q,marginLeft:q,backgroundPositionX:q,backgroundPositionY:q},ix={rotate:yt,rotateX:yt,rotateY:yt,rotateZ:yt,scale:is,scaleX:is,scaleY:is,scaleZ:is,skew:yt,skewX:yt,skewY:yt,distance:q,translateX:q,translateY:q,translateZ:q,x:q,y:q,z:q,perspective:q,transformPerspective:q,opacity:Ln,originX:Sa,originY:Sa,originZ:q},Pa={...gn,transform:Math.round},Wi={...rx,...ix,zIndex:Pa,size:q,fillOpacity:Ln,strokeOpacity:Ln,numOctaves:Pa},ox={...Wi,color:Re,backgroundColor:Re,outlineColor:Re,fill:Re,stroke:Re,borderColor:Re,borderTopColor:Re,borderRightColor:Re,borderBottomColor:Re,borderLeftColor:Re,filter:Yr,WebkitFilter:Yr},Ki=e=>ox[e];function Vu(e,t){let n=Ki(e);return n!==Yr&&(n=_t),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const ax=new Set(["auto","none","0"]);function lx(e,t,n){let s=0,r;for(;s<e.length&&!r;){const i=e[s];typeof i=="string"&&!ax.has(i)&&Dn(i).values.length&&(r=e[s]),s++}if(r&&n)for(const i of t)e[i]=Vu(n,r)}class Ou extends Ui{constructor(t,n,s,r,i){super(t,n,s,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),Hi(c))){const d=Au(c,n.current);d!==void 0&&(t[l]=d),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Vy.has(s)||t.length!==2)return;const[r,i]=t,o=Na(r),a=Na(i);if(o!==a)if(_a(o)&&_a(a))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,s=[];for(let r=0;r<t.length;r++)Ry(t[r])&&s.push(r);s.length&&lx(t,s,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ln[s](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&t.getValue(s,r).jump(r,!1)}measureEndState(){var t;const{element:n,name:s,unresolvedKeyframes:r}=this;if(!n||!n.current)return;const i=n.getValue(s);i&&i.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=ln[s](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function Xi(e){return typeof e=="function"}let hs;function cx(){hs=void 0}const ct={now:()=>(hs===void 0&&ct.set(Pe.isProcessing||_y.useManualTiming?Pe.timestamp:performance.now()),hs),set:e=>{hs=e,queueMicrotask(cx)}},ja=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(_t.test(e)||e==="0")&&!e.startsWith("url("));function ux(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function dx(e,t,n,s){const r=e[0];if(r===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],o=ja(r,t),a=ja(i,t);return!o||!a?!1:ux(e)||(n==="spring"||Xi(n))&&s}const fx=40;class Bu{constructor({autoplay:t=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ct.now(),this.options={autoplay:t,delay:n,type:s,repeat:r,repeatDelay:i,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>fx?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Uy(),this._resolved}onKeyframesResolved(t,n){this.resolvedAt=ct.now(),this.hasAttemptedResolve=!0;const{name:s,type:r,velocity:i,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!dx(t,s,r,i))if(o)this.options.duration=0;else{l==null||l(Hs(t,this.options,n)),a==null||a(),this.resolveFinishedPromise();return}const d=this.initPlayback(t,n);d!==!1&&(this._resolved={keyframes:t,finalKeyframe:n,...d},this.onPostResolved())}onPostResolved(){}then(t,n){return this.currentFinishedPromise.then(t,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const cn=(e,t,n)=>{const s=t-e;return s===0?1:(n-e)/s},Fu=(e,t,n=10)=>{let s="";const r=Math.max(Math.round(t/n),2);for(let i=0;i<r;i++)s+=e(cn(0,r-1,i))+", ";return`linear(${s.substring(0,s.length-2)})`};function Hu(e,t){return t?e*(1e3/t):0}const hx=5;function Uu(e,t,n){const s=Math.max(t-hx,0);return Hu(n-e(s),t-s)}const ye={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},hr=.001;function mx({duration:e=ye.duration,bounce:t=ye.bounce,velocity:n=ye.velocity,mass:s=ye.mass}){let r,i,o=1-t;o=mt(ye.minDamping,ye.maxDamping,o),e=mt(ye.minDuration,ye.maxDuration,ht(e)),o<1?(r=c=>{const d=c*o,u=d*e,h=d-n,f=Zr(c,o),p=Math.exp(-u);return hr-h/f*p},i=c=>{const u=c*o*e,h=u*n+n,f=Math.pow(o,2)*Math.pow(c,2)*e,p=Math.exp(-u),v=Zr(Math.pow(c,2),o);return(-r(c)+hr>0?-1:1)*((h-f)*p)/v}):(r=c=>{const d=Math.exp(-c*e),u=(c-n)*e+1;return-hr+d*u},i=c=>{const d=Math.exp(-c*e),u=(n-c)*(e*e);return d*u});const a=5/e,l=gx(r,i,a);if(e=ft(e),isNaN(l))return{stiffness:ye.stiffness,damping:ye.damping,duration:e};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:e}}}const px=12;function gx(e,t,n){let s=n;for(let r=1;r<px;r++)s=s-e(s)/t(s);return s}function Zr(e,t){return e*Math.sqrt(1-t*t)}const Jr=2e4;function zu(e){let t=0;const n=50;let s=e.next(t);for(;!s.done&&t<Jr;)t+=n,s=e.next(t);return t>=Jr?1/0:t}const vx=["duration","bounce"],yx=["stiffness","damping","mass"];function Ra(e,t){return t.some(n=>e[n]!==void 0)}function xx(e){let t={velocity:ye.velocity,stiffness:ye.stiffness,damping:ye.damping,mass:ye.mass,isResolvedFromDuration:!1,...e};if(!Ra(e,yx)&&Ra(e,vx))if(e.visualDuration){const n=e.visualDuration,s=2*Math.PI/(n*1.2),r=s*s,i=2*mt(.05,1,1-e.bounce)*Math.sqrt(r);t={...t,mass:ye.mass,stiffness:r,damping:i}}else{const n=mx(e);t={...t,...n,mass:ye.mass},t.isResolvedFromDuration=!0}return t}function Gu(e=ye.visualDuration,t=ye.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:r}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:d,duration:u,velocity:h,isResolvedFromDuration:f}=xx({...n,velocity:-ht(n.velocity||0)}),p=h||0,v=c/(2*Math.sqrt(l*d)),y=o-i,b=ht(Math.sqrt(l/d)),x=Math.abs(y)<5;s||(s=x?ye.restSpeed.granular:ye.restSpeed.default),r||(r=x?ye.restDelta.granular:ye.restDelta.default);let w;if(v<1){const _=Zr(b,v);w=j=>{const D=Math.exp(-v*b*j);return o-D*((p+v*b*y)/_*Math.sin(_*j)+y*Math.cos(_*j))}}else if(v===1)w=_=>o-Math.exp(-b*_)*(y+(p+b*y)*_);else{const _=b*Math.sqrt(v*v-1);w=j=>{const D=Math.exp(-v*b*j),R=Math.min(_*j,300);return o-D*((p+v*b*y)*Math.sinh(R)+_*y*Math.cosh(R))/_}}const E={calculatedDuration:f&&u||null,next:_=>{const j=w(_);if(f)a.done=_>=u;else{let D=0;v<1&&(D=_===0?ft(p):Uu(w,_,j));const R=Math.abs(D)<=s,P=Math.abs(o-j)<=r;a.done=R&&P}return a.value=a.done?o:j,a},toString:()=>{const _=Math.min(zu(E),Jr),j=Fu(D=>E.next(_*D).value,_,30);return _+"ms "+j}};return E}function ka({keyframes:e,velocity:t=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:d}){const u=e[0],h={done:!1,value:u},f=R=>a!==void 0&&R<a||l!==void 0&&R>l,p=R=>a===void 0?l:l===void 0||Math.abs(a-R)<Math.abs(l-R)?a:l;let v=n*t;const y=u+v,b=o===void 0?y:o(y);b!==y&&(v=b-u);const x=R=>-v*Math.exp(-R/s),w=R=>b+x(R),E=R=>{const P=x(R),M=w(R);h.done=Math.abs(P)<=c,h.value=h.done?b:M};let _,j;const D=R=>{f(h.value)&&(_=R,j=Gu({keyframes:[h.value,p(h.value)],velocity:Uu(w,R,h.value),damping:r,stiffness:i,restDelta:c,restSpeed:d}))};return D(0),{calculatedDuration:null,next:R=>{let P=!1;return!j&&_===void 0&&(P=!0,E(R),D(R)),_!==void 0&&R>=_?j.next(R-_):(!P&&E(R),h)}}}const wx=Wn(.42,0,1,1),bx=Wn(0,0,.58,1),Wu=Wn(.42,0,.58,1),Ex=e=>Array.isArray(e)&&typeof e[0]!="number",Yi=e=>Array.isArray(e)&&typeof e[0]=="number",Ia={linear:He,easeIn:wx,easeInOut:Wu,easeOut:bx,circIn:Fi,circInOut:Su,circOut:Eu,backIn:Bi,backInOut:wu,backOut:xu,anticipate:bu},Ma=e=>{if(Yi(e)){Gr(e.length===4);const[t,n,s,r]=e;return Wn(t,n,s,r)}else if(typeof e=="string")return Gr(Ia[e]!==void 0),Ia[e];return e},Sx=(e,t)=>n=>t(e(n)),Xn=(...e)=>e.reduce(Sx),pe=(e,t,n)=>e+(t-e)*n;function mr(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function _x({hue:e,saturation:t,lightness:n,alpha:s}){e/=360,t/=100,n/=100;let r=0,i=0,o=0;if(!t)r=i=o=n;else{const a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;r=mr(l,a,e+1/3),i=mr(l,a,e),o=mr(l,a,e-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function Es(e,t){return n=>n>0?t:e}const pr=(e,t,n)=>{const s=e*e,r=n*(t*t-s)+s;return r<0?0:Math.sqrt(r)},Tx=[Xr,kt,Yt],Cx=e=>Tx.find(t=>t.test(e));function $a(e){const t=Cx(e);if(!t)return!1;let n=t.parse(e);return t===Yt&&(n=_x(n)),n}const La=(e,t)=>{const n=$a(e),s=$a(t);if(!n||!s)return Es(e,t);const r={...n};return i=>(r.red=pr(n.red,s.red,i),r.green=pr(n.green,s.green,i),r.blue=pr(n.blue,s.blue,i),r.alpha=pe(n.alpha,s.alpha,i),kt.transform(r))},Qr=new Set(["none","hidden"]);function Nx(e,t){return Qr.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function Ax(e,t){return n=>pe(e,t,n)}function Zi(e){return typeof e=="number"?Ax:typeof e=="string"?Hi(e)?Es:Re.test(e)?La:Rx:Array.isArray(e)?Ku:typeof e=="object"?Re.test(e)?La:Px:Es}function Ku(e,t){const n=[...e],s=n.length,r=e.map((i,o)=>Zi(i)(i,t[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}}function Px(e,t){const n={...e,...t},s={};for(const r in n)e[r]!==void 0&&t[r]!==void 0&&(s[r]=Zi(e[r])(e[r],t[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}}function jx(e,t){var n;const s=[],r={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const o=t.types[i],a=e.indexes[o][r[o]],l=(n=e.values[a])!==null&&n!==void 0?n:0;s[i]=l,r[o]++}return s}const Rx=(e,t)=>{const n=_t.createTransformer(t),s=Dn(e),r=Dn(t);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?Qr.has(e)&&!r.values.length||Qr.has(t)&&!s.values.length?Nx(e,t):Xn(Ku(jx(s,r),r.values),n):Es(e,t)};function Xu(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?pe(e,t,n):Zi(e)(e,t)}function kx(e,t,n){const s=[],r=n||Xu,i=e.length-1;for(let o=0;o<i;o++){let a=r(e[o],e[o+1]);if(t){const l=Array.isArray(t)?t[o]||He:t;a=Xn(l,a)}s.push(a)}return s}function Ix(e,t,{clamp:n=!0,ease:s,mixer:r}={}){const i=e.length;if(Gr(i===t.length),i===1)return()=>t[0];if(i===2&&e[0]===e[1])return()=>t[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=kx(t,s,r),a=o.length,l=c=>{let d=0;if(a>1)for(;d<e.length-2&&!(c<e[d+1]);d++);const u=cn(e[d],e[d+1],c);return o[d](u)};return n?c=>l(mt(e[0],e[i-1],c)):l}function Mx(e,t){const n=e[e.length-1];for(let s=1;s<=t;s++){const r=cn(0,t,s);e.push(pe(n,1,r))}}function $x(e){const t=[0];return Mx(t,e.length-1),t}function Lx(e,t){return e.map(n=>n*t)}function Dx(e,t){return e.map(()=>t||Wu).splice(0,e.length-1)}function Ss({duration:e=300,keyframes:t,times:n,ease:s="easeInOut"}){const r=Ex(s)?s.map(Ma):Ma(s),i={done:!1,value:t[0]},o=Lx(n&&n.length===t.length?n:$x(t),e),a=Ix(o,t,{ease:Array.isArray(r)?r:Dx(t,r)});return{calculatedDuration:e,next:l=>(i.value=a(l),i.done=l>=e,i)}}const Vx=e=>{const t=({timestamp:n})=>e(n);return{start:()=>fe.update(t,!0),stop:()=>St(t),now:()=>Pe.isProcessing?Pe.timestamp:ct.now()}},Ox={decay:ka,inertia:ka,tween:Ss,keyframes:Ss,spring:Gu},Bx=e=>e/100;class Ji extends Bu{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:s,element:r,keyframes:i}=this.options,o=(r==null?void 0:r.KeyframeResolver)||Ui,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(i,a,n,s,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:n="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=this.options,a=Xi(n)?n:Ox[n]||Ss;let l,c;a!==Ss&&typeof t[0]!="number"&&(l=Xn(Bx,Xu(t[0],t[1])),t=[0,100]);const d=a({...this.options,keyframes:t});i==="mirror"&&(c=a({...this.options,keyframes:[...t].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=zu(d));const{calculatedDuration:u}=d,h=u+r,f=h*(s+1)-r;return{generator:d,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:u,resolvedDuration:h,totalDuration:f}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,n=!1){const{resolved:s}=this;if(!s){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:r,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:d,resolvedDuration:u}=s;if(this.startTime===null)return i.next(0);const{delay:h,repeat:f,repeatType:p,repeatDelay:v,onUpdate:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-d/this.speed,this.startTime)),n?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const b=this.currentTime-h*(this.speed>=0?1:-1),x=this.speed>=0?b<0:b>d;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let w=this.currentTime,E=i;if(f){const R=Math.min(this.currentTime,d)/u;let P=Math.floor(R),M=R%1;!M&&R>=1&&(M=1),M===1&&P--,P=Math.min(P,f+1),!!(P%2)&&(p==="reverse"?(M=1-M,v&&(M-=v/u)):p==="mirror"&&(E=o)),w=mt(0,1,M)*u}const _=x?{done:!1,value:l[0]}:E.next(w);a&&(_.value=a(_.value));let{done:j}=_;!x&&c!==null&&(j=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return D&&r!==void 0&&(_.value=Hs(l,this.options,r)),y&&y(_.value),D&&this.finish(),_}get duration(){const{resolved:t}=this;return t?ht(t.calculatedDuration):0}get time(){return ht(this.currentTime)}set time(t){t=ft(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=ht(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=Vx,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const Fx=new Set(["opacity","clipPath","filter","transform"]);function Qi(e){let t;return()=>(t===void 0&&(t=e()),t)}const Hx={linearEasing:void 0};function Ux(e,t){const n=Qi(e);return()=>{var s;return(s=Hx[t])!==null&&s!==void 0?s:n()}}const _s=Ux(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing");function Yu(e){return!!(typeof e=="function"&&_s()||!e||typeof e=="string"&&(e in qr||_s())||Yi(e)||Array.isArray(e)&&e.every(Yu))}const Cn=([e,t,n,s])=>`cubic-bezier(${e}, ${t}, ${n}, ${s})`,qr={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Cn([0,.65,.55,1]),circOut:Cn([.55,0,1,.45]),backIn:Cn([.31,.01,.66,-.59]),backOut:Cn([.33,1.53,.69,.99])};function Zu(e,t){if(e)return typeof e=="function"&&_s()?Fu(e,t):Yi(e)?Cn(e):Array.isArray(e)?e.map(n=>Zu(n,t)||qr.easeOut):qr[e]}function zx(e,t,n,{delay:s=0,duration:r=300,repeat:i=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[t]:n};l&&(c.offset=l);const d=Zu(a,r);return Array.isArray(d)&&(c.easing=d),e.animate(c,{delay:s,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function Da(e,t){e.timeline=t,e.onfinish=null}const Gx=Qi(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Ts=10,Wx=2e4;function Kx(e){return Xi(e.type)||e.type==="spring"||!Yu(e.ease)}function Xx(e,t){const n=new Ji({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:e[0]};const r=[];let i=0;for(;!s.done&&i<Wx;)s=n.sample(i),r.push(s.value),i+=Ts;return{times:void 0,keyframes:r,duration:i-Ts,ease:"linear"}}const Ju={anticipate:bu,backInOut:wu,circInOut:Su};function Yx(e){return e in Ju}class Va extends Bu{constructor(t){super(t);const{name:n,motionValue:s,element:r,keyframes:i}=this.options;this.resolver=new Ou(i,(o,a)=>this.onKeyframesResolved(o,a),n,s,r),this.resolver.scheduleResolve()}initPlayback(t,n){var s;let{duration:r=300,times:i,ease:o,type:a,motionValue:l,name:c,startTime:d}=this.options;if(!(!((s=l.owner)===null||s===void 0)&&s.current))return!1;if(typeof o=="string"&&_s()&&Yx(o)&&(o=Ju[o]),Kx(this.options)){const{onComplete:h,onUpdate:f,motionValue:p,element:v,...y}=this.options,b=Xx(t,y);t=b.keyframes,t.length===1&&(t[1]=t[0]),r=b.duration,i=b.times,o=b.ease,a="keyframes"}const u=zx(l.owner.current,c,t,{...this.options,duration:r,times:i,ease:o});return u.startTime=d??this.calcStartTime(),this.pendingTimeline?(Da(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:h}=this.options;l.set(Hs(t,this.options,n)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:r,times:i,type:a,ease:o,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:n}=t;return ht(n)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:n}=t;return ht(n.currentTime||0)}set time(t){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=ft(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:n}=t;return n.playbackRate}set speed(t){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:n}=t;return n.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:n}=t;return n.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:n}=this;if(!n)return He;const{animation:s}=n;Da(s,t)}return He}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:n,keyframes:s,duration:r,type:i,ease:o,times:a}=t;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:d,onComplete:u,element:h,...f}=this.options,p=new Ji({...f,keyframes:s,duration:r,type:i,ease:o,times:a,isGenerator:!0}),v=ft(this.time);c.setWithVelocity(p.sample(v-Ts).value,p.sample(v).value,Ts)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:n,name:s,repeatDelay:r,repeatType:i,damping:o,type:a}=t;return Gx()&&s&&Fx.has(s)&&n&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate&&!r&&i!=="mirror"&&o!==0&&a!=="inertia"}}const Zx=Qi(()=>window.ScrollTimeline!==void 0);class Jx{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}then(t,n){return Promise.all(this.animations).then(t).catch(n)}getAll(t){return this.animations[0][t]}setAll(t,n){for(let s=0;s<this.animations.length;s++)this.animations[s][t]=n}attachTimeline(t,n){const s=this.animations.map(r=>Zx()&&r.attachTimeline?r.attachTimeline(t):n(r));return()=>{s.forEach((r,i)=>{r&&r(),this.animations[i].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let n=0;n<this.animations.length;n++)t=Math.max(t,this.animations[n].duration);return t}runAll(t){this.animations.forEach(n=>n[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function Qx({when:e,delay:t,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...d}){return!!Object.keys(d).length}const qi=(e,t,n,s={},r,i)=>o=>{const a=Oi(s,e)||{},l=a.delay||s.delay||0;let{elapsed:c=0}=s;c=c-ft(l);let d={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-c,onUpdate:h=>{t.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:i?void 0:r};Qx(a)||(d={...d,...Sy(e,d)}),d.duration&&(d.duration=ft(d.duration)),d.repeatDelay&&(d.repeatDelay=ft(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let u=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(u=!0)),u&&!i&&t.get()!==void 0){const h=Hs(d.keyframes,a);if(h!==void 0)return fe.update(()=>{d.onUpdate(h),d.onComplete()}),new Jx([])}return!i&&Va.supports(d)?new Va(d):new Ji(d)},qx=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),ew=e=>zr(e)?e[e.length-1]||0:e;function eo(e,t){e.indexOf(t)===-1&&e.push(t)}function to(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class no{constructor(){this.subscriptions=[]}add(t){return eo(this.subscriptions,t),()=>to(this.subscriptions,t)}notify(t,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(t,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Oa=30,tw=e=>!isNaN(parseFloat(e));class nw{constructor(t,n={}){this.version="11.15.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{const i=ct.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=ct.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=tw(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new no);const s=this.events[t].add(n);return t==="change"?()=>{s(),fe.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ct.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Oa)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Oa);return Hu(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Vn(e,t){return new nw(e,t)}function sw(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Vn(n))}function rw(e,t){const n=Fs(e,t);let{transitionEnd:s={},transition:r={},...i}=n||{};i={...i,...s};for(const o in i){const a=ew(i[o]);sw(e,o,a)}}const so=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),iw="framerAppearId",Qu="data-"+so(iw);function qu(e){return e.props[Qu]}const ke=e=>!!(e&&e.getVelocity);function ow(e){return!!(ke(e)&&e.add)}function ei(e,t){const n=e.getValue("willChange");if(ow(n))return n.add(t)}function aw({protectedKeys:e,needsAnimating:t},n){const s=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,s}function ed(e,t,{delay:n=0,transitionOverride:s,type:r}={}){var i;let{transition:o=e.getDefaultTransition(),transitionEnd:a,...l}=t;s&&(o=s);const c=[],d=r&&e.animationState&&e.animationState.getState()[r];for(const u in l){const h=e.getValue(u,(i=e.latestValues[u])!==null&&i!==void 0?i:null),f=l[u];if(f===void 0||d&&aw(d,u))continue;const p={delay:n,...Oi(o||{},u)};let v=!1;if(window.MotionHandoffAnimation){const b=qu(e);if(b){const x=window.MotionHandoffAnimation(b,u,fe);x!==null&&(p.startTime=x,v=!0)}}ei(e,u),h.start(qi(u,h,f,e.shouldReduceMotion&&Dt.has(u)?{type:!1}:p,e,v));const y=h.animation;y&&c.push(y)}return a&&Promise.all(c).then(()=>{fe.update(()=>{a&&rw(e,a)})}),c}function ti(e,t,n={}){var s;const r=Fs(e,t,n.type==="exit"?(s=e.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const o=r?()=>Promise.all(ed(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:h}=i;return lw(e,t,d+c,u,h,n)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,d]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>d())}else return Promise.all([o(),a(n.delay)])}function lw(e,t,n=0,s=0,r=1,i){const o=[],a=(e.variantChildren.size-1)*s,l=r===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(e.variantChildren).sort(cw).forEach((c,d)=>{c.notify("AnimationStart",t),o.push(ti(c,t,{...i,delay:n+l(d)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(o)}function cw(e,t){return e.sortNodePosition(t)}function uw(e,t,n={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const r=t.map(i=>ti(e,i,n));s=Promise.all(r)}else if(typeof t=="string")s=ti(e,t,n);else{const r=typeof t=="function"?Fs(e,t,n.custom):t;s=Promise.all(ed(e,r,n))}return s.then(()=>{e.notify("AnimationComplete",t)})}const dw=Vi.length;function td(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?td(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<dw;n++){const s=Vi[n],r=e.props[s];($n(r)||r===!1)&&(t[s]=r)}return t}const fw=[...Di].reverse(),hw=Di.length;function mw(e){return t=>Promise.all(t.map(({animation:n,options:s})=>uw(e,n,s)))}function pw(e){let t=mw(e),n=Ba(),s=!0;const r=l=>(c,d)=>{var u;const h=Fs(e,d,l==="exit"?(u=e.presenceContext)===null||u===void 0?void 0:u.custom:void 0);if(h){const{transition:f,transitionEnd:p,...v}=h;c={...c,...v,...p}}return c};function i(l){t=l(e)}function o(l){const{props:c}=e,d=td(e.parent)||{},u=[],h=new Set;let f={},p=1/0;for(let y=0;y<hw;y++){const b=fw[y],x=n[b],w=c[b]!==void 0?c[b]:d[b],E=$n(w),_=b===l?x.isActive:null;_===!1&&(p=y);let j=w===d[b]&&w!==c[b]&&E;if(j&&s&&e.manuallyAnimateOnMount&&(j=!1),x.protectedKeys={...f},!x.isActive&&_===null||!w&&!x.prevProp||Bs(w)||typeof w=="boolean")continue;const D=gw(x.prevProp,w);let R=D||b===l&&x.isActive&&!j&&E||y>p&&E,P=!1;const M=Array.isArray(w)?w:[w];let L=M.reduce(r(b),{});_===!1&&(L={});const{prevResolvedValues:$={}}=x,U={...$,...L},T=I=>{R=!0,h.has(I)&&(P=!0,h.delete(I)),x.needsAnimating[I]=!0;const F=e.getValue(I);F&&(F.liveStyle=!1)};for(const I in U){const F=L[I],S=$[I];if(f.hasOwnProperty(I))continue;let O=!1;zr(F)&&zr(S)?O=!mu(F,S):O=F!==S,O?F!=null?T(I):h.add(I):F!==void 0&&h.has(I)?T(I):x.protectedKeys[I]=!0}x.prevProp=w,x.prevResolvedValues=L,x.isActive&&(f={...f,...L}),s&&e.blockInitialAnimation&&(R=!1),R&&(!(j&&D)||P)&&u.push(...M.map(I=>({animation:I,options:{type:b}})))}if(h.size){const y={};h.forEach(b=>{const x=e.getBaseTarget(b),w=e.getValue(b);w&&(w.liveStyle=!0),y[b]=x??null}),u.push({animation:y})}let v=!!u.length;return s&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(v=!1),s=!1,v?t(u):Promise.resolve()}function a(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)===null||d===void 0||d.forEach(h=>{var f;return(f=h.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),n[l].isActive=c;const u=o(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n,reset:()=>{n=Ba(),s=!0}}}function gw(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!mu(t,e):!1}function Ct(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Ba(){return{animate:Ct(!0),whileInView:Ct(),whileHover:Ct(),whileTap:Ct(),whileDrag:Ct(),whileFocus:Ct(),exit:Ct()}}class Tt{constructor(t){this.isMounted=!1,this.node=t}update(){}}class vw extends Tt{constructor(t){super(t),t.animationState||(t.animationState=pw(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Bs(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let yw=0;class xw extends Tt{constructor(){super(...arguments),this.id=yw++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const r=this.node.animationState.setActive("exit",!t);n&&!t&&r.then(()=>n(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const ww={animation:{Feature:vw},exit:{Feature:xw}},et={x:!1,y:!1};function nd(){return et.x||et.y}function bw(e,t,n){var s;if(e instanceof Element)return[e];if(typeof e=="string"){let r=document;const i=(s=void 0)!==null&&s!==void 0?s:r.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}function sd(e,t){const n=bw(e),s=new AbortController,r={passive:!0,...t,signal:s.signal};return[n,r,()=>s.abort()]}function Fa(e){return t=>{t.pointerType==="touch"||nd()||e(t)}}function Ew(e,t,n={}){const[s,r,i]=sd(e,n),o=Fa(a=>{const{target:l}=a,c=t(a);if(!c||!l)return;const d=Fa(u=>{c(u),l.removeEventListener("pointerleave",d)});l.addEventListener("pointerleave",d,r)});return s.forEach(a=>{a.addEventListener("pointerenter",o,r)}),i}const ro=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Nn=new WeakSet;function Ha(e){return t=>{t.key==="Enter"&&e(t)}}function gr(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Sw=(e,t)=>{const n=e.currentTarget;if(!n)return;const s=Ha(()=>{if(Nn.has(n))return;gr(n,"down");const r=Ha(()=>{gr(n,"up")}),i=()=>gr(n,"cancel");n.addEventListener("keyup",r,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",s,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),t)},_w=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Tw(e){return _w.has(e.tagName)||e.tabIndex!==-1}const rd=(e,t)=>t?e===t?!0:rd(e,t.parentElement):!1;function Ua(e){return ro(e)&&!nd()}function Cw(e,t,n={}){const[s,r,i]=sd(e,n),o=a=>{const l=a.currentTarget;if(!Ua(a)||Nn.has(l))return;Nn.add(l);const c=t(a),d=(f,p)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",h),!(!Ua(f)||!Nn.has(l))&&(Nn.delete(l),c&&c(f,{success:p}))},u=f=>{d(f,n.useGlobalTarget||rd(l,f.target))},h=f=>{d(f,!1)};window.addEventListener("pointerup",u,r),window.addEventListener("pointercancel",h,r)};return s.forEach(a=>{Tw(a)||(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),a.addEventListener("focus",c=>Sw(c,r),r)}),i}function Nw(e){return e==="x"||e==="y"?et[e]?null:(et[e]=!0,()=>{et[e]=!1}):et.x||et.y?null:(et.x=et.y=!0,()=>{et.x=et.y=!1})}function Yn(e){return{point:{x:e.pageX,y:e.pageY}}}const Aw=e=>t=>ro(t)&&e(t,Yn(t));function On(e,t,n,s={passive:!0}){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n)}function Rn(e,t,n,s){return On(e,t,Aw(n),s)}const za=(e,t)=>Math.abs(e-t);function Pw(e,t){const n=za(e.x,t.x),s=za(e.y,t.y);return Math.sqrt(n**2+s**2)}class id{constructor(t,n,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const u=yr(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,f=Pw(u.offset,{x:0,y:0})>=3;if(!h&&!f)return;const{point:p}=u,{timestamp:v}=Pe;this.history.push({...p,timestamp:v});const{onStart:y,onMove:b}=this.handlers;h||(y&&y(this.lastMoveEvent,u),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,u)},this.handlePointerMove=(u,h)=>{this.lastMoveEvent=u,this.lastMoveEventInfo=vr(h,this.transformPagePoint),fe.update(this.updatePoint,!0)},this.handlePointerUp=(u,h)=>{this.end();const{onEnd:f,onSessionEnd:p,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=yr(u.type==="pointercancel"?this.lastMoveEventInfo:vr(h,this.transformPagePoint),this.history);this.startEvent&&f&&f(u,y),p&&p(u,y)},!ro(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.contextWindow=r||window;const o=Yn(t),a=vr(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=Pe;this.history=[{...l,timestamp:c}];const{onSessionStart:d}=n;d&&d(t,yr(a,this.history)),this.removeListeners=Xn(Rn(this.contextWindow,"pointermove",this.handlePointerMove),Rn(this.contextWindow,"pointerup",this.handlePointerUp),Rn(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),St(this.updatePoint)}}function vr(e,t){return t?{point:t(e.point)}:e}function Ga(e,t){return{x:e.x-t.x,y:e.y-t.y}}function yr({point:e},t){return{point:e,delta:Ga(e,od(t)),offset:Ga(e,jw(t)),velocity:Rw(t,.1)}}function jw(e){return e[0]}function od(e){return e[e.length-1]}function Rw(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,s=null;const r=od(e);for(;n>=0&&(s=e[n],!(r.timestamp-s.timestamp>ft(t)));)n--;if(!s)return{x:0,y:0};const i=ht(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Zt(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}const ad=1e-4,kw=1-ad,Iw=1+ad,ld=.01,Mw=0-ld,$w=0+ld;function Ue(e){return e.max-e.min}function Lw(e,t,n){return Math.abs(e-t)<=n}function Wa(e,t,n,s=.5){e.origin=s,e.originPoint=pe(t.min,t.max,e.origin),e.scale=Ue(n)/Ue(t),e.translate=pe(n.min,n.max,e.origin)-e.originPoint,(e.scale>=kw&&e.scale<=Iw||isNaN(e.scale))&&(e.scale=1),(e.translate>=Mw&&e.translate<=$w||isNaN(e.translate))&&(e.translate=0)}function kn(e,t,n,s){Wa(e.x,t.x,n.x,s?s.originX:void 0),Wa(e.y,t.y,n.y,s?s.originY:void 0)}function Ka(e,t,n){e.min=n.min+t.min,e.max=e.min+Ue(t)}function Dw(e,t,n){Ka(e.x,t.x,n.x),Ka(e.y,t.y,n.y)}function Xa(e,t,n){e.min=t.min-n.min,e.max=e.min+Ue(t)}function In(e,t,n){Xa(e.x,t.x,n.x),Xa(e.y,t.y,n.y)}function Vw(e,{min:t,max:n},s){return t!==void 0&&e<t?e=s?pe(t,e,s.min):Math.max(e,t):n!==void 0&&e>n&&(e=s?pe(n,e,s.max):Math.min(e,n)),e}function Ya(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function Ow(e,{top:t,left:n,bottom:s,right:r}){return{x:Ya(e.x,n,r),y:Ya(e.y,t,s)}}function Za(e,t){let n=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,s]=[s,n]),{min:n,max:s}}function Bw(e,t){return{x:Za(e.x,t.x),y:Za(e.y,t.y)}}function Fw(e,t){let n=.5;const s=Ue(e),r=Ue(t);return r>s?n=cn(t.min,t.max-s,e.min):s>r&&(n=cn(e.min,e.max-r,t.min)),mt(0,1,n)}function Hw(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const ni=.35;function Uw(e=ni){return e===!1?e=0:e===!0&&(e=ni),{x:Ja(e,"left","right"),y:Ja(e,"top","bottom")}}function Ja(e,t,n){return{min:Qa(e,t),max:Qa(e,n)}}function Qa(e,t){return typeof e=="number"?e:e[t]||0}const qa=()=>({translate:0,scale:1,origin:0,originPoint:0}),Jt=()=>({x:qa(),y:qa()}),el=()=>({min:0,max:0}),Se=()=>({x:el(),y:el()});function Xe(e){return[e("x"),e("y")]}function cd({top:e,left:t,right:n,bottom:s}){return{x:{min:t,max:n},y:{min:e,max:s}}}function zw({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Gw(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function xr(e){return e===void 0||e===1}function si({scale:e,scaleX:t,scaleY:n}){return!xr(e)||!xr(t)||!xr(n)}function At(e){return si(e)||ud(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function ud(e){return tl(e.x)||tl(e.y)}function tl(e){return e&&e!=="0%"}function Cs(e,t,n){const s=e-n,r=t*s;return n+r}function nl(e,t,n,s,r){return r!==void 0&&(e=Cs(e,r,s)),Cs(e,n,s)+t}function ri(e,t=0,n=1,s,r){e.min=nl(e.min,t,n,s,r),e.max=nl(e.max,t,n,s,r)}function dd(e,{x:t,y:n}){ri(e.x,t.translate,t.scale,t.originPoint),ri(e.y,n.translate,n.scale,n.originPoint)}const sl=.999999999999,rl=1.0000000000001;function Ww(e,t,n,s=!1){const r=n.length;if(!r)return;t.x=t.y=1;let i,o;for(let a=0;a<r;a++){i=n[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&qt(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,dd(e,o)),s&&At(i.latestValues)&&qt(e,i.latestValues))}t.x<rl&&t.x>sl&&(t.x=1),t.y<rl&&t.y>sl&&(t.y=1)}function Qt(e,t){e.min=e.min+t,e.max=e.max+t}function il(e,t,n,s,r=.5){const i=pe(e.min,e.max,r);ri(e,t,n,i,s)}function qt(e,t){il(e.x,t.x,t.scaleX,t.scale,t.originX),il(e.y,t.y,t.scaleY,t.scale,t.originY)}function fd(e,t){return cd(Gw(e.getBoundingClientRect(),t))}function Kw(e,t,n){const s=fd(e,n),{scroll:r}=t;return r&&(Qt(s.x,r.offset.x),Qt(s.y,r.offset.y)),s}const hd=({current:e})=>e?e.ownerDocument.defaultView:null,Xw=new WeakMap;class Yw{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Se(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=d=>{const{dragSnapToOrigin:u}=this.getProps();u?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Yn(d).point)},i=(d,u)=>{const{drag:h,dragPropagation:f,onDragStart:p}=this.getProps();if(h&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Nw(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Xe(y=>{let b=this.getAxisMotionValue(y).get()||0;if(lt.test(b)){const{projection:x}=this.visualElement;if(x&&x.layout){const w=x.layout.layoutBox[y];w&&(b=Ue(w)*(parseFloat(b)/100))}}this.originPoint[y]=b}),p&&fe.postRender(()=>p(d,u)),ei(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},o=(d,u)=>{const{dragPropagation:h,dragDirectionLock:f,onDirectionLock:p,onDrag:v}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:y}=u;if(f&&this.currentDirection===null){this.currentDirection=Zw(y),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",u.point,y),this.updateAxis("y",u.point,y),this.visualElement.render(),v&&v(d,u)},a=(d,u)=>this.stop(d,u),l=()=>Xe(d=>{var u;return this.getAnimationState(d)==="paused"&&((u=this.getAxisMotionValue(d).animation)===null||u===void 0?void 0:u.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new id(t,{onSessionStart:r,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:hd(this.visualElement)})}stop(t,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:r}=n;this.startAnimation(r);const{onDragEnd:i}=this.getProps();i&&fe.postRender(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,s){const{drag:r}=this.getProps();if(!s||!os(t,r,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(o=Vw(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){var t;const{dragConstraints:n,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;n&&Zt(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&r?this.constraints=Ow(r.layoutBox,n):this.constraints=!1,this.elastic=Uw(s),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Xe(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Hw(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!Zt(t))return!1;const s=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=Kw(s,r.root,this.visualElement.getTransformPagePoint());let o=Bw(r.layout.layoutBox,i);if(n){const a=n(zw(o));this.hasMutatedConstraints=!!a,a&&(o=cd(a))}return o}startAnimation(t){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Xe(d=>{if(!os(d,n,this.currentDirection))return;let u=l&&l[d]||{};o&&(u={min:0,max:0});const h=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:s?t[d]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...u};return this.startAxisValueAnimation(d,p)});return Promise.all(c).then(a)}startAxisValueAnimation(t,n){const s=this.getAxisMotionValue(t);return ei(this.visualElement,t),s.start(qi(t,s,0,n,this.visualElement,!1))}stopAnimation(){Xe(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Xe(t=>{var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){Xe(n=>{const{drag:s}=this.getProps();if(!os(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];i.set(t[n]-pe(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!Zt(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Xe(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();r[o]=Fw({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),Xe(o=>{if(!os(o,t,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(pe(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;Xw.set(this.visualElement,this);const t=this.visualElement.current,n=Rn(t,"pointerdown",l=>{const{drag:c,dragListener:d=!0}=this.getProps();c&&d&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();Zt(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),fe.read(s);const o=On(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Xe(d=>{const u=this.getAxisMotionValue(d);u&&(this.originPoint[d]+=l[d].translate,u.set(u.get()+l[d].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=ni,dragMomentum:a=!0}=t;return{...t,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function os(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function Zw(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class Jw extends Tt{constructor(t){super(t),this.removeGroupControls=He,this.removeListeners=He,this.controls=new Yw(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||He}unmount(){this.removeGroupControls(),this.removeListeners()}}const ol=e=>(t,n)=>{e&&fe.postRender(()=>e(t,n))};class Qw extends Tt{constructor(){super(...arguments),this.removePointerDownListener=He}onPointerDown(t){this.session=new id(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:hd(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:ol(t),onStart:ol(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&fe.postRender(()=>r(i,o))}}}mount(){this.removePointerDownListener=Rn(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Us=g.createContext(null);function qw(){const e=g.useContext(Us);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:s}=e,r=g.useId();g.useEffect(()=>s(r),[]);const i=g.useCallback(()=>n&&n(r),[r,n]);return!t&&n?[!1,i]:[!0]}const io=g.createContext({}),md=g.createContext({}),ms={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function al(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const bn={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(q.test(e))e=parseFloat(e);else return e;const n=al(e,t.target.x),s=al(e,t.target.y);return`${n}% ${s}%`}},eb={correct:(e,{treeScale:t,projectionDelta:n})=>{const s=e,r=_t.parse(e);if(r.length>5)return s;const i=_t.createTransformer(e),o=typeof r[0]!="number"?1:0,a=n.x.scale*t.x,l=n.y.scale*t.y;r[0+o]/=a,r[1+o]/=l;const c=pe(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),i(r)}},Ns={};function tb(e){Object.assign(Ns,e)}const{schedule:oo,cancel:fT}=pu(queueMicrotask,!1);class nb extends g.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=t;tb(sb),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),ms.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,o=s.projection;return o&&(o.isPresent=i,r||t.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||fe.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),oo.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=t;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function pd(e){const[t,n]=qw(),s=g.useContext(io);return m.jsx(nb,{...e,layoutGroup:s,switchLayoutGroup:g.useContext(md),isPresent:t,safeToRemove:n})}const sb={borderRadius:{...bn,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:bn,borderTopRightRadius:bn,borderBottomLeftRadius:bn,borderBottomRightRadius:bn,boxShadow:eb},gd=["TopLeft","TopRight","BottomLeft","BottomRight"],rb=gd.length,ll=e=>typeof e=="string"?parseFloat(e):e,cl=e=>typeof e=="number"||q.test(e);function ib(e,t,n,s,r,i){r?(e.opacity=pe(0,n.opacity!==void 0?n.opacity:1,ob(s)),e.opacityExit=pe(t.opacity!==void 0?t.opacity:1,0,ab(s))):i&&(e.opacity=pe(t.opacity!==void 0?t.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let o=0;o<rb;o++){const a=`border${gd[o]}Radius`;let l=ul(t,a),c=ul(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||cl(l)===cl(c)?(e[a]=Math.max(pe(ll(l),ll(c),s),0),(lt.test(c)||lt.test(l))&&(e[a]+="%")):e[a]=c}(t.rotate||n.rotate)&&(e.rotate=pe(t.rotate||0,n.rotate||0,s))}function ul(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const ob=vd(0,.5,Eu),ab=vd(.5,.95,He);function vd(e,t,n){return s=>s<e?0:s>t?1:n(cn(e,t,s))}function dl(e,t){e.min=t.min,e.max=t.max}function Ke(e,t){dl(e.x,t.x),dl(e.y,t.y)}function fl(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function hl(e,t,n,s,r){return e-=t,e=Cs(e,1/n,s),r!==void 0&&(e=Cs(e,1/r,s)),e}function lb(e,t=0,n=1,s=.5,r,i=e,o=e){if(lt.test(t)&&(t=parseFloat(t),t=pe(o.min,o.max,t/100)-o.min),typeof t!="number")return;let a=pe(i.min,i.max,s);e===i&&(a-=t),e.min=hl(e.min,t,n,a,r),e.max=hl(e.max,t,n,a,r)}function ml(e,t,[n,s,r],i,o){lb(e,t[n],t[s],t[r],t.scale,i,o)}const cb=["x","scaleX","originX"],ub=["y","scaleY","originY"];function pl(e,t,n,s){ml(e.x,t,cb,n?n.x:void 0,s?s.x:void 0),ml(e.y,t,ub,n?n.y:void 0,s?s.y:void 0)}function gl(e){return e.translate===0&&e.scale===1}function yd(e){return gl(e.x)&&gl(e.y)}function vl(e,t){return e.min===t.min&&e.max===t.max}function db(e,t){return vl(e.x,t.x)&&vl(e.y,t.y)}function yl(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function xd(e,t){return yl(e.x,t.x)&&yl(e.y,t.y)}function xl(e){return Ue(e.x)/Ue(e.y)}function wl(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class fb{constructor(){this.members=[]}add(t){eo(this.members,t),t.scheduleRender()}remove(t){if(to(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(r=>t===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(t,n){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,n&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:s}=t;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function hb(e,t,n){let s="";const r=e.x.translate/t.x,i=e.y.translate/t.y,o=(n==null?void 0:n.z)||0;if((r||i||o)&&(s=`translate3d(${r}px, ${i}px, ${o}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:d,rotateX:u,rotateY:h,skewX:f,skewY:p}=n;c&&(s=`perspective(${c}px) ${s}`),d&&(s+=`rotate(${d}deg) `),u&&(s+=`rotateX(${u}deg) `),h&&(s+=`rotateY(${h}deg) `),f&&(s+=`skewX(${f}deg) `),p&&(s+=`skewY(${p}deg) `)}const a=e.x.scale*t.x,l=e.y.scale*t.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const mb=(e,t)=>e.depth-t.depth;class pb{constructor(){this.children=[],this.isDirty=!1}add(t){eo(this.children,t),this.isDirty=!0}remove(t){to(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(mb),this.isDirty=!1,this.children.forEach(t)}}function ps(e){const t=ke(e)?e.get():e;return qx(t)?t.toValue():t}function gb(e,t){const n=ct.now(),s=({timestamp:r})=>{const i=r-n;i>=t&&(St(s),e(i-t))};return fe.read(s,!0),()=>St(s)}function vb(e){return e instanceof SVGElement&&e.tagName!=="svg"}function yb(e,t,n){const s=ke(e)?e:Vn(e);return s.start(qi("",s,t,n)),s.animation}const Pt={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},An=typeof window<"u"&&window.MotionDebug!==void 0,wr=["","X","Y","Z"],xb={visibility:"hidden"},bl=1e3;let wb=0;function br(e,t,n,s){const{latestValues:r}=t;r[e]&&(n[e]=r[e],t.setStaticValue(e,0),s&&(s[e]=0))}function wd(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=qu(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",fe,!(r||i))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&wd(s)}function bd({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},a=t==null?void 0:t()){this.id=wb++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,An&&(Pt.totalNodes=Pt.resolvedTargetDeltas=Pt.recalculatedProjection=0),this.nodes.forEach(Sb),this.nodes.forEach(Ab),this.nodes.forEach(Pb),this.nodes.forEach(_b),An&&window.MotionDebug.record(Pt)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new pb)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new no),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=vb(o),this.instance=o;const{layoutId:l,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),e){let u;const h=()=>this.root.updateBlockedByResize=!1;e(o,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=gb(h,250),ms.hasAnimatedSinceResize&&(ms.hasAnimatedSinceResize=!1,this.nodes.forEach(Sl))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||d.getDefaultTransition()||Mb,{onLayoutAnimationStart:y,onLayoutAnimationComplete:b}=d.getProps(),x=!this.targetLayout||!xd(this.targetLayout,p)||f,w=!h&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||h&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const E={...Oi(v,"layout"),onPlay:y,onComplete:b};(d.shouldReduceMotion||this.options.layoutRoot)&&(E.delay=0,E.type=!1),this.startAnimation(E)}else h||Sl(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,St(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(jb),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&wd(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const u=this.path[d];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(El);return}this.isUpdating||this.nodes.forEach(Cb),this.isUpdating=!1,this.nodes.forEach(Nb),this.nodes.forEach(bb),this.nodes.forEach(Eb),this.clearAllSnapshots();const a=ct.now();Pe.delta=mt(0,1e3/60,a-Pe.timestamp),Pe.timestamp=a,Pe.isProcessing=!0,dr.update.process(Pe),dr.preRender.process(Pe),dr.render.process(Pe),Pe.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,oo.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Tb),this.sharedNodes.forEach(Rb)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,fe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){fe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Se(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!yd(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,d=c!==this.prevTransformTemplateValue;o&&(a||At(this.latestValues)||d)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),$b(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return Se();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(Lb))){const{scroll:d}=this.root;d&&(Qt(l.x,d.offset.x),Qt(l.y,d.offset.y))}return l}removeElementScroll(o){var a;const l=Se();if(Ke(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:h}=d;d!==this.root&&u&&h.layoutScroll&&(u.wasRoot&&Ke(l,o),Qt(l.x,u.offset.x),Qt(l.y,u.offset.y))}return l}applyTransform(o,a=!1){const l=Se();Ke(l,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&qt(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),At(d.latestValues)&&qt(l,d.latestValues)}return At(this.latestValues)&&qt(l,this.latestValues),l}removeTransform(o){const a=Se();Ke(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!At(c.latestValues))continue;si(c.latestValues)&&c.updateSnapshot();const d=Se(),u=c.measurePageBox();Ke(d,u),pl(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,d)}return At(this.latestValues)&&pl(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Pe.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:h}=this.options;if(!(!this.layout||!(u||h))){if(this.resolvedRelativeTargetAt=Pe.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Se(),this.relativeTargetOrigin=Se(),In(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),Ke(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Se(),this.targetWithTransforms=Se()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Dw(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ke(this.target,this.layout.layoutBox),dd(this.target,this.targetDelta)):Ke(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Se(),this.relativeTargetOrigin=Se(),In(this.relativeTargetOrigin,this.target,f.target),Ke(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}An&&Pt.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||si(this.parent.latestValues)||ud(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Pe.timestamp&&(c=!1),c)return;const{layout:d,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||u))return;Ke(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;Ww(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Se());const{target:p}=a;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(fl(this.prevProjectionDelta.x,this.projectionDelta.x),fl(this.prevProjectionDelta.y,this.projectionDelta.y)),kn(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!wl(this.projectionDelta.x,this.prevProjectionDelta.x)||!wl(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),An&&Pt.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Jt(),this.projectionDelta=Jt(),this.projectionDeltaWithTransform=Jt()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},d={...this.latestValues},u=Jt();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=Se(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,v=f!==p,y=this.getStack(),b=!y||y.members.length<=1,x=!!(v&&!b&&this.options.crossfade===!0&&!this.path.some(Ib));this.animationProgress=0;let w;this.mixTargetDelta=E=>{const _=E/1e3;_l(u.x,o.x,_),_l(u.y,o.y,_),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(In(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),kb(this.relativeTarget,this.relativeTargetOrigin,h,_),w&&db(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=Se()),Ke(w,this.relativeTarget)),v&&(this.animationValues=d,ib(d,c,this.latestValues,_,x,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(St(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=fe.update(()=>{ms.hasAnimatedSinceResize=!0,this.currentAnimation=yb(0,bl,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(bl),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:d}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&Ed(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Se();const u=Ue(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+u;const h=Ue(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}Ke(a,l),qt(a,d),kn(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new fb),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&br("z",o,c,this.animationValues);for(let d=0;d<wr.length;d++)br(`rotate${wr[d]}`,o,c,this.animationValues),br(`skew${wr[d]}`,o,c,this.animationValues);o.render();for(const d in c)o.setStaticValue(d,c[d]),this.animationValues&&(this.animationValues[d]=c[d]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return xb;const c={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=ps(o==null?void 0:o.pointerEvents)||"",c.transform=d?d(this.latestValues,""):"none",c;const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=ps(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!At(this.latestValues)&&(v.transform=d?d({},""):"none",this.hasProjected=!1),v}const h=u.animationValues||u.latestValues;this.applyTransformsToTarget(),c.transform=hb(this.projectionDeltaWithTransform,this.treeScale,h),d&&(c.transform=d(h,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,u.animationValues?c.opacity=u===this?(l=(a=h.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:c.opacity=u===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const v in Ns){if(h[v]===void 0)continue;const{correct:y,applyTo:b}=Ns[v],x=c.transform==="none"?h[v]:y(h[v],u);if(b){const w=b.length;for(let E=0;E<w;E++)c[b[E]]=x}else c[v]=x}return this.options.layoutId&&(c.pointerEvents=u===this?ps(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(El),this.root.sharedNodes.clear()}}}function bb(e){e.updateLayout()}function Eb(e){var t;const n=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=e.layout,{animationType:i}=e.options,o=n.source!==e.layout.source;i==="size"?Xe(u=>{const h=o?n.measuredBox[u]:n.layoutBox[u],f=Ue(h);h.min=s[u].min,h.max=h.min+f}):Ed(i,n.layoutBox,s)&&Xe(u=>{const h=o?n.measuredBox[u]:n.layoutBox[u],f=Ue(s[u]);h.max=h.min+f,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[u].max=e.relativeTarget[u].min+f)});const a=Jt();kn(a,s,n.layoutBox);const l=Jt();o?kn(l,e.applyTransform(r,!0),n.measuredBox):kn(l,s,n.layoutBox);const c=!yd(a);let d=!1;if(!e.resumeFrom){const u=e.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:h,layout:f}=u;if(h&&f){const p=Se();In(p,n.layoutBox,h.layoutBox);const v=Se();In(v,s,f.layoutBox),xd(p,v)||(d=!0),u.options.layoutRoot&&(e.relativeTarget=v,e.relativeTargetOrigin=p,e.relativeParent=u)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:d})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function Sb(e){An&&Pt.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function _b(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Tb(e){e.clearSnapshot()}function El(e){e.clearMeasurements()}function Cb(e){e.isLayoutDirty=!1}function Nb(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Sl(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Ab(e){e.resolveTargetDelta()}function Pb(e){e.calcProjection()}function jb(e){e.resetSkewAndRotation()}function Rb(e){e.removeLeadSnapshot()}function _l(e,t,n){e.translate=pe(t.translate,0,n),e.scale=pe(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Tl(e,t,n,s){e.min=pe(t.min,n.min,s),e.max=pe(t.max,n.max,s)}function kb(e,t,n,s){Tl(e.x,t.x,n.x,s),Tl(e.y,t.y,n.y,s)}function Ib(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Mb={duration:.45,ease:[.4,0,.1,1]},Cl=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Nl=Cl("applewebkit/")&&!Cl("chrome/")?Math.round:He;function Al(e){e.min=Nl(e.min),e.max=Nl(e.max)}function $b(e){Al(e.x),Al(e.y)}function Ed(e,t,n){return e==="position"||e==="preserve-aspect"&&!Lw(xl(t),xl(n),.2)}function Lb(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const Db=bd({attachResizeListener:(e,t)=>On(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Er={current:void 0},Sd=bd({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Er.current){const e=new Db({});e.mount(window),e.setOptions({layoutScroll:!0}),Er.current=e}return Er.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Vb={pan:{Feature:Qw},drag:{Feature:Jw,ProjectionNode:Sd,MeasureLayout:pd}};function Pl(e,t,n){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,i=s[r];i&&fe.postRender(()=>i(t,Yn(t)))}class Ob extends Tt{mount(){const{current:t}=this.node;t&&(this.unmount=Ew(t,n=>(Pl(this.node,n,"Start"),s=>Pl(this.node,s,"End"))))}unmount(){}}class Bb extends Tt{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Xn(On(this.node.current,"focus",()=>this.onFocus()),On(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function jl(e,t,n){const{props:s}=e;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),i=s[r];i&&fe.postRender(()=>i(t,Yn(t)))}class Fb extends Tt{mount(){const{current:t}=this.node;t&&(this.unmount=Cw(t,n=>(jl(this.node,n,"Start"),(s,{success:r})=>jl(this.node,s,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const ii=new WeakMap,Sr=new WeakMap,Hb=e=>{const t=ii.get(e.target);t&&t(e)},Ub=e=>{e.forEach(Hb)};function zb({root:e,...t}){const n=e||document;Sr.has(n)||Sr.set(n,{});const s=Sr.get(n),r=JSON.stringify(t);return s[r]||(s[r]=new IntersectionObserver(Ub,{root:e,...t})),s[r]}function Gb(e,t,n){const s=zb(t);return ii.set(e,n),s.observe(e),()=>{ii.delete(e),s.unobserve(e)}}const Wb={some:0,all:1};class Kb extends Tt{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=t,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:Wb[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:d,onViewportLeave:u}=this.node.getProps(),h=c?d:u;h&&h(l)};return Gb(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(Xb(t,n))&&this.startObserver()}unmount(){}}function Xb({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const Yb={inView:{Feature:Kb},tap:{Feature:Fb},focus:{Feature:Bb},hover:{Feature:Ob}},Zb={layout:{ProjectionNode:Sd,MeasureLayout:pd}},ao=g.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),zs=g.createContext({}),lo=typeof window<"u",_d=lo?g.useLayoutEffect:g.useEffect,Td=g.createContext({strict:!1});function Jb(e,t,n,s,r){var i,o;const{visualElement:a}=g.useContext(zs),l=g.useContext(Td),c=g.useContext(Us),d=g.useContext(ao).reducedMotion,u=g.useRef(null);s=s||l.renderer,!u.current&&s&&(u.current=s(e,{visualState:t,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:d}));const h=u.current,f=g.useContext(md);h&&!h.projection&&r&&(h.type==="html"||h.type==="svg")&&Qb(u.current,n,r,f);const p=g.useRef(!1);g.useInsertionEffect(()=>{h&&p.current&&h.update(n,c)});const v=n[Qu],y=g.useRef(!!v&&!(!((i=window.MotionHandoffIsComplete)===null||i===void 0)&&i.call(window,v))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,v)));return _d(()=>{h&&(p.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),oo.render(h.render),y.current&&h.animationState&&h.animationState.animateChanges())}),g.useEffect(()=>{h&&(!y.current&&h.animationState&&h.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,v)}),y.current=!1))}),h}function Qb(e,t,n,s){const{layoutId:r,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Cd(e.parent)),e.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:!!o||a&&Zt(a),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:c})}function Cd(e){if(e)return e.options.allowProjection!==!1?e.projection:Cd(e.parent)}function qb(e,t,n){return g.useCallback(s=>{s&&e.mount&&e.mount(s),t&&(s?t.mount(s):t.unmount()),n&&(typeof n=="function"?n(s):Zt(n)&&(n.current=s))},[t])}function Gs(e){return Bs(e.animate)||Vi.some(t=>$n(e[t]))}function Nd(e){return!!(Gs(e)||e.variants)}function eE(e,t){if(Gs(e)){const{initial:n,animate:s}=e;return{initial:n===!1||$n(n)?n:void 0,animate:$n(s)?s:void 0}}return e.inherit!==!1?t:{}}function tE(e){const{initial:t,animate:n}=eE(e,g.useContext(zs));return g.useMemo(()=>({initial:t,animate:n}),[Rl(t),Rl(n)])}function Rl(e){return Array.isArray(e)?e.join(" "):e}const kl={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},un={};for(const e in kl)un[e]={isEnabled:t=>kl[e].some(n=>!!t[n])};function nE(e){for(const t in e)un[t]={...un[t],...e[t]}}const sE=Symbol.for("motionComponentSymbol");function rE({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:s,Component:r}){e&&nE(e);function i(a,l){let c;const d={...g.useContext(ao),...a,layoutId:iE(a)},{isStatic:u}=d,h=tE(a),f=s(a,u);if(!u&&lo){oE();const p=aE(d);c=p.MeasureLayout,h.visualElement=Jb(r,f,d,t,p.ProjectionNode)}return m.jsxs(zs.Provider,{value:h,children:[c&&h.visualElement?m.jsx(c,{visualElement:h.visualElement,...d}):null,n(r,a,qb(f,h.visualElement,l),f,u,h.visualElement)]})}const o=g.forwardRef(i);return o[sE]=r,o}function iE({layoutId:e}){const t=g.useContext(io).id;return t&&e!==void 0?t+"-"+e:e}function oE(e,t){g.useContext(Td).strict}function aE(e){const{drag:t,layout:n}=un;if(!t&&!n)return{};const s={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const lE=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function co(e){return typeof e!="string"||e.includes("-")?!1:!!(lE.indexOf(e)>-1||/[A-Z]/u.test(e))}function Ad(e,{style:t,vars:n},s,r){Object.assign(e.style,t,r&&r.getProjectionStyles(s));for(const i in n)e.style.setProperty(i,n[i])}const Pd=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function jd(e,t,n,s){Ad(e,t,void 0,s);for(const r in t.attrs)e.setAttribute(Pd.has(r)?r:so(r),t.attrs[r])}function Rd(e,{layout:t,layoutId:n}){return Dt.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Ns[e]||e==="opacity")}function uo(e,t,n){var s;const{style:r}=e,i={};for(const o in r)(ke(r[o])||t.style&&ke(t.style[o])||Rd(o,e)||((s=n==null?void 0:n.getValue(o))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(i[o]=r[o]);return i}function kd(e,t,n){const s=uo(e,t,n);for(const r in e)if(ke(e[r])||ke(t[r])){const i=Gn.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[i]=e[r]}return s}function fo(e){const t=g.useRef(null);return t.current===null&&(t.current=e()),t.current}function cE({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:n},s,r,i){const o={latestValues:uE(s,r,i,e),renderState:t()};return n&&(o.mount=a=>n(s,a,o)),o}const Id=e=>(t,n)=>{const s=g.useContext(zs),r=g.useContext(Us),i=()=>cE(e,t,s,r);return n?i():fo(i)};function uE(e,t,n,s){const r={},i=s(e,{});for(const h in i)r[h]=ps(i[h]);let{initial:o,animate:a}=e;const l=Gs(e),c=Nd(e);t&&c&&!l&&e.inherit!==!1&&(o===void 0&&(o=t.initial),a===void 0&&(a=t.animate));let d=n?n.initial===!1:!1;d=d||o===!1;const u=d?a:o;if(u&&typeof u!="boolean"&&!Bs(u)){const h=Array.isArray(u)?u:[u];for(let f=0;f<h.length;f++){const p=Li(e,h[f]);if(p){const{transitionEnd:v,transition:y,...b}=p;for(const x in b){let w=b[x];if(Array.isArray(w)){const E=d?w.length-1:0;w=w[E]}w!==null&&(r[x]=w)}for(const x in v)r[x]=v[x]}}}return r}const ho=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Md=()=>({...ho(),attrs:{}}),$d=(e,t)=>t&&typeof e=="number"?t.transform(e):e,dE={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},fE=Gn.length;function hE(e,t,n){let s="",r=!0;for(let i=0;i<fE;i++){const o=Gn[i],a=e[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=$d(a,Wi[o]);if(!l){r=!1;const d=dE[o]||o;s+=`${d}(${c}) `}n&&(t[o]=c)}}return s=s.trim(),n?s=n(t,r?"":s):r&&(s="none"),s}function mo(e,t,n){const{style:s,vars:r,transformOrigin:i}=e;let o=!1,a=!1;for(const l in t){const c=t[l];if(Dt.has(l)){o=!0;continue}else if(Nu(l)){r[l]=c;continue}else{const d=$d(c,Wi[l]);l.startsWith("origin")?(a=!0,i[l]=d):s[l]=d}}if(t.transform||(o||n?s.transform=hE(t,e.transform,n):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:d=0}=i;s.transformOrigin=`${l} ${c} ${d}`}}function Il(e,t,n){return typeof e=="string"?e:q.transform(t+n*e)}function mE(e,t,n){const s=Il(t,e.x,e.width),r=Il(n,e.y,e.height);return`${s} ${r}`}const pE={offset:"stroke-dashoffset",array:"stroke-dasharray"},gE={offset:"strokeDashoffset",array:"strokeDasharray"};function vE(e,t,n=1,s=0,r=!0){e.pathLength=1;const i=r?pE:gE;e[i.offset]=q.transform(-s);const o=q.transform(t),a=q.transform(n);e[i.array]=`${o} ${a}`}function po(e,{attrX:t,attrY:n,attrScale:s,originX:r,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},d,u){if(mo(e,c,u),d){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:f,dimensions:p}=e;h.transform&&(p&&(f.transform=h.transform),delete h.transform),p&&(r!==void 0||i!==void 0||f.transform)&&(f.transformOrigin=mE(p,r!==void 0?r:.5,i!==void 0?i:.5)),t!==void 0&&(h.x=t),n!==void 0&&(h.y=n),s!==void 0&&(h.scale=s),o!==void 0&&vE(h,o,a,l,!1)}const go=e=>typeof e=="string"&&e.toLowerCase()==="svg",yE={useVisualState:Id({scrapeMotionValuesFromProps:kd,createRenderState:Md,onMount:(e,t,{renderState:n,latestValues:s})=>{fe.read(()=>{try{n.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),fe.render(()=>{po(n,s,go(t.tagName),e.transformTemplate),jd(t,n)})}})},xE={useVisualState:Id({scrapeMotionValuesFromProps:uo,createRenderState:ho})};function Ld(e,t,n){for(const s in t)!ke(t[s])&&!Rd(s,n)&&(e[s]=t[s])}function wE({transformTemplate:e},t){return g.useMemo(()=>{const n=ho();return mo(n,t,e),Object.assign({},n.vars,n.style)},[t])}function bE(e,t){const n=e.style||{},s={};return Ld(s,n,e),Object.assign(s,wE(e,t)),s}function EE(e,t){const n={},s=bE(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=s,n}const SE=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function As(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||SE.has(e)}let Dd=e=>!As(e);function _E(e){e&&(Dd=t=>t.startsWith("on")?!As(t):e(t))}try{_E(require("@emotion/is-prop-valid").default)}catch{}function TE(e,t,n){const s={};for(const r in e)r==="values"&&typeof e.values=="object"||(Dd(r)||n===!0&&As(r)||!t&&!As(r)||e.draggable&&r.startsWith("onDrag"))&&(s[r]=e[r]);return s}function CE(e,t,n,s){const r=g.useMemo(()=>{const i=Md();return po(i,t,go(s),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};Ld(i,e.style,e),r.style={...i,...r.style}}return r}function NE(e=!1){return(n,s,r,{latestValues:i},o)=>{const l=(co(n)?CE:EE)(s,i,o,n),c=TE(s,typeof n=="string",e),d=n!==g.Fragment?{...c,...l,ref:r}:{},{children:u}=s,h=g.useMemo(()=>ke(u)?u.get():u,[u]);return g.createElement(n,{...d,children:h})}}function AE(e,t){return function(s,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...co(s)?yE:xE,preloadedFeatures:e,useRender:NE(r),createVisualElement:t,Component:s};return rE(o)}}const oi={current:null},Vd={current:!1};function PE(){if(Vd.current=!0,!!lo)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>oi.current=e.matches;e.addListener(t),t()}else oi.current=!1}function jE(e,t,n){for(const s in t){const r=t[s],i=n[s];if(ke(r))e.addValue(s,r);else if(ke(i))e.addValue(s,Vn(r,{owner:e}));else if(i!==r)if(e.hasValue(s)){const o=e.getValue(s);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=e.getStaticValue(s);e.addValue(s,Vn(o!==void 0?o:r,{owner:e}))}}for(const s in n)t[s]===void 0&&e.removeValue(s);return t}const Ml=new WeakMap,RE=[...ju,Re,_t],kE=e=>RE.find(Pu(e)),$l=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class IE{scrapeMotionValuesFromProps(t,n,s){return{}}constructor({parent:t,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Ui,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=ct.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,fe.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=Gs(n),this.isVariantNode=Nd(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in u){const f=u[h];l[h]!==void 0&&ke(f)&&f.set(l[h],!1)}}mount(t){this.current=t,Ml.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),Vd.current||PE(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:oi.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Ml.delete(this.current),this.projection&&this.projection.unmount(),St(this.notifyUpdate),St(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=Dt.has(t),r=n.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&fe.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{r(),i(),o&&o(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in un){const n=un[t];if(!n)continue;const{isEnabled:s,Feature:r}=n;if(!this.features[t]&&r&&s(this.props)&&(this.features[t]=new r(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Se()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<$l.length;s++){const r=$l[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i="on"+r,o=t[i];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=jE(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const s=this.values.get(t);n!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&n!==void 0&&(s=Vn(n===null?void 0:n,{owner:this}),this.addValue(t,s)),s}readValue(t,n){var s;let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(s=this.getBaseTargetFromProps(this.props,t))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(Tu(r)||_u(r))?r=parseFloat(r):!kE(r)&&_t.test(n)&&(r=Vu(t,n)),this.setBaseTarget(t,ke(r)?r.get():r)),ke(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var n;const{initial:s}=this.props;let r;if(typeof s=="string"||typeof s=="object"){const o=Li(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(r=o[t])}if(s&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!ke(i)?i:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new no),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class Od extends IE{constructor(){super(...arguments),this.KeyframeResolver=Ou}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:s}){delete n[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ke(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function ME(e){return window.getComputedStyle(e)}class $E extends Od{constructor(){super(...arguments),this.type="html",this.renderInstance=Ad}readValueFromInstance(t,n){if(Dt.has(n)){const s=Ki(n);return s&&s.default||0}else{const s=ME(t),r=(Nu(n)?s.getPropertyValue(n):s[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(t,{transformPagePoint:n}){return fd(t,n)}build(t,n,s){mo(t,n,s.transformTemplate)}scrapeMotionValuesFromProps(t,n,s){return uo(t,n,s)}}class LE extends Od{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Se}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Dt.has(n)){const s=Ki(n);return s&&s.default||0}return n=Pd.has(n)?n:so(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,s){return kd(t,n,s)}build(t,n,s){po(t,n,this.isSVGTag,s.transformTemplate)}renderInstance(t,n,s,r){jd(t,n,s,r)}mount(t){this.isSVGTag=go(t.tagName),super.mount(t)}}const DE=(e,t)=>co(e)?new LE(t):new $E(t,{allowProjection:e!==g.Fragment}),VE=AE({...ww,...Yb,...Vb,...Zb},DE),Ll=yy(VE);class OE extends g.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function BE({children:e,isPresent:t}){const n=g.useId(),s=g.useRef(null),r=g.useRef({width:0,height:0,top:0,left:0}),{nonce:i}=g.useContext(ao);return g.useInsertionEffect(()=>{const{width:o,height:a,top:l,left:c}=r.current;if(t||!s.current||!o||!a)return;s.current.dataset.motionPopId=n;const d=document.createElement("style");return i&&(d.nonce=i),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),m.jsx(OE,{isPresent:t,childRef:s,sizeRef:r,children:g.cloneElement(e,{ref:s})})}const FE=({children:e,initial:t,isPresent:n,onExitComplete:s,custom:r,presenceAffectsLayout:i,mode:o})=>{const a=fo(HE),l=g.useId(),c=g.useCallback(u=>{a.set(u,!0);for(const h of a.values())if(!h)return;s&&s()},[a,s]),d=g.useMemo(()=>({id:l,initial:t,isPresent:n,custom:r,onExitComplete:c,register:u=>(a.set(u,!1),()=>a.delete(u))}),i?[Math.random(),c]:[n,c]);return g.useMemo(()=>{a.forEach((u,h)=>a.set(h,!1))},[n]),g.useEffect(()=>{!n&&!a.size&&s&&s()},[n]),o==="popLayout"&&(e=m.jsx(BE,{isPresent:n,children:e})),m.jsx(Us.Provider,{value:d,children:e})};function HE(){return new Map}const as=e=>e.key||"";function Dl(e){const t=[];return g.Children.forEach(e,n=>{g.isValidElement(n)&&t.push(n)}),t}const UE=({children:e,exitBeforeEnter:t,custom:n,initial:s=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const a=g.useMemo(()=>Dl(e),[e]),l=a.map(as),c=g.useRef(!0),d=g.useRef(a),u=fo(()=>new Map),[h,f]=g.useState(a),[p,v]=g.useState(a);_d(()=>{c.current=!1,d.current=a;for(let x=0;x<p.length;x++){const w=as(p[x]);l.includes(w)?u.delete(w):u.get(w)!==!0&&u.set(w,!1)}},[p,l.length,l.join("-")]);const y=[];if(a!==h){let x=[...a];for(let w=0;w<p.length;w++){const E=p[w],_=as(E);l.includes(_)||(x.splice(w,0,E),y.push(E))}o==="wait"&&y.length&&(x=y),v(Dl(x)),f(a);return}const{forceRender:b}=g.useContext(io);return m.jsx(m.Fragment,{children:p.map(x=>{const w=as(x),E=a===p||l.includes(w),_=()=>{if(u.has(w))u.set(w,!0);else return;let j=!0;u.forEach(D=>{D||(j=!1)}),j&&(b==null||b(),v(d.current),r&&r())};return m.jsx(FE,{isPresent:E,initial:!c.current||s?void 0:!1,custom:E?void 0:n,presenceAffectsLayout:i,mode:o,onExitComplete:E?void 0:_,children:x},w)})})};function zE({content:e,disabled:t}){const[n,s]=g.useState(!1),r=i=>{i.stopPropagation(),navigator.clipboard.writeText(e),s(!0),setTimeout(()=>s(!1),2e3)};return m.jsx(Xt,{onClick:i=>r(i),variant:"ghost",tooltip:"Copy content",disabled:t,children:m.jsx(UE,{mode:"wait",initial:!1,children:n?m.jsx(Ll.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.15},children:m.jsx(nm,{className:"text-green-500"})},"check"):m.jsx(Ll.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.15},children:m.jsx(Bh,{})},"copy")})})}function Bd({branch:e,branchOptions:t,onSelect:n,isLoading:s}){if(!t||!e)return null;const r=t.indexOf(e);return m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(me,{variant:"ghost",size:"icon",className:"size-6 p-1",onClick:()=>{const i=t[r-1];i&&n(i)},disabled:s,children:m.jsx(Vh,{})}),m.jsxs("span",{className:"text-sm",children:[r+1," / ",t.length]}),m.jsx(me,{variant:"ghost",size:"icon",className:"size-6 p-1",onClick:()=>{const i=t[r+1];i&&n(i)},disabled:s,children:m.jsx(wc,{})})]})}function Fd({content:e,isHumanMessage:t,isAiMessage:n,isEditing:s,setIsEditing:r,handleSubmitEdit:i,handleRegenerate:o,isLoading:a}){if(t&&n)throw new Error("Can only set one of isHumanMessage or isAiMessage to true, not both.");if(!t&&!n)throw new Error("One of isHumanMessage or isAiMessage must be set to true.");if(t&&(s===void 0||r===void 0||i===void 0))throw new Error("If isHumanMessage is true, all of isEditing, setIsEditing, and handleSubmitEdit must be set.");const l=t&&s!==void 0&&!!r&&!!i;return t&&s&&r&&i?m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Xt,{disabled:a,tooltip:"Cancel edit",variant:"ghost",onClick:()=>{r(!1)},children:m.jsx(bt,{})}),m.jsx(Xt,{disabled:a,tooltip:"Submit",variant:"secondary",onClick:i,children:m.jsx(rm,{})})]}):m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(zE,{content:e,disabled:a}),n&&!!o&&m.jsx(Xt,{disabled:a,tooltip:"Refresh",variant:"ghost",onClick:o,children:m.jsx(sm,{})}),l&&m.jsx(Xt,{disabled:a,tooltip:"Edit",variant:"ghost",onClick:()=>{r==null||r(!0)},children:m.jsx(Oh,{})})]})}function _r({toolCalls:e}){return!e||e.length===0?null:m.jsx("div",{className:"space-y-2",children:e.map((t,n)=>m.jsx(GE,{toolCall:t},t.id||n))})}function GE({toolCall:e}){const[t,n]=g.useState(!1);return m.jsx(bc,{className:"bg-blue-50 border-blue-200",children:m.jsxs(bh,{open:t,onOpenChange:n,children:[m.jsx(Eh,{asChild:!0,children:m.jsx(Ec,{className:"cursor-pointer hover:bg-blue-100/50 transition-colors pb-3",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Hh,{className:"h-4 w-4 text-blue-600"}),m.jsx(Sc,{className:"text-sm font-medium text-blue-900",children:e.name}),m.jsx(tn,{variant:"outline",className:"text-xs bg-blue-100 text-blue-700 border-blue-300",children:"Tool Call"})]}),t?m.jsx(Uh,{className:"h-4 w-4 text-blue-600"}):m.jsx(wc,{className:"h-4 w-4 text-blue-600"})]})})}),m.jsx(Sh,{children:m.jsxs(_c,{className:"pt-0",children:[e.args&&Object.keys(e.args).length>0&&m.jsxs("div",{className:"mt-2",children:[m.jsx("div",{className:"text-xs font-medium text-blue-800 mb-2",children:"Arguments:"}),m.jsx("div",{className:"bg-white rounded border p-3",children:m.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap overflow-x-auto",children:JSON.stringify(e.args,null,2)})})]}),e.id&&m.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:["ID: ",e.id]})]})})]})})}function WE({message:e}){const t=typeof e.content=="string"?e.content:Array.isArray(e.content)?e.content.map(s=>typeof s=="string"?s:s.text||"").join(""):"",n="name"in e?e.name:"Unknown Tool";return m.jsxs(bc,{className:"bg-green-50 border-green-200",children:[m.jsx(Ec,{className:"pb-3",children:m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(im,{className:"h-4 w-4 text-green-600"}),m.jsxs(Sc,{className:"text-sm font-medium text-green-900",children:[n," Result"]}),m.jsx(tn,{variant:"outline",className:"text-xs bg-green-100 text-green-700 border-green-300",children:"Result"})]})}),t&&m.jsx(_c,{children:m.jsx("div",{className:"bg-white rounded border p-3",children:m.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap overflow-x-auto",children:t})})})]})}function Vl(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="agent-inbox")}function KE({interrupt:e}){return m.jsxs("div",{className:"p-4 border rounded-lg bg-muted",children:[m.jsx("p",{className:"text-sm text-muted-foreground",children:"Agent Inbox Interrupt"}),m.jsx("pre",{className:"text-xs mt-2 overflow-auto",children:JSON.stringify(e,null,2)})]})}function XE({interrupt:e}){return m.jsxs("div",{className:"p-4 border rounded-lg bg-yellow-50",children:[m.jsx("p",{className:"text-sm text-yellow-800",children:"Generic Interrupt"}),m.jsx("pre",{className:"text-xs mt-2 overflow-auto text-yellow-700",children:JSON.stringify(e,null,2)})]})}const Vt=g.createContext(null),YE=e=>{const t=g.useContext(Vt),[n,s]=t.mounted,[r]=t.content,[i]=t.title,o=n===e.id,a=e.children==null&&e.title==null;return g.useEffect(()=>{a&&s(l=>l===e.id?null:l)},[a,s,e.id]),o?m.jsxs(m.Fragment,{children:[i!=null?Ir.createPortal(m.jsx(m.Fragment,{children:e.title}),i):null,r!=null?Ir.createPortal(m.jsx(m.Fragment,{children:e.children}),r):null]}):null};function ZE(e){const t=g.useContext(Vt),[n]=t.mounted,s=g.useRef(null),[,r]=t.content;return g.useLayoutEffect(()=>r==null?void 0:r(n?s.current:null),[r,n]),n?m.jsx("div",{...e,ref:s}):null}function JE(e){const t=g.useContext(Vt),n=g.useRef(null),[,s]=t.title;return g.useLayoutEffect(()=>s==null?void 0:s(n.current),[s]),m.jsx("div",{...e,ref:n})}function QE(e){const t=g.useState(null),n=g.useState(null),s=g.useState(null),r=g.useState(null),i=g.useState({});return m.jsx(Vt.Provider,{value:{open:s,mounted:r,title:n,content:t,context:i},children:e.children})}function qE(){const e=g.useId(),t=g.useContext(Vt),[n,s]=t.open,[r,i]=t.context,[,o]=t.mounted,a=n===e,l=g.useCallback(d=>{s(typeof d=="boolean"?d?e:null:u=>u===e?null:e),o(e)},[s,o,e]);return[g.useCallback(d=>m.jsx(YE,{id:e,title:d.title,children:d.children}),[e]),{open:a,setOpen:l,context:r,setContext:i}]}function eS(){const e=g.useContext(Vt),[t,n]=e.open,s=t!==null,r=g.useCallback(()=>n(null),[n]);return[s,r]}function tS(){return g.useContext(Vt).context}function nS({message:e,thread:t}){var i;const n=qE(),{values:s}=Os(),r=(i=s.ui)==null?void 0:i.filter(o=>{var a;return((a=o.metadata)==null?void 0:a.message_id)===e.id});return r!=null&&r.length?m.jsx(m.Fragment,{children:r.map(o=>m.jsx(Iv,{stream:t,message:o,meta:{ui:o,artifact:n}},o.id))},e.id):null}function sS(e){return e.filter(n=>n.type==="tool_use"&&n.id).map(n=>{const s=n;let r={};if(s!=null&&s.input)try{r=Lc(s.input)??{}}catch{}return{name:s.name??"",id:s.id??"",args:r,type:"tool_call"}})}function Ol({interruptValue:e,isLastMessage:t,hasNoAIOrToolMessages:n}){return m.jsxs(m.Fragment,{children:[Vl(e)&&(t||n)&&m.jsx(KE,{interrupt:e}),e&&!Vl(e)&&(t||n)?m.jsx(XE,{interrupt:e}):null]})}function Bl({message:e,isLoading:t,handleRegenerate:n}){var b,x;const s=(e==null?void 0:e.content)??[],r=$i(s),[i]=on("hideToolCalls",Tc.withDefault(!1)),o=Os(),a=o.messages[o.messages.length-1].id===(e==null?void 0:e.id),l=!o.messages.find(w=>w.type==="ai"||w.type==="tool"),c=e?o.getMessagesMetadata(e):void 0,d=o.interrupt,u=(b=c==null?void 0:c.firstSeenState)==null?void 0:b.parent_checkpoint,h=Array.isArray(s)?sS(s):void 0,f=e&&"tool_calls"in e&&e.tool_calls&&e.tool_calls.length>0,p=f&&((x=e.tool_calls)==null?void 0:x.some(w=>w.args&&Object.keys(w.args).length>0)),v=!!(h!=null&&h.length),y=(e==null?void 0:e.type)==="tool";return y&&i?null:m.jsx("div",{className:"group mr-auto flex items-start gap-2",children:m.jsx("div",{className:"flex flex-col gap-2",children:y?m.jsxs(m.Fragment,{children:[m.jsx(WE,{message:e}),m.jsx(Ol,{interruptValue:d==null?void 0:d.value,isLastMessage:a,hasNoAIOrToolMessages:l})]}):m.jsxs(m.Fragment,{children:[r.length>0&&m.jsx("div",{className:"py-1",children:m.jsx(Fh,{children:r})}),!i&&m.jsx(m.Fragment,{children:f&&p&&m.jsx(_r,{toolCalls:e.tool_calls})||v&&m.jsx(_r,{toolCalls:h})||f&&m.jsx(_r,{toolCalls:e.tool_calls})}),e&&m.jsx(nS,{message:e,thread:o}),m.jsx(Ol,{interruptValue:d==null?void 0:d.value,isLastMessage:a,hasNoAIOrToolMessages:l}),m.jsxs("div",{className:je("mr-auto flex items-center gap-2 transition-opacity","opacity-0 group-focus-within:opacity-100 group-hover:opacity-100"),children:[m.jsx(Bd,{branch:c==null?void 0:c.branch,branchOptions:c==null?void 0:c.branchOptions,onSelect:w=>o.setBranch(w),isLoading:t}),m.jsx(Fd,{content:r,isLoading:t,isAiMessage:!0,handleRegenerate:()=>n(u)})]})]})})})}function rS(){return m.jsx("div",{className:"mr-auto flex items-start gap-2",children:m.jsxs("div",{className:"bg-muted flex h-8 items-center gap-1 rounded-2xl px-4 py-2",children:[m.jsx("div",{className:"bg-foreground/50 h-1.5 w-1.5 animate-[pulse_1.5s_ease-in-out_infinite] rounded-full"}),m.jsx("div",{className:"bg-foreground/50 h-1.5 w-1.5 animate-[pulse_1.5s_ease-in-out_0.5s_infinite] rounded-full"}),m.jsx("div",{className:"bg-foreground/50 h-1.5 w-1.5 animate-[pulse_1.5s_ease-in-out_1s_infinite] rounded-full"})]})})}const Hd=({block:e,removable:t=!1,onRemove:n,className:s,size:r="md"})=>{var i,o,a;if(e.type==="image"&&typeof e.mime_type=="string"&&e.mime_type.startsWith("image/")){const l=`data:${e.mime_type};base64,${e.data}`;let c="rounded-md object-cover h-16 w-16 text-lg";return r==="sm"&&(c="rounded-md object-cover h-10 w-10 text-base"),r==="lg"&&(c="rounded-md object-cover h-24 w-24 text-xl"),m.jsxs("div",{className:je("relative inline-block",s),children:[m.jsx("img",{src:l,alt:String(((i=e.metadata)==null?void 0:i.name)||"uploaded image"),className:c}),t&&m.jsx("button",{type:"button",className:"absolute top-1 right-1 z-10 rounded-full bg-gray-500 text-white hover:bg-gray-700",onClick:n,"aria-label":"Remove image",children:m.jsx(bt,{className:"h-4 w-4"})})]})}if(e.type==="file"&&e.mime_type==="application/pdf"){const l=((o=e.metadata)==null?void 0:o.filename)||((a=e.metadata)==null?void 0:a.name)||"PDF file";return m.jsxs("div",{className:je("relative flex items-start gap-2 rounded-md border bg-gray-100 px-3 py-2",s),children:[m.jsx("div",{className:"flex flex-shrink-0 flex-col items-start justify-start",children:m.jsx(Vo,{className:je("text-teal-700",r==="sm"?"h-5 w-5":"h-7 w-7")})}),m.jsx("span",{className:je("min-w-0 flex-1 text-sm break-all text-gray-800"),style:{wordBreak:"break-all",whiteSpace:"pre-wrap"},children:String(l)}),t&&m.jsx("button",{type:"button",className:"ml-2 self-start rounded-full bg-gray-200 p-1 text-teal-700 hover:bg-gray-300",onClick:n,"aria-label":"Remove PDF",children:m.jsx(bt,{className:"h-4 w-4"})})]})}return m.jsxs("div",{className:je("flex items-center gap-2 rounded-md border bg-gray-100 px-3 py-2 text-gray-500",s),children:[m.jsx(Vo,{className:"h-5 w-5 flex-shrink-0"}),m.jsx("span",{className:"truncate text-xs",children:"Unsupported file type"}),t&&m.jsx("button",{type:"button",className:"ml-2 rounded-full bg-gray-200 p-1 text-gray-500 hover:bg-gray-300",onClick:n,"aria-label":"Remove file",children:m.jsx(bt,{className:"h-4 w-4"})})]})};function iS(e){return e&&typeof e=="object"&&(e.type==="image"||e.type==="file")&&typeof e.data=="string"&&typeof e.mime_type=="string"}async function Tr(e){return new Promise((t,n)=>{const s=new FileReader;s.onload=()=>{const i=s.result.split(",")[1];e.type==="application/pdf"?t({type:"file",source_type:"base64",data:i,mime_type:e.type,metadata:{filename:e.name}}):t({type:"image",source_type:"base64",data:i,mime_type:e.type,metadata:{name:e.name}})},s.onerror=n,s.readAsDataURL(e)})}function oS({value:e,setValue:t,onSubmit:n}){const s=r=>{(r.metaKey||r.ctrlKey)&&r.key==="Enter"&&(r.preventDefault(),n())};return m.jsx($r,{value:e,onChange:r=>t(r.target.value),onKeyDown:s,className:"focus-visible:ring-0"})}function aS({message:e,isLoading:t}){var u;const n=Os(),s=n.getMessagesMetadata(e),r=(u=s==null?void 0:s.firstSeenState)==null?void 0:u.parent_checkpoint,[i,o]=g.useState(!1),[a,l]=g.useState(""),c=$i(e.content),d=()=>{o(!1);const h={type:"human",content:a};n.submit({messages:[h]},{checkpoint:r,streamMode:["values"],streamSubgraphs:!0,streamResumable:!0,optimisticValues:f=>{var v;const p=(v=s==null?void 0:s.firstSeenState)==null?void 0:v.values;return p?{...p,messages:[...p.messages??[],h]}:f}})};return m.jsx("div",{className:je("group ml-auto flex items-center gap-2",i&&"w-full max-w-xl"),children:m.jsxs("div",{className:je("flex flex-col gap-2",i&&"w-full"),children:[i?m.jsx(oS,{value:a,setValue:l,onSubmit:d}):m.jsxs("div",{className:"flex flex-col gap-2",children:[Array.isArray(e.content)&&e.content.length>0&&m.jsx("div",{className:"flex flex-wrap items-end justify-end gap-2",children:e.content.reduce((h,f,p)=>(iS(f)&&h.push(m.jsx(Hd,{block:f,size:"md"},p)),h),[])}),c?m.jsx("p",{className:"bg-muted ml-auto w-fit max-w-xs rounded-3xl px-4 py-2 text-right whitespace-pre-wrap text-base leading-relaxed break-words",style:{overflowWrap:"anywhere"},children:c}):null]}),m.jsxs("div",{className:je("ml-auto flex items-center gap-2 transition-opacity","opacity-0 group-focus-within:opacity-100 group-hover:opacity-100",i&&"opacity-100"),children:[m.jsx(Bd,{branch:s==null?void 0:s.branch,branchOptions:s==null?void 0:s.branchOptions,onSelect:h=>n.setBranch(h),isLoading:t}),m.jsx(Fd,{isLoading:t,content:c,isEditing:i,setIsEditing:h=>{h&&l(c),o(h)},handleSubmitEdit:d,isHumanMessage:!0})]})]})})}const Ud="do-not-render-";function lS(e){const t=[];return e.forEach((n,s)=>{var i,o;if(n.type!=="ai"||((i=n.tool_calls)==null?void 0:i.length)===0)return;const r=e[s+1];r&&r.type==="tool"||t.push(...((o=n.tool_calls)==null?void 0:o.map(a=>({type:"tool",tool_call_id:a.id??"",id:`${Ud}${$c()}`,name:a.name,content:"Successfully handled tool call."})))??[])}),t}/*!---------------------------------------------------------------------------------------------
 *  Copyright (c) StackBlitz. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/const cS={damping:.7,stiffness:.05,mass:1.25},uS=70,dS=1e3/60,fS=350;let Ws=!1;var fc;(fc=globalThis.document)==null||fc.addEventListener("mousedown",()=>{Ws=!0});var hc;(hc=globalThis.document)==null||hc.addEventListener("mouseup",()=>{Ws=!1});var mc;(mc=globalThis.document)==null||mc.addEventListener("click",()=>{Ws=!1});const hS=(e={})=>{const[t,n]=g.useState(!1),[s,r]=g.useState(e.initial!==!1),[i,o]=g.useState(!1),a=g.useRef(null);a.current=e;const l=g.useCallback(()=>{var E;if(!Ws)return!1;const x=window.getSelection();if(!x||!x.rangeCount)return!1;const w=x.getRangeAt(0);return w.commonAncestorContainer.contains(y.current)||((E=y.current)==null?void 0:E.contains(w.commonAncestorContainer))},[]),c=g.useCallback(x=>{u.isAtBottom=x,r(x)},[]),d=g.useCallback(x=>{u.escapedFromLock=x,n(x)},[]),u=g.useMemo(()=>{let x;return{escapedFromLock:t,isAtBottom:s,resizeDifference:0,accumulated:0,velocity:0,listeners:new Set,get scrollTop(){var w;return((w=y.current)==null?void 0:w.scrollTop)??0},set scrollTop(w){y.current&&(y.current.scrollTop=w,u.ignoreScrollToTop=y.current.scrollTop)},get targetScrollTop(){return!y.current||!b.current?0:y.current.scrollHeight-1-y.current.clientHeight},get calculatedTargetScrollTop(){if(!y.current||!b.current)return 0;const{targetScrollTop:w}=this;if(!e.targetScrollTop)return w;if((x==null?void 0:x.targetScrollTop)===w)return x.calculatedScrollTop;const E=Math.max(Math.min(e.targetScrollTop(w,{scrollElement:y.current,contentElement:b.current}),w),0);return x={targetScrollTop:w,calculatedScrollTop:E},requestAnimationFrame(()=>{x=void 0}),E},get scrollDifference(){return this.calculatedTargetScrollTop-this.scrollTop},get isNearBottom(){return this.scrollDifference<=uS}}},[]),h=g.useCallback((x={})=>{var P;typeof x=="string"&&(x={animation:x}),x.preserveScrollPosition||c(!0);const w=Date.now()+(Number(x.wait)||0),E=Nr(a.current,x.animation),{ignoreEscapes:_=!1}=x;let j,D=u.calculatedTargetScrollTop;x.duration instanceof Promise?x.duration.finally(()=>{j=Date.now()}):j=w+(x.duration??0);const R=async()=>{const M=new Promise(requestAnimationFrame).then(()=>{var T;if(!u.isAtBottom)return u.animation=void 0,!1;const{scrollTop:L}=u,$=performance.now(),U=($-(u.lastTick??$))/dS;if(u.animation||(u.animation={behavior:E,promise:M,ignoreEscapes:_}),u.animation.behavior===E&&(u.lastTick=$),l()||w>Date.now())return R();if(L<Math.min(D,u.calculatedTargetScrollTop)){if(((T=u.animation)==null?void 0:T.behavior)===E){if(E==="instant")return u.scrollTop=u.calculatedTargetScrollTop,R();u.velocity=(E.damping*u.velocity+E.stiffness*u.scrollDifference)/E.mass,u.accumulated+=u.velocity*U,u.scrollTop+=u.accumulated,u.scrollTop!==L&&(u.accumulated=0)}return R()}return j>Date.now()?(D=u.calculatedTargetScrollTop,R()):(u.animation=void 0,u.scrollTop<u.calculatedTargetScrollTop?h({animation:Nr(a.current,a.current.resize),ignoreEscapes:_,duration:Math.max(0,j-Date.now())||void 0}):u.isAtBottom)});return M.then(L=>(requestAnimationFrame(()=>{u.animation||(u.lastTick=void 0,u.velocity=0)}),L))};return x.wait!==!0&&(u.animation=void 0),((P=u.animation)==null?void 0:P.behavior)===E?u.animation.promise:R()},[c,l,u]),f=g.useCallback(()=>{d(!0),c(!1)},[d,c]),p=g.useCallback(({target:x})=>{if(x!==y.current)return;const{scrollTop:w,ignoreScrollToTop:E}=u;let{lastScrollTop:_=w}=u;u.lastScrollTop=w,u.ignoreScrollToTop=void 0,E&&E>w&&(_=E),o(u.isNearBottom),setTimeout(()=>{var R;if(u.resizeDifference||w===E)return;if(l()){d(!0),c(!1);return}const j=w>_,D=w<_;if((R=u.animation)!=null&&R.ignoreEscapes){u.scrollTop=_;return}D&&(d(!0),c(!1)),j&&d(!1),!u.escapedFromLock&&u.isNearBottom&&c(!0)},1)},[d,c,l,u]),v=g.useCallback(({target:x,deltaY:w})=>{var _;let E=x;for(;!["scroll","auto"].includes(getComputedStyle(E).overflow);){if(!E.parentElement)return;E=E.parentElement}E===y.current&&w<0&&y.current.scrollHeight>y.current.clientHeight&&!((_=u.animation)!=null&&_.ignoreEscapes)&&(d(!0),c(!1))},[d,c,u]),y=Fl(x=>{var w,E;(w=y.current)==null||w.removeEventListener("scroll",p),(E=y.current)==null||E.removeEventListener("wheel",v),x==null||x.addEventListener("scroll",p,{passive:!0}),x==null||x.addEventListener("wheel",v,{passive:!0})},[]),b=Fl(x=>{var E,_;if((E=u.resizeObserver)==null||E.disconnect(),!x)return;let w;u.resizeObserver=new ResizeObserver(([j])=>{const{height:D}=j.contentRect,R=D-(w??D);if(u.resizeDifference=R,u.scrollTop>u.targetScrollTop&&(u.scrollTop=u.targetScrollTop),o(u.isNearBottom),R>=0){const P=Nr(a.current,w?a.current.resize:a.current.initial);h({animation:P,wait:!0,preserveScrollPosition:!0,duration:P==="instant"?void 0:fS})}else u.isNearBottom&&(d(!1),c(!0));w=D,requestAnimationFrame(()=>{setTimeout(()=>{u.resizeDifference===R&&(u.resizeDifference=0)},1)})}),(_=u.resizeObserver)==null||_.observe(x)},[]);return{contentRef:b,scrollRef:y,scrollToBottom:h,stopScroll:f,isAtBottom:s||i,isNearBottom:i,escapedFromLock:t,state:u}};function Fl(e,t){const n=g.useCallback(s=>(n.current=s,e(s)),t);return n}const Cr=new Map;function Nr(...e){const t={...cS};let n=!1;for(const r of e){if(r==="instant"){n=!0;continue}typeof r=="object"&&(n=!1,t.damping=r.damping??t.damping,t.stiffness=r.stiffness??t.stiffness,t.mass=r.mass??t.mass)}const s=JSON.stringify(t);return Cr.has(s)||Cr.set(s,Object.freeze(t)),n?"instant":Cr.get(s)}const zd=g.createContext(null),mS=typeof window<"u"?g.useLayoutEffect:g.useEffect;function ai({instance:e,children:t,resize:n,initial:s,mass:r,damping:i,stiffness:o,targetScrollTop:a,contextRef:l,...c}){const d=g.useRef(null),u=g.useCallback((_,j)=>{const D=(E==null?void 0:E.targetScrollTop)??a;return(D==null?void 0:D(_,j))??_},[a]),h=hS({mass:r,damping:i,stiffness:o,resize:n,initial:s,targetScrollTop:u}),{scrollRef:f,contentRef:p,scrollToBottom:v,stopScroll:y,isAtBottom:b,escapedFromLock:x,state:w}=e??h,E=g.useMemo(()=>({scrollToBottom:v,stopScroll:y,scrollRef:f,isAtBottom:b,escapedFromLock:x,contentRef:p,state:w,get targetScrollTop(){return d.current},set targetScrollTop(_){d.current=_}}),[v,b,p,f,y,x,w]);return g.useImperativeHandle(l,()=>E,[E]),mS(()=>{f.current&&getComputedStyle(f.current).overflow==="visible"&&(f.current.style.overflow="auto")},[]),m.jsx(zd.Provider,{value:E,children:m.jsx("div",{...c,children:typeof t=="function"?t(E):t})})}(function(e){function t({children:n,...s}){const r=vo();return m.jsx("div",{ref:r.scrollRef,style:{height:"100%",width:"100%"},children:m.jsx("div",{...s,ref:r.contentRef,children:typeof n=="function"?n(r):n})})}e.Content=t})(ai||(ai={}));function vo(){const e=g.useContext(zd);if(!e)throw new Error("use-stick-to-bottom component context must be used within a StickToBottom component");return e}const gt=["image/jpeg","image/png","image/gif","image/webp","application/pdf"];function pS({initialBlocks:e=[]}={}){const[t,n]=g.useState(e),s=g.useRef(null),[r,i]=g.useState(!1),o=g.useRef(0),a=(h,f)=>h.type==="application/pdf"?f.some(p=>{var v;return p.type==="file"&&p.mime_type==="application/pdf"&&((v=p.metadata)==null?void 0:v.filename)===h.name}):gt.includes(h.type)?f.some(p=>{var v;return p.type==="image"&&((v=p.metadata)==null?void 0:v.name)===h.name&&p.mime_type===h.type}):!1,l=async h=>{const f=h.target.files;if(!f)return;const p=Array.from(f),v=p.filter(E=>gt.includes(E.type)),y=p.filter(E=>!gt.includes(E.type)),b=v.filter(E=>a(E,t)),x=v.filter(E=>!a(E,t));y.length>0&&Nt.error("You have uploaded invalid file type. Please upload a JPEG, PNG, GIF, WEBP image or a PDF."),b.length>0&&Nt.error(`Duplicate file(s) detected: ${b.map(E=>E.name).join(", ")}. Each file can only be uploaded once per message.`);const w=x.length?await Promise.all(x.map(Tr)):[];n(E=>[...E,...w]),h.target.value=""},c=h=>{n(f=>f.filter((p,v)=>v!==h))},d=()=>n([]);return g.useEffect(()=>{if(!s.current)return;const h=_=>{var j,D;(D=(j=_.dataTransfer)==null?void 0:j.types)!=null&&D.includes("Files")&&(o.current+=1,i(!0))},f=_=>{var j,D;(D=(j=_.dataTransfer)==null?void 0:j.types)!=null&&D.includes("Files")&&(o.current-=1,o.current<=0&&(i(!1),o.current=0))},p=async _=>{if(_.preventDefault(),_.stopPropagation(),o.current=0,i(!1),!_.dataTransfer)return;const j=Array.from(_.dataTransfer.files),D=j.filter($=>gt.includes($.type)),R=j.filter($=>!gt.includes($.type)),P=D.filter($=>a($,t)),M=D.filter($=>!a($,t));R.length>0&&Nt.error("You have uploaded invalid file type. Please upload a JPEG, PNG, GIF, WEBP image or a PDF."),P.length>0&&Nt.error(`Duplicate file(s) detected: ${P.map($=>$.name).join(", ")}. Each file can only be uploaded once per message.`);const L=M.length?await Promise.all(M.map(Tr)):[];n($=>[...$,...L])},v=_=>{o.current=0,i(!1)};window.addEventListener("dragenter",h),window.addEventListener("dragleave",f),window.addEventListener("drop",p),window.addEventListener("dragend",v);const y=_=>{_.preventDefault(),_.stopPropagation()};window.addEventListener("dragover",y);const b=_=>{_.preventDefault(),_.stopPropagation(),i(!0)},x=_=>{_.preventDefault(),_.stopPropagation(),i(!0)},w=_=>{_.preventDefault(),_.stopPropagation(),i(!1)},E=s.current;return E.addEventListener("dragover",b),E.addEventListener("dragenter",x),E.addEventListener("dragleave",w),()=>{E.removeEventListener("dragover",b),E.removeEventListener("dragenter",x),E.removeEventListener("dragleave",w),window.removeEventListener("dragenter",h),window.removeEventListener("dragleave",f),window.removeEventListener("drop",p),window.removeEventListener("dragend",v),window.removeEventListener("dragover",y),o.current=0}},[t]),{contentBlocks:t,setContentBlocks:n,handleFileUpload:l,dropRef:s,removeBlock:c,resetBlocks:d,dragOver:r,handlePaste:async h=>{const f=h.clipboardData.items;if(!f)return;const p=[];for(let E=0;E<f.length;E+=1){const _=f[E];if(_.kind==="file"){const j=_.getAsFile();j&&p.push(j)}}if(p.length===0)return;h.preventDefault();const v=p.filter(E=>gt.includes(E.type)),y=p.filter(E=>!gt.includes(E.type)),b=E=>E.type==="application/pdf"?t.some(_=>{var j;return _.type==="file"&&_.mime_type==="application/pdf"&&((j=_.metadata)==null?void 0:j.filename)===E.name}):gt.includes(E.type)?t.some(_=>{var j;return _.type==="image"&&((j=_.metadata)==null?void 0:j.name)===E.name&&_.mime_type===E.type}):!1,x=v.filter(b),w=v.filter(E=>!b(E));if(y.length>0&&Nt.error("You have pasted an invalid file type. Please paste a JPEG, PNG, GIF, WEBP image or a PDF."),x.length>0&&Nt.error(`Duplicate file(s) detected: ${x.map(E=>E.name).join(", ")}. Each file can only be uploaded once per message.`),w.length>0){const E=await Promise.all(w.map(Tr));n(_=>[..._,...E])}}}}const gS=({blocks:e,onRemove:t,size:n="md",className:s})=>e.length?m.jsx("div",{className:je("flex flex-wrap gap-2 p-3.5 pb-0",s),children:e.map((r,i)=>m.jsx(Hd,{block:r,removable:!0,onRemove:()=>t(i),size:n},i))}):null,Gd=g.memo(({agent:e,isSelected:t,onSelect:n})=>{const s=g.useCallback(()=>{n(e)},[e,n]);return m.jsx("div",{className:`
        flex items-center py-4 cursor-pointer 
        hover:bg-accent transition-colors 
        ${t?"bg-accent/50":""}
      `,onClick:s,children:m.jsx("div",{className:"flex items-center space-x-4 w-full",children:m.jsx("div",{className:"flex-1 min-w-0",children:m.jsxs("div",{className:"flex flex-col",children:[m.jsx("h3",{className:"font-semibold text-base truncate",children:e.name}),m.jsx("p",{className:"text-xs text-muted-foreground truncate",children:e.description||""})]})})})})});Gd.displayName="AgentSelectionCard";function vS({onSelectAgent:e,selectedAgent:t}){const{agents:n,totalCount:s,isLoadingData:r,error:i,hasNextPage:o,isFetchingNextPage:a,searchQuery:l,setSearchQuery:c,loadMoreRef:d,fetchNextPage:u}=Gh(),h=g.useCallback(v=>{c(v.target.value)},[c]),f=g.useCallback(()=>{c("")},[c]),p=g.useCallback(()=>{u()},[u]);return i?m.jsxs("div",{className:"text-center py-12",children:[m.jsx("p",{className:"text-destructive",children:""}),m.jsx(me,{onClick:p,className:"mt-4",children:""})]}):m.jsx("div",{className:"h-full",children:m.jsxs(Cc,{className:"h-full",children:[m.jsx("div",{className:"mb-6",children:m.jsxs("div",{className:"relative",children:[m.jsx(Nc,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),m.jsx(gs,{className:"pl-8 h-10 bg-transparent",placeholder:"...",value:l,onChange:h}),l&&m.jsx(me,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 p-0 opacity-70 hover:opacity-100",onClick:f,disabled:r,children:m.jsx(bt,{className:"h-4 w-4"})})]})}),r&&n.length===0?m.jsxs("div",{className:"flex justify-center items-center py-12",children:[m.jsx(vs,{className:"h-8 w-8 animate-spin"}),m.jsx("span",{className:"ml-2",children:"..."})]}):n.length===0?m.jsx("div",{className:"text-center py-12",children:m.jsx("p",{className:"text-muted-foreground",children:l?` "${l}" `:""})}):m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:n.map(v=>m.jsx(Gd,{agent:v,isSelected:(t==null?void 0:t.uuid)===v.uuid,onSelect:e||(()=>{})},v.uuid))}),m.jsx("div",{ref:d,className:"mt-8 flex justify-center",children:a?m.jsxs("div",{className:"flex items-center gap-2 py-4",children:[m.jsx(vs,{className:"h-5 w-5 animate-spin"}),m.jsx("span",{className:"text-sm text-muted-foreground",children:"..."})]}):o?m.jsx("div",{className:"py-4",children:m.jsx(me,{variant:"outline",onClick:p,className:"text-sm",children:l?"":""})}):n.length>0?m.jsx("div",{className:"py-4 text-center",children:m.jsx("span",{className:"text-sm text-muted-foreground",children:""})}):null})]})]})})}const yS=_h({title:Js().min(2,{message:"2"}).max(200,{message:"200"}),prompts:Js().min(5,{message:"5"}),remark:Js().optional(),is_active:Lo().default(!0),is_public:Lo().default(!1)});function xS({initialData:e,onSubmit:t,isSubmitting:n=!1}){const[s,r]=g.useState((e==null?void 0:e.tags)||[]),[i,o]=g.useState(""),a=Th({resolver:Ch(yS),defaultValues:{title:(e==null?void 0:e.title)||"",prompts:(e==null?void 0:e.prompts)||"",remark:(e==null?void 0:e.remark)||"",is_active:(e==null?void 0:e.is_active)!==void 0?e.is_active:!0,is_public:(e==null?void 0:e.is_public)||!1,tags:(e==null?void 0:e.tags)||[]}});g.useEffect(()=>{a.setValue("tags",s)},[s,a]);const l=()=>{const h=i.trim();h&&!s.includes(h)&&(r([...s,h]),o(""))},c=h=>{r(s.filter(f=>f!==h))},d=h=>{h.key==="Enter"&&(h.preventDefault(),l())},u=h=>{t({...h,tags:s})};return m.jsx(Nh,{...a,children:m.jsxs("form",{onSubmit:a.handleSubmit(u),className:"space-y-6",children:[m.jsx(vn,{control:a.control,name:"title",render:({field:h})=>m.jsxs(yn,{children:[m.jsx(Bt,{children:""}),m.jsx(xn,{children:m.jsx(gs,{placeholder:"",...h})}),m.jsx(Ft,{children:""}),m.jsx(Qs,{})]})}),m.jsx(vn,{control:a.control,name:"prompts",render:({field:h})=>m.jsxs(yn,{children:[m.jsx(Bt,{children:""}),m.jsx(xn,{children:m.jsx($r,{placeholder:"...",className:"min-h-[200px]",...h})}),m.jsx(Ft,{children:""}),m.jsx(Qs,{})]})}),m.jsx(vn,{control:a.control,name:"remark",render:({field:h})=>m.jsxs(yn,{children:[m.jsx(Bt,{children:""}),m.jsx(xn,{children:m.jsx($r,{placeholder:"...",className:"min-h-[100px]",...h})}),m.jsx(Ft,{children:""}),m.jsx(Qs,{})]})}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Bt,{children:""}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(gs,{placeholder:"...",value:i,onChange:h=>o(h.target.value),onKeyDown:d,className:"flex-1"}),m.jsxs(me,{type:"button",variant:"outline",onClick:l,disabled:!i.trim(),children:[m.jsx(Ac,{className:"h-4 w-4 mr-2"}),""]})]}),m.jsx(Ft,{children:""}),m.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:s.map(h=>m.jsxs(tn,{variant:"secondary",className:"px-3 py-1",children:[h,m.jsx(me,{type:"button",variant:"ghost",size:"sm",className:"h-4 w-4 p-0 ml-2",onClick:()=>c(h),children:m.jsx(bt,{className:"h-3 w-3"})})]},h))})]}),m.jsxs("div",{className:"flex flex-col gap-4",children:[m.jsx(vn,{control:a.control,name:"is_active",render:({field:h})=>m.jsxs(yn,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[m.jsxs("div",{className:"space-y-0.5",children:[m.jsx(Bt,{className:"text-base",children:""}),m.jsx(Ft,{children:""})]}),m.jsx(xn,{children:m.jsx(Lr,{checked:h.value,onCheckedChange:h.onChange})})]})}),m.jsx(vn,{control:a.control,name:"is_public",render:({field:h})=>m.jsxs(yn,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[m.jsxs("div",{className:"space-y-0.5",children:[m.jsx(Bt,{className:"text-base",children:""}),m.jsx(Ft,{children:""})]}),m.jsx(xn,{children:m.jsx(Lr,{checked:h.value,onCheckedChange:h.onChange})})]})})]}),m.jsx(me,{type:"submit",className:"w-full",disabled:n,children:n?"...":e?"":""})]})})}function wS(){const{toast:e}=Pc(),[t,n]=g.useState([]),[s,r]=g.useState(0),[i,o]=g.useState(!1),[a,l]=g.useState(null),[c,d]=g.useState(1),[u,h]=g.useState(!1),[f,p]=g.useState(!1),[v,y]=g.useState(""),b=20,x=g.useCallback(async(M,L)=>{try{o(!0),l(null);const $=await wt.post("/prompts/page",{page:M,rows:b,keyword:L||void 0});if($.data&&$.data.items!==void 0){const{items:U,pagination:T}=$.data;n(M===1?U:N=>[...N,...U]),r(T.total),h(M<T.pages)}else throw new Error("")}catch($){l($ instanceof Error?$:new Error("")),e({title:"",description:$ instanceof Error?$.message:"",variant:"destructive"})}finally{o(!1),p(!1)}},[e]);g.useEffect(()=>{d(1);const M=setTimeout(()=>{x(1,v)},300);return()=>clearTimeout(M)},[v,x]);const w=g.useCallback(()=>{if(u&&!f){p(!0);const M=c+1;d(M),x(M,v)}},[u,f,c,v,x]),E=g.useCallback(async M=>{try{const L=await wt.post("/prompts/create",M);if(L.data)return e({title:"",description:""}),x(1,v),L.data;throw new Error("")}catch(L){throw e({title:"",description:L instanceof Error?L.message:"",variant:"destructive"}),L}},[e,x,v]),_=g.useCallback(async(M,L)=>{try{const $=await wt.post(`/prompts/update/${M}`,L);if($.data)return e({title:"",description:""}),x(1,v),$.data;throw new Error("")}catch($){throw e({title:"",description:$ instanceof Error?$.message:"",variant:"destructive"}),$}},[e,x,v]),j=g.useCallback(async M=>{try{const L=await wt.post(`/prompts/delete/${M}`);if(console.log("response.data",L),L.status===200)return e({title:"",description:""}),x(1,v),!0;throw new Error("")}catch(L){throw e({title:"",description:L instanceof Error?L.message:"",variant:"destructive"}),L}},[e,x,v]),D=g.useCallback(async M=>{try{const L=await wt.post(`/prompts/detail/${M}`);if(L.data)return L.data;throw new Error("")}catch(L){throw e({title:"",description:L instanceof Error?L.message:"",variant:"destructive"}),L}},[e]),R=g.useRef(null),{loadMoreRef:P}=Kh({hasNextPage:u,isFetchingNextPage:f,fetchNextPage:w});return g.useEffect(()=>{R.current&&P.current&&(R.current=P.current)},[P]),{prompts:t,totalCount:s,isLoadingData:i,error:a,hasNextPage:u,isFetchingNextPage:f,searchQuery:v,setSearchQuery:y,loadMoreRef:R,fetchNextPage:w,createPrompt:E,updatePrompt:_,deletePrompt:j,getPromptDetail:D}}const Wd=g.memo(({prompt:e,isSelected:t,onSelect:n,onEdit:s,onDelete:r})=>{const i=g.useCallback(()=>{n(e)},[e,n]),o=a=>new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return m.jsx("div",{className:`
        group flex items-center py-4 cursor-pointer 
        hover:bg-accent transition-colors 
        ${t?"bg-accent/50":""}
      `,onClick:i,children:m.jsxs("div",{className:"flex items-center space-x-4 w-full",children:[m.jsx("div",{className:"flex-1 min-w-0",children:m.jsxs("div",{className:"flex flex-col",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("h3",{className:"font-semibold text-base truncate",children:e.title}),e.is_active&&m.jsx(tn,{variant:"outline",className:"bg-green-50 text-green-700 dark:bg-green-900/30 dark:text-green-400",children:""}),e.is_public&&m.jsx(tn,{variant:"outline",className:"bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",children:""})]}),m.jsx("p",{className:"text-xs text-muted-foreground truncate",children:e.prompts||""}),e.tags&&e.tags.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:e.tags.map((a,l)=>m.jsxs(tn,{variant:"secondary",className:"text-xs px-2 py-0",children:[m.jsx(Xh,{className:"h-3 w-3 mr-1"}),a]},l))}),m.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[": ",o(e.updated_at)]})]})}),m.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[m.jsx(me,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:a=>{a.stopPropagation(),s(e)},children:m.jsx(Ic,{className:"h-4 w-4"})}),m.jsx(me,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-destructive hover:text-destructive",onClick:a=>{a.stopPropagation(),r(e)},children:m.jsx(Ah,{className:"h-4 w-4"})})]})]})})});Wd.displayName="PromptCard";function bS({onSelectPrompt:e,selectedPrompt:t}){const{prompts:n,totalCount:s,isLoadingData:r,error:i,hasNextPage:o,isFetchingNextPage:a,searchQuery:l,setSearchQuery:c,loadMoreRef:d,fetchNextPage:u,createPrompt:h,updatePrompt:f,deletePrompt:p}=wS(),[v,y]=g.useState(!1),[b,x]=g.useState(!1),[w,E]=g.useState(null),_=g.useCallback($=>{c($.target.value)},[c]),j=g.useCallback(()=>{c("")},[c]),D=g.useCallback(()=>{u()},[u]),R=g.useCallback(()=>{E(null),y(!0)},[]),P=g.useCallback($=>{E($),y(!0)},[]),M=g.useCallback(async $=>{if(confirm(` "${$.title}" `))try{await p($.uuid)}catch(U){console.error(":",U)}},[p]),L=g.useCallback(async $=>{try{x(!0),w?await f(w.uuid,$):await h($),y(!1),E(null)}catch(U){console.error(w?":":":",U)}finally{x(!1)}},[h,f,w]);return i?m.jsxs("div",{className:"text-center py-12",children:[m.jsx("p",{className:"text-destructive",children:""}),m.jsx(me,{onClick:D,className:"mt-4",children:""})]}):m.jsxs("div",{className:"h-full",children:[m.jsxs(Cc,{className:"h-full",children:[m.jsx("div",{className:"mb-6",children:m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("div",{className:"relative flex-1",children:[m.jsx(Nc,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),m.jsx(gs,{className:"pl-8 h-10 bg-transparent",placeholder:"...",value:l,onChange:_}),l&&m.jsx(me,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 p-0 opacity-70 hover:opacity-100",onClick:j,disabled:r,children:m.jsx(bt,{className:"h-4 w-4"})})]}),m.jsxs(me,{onClick:R,size:"sm",className:"h-10 px-3",children:[m.jsx(Ac,{className:"h-4 w-4 mr-1"}),""]})]})}),r&&n.length===0?m.jsxs("div",{className:"flex justify-center items-center py-12",children:[m.jsx(vs,{className:"h-8 w-8 animate-spin"}),m.jsx("span",{className:"ml-2",children:"..."})]}):n.length===0?m.jsx("div",{className:"text-center py-12",children:m.jsx("p",{className:"text-muted-foreground",children:l?` "${l}" `:""})}):m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:n.map($=>m.jsx(Wd,{prompt:$,isSelected:(t==null?void 0:t.uuid)===$.uuid,onSelect:e||(()=>{}),onEdit:P,onDelete:M},$.uuid))}),m.jsx("div",{ref:d,className:"mt-8 flex justify-center",children:a?m.jsxs("div",{className:"flex items-center gap-2 py-4",children:[m.jsx(vs,{className:"h-5 w-5 animate-spin"}),m.jsx("span",{className:"text-sm text-muted-foreground",children:"..."})]}):o?m.jsx("div",{className:"py-4",children:m.jsx(me,{variant:"outline",onClick:D,className:"text-sm",children:l?"":""})}):n.length>0?m.jsx("div",{className:"py-4 text-center",children:m.jsx("span",{className:"text-sm text-muted-foreground",children:""})}):null})]})]}),m.jsx(ys,{open:v,onOpenChange:$=>{y($),$||E(null)},children:m.jsxs(xs,{className:"sm:max-w-[600px] max-h-[80vh] flex flex-col",children:[m.jsx(ws,{children:m.jsx(bs,{children:w?"":""})}),m.jsx("div",{className:"flex-1 overflow-y-auto pr-4",children:m.jsx(xS,{initialData:w||void 0,onSubmit:L,isSubmitting:b})})]})})]})}const Ks=g.createContext(null),ES=Ks.Provider,pt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Kd=pt.error001();function ge(e,t){const n=g.useContext(Ks);if(n===null)throw new Error(Kd);return Yh(n,e,t)}const Ce=()=>{const e=g.useContext(Ks);if(e===null)throw new Error(Kd);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},SS=e=>e.userSelectionActive?"none":"all";function yo({position:e,children:t,className:n,style:s,...r}){const i=ge(SS),o=`${e}`.split("-");return C.createElement("div",{className:Oe(["react-flow__panel",n,...o]),style:{...s,pointerEvents:i},...r},t)}function _S({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:C.createElement(yo,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},C.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const TS=({x:e,y:t,label:n,labelStyle:s={},labelShowBg:r=!0,labelBgStyle:i={},labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d})=>{const u=g.useRef(null),[h,f]=g.useState({x:0,y:0,width:0,height:0}),p=Oe(["react-flow__edge-textwrapper",c]);return g.useEffect(()=>{if(u.current){const v=u.current.getBBox();f({x:v.x,y:v.y,width:v.width,height:v.height})}},[n]),typeof n>"u"||!n?null:C.createElement("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:p,visibility:h.width?"visible":"hidden",...d},r&&C.createElement("rect",{width:h.width+2*o[0],x:-o[0],y:-o[1],height:h.height+2*o[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),C.createElement("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:u,style:s},n),l)};var CS=g.memo(TS);const xo=e=>({width:e.offsetWidth,height:e.offsetHeight}),dn=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),wo=(e={x:0,y:0},t)=>({x:dn(e.x,t[0][0],t[1][0]),y:dn(e.y,t[0][1],t[1][1])}),Hl=(e,t,n)=>e<t?dn(Math.abs(e-t),1,50)/50:e>n?-dn(Math.abs(e-n),1,50)/50:0,Xd=(e,t)=>{const n=Hl(e.x,35,t.width-35)*20,s=Hl(e.y,35,t.height-35)*20;return[n,s]},Yd=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},NS=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),bo=({x:e,y:t,width:n,height:s})=>({x:e,y:t,x2:e+n,y2:t+s}),AS=({x:e,y:t,x2:n,y2:s})=>({x:e,y:t,width:n-e,height:s-t}),Ul=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),li=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),s=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*s)},PS=e=>Ye(e.width)&&Ye(e.height)&&Ye(e.x)&&Ye(e.y),Ye=e=>!isNaN(e)&&isFinite(e),xe=Symbol.for("internals"),Zd=["Enter"," ","Escape"],jS=(e,t)=>{},RS=e=>"nativeEvent"in e;function ci(e){var r,i;const t=RS(e)?e.nativeEvent:e,n=((i=(r=t.composedPath)==null?void 0:r.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const Jd=e=>"clientX"in e,Et=(e,t)=>{var i,o;const n=Jd(e),s=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,r=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:s-((t==null?void 0:t.left)??0),y:r-((t==null?void 0:t.top)??0)}},Ps=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Zn=({id:e,path:t,labelX:n,labelY:s,label:r,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:u,markerStart:h,interactionWidth:f=20})=>C.createElement(C.Fragment,null,C.createElement("path",{id:e,style:d,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:u,markerStart:h}),f&&C.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),r&&Ye(n)&&Ye(s)?C.createElement(CS,{x:n,y:s,label:r,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c}):null);Zn.displayName="BaseEdge";function En(e,t,n){return n===void 0?n:s=>{const r=t().edges.find(i=>i.id===e);r&&n(s,{...r})}}function Qd({sourceX:e,sourceY:t,targetX:n,targetY:s}){const r=Math.abs(n-e)/2,i=n<e?n+r:n-r,o=Math.abs(s-t)/2,a=s<t?s+o:s-o;return[i,a,r,o]}function qd({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:r,sourceControlY:i,targetControlX:o,targetControlY:a}){const l=e*.125+r*.375+o*.375+n*.125,c=t*.125+i*.375+a*.375+s*.125,d=Math.abs(l-e),u=Math.abs(c-t);return[l,c,d,u]}var $t;(function(e){e.Strict="strict",e.Loose="loose"})($t||($t={}));var It;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(It||(It={}));var fn;(function(e){e.Partial="partial",e.Full="full"})(fn||(fn={}));var dt;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(dt||(dt={}));var js;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(js||(js={}));var J;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(J||(J={}));function zl({pos:e,x1:t,y1:n,x2:s,y2:r}){return e===J.Left||e===J.Right?[.5*(t+s),n]:[t,.5*(n+r)]}function ef({sourceX:e,sourceY:t,sourcePosition:n=J.Bottom,targetX:s,targetY:r,targetPosition:i=J.Top}){const[o,a]=zl({pos:n,x1:e,y1:t,x2:s,y2:r}),[l,c]=zl({pos:i,x1:s,y1:r,x2:e,y2:t}),[d,u,h,f]=qd({sourceX:e,sourceY:t,targetX:s,targetY:r,sourceControlX:o,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${e},${t} C${o},${a} ${l},${c} ${s},${r}`,d,u,h,f]}const Eo=g.memo(({sourceX:e,sourceY:t,targetX:n,targetY:s,sourcePosition:r=J.Bottom,targetPosition:i=J.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:p,interactionWidth:v})=>{const[y,b,x]=ef({sourceX:e,sourceY:t,sourcePosition:r,targetX:n,targetY:s,targetPosition:i});return C.createElement(Zn,{path:y,labelX:b,labelY:x,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:p,interactionWidth:v})});Eo.displayName="SimpleBezierEdge";const Gl={[J.Left]:{x:-1,y:0},[J.Right]:{x:1,y:0},[J.Top]:{x:0,y:-1},[J.Bottom]:{x:0,y:1}},kS=({source:e,sourcePosition:t=J.Bottom,target:n})=>t===J.Left||t===J.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Wl=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function IS({source:e,sourcePosition:t=J.Bottom,target:n,targetPosition:s=J.Top,center:r,offset:i}){const o=Gl[t],a=Gl[s],l={x:e.x+o.x*i,y:e.y+o.y*i},c={x:n.x+a.x*i,y:n.y+a.y*i},d=kS({source:l,sourcePosition:t,target:c}),u=d.x!==0?"x":"y",h=d[u];let f=[],p,v;const y={x:0,y:0},b={x:0,y:0},[x,w,E,_]=Qd({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[u]*a[u]===-1){p=r.x??x,v=r.y??w;const D=[{x:p,y:l.y},{x:p,y:c.y}],R=[{x:l.x,y:v},{x:c.x,y:v}];o[u]===h?f=u==="x"?D:R:f=u==="x"?R:D}else{const D=[{x:l.x,y:c.y}],R=[{x:c.x,y:l.y}];if(u==="x"?f=o.x===h?R:D:f=o.y===h?D:R,t===s){const U=Math.abs(e[u]-n[u]);if(U<=i){const T=Math.min(i-1,i-U);o[u]===h?y[u]=(l[u]>e[u]?-1:1)*T:b[u]=(c[u]>n[u]?-1:1)*T}}if(t!==s){const U=u==="x"?"y":"x",T=o[u]===a[U],N=l[U]>c[U],B=l[U]<c[U];(o[u]===1&&(!T&&N||T&&B)||o[u]!==1&&(!T&&B||T&&N))&&(f=u==="x"?D:R)}const P={x:l.x+y.x,y:l.y+y.y},M={x:c.x+b.x,y:c.y+b.y},L=Math.max(Math.abs(P.x-f[0].x),Math.abs(M.x-f[0].x)),$=Math.max(Math.abs(P.y-f[0].y),Math.abs(M.y-f[0].y));L>=$?(p=(P.x+M.x)/2,v=f[0].y):(p=f[0].x,v=(P.y+M.y)/2)}return[[e,{x:l.x+y.x,y:l.y+y.y},...f,{x:c.x+b.x,y:c.y+b.y},n],p,v,E,_]}function MS(e,t,n,s){const r=Math.min(Wl(e,t)/2,Wl(t,n)/2,s),{x:i,y:o}=t;if(e.x===i&&i===n.x||e.y===o&&o===n.y)return`L${i} ${o}`;if(e.y===o){const c=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${i+r*c},${o}Q ${i},${o} ${i},${o+r*d}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${o+r*l}Q ${i},${o} ${i+r*a},${o}`}function ui({sourceX:e,sourceY:t,sourcePosition:n=J.Bottom,targetX:s,targetY:r,targetPosition:i=J.Top,borderRadius:o=5,centerX:a,centerY:l,offset:c=20}){const[d,u,h,f,p]=IS({source:{x:e,y:t},sourcePosition:n,target:{x:s,y:r},targetPosition:i,center:{x:a,y:l},offset:c});return[d.reduce((y,b,x)=>{let w="";return x>0&&x<d.length-1?w=MS(d[x-1],b,d[x+1],o):w=`${x===0?"M":"L"}${b.x} ${b.y}`,y+=w,y},""),u,h,f,p]}const Xs=g.memo(({sourceX:e,sourceY:t,targetX:n,targetY:s,label:r,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,sourcePosition:u=J.Bottom,targetPosition:h=J.Top,markerEnd:f,markerStart:p,pathOptions:v,interactionWidth:y})=>{const[b,x,w]=ui({sourceX:e,sourceY:t,sourcePosition:u,targetX:n,targetY:s,targetPosition:h,borderRadius:v==null?void 0:v.borderRadius,offset:v==null?void 0:v.offset});return C.createElement(Zn,{path:b,labelX:x,labelY:w,label:r,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:f,markerStart:p,interactionWidth:y})});Xs.displayName="SmoothStepEdge";const So=g.memo(e=>{var t;return C.createElement(Xs,{...e,pathOptions:g.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});So.displayName="StepEdge";function $S({sourceX:e,sourceY:t,targetX:n,targetY:s}){const[r,i,o,a]=Qd({sourceX:e,sourceY:t,targetX:n,targetY:s});return[`M ${e},${t}L ${n},${s}`,r,i,o,a]}const _o=g.memo(({sourceX:e,sourceY:t,targetX:n,targetY:s,label:r,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:u,markerStart:h,interactionWidth:f})=>{const[p,v,y]=$S({sourceX:e,sourceY:t,targetX:n,targetY:s});return C.createElement(Zn,{path:p,labelX:v,labelY:y,label:r,labelStyle:i,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:u,markerStart:h,interactionWidth:f})});_o.displayName="StraightEdge";function ls(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Kl({pos:e,x1:t,y1:n,x2:s,y2:r,c:i}){switch(e){case J.Left:return[t-ls(t-s,i),n];case J.Right:return[t+ls(s-t,i),n];case J.Top:return[t,n-ls(n-r,i)];case J.Bottom:return[t,n+ls(r-n,i)]}}function To({sourceX:e,sourceY:t,sourcePosition:n=J.Bottom,targetX:s,targetY:r,targetPosition:i=J.Top,curvature:o=.25}){const[a,l]=Kl({pos:n,x1:e,y1:t,x2:s,y2:r,c:o}),[c,d]=Kl({pos:i,x1:s,y1:r,x2:e,y2:t,c:o}),[u,h,f,p]=qd({sourceX:e,sourceY:t,targetX:s,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${s},${r}`,u,h,f,p]}const Rs=g.memo(({sourceX:e,sourceY:t,targetX:n,targetY:s,sourcePosition:r=J.Bottom,targetPosition:i=J.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:p,pathOptions:v,interactionWidth:y})=>{const[b,x,w]=To({sourceX:e,sourceY:t,sourcePosition:r,targetX:n,targetY:s,targetPosition:i,curvature:v==null?void 0:v.curvature});return C.createElement(Zn,{path:b,labelX:x,labelY:w,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:p,interactionWidth:y})});Rs.displayName="BezierEdge";const Co=g.createContext(null),LS=Co.Provider;Co.Consumer;const DS=()=>g.useContext(Co),VS=e=>"id"in e&&"source"in e&&"target"in e,OS=({source:e,sourceHandle:t,target:n,targetHandle:s})=>`reactflow__edge-${e}${t||""}-${n}${s||""}`,di=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(s=>`${s}=${e[s]}`).join("&")}`,BS=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),tf=(e,t)=>{if(!e.source||!e.target)return t;let n;return VS(e)?n={...e}:n={...e,id:OS(e)},BS(n,t)?t:t.concat(n)},fi=({x:e,y:t},[n,s,r],i,[o,a])=>{const l={x:(e-n)/r,y:(t-s)/r};return i?{x:o*Math.round(l.x/o),y:a*Math.round(l.y/a)}:l},nf=({x:e,y:t},[n,s,r])=>({x:e*r+n,y:t*r+s}),sn=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],s=(e.height??0)*t[1],r={x:e.position.x-n,y:e.position.y-s};return{...r,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-s}:r}},No=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((s,r)=>{const{x:i,y:o}=sn(r,t).positionAbsolute;return NS(s,bo({x:i,y:o,width:r.width||0,height:r.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return AS(n)},sf=(e,t,[n,s,r]=[0,0,1],i=!1,o=!1,a=[0,0])=>{const l={x:(t.x-n)/r,y:(t.y-s)/r,width:t.width/r,height:t.height/r},c=[];return e.forEach(d=>{const{width:u,height:h,selectable:f=!0,hidden:p=!1}=d;if(o&&!f||p)return!1;const{positionAbsolute:v}=sn(d,a),y={x:v.x,y:v.y,width:u||0,height:h||0},b=li(l,y),x=typeof u>"u"||typeof h>"u"||u===null||h===null,w=i&&b>0,E=(u||0)*(h||0);(x||w||b>=E||d.dragging)&&c.push(d)}),c},rf=(e,t)=>{const n=e.map(s=>s.id);return t.filter(s=>n.includes(s.source)||n.includes(s.target))},of=(e,t,n,s,r,i=.1)=>{const o=t/(e.width*(1+i)),a=n/(e.height*(1+i)),l=Math.min(o,a),c=dn(l,s,r),d=e.x+e.width/2,u=e.y+e.height/2,h=t/2-d*c,f=n/2-u*c;return{x:h,y:f,zoom:c}},jt=(e,t=0)=>e.transition().duration(t);function Xl(e,t,n,s){return(t[n]||[]).reduce((r,i)=>{var o,a;return`${e.id}-${i.id}-${n}`!==s&&r.push({id:i.id||null,type:n,nodeId:e.id,x:(((o=e.positionAbsolute)==null?void 0:o.x)??0)+i.x+i.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+i.y+i.height/2}),r},[])}function FS(e,t,n,s,r,i){const{x:o,y:a}=Et(e),c=t.elementsFromPoint(o,a).find(p=>p.classList.contains("react-flow__handle"));if(c){const p=c.getAttribute("data-nodeid");if(p){const v=Ao(void 0,c),y=c.getAttribute("data-handleid"),b=i({nodeId:p,id:y,type:v});if(b){const x=r.find(w=>w.nodeId===p&&w.type===v&&w.id===y);return{handle:{id:y,type:v,nodeId:p,x:(x==null?void 0:x.x)||n.x,y:(x==null?void 0:x.y)||n.y},validHandleResult:b}}}}let d=[],u=1/0;if(r.forEach(p=>{const v=Math.sqrt((p.x-n.x)**2+(p.y-n.y)**2);if(v<=s){const y=i(p);v<=u&&(v<u?d=[{handle:p,validHandleResult:y}]:v===u&&d.push({handle:p,validHandleResult:y}),u=v)}}),!d.length)return{handle:null,validHandleResult:af()};if(d.length===1)return d[0];const h=d.some(({validHandleResult:p})=>p.isValid),f=d.some(({handle:p})=>p.type==="target");return d.find(({handle:p,validHandleResult:v})=>f?p.type==="target":h?v.isValid:!0)||d[0]}const HS={source:null,target:null,sourceHandle:null,targetHandle:null},af=()=>({handleDomNode:null,isValid:!1,connection:HS,endHandle:null});function lf(e,t,n,s,r,i,o){const a=r==="target",l=o.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),c={...af(),handleDomNode:l};if(l){const d=Ao(void 0,l),u=l.getAttribute("data-nodeid"),h=l.getAttribute("data-handleid"),f=l.classList.contains("connectable"),p=l.classList.contains("connectableend"),v={source:a?u:n,sourceHandle:a?h:s,target:a?n:u,targetHandle:a?s:h};c.connection=v,f&&p&&(t===$t.Strict?a&&d==="source"||!a&&d==="target":u!==n||h!==s)&&(c.endHandle={nodeId:u,handleId:h,type:d},c.isValid=i(v))}return c}function US({nodes:e,nodeId:t,handleId:n,handleType:s}){return e.reduce((r,i)=>{if(i[xe]){const{handleBounds:o}=i[xe];let a=[],l=[];o&&(a=Xl(i,o,"source",`${t}-${n}-${s}`),l=Xl(i,o,"target",`${t}-${n}-${s}`)),r.push(...a,...l)}return r},[])}function Ao(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Ar(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function zS(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function cf({event:e,handleId:t,nodeId:n,onConnect:s,isTarget:r,getState:i,setState:o,isValidConnection:a,edgeUpdaterType:l,onReconnectEnd:c}){const d=Yd(e.target),{connectionMode:u,domNode:h,autoPanOnConnect:f,connectionRadius:p,onConnectStart:v,panBy:y,getNodes:b,cancelConnection:x}=i();let w=0,E;const{x:_,y:j}=Et(e),D=d==null?void 0:d.elementFromPoint(_,j),R=Ao(l,D),P=h==null?void 0:h.getBoundingClientRect();if(!P||!R)return;let M,L=Et(e,P),$=!1,U=null,T=!1,N=null;const B=US({nodes:b(),nodeId:n,handleId:t,handleType:R}),I=()=>{if(!f)return;const[O,z]=Xd(L,P);y({x:O,y:z}),w=requestAnimationFrame(I)};o({connectionPosition:L,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:R,connectionStartHandle:{nodeId:n,handleId:t,type:R},connectionEndHandle:null}),v==null||v(e,{nodeId:n,handleId:t,handleType:R});function F(O){const{transform:z}=i();L=Et(O,P);const{handle:k,validHandleResult:H}=FS(O,d,fi(L,z,!1,[1,1]),p,B,V=>lf(V,u,n,t,r?"target":"source",a,d));if(E=k,$||(I(),$=!0),N=H.handleDomNode,U=H.connection,T=H.isValid,o({connectionPosition:E&&T?nf({x:E.x,y:E.y},z):L,connectionStatus:zS(!!E,T),connectionEndHandle:H.endHandle}),!E&&!T&&!N)return Ar(M);U.source!==U.target&&N&&(Ar(M),M=N,N.classList.add("connecting","react-flow__handle-connecting"),N.classList.toggle("valid",T),N.classList.toggle("react-flow__handle-valid",T))}function S(O){var z,k;(E||N)&&U&&T&&(s==null||s(U)),(k=(z=i()).onConnectEnd)==null||k.call(z,O),l&&(c==null||c(O)),Ar(M),x(),cancelAnimationFrame(w),$=!1,T=!1,U=null,N=null,d.removeEventListener("mousemove",F),d.removeEventListener("mouseup",S),d.removeEventListener("touchmove",F),d.removeEventListener("touchend",S)}d.addEventListener("mousemove",F),d.addEventListener("mouseup",S),d.addEventListener("touchmove",F),d.addEventListener("touchend",S)}const Yl=()=>!0,GS=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),WS=(e,t,n)=>s=>{const{connectionStartHandle:r,connectionEndHandle:i,connectionClickStartHandle:o}=s;return{connecting:(r==null?void 0:r.nodeId)===e&&(r==null?void 0:r.handleId)===t&&(r==null?void 0:r.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n}},uf=g.forwardRef(({type:e="source",position:t=J.Top,isValidConnection:n,isConnectable:s=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:o,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:u,...h},f)=>{var P,M;const p=o||null,v=e==="target",y=Ce(),b=DS(),{connectOnClick:x,noPanClassName:w}=ge(GS,Ie),{connecting:E,clickConnecting:_}=ge(WS(b,p,e),Ie);b||(M=(P=y.getState()).onError)==null||M.call(P,"010",pt.error010());const j=L=>{const{defaultEdgeOptions:$,onConnect:U,hasDefaultEdges:T}=y.getState(),N={...$,...L};if(T){const{edges:B,setEdges:I}=y.getState();I(tf(N,B))}U==null||U(N),a==null||a(N)},D=L=>{if(!b)return;const $=Jd(L);r&&($&&L.button===0||!$)&&cf({event:L,handleId:p,nodeId:b,onConnect:j,isTarget:v,getState:y.getState,setState:y.setState,isValidConnection:n||y.getState().isValidConnection||Yl}),$?d==null||d(L):u==null||u(L)},R=L=>{const{onClickConnectStart:$,onClickConnectEnd:U,connectionClickStartHandle:T,connectionMode:N,isValidConnection:B}=y.getState();if(!b||!T&&!r)return;if(!T){$==null||$(L,{nodeId:b,handleId:p,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:b,type:e,handleId:p}});return}const I=Yd(L.target),F=n||B||Yl,{connection:S,isValid:O}=lf({nodeId:b,id:p,type:e},N,T.nodeId,T.handleId||null,T.type,F,I);O&&j(S),U==null||U(L),y.setState({connectionClickStartHandle:null})};return C.createElement("div",{"data-handleid":p,"data-nodeid":b,"data-handlepos":t,"data-id":`${b}-${p}-${e}`,className:Oe(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",w,c,{source:!v,target:v,connectable:s,connectablestart:r,connectableend:i,connecting:_,connectionindicator:s&&(r&&!E||i&&E)}]),onMouseDown:D,onTouchStart:D,onClick:x?R:void 0,ref:f,...h},l)});uf.displayName="Handle";var hn=g.memo(uf);const df=({data:e,isConnectable:t,targetPosition:n=J.Top,sourcePosition:s=J.Bottom})=>C.createElement(C.Fragment,null,C.createElement(hn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,C.createElement(hn,{type:"source",position:s,isConnectable:t}));df.displayName="DefaultNode";var hi=g.memo(df);const ff=({data:e,isConnectable:t,sourcePosition:n=J.Bottom})=>C.createElement(C.Fragment,null,e==null?void 0:e.label,C.createElement(hn,{type:"source",position:n,isConnectable:t}));ff.displayName="InputNode";var hf=g.memo(ff);const mf=({data:e,isConnectable:t,targetPosition:n=J.Top})=>C.createElement(C.Fragment,null,C.createElement(hn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);mf.displayName="OutputNode";var pf=g.memo(mf);const Po=()=>null;Po.displayName="GroupNode";const KS=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),cs=e=>e.id;function XS(e,t){return Ie(e.selectedNodes.map(cs),t.selectedNodes.map(cs))&&Ie(e.selectedEdges.map(cs),t.selectedEdges.map(cs))}const gf=g.memo(({onSelectionChange:e})=>{const t=Ce(),{selectedNodes:n,selectedEdges:s}=ge(KS,XS);return g.useEffect(()=>{const r={nodes:n,edges:s};e==null||e(r),t.getState().onSelectionChange.forEach(i=>i(r))},[n,s,e]),null});gf.displayName="SelectionListener";const YS=e=>!!e.onSelectionChange;function ZS({onSelectionChange:e}){const t=ge(YS);return e||t?C.createElement(gf,{onSelectionChange:e}):null}const JS=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Ut(e,t){g.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function ne(e,t,n){g.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const QS=({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,onConnect:r,onConnectStart:i,onConnectEnd:o,onClickConnectStart:a,onClickConnectEnd:l,nodesDraggable:c,nodesConnectable:d,nodesFocusable:u,edgesFocusable:h,edgesUpdatable:f,elevateNodesOnSelect:p,minZoom:v,maxZoom:y,nodeExtent:b,onNodesChange:x,onEdgesChange:w,elementsSelectable:E,connectionMode:_,snapGrid:j,snapToGrid:D,translateExtent:R,connectOnClick:P,defaultEdgeOptions:M,fitView:L,fitViewOptions:$,onNodesDelete:U,onEdgesDelete:T,onNodeDrag:N,onNodeDragStart:B,onNodeDragStop:I,onSelectionDrag:F,onSelectionDragStart:S,onSelectionDragStop:O,noPanClassName:z,nodeOrigin:k,rfId:H,autoPanOnConnect:V,autoPanOnNodeDrag:A,onError:G,connectionRadius:K,isValidConnection:Y,nodeDragThreshold:Q})=>{const{setNodes:X,setEdges:ae,setDefaultNodesAndEdges:de,setMinZoom:he,setMaxZoom:ce,setTranslateExtent:ie,setNodeExtent:ve,reset:re}=ge(JS,Ie),Z=Ce();return g.useEffect(()=>{const we=s==null?void 0:s.map(Ne=>({...Ne,...M}));return de(n,we),()=>{re()}},[]),ne("defaultEdgeOptions",M,Z.setState),ne("connectionMode",_,Z.setState),ne("onConnect",r,Z.setState),ne("onConnectStart",i,Z.setState),ne("onConnectEnd",o,Z.setState),ne("onClickConnectStart",a,Z.setState),ne("onClickConnectEnd",l,Z.setState),ne("nodesDraggable",c,Z.setState),ne("nodesConnectable",d,Z.setState),ne("nodesFocusable",u,Z.setState),ne("edgesFocusable",h,Z.setState),ne("edgesUpdatable",f,Z.setState),ne("elementsSelectable",E,Z.setState),ne("elevateNodesOnSelect",p,Z.setState),ne("snapToGrid",D,Z.setState),ne("snapGrid",j,Z.setState),ne("onNodesChange",x,Z.setState),ne("onEdgesChange",w,Z.setState),ne("connectOnClick",P,Z.setState),ne("fitViewOnInit",L,Z.setState),ne("fitViewOnInitOptions",$,Z.setState),ne("onNodesDelete",U,Z.setState),ne("onEdgesDelete",T,Z.setState),ne("onNodeDrag",N,Z.setState),ne("onNodeDragStart",B,Z.setState),ne("onNodeDragStop",I,Z.setState),ne("onSelectionDrag",F,Z.setState),ne("onSelectionDragStart",S,Z.setState),ne("onSelectionDragStop",O,Z.setState),ne("noPanClassName",z,Z.setState),ne("nodeOrigin",k,Z.setState),ne("rfId",H,Z.setState),ne("autoPanOnConnect",V,Z.setState),ne("autoPanOnNodeDrag",A,Z.setState),ne("onError",G,Z.setState),ne("connectionRadius",K,Z.setState),ne("isValidConnection",Y,Z.setState),ne("nodeDragThreshold",Q,Z.setState),Ut(e,X),Ut(t,ae),Ut(v,he),Ut(y,ce),Ut(R,ie),Ut(b,ve),null},Zl={display:"none"},qS={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},vf="react-flow__node-desc",yf="react-flow__edge-desc",e1="react-flow__aria-live",t1=e=>e.ariaLiveMessage;function n1({rfId:e}){const t=ge(t1);return C.createElement("div",{id:`${e1}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:qS},t)}function s1({rfId:e,disableKeyboardA11y:t}){return C.createElement(C.Fragment,null,C.createElement("div",{id:`${vf}-${e}`,style:Zl},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),C.createElement("div",{id:`${yf}-${e}`,style:Zl},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&C.createElement(n1,{rfId:e}))}var Bn=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,s]=g.useState(!1),r=g.useRef(!1),i=g.useRef(new Set([])),[o,a]=g.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.split("+")),d=c.reduce((u,h)=>u.concat(...h),[]);return[c,d]}return[[],[]]},[e]);return g.useEffect(()=>{const l=typeof document<"u"?document:null,c=(t==null?void 0:t.target)||l;if(e!==null){const d=f=>{if(r.current=f.ctrlKey||f.metaKey||f.shiftKey,(!r.current||r.current&&!t.actInsideInputWithModifier)&&ci(f))return!1;const v=Ql(f.code,a);i.current.add(f[v]),Jl(o,i.current,!1)&&(f.preventDefault(),s(!0))},u=f=>{if((!r.current||r.current&&!t.actInsideInputWithModifier)&&ci(f))return!1;const v=Ql(f.code,a);Jl(o,i.current,!0)?(s(!1),i.current.clear()):i.current.delete(f[v]),f.key==="Meta"&&i.current.clear(),r.current=!1},h=()=>{i.current.clear(),s(!1)};return c==null||c.addEventListener("keydown",d),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",h),()=>{c==null||c.removeEventListener("keydown",d),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",h)}}},[e,s]),n};function Jl(e,t,n){return e.filter(s=>n||s.length===t.size).some(s=>s.every(r=>t.has(r)))}function Ql(e,t){return t.includes(e)?"code":"key"}function xf(e,t,n,s){var a,l;const r=e.parentNode||e.parentId;if(!r)return n;const i=t.get(r),o=sn(i,s);return xf(i,t,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(((a=i[xe])==null?void 0:a.z)??0)>(n.z??0)?((l=i[xe])==null?void 0:l.z)??0:n.z??0},s)}function wf(e,t,n){e.forEach(s=>{var i;const r=s.parentNode||s.parentId;if(r&&!e.has(r))throw new Error(`Parent node ${r} not found`);if(r||n!=null&&n[s.id]){const{x:o,y:a,z:l}=xf(s,e,{...s.position,z:((i=s[xe])==null?void 0:i.z)??0},t);s.positionAbsolute={x:o,y:a},s[xe].z=l,n!=null&&n[s.id]&&(s[xe].isParent=!0)}})}function Pr(e,t,n,s){const r=new Map,i={},o=s?1e3:0;return e.forEach(a=>{var f;const l=(Ye(a.zIndex)?a.zIndex:0)+(a.selected?o:0),c=t.get(a.id),d={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},u=a.parentNode||a.parentId;u&&(i[u]=!0);const h=(c==null?void 0:c.type)&&(c==null?void 0:c.type)!==a.type;Object.defineProperty(d,xe,{enumerable:!1,value:{handleBounds:h||(f=c==null?void 0:c[xe])==null?void 0:f.handleBounds,z:l}}),r.set(a.id,d)}),wf(r,n,i),r}function bf(e,t={}){const{getNodes:n,width:s,height:r,minZoom:i,maxZoom:o,d3Zoom:a,d3Selection:l,fitViewOnInitDone:c,fitViewOnInit:d,nodeOrigin:u}=e(),h=t.initial&&!c&&d;if(a&&l&&(h||!t.initial)){const p=n().filter(y=>{var x;const b=t.includeHiddenNodes?y.width&&y.height:!y.hidden;return(x=t.nodes)!=null&&x.length?b&&t.nodes.some(w=>w.id===y.id):b}),v=p.every(y=>y.width&&y.height);if(p.length>0&&v){const y=No(p,u),{x:b,y:x,zoom:w}=of(y,s,r,t.minZoom??i,t.maxZoom??o,t.padding??.1),E=nn.translate(b,x).scale(w);return typeof t.duration=="number"&&t.duration>0?a.transform(jt(l,t.duration),E):a.transform(l,E),!0}}return!1}function r1(e,t){return e.forEach(n=>{const s=t.get(n.id);s&&t.set(s.id,{...s,[xe]:s[xe],selected:n.selected})}),new Map(t)}function i1(e,t){return t.map(n=>{const s=e.find(r=>r.id===n.id);return s&&(n.selected=s.selected),n})}function us({changedNodes:e,changedEdges:t,get:n,set:s}){const{nodeInternals:r,edges:i,onNodesChange:o,onEdgesChange:a,hasDefaultNodes:l,hasDefaultEdges:c}=n();e!=null&&e.length&&(l&&s({nodeInternals:r1(e,r)}),o==null||o(e)),t!=null&&t.length&&(c&&s({edges:i1(t,i)}),a==null||a(t))}const zt=()=>{},o1={zoomIn:zt,zoomOut:zt,zoomTo:zt,getZoom:()=>1,setViewport:zt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:zt,fitBounds:zt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},a1=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),l1=()=>{const e=Ce(),{d3Zoom:t,d3Selection:n}=ge(a1,Ie);return g.useMemo(()=>n&&t?{zoomIn:r=>t.scaleBy(jt(n,r==null?void 0:r.duration),1.2),zoomOut:r=>t.scaleBy(jt(n,r==null?void 0:r.duration),1/1.2),zoomTo:(r,i)=>t.scaleTo(jt(n,i==null?void 0:i.duration),r),getZoom:()=>e.getState().transform[2],setViewport:(r,i)=>{const[o,a,l]=e.getState().transform,c=nn.translate(r.x??o,r.y??a).scale(r.zoom??l);t.transform(jt(n,i==null?void 0:i.duration),c)},getViewport:()=>{const[r,i,o]=e.getState().transform;return{x:r,y:i,zoom:o}},fitView:r=>bf(e.getState,r),setCenter:(r,i,o)=>{const{width:a,height:l,maxZoom:c}=e.getState(),d=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:c,u=a/2-r*d,h=l/2-i*d,f=nn.translate(u,h).scale(d);t.transform(jt(n,o==null?void 0:o.duration),f)},fitBounds:(r,i)=>{const{width:o,height:a,minZoom:l,maxZoom:c}=e.getState(),{x:d,y:u,zoom:h}=of(r,o,a,l,c,(i==null?void 0:i.padding)??.1),f=nn.translate(d,u).scale(h);t.transform(jt(n,i==null?void 0:i.duration),f)},project:r=>{const{transform:i,snapToGrid:o,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),fi(r,i,o,a)},screenToFlowPosition:r=>{const{transform:i,snapToGrid:o,snapGrid:a,domNode:l}=e.getState();if(!l)return r;const{x:c,y:d}=l.getBoundingClientRect(),u={x:r.x-c,y:r.y-d};return fi(u,i,o,a)},flowToScreenPosition:r=>{const{transform:i,domNode:o}=e.getState();if(!o)return r;const{x:a,y:l}=o.getBoundingClientRect(),c=nf(r,i);return{x:c.x+a,y:c.y+l}},viewportInitialized:!0}:o1,[t,n])};function jo(){const e=l1(),t=Ce(),n=g.useCallback(()=>t.getState().getNodes().map(v=>({...v})),[]),s=g.useCallback(v=>t.getState().nodeInternals.get(v),[]),r=g.useCallback(()=>{const{edges:v=[]}=t.getState();return v.map(y=>({...y}))},[]),i=g.useCallback(v=>{const{edges:y=[]}=t.getState();return y.find(b=>b.id===v)},[]),o=g.useCallback(v=>{const{getNodes:y,setNodes:b,hasDefaultNodes:x,onNodesChange:w}=t.getState(),E=y(),_=typeof v=="function"?v(E):v;if(x)b(_);else if(w){const j=_.length===0?E.map(D=>({type:"remove",id:D.id})):_.map(D=>({item:D,type:"reset"}));w(j)}},[]),a=g.useCallback(v=>{const{edges:y=[],setEdges:b,hasDefaultEdges:x,onEdgesChange:w}=t.getState(),E=typeof v=="function"?v(y):v;if(x)b(E);else if(w){const _=E.length===0?y.map(j=>({type:"remove",id:j.id})):E.map(j=>({item:j,type:"reset"}));w(_)}},[]),l=g.useCallback(v=>{const y=Array.isArray(v)?v:[v],{getNodes:b,setNodes:x,hasDefaultNodes:w,onNodesChange:E}=t.getState();if(w){const j=[...b(),...y];x(j)}else if(E){const _=y.map(j=>({item:j,type:"add"}));E(_)}},[]),c=g.useCallback(v=>{const y=Array.isArray(v)?v:[v],{edges:b=[],setEdges:x,hasDefaultEdges:w,onEdgesChange:E}=t.getState();if(w)x([...b,...y]);else if(E){const _=y.map(j=>({item:j,type:"add"}));E(_)}},[]),d=g.useCallback(()=>{const{getNodes:v,edges:y=[],transform:b}=t.getState(),[x,w,E]=b;return{nodes:v().map(_=>({..._})),edges:y.map(_=>({..._})),viewport:{x,y:w,zoom:E}}},[]),u=g.useCallback(({nodes:v,edges:y})=>{const{nodeInternals:b,getNodes:x,edges:w,hasDefaultNodes:E,hasDefaultEdges:_,onNodesDelete:j,onEdgesDelete:D,onNodesChange:R,onEdgesChange:P}=t.getState(),M=(v||[]).map(N=>N.id),L=(y||[]).map(N=>N.id),$=x().reduce((N,B)=>{const I=B.parentNode||B.parentId,F=!M.includes(B.id)&&I&&N.find(O=>O.id===I);return(typeof B.deletable=="boolean"?B.deletable:!0)&&(M.includes(B.id)||F)&&N.push(B),N},[]),U=w.filter(N=>typeof N.deletable=="boolean"?N.deletable:!0),T=U.filter(N=>L.includes(N.id));if($||T){const N=rf($,U),B=[...T,...N],I=B.reduce((F,S)=>(F.includes(S.id)||F.push(S.id),F),[]);if((_||E)&&(_&&t.setState({edges:w.filter(F=>!I.includes(F.id))}),E&&($.forEach(F=>{b.delete(F.id)}),t.setState({nodeInternals:new Map(b)}))),I.length>0&&(D==null||D(B),P&&P(I.map(F=>({id:F,type:"remove"})))),$.length>0&&(j==null||j($),R)){const F=$.map(S=>({id:S.id,type:"remove"}));R(F)}}},[]),h=g.useCallback(v=>{const y=PS(v),b=y?null:t.getState().nodeInternals.get(v.id);return!y&&!b?[null,null,y]:[y?v:Ul(b),b,y]},[]),f=g.useCallback((v,y=!0,b)=>{const[x,w,E]=h(v);return x?(b||t.getState().getNodes()).filter(_=>{if(!E&&(_.id===w.id||!_.positionAbsolute))return!1;const j=Ul(_),D=li(j,x);return y&&D>0||D>=x.width*x.height}):[]},[]),p=g.useCallback((v,y,b=!0)=>{const[x]=h(v);if(!x)return!1;const w=li(x,y);return b&&w>0||w>=x.width*x.height},[]);return g.useMemo(()=>({...e,getNodes:n,getNode:s,getEdges:r,getEdge:i,setNodes:o,setEdges:a,addNodes:l,addEdges:c,toObject:d,deleteElements:u,getIntersectingNodes:f,isNodeIntersecting:p}),[e,n,s,r,i,o,a,l,c,d,u,f,p])}const c1={actInsideInputWithModifier:!1};var u1=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=Ce(),{deleteElements:s}=jo(),r=Bn(e,c1),i=Bn(t);g.useEffect(()=>{if(r){const{edges:o,getNodes:a}=n.getState(),l=a().filter(d=>d.selected),c=o.filter(d=>d.selected);s({nodes:l,edges:c}),n.setState({nodesSelectionActive:!1})}},[r]),g.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function d1(e){const t=Ce();g.useEffect(()=>{let n;const s=()=>{var i,o;if(!e.current)return;const r=xo(e.current);(r.height===0||r.width===0)&&((o=(i=t.getState()).onError)==null||o.call(i,"004",pt.error004())),t.setState({width:r.width||500,height:r.height||500})};return s(),window.addEventListener("resize",s),e.current&&(n=new ResizeObserver(()=>s()),n.observe(e.current)),()=>{window.removeEventListener("resize",s),n&&e.current&&n.unobserve(e.current)}},[])}const Ro={position:"absolute",width:"100%",height:"100%",top:0,left:0},f1=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ds=e=>({x:e.x,y:e.y,zoom:e.k}),Gt=(e,t)=>e.target.closest(`.${t}`),ql=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),ec=e=>{const t=e.ctrlKey&&Ps()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},h1=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),m1=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:s,zoomOnScroll:r=!0,zoomOnPinch:i=!0,panOnScroll:o=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=It.Free,zoomOnDoubleClick:c=!0,elementsSelectable:d,panOnDrag:u=!0,defaultViewport:h,translateExtent:f,minZoom:p,maxZoom:v,zoomActivationKeyCode:y,preventScrolling:b=!0,children:x,noWheelClassName:w,noPanClassName:E})=>{const _=g.useRef(),j=Ce(),D=g.useRef(!1),R=g.useRef(!1),P=g.useRef(null),M=g.useRef({x:0,y:0,zoom:0}),{d3Zoom:L,d3Selection:$,d3ZoomHandler:U,userSelectionActive:T}=ge(h1,Ie),N=Bn(y),B=g.useRef(0),I=g.useRef(!1),F=g.useRef();return d1(P),g.useEffect(()=>{if(P.current){const S=P.current.getBoundingClientRect(),O=Jh().scaleExtent([p,v]).translateExtent(f),z=Mc(P.current).call(O),k=nn.translate(h.x,h.y).scale(dn(h.zoom,p,v)),H=[[0,0],[S.width,S.height]],V=O.constrain()(k,H,f);O.transform(z,V),O.wheelDelta(ec),j.setState({d3Zoom:O,d3Selection:z,d3ZoomHandler:z.on("wheel.zoom"),transform:[V.x,V.y,V.k],domNode:P.current.closest(".react-flow")})}},[]),g.useEffect(()=>{$&&L&&(o&&!N&&!T?$.on("wheel.zoom",S=>{if(Gt(S,w))return!1;S.preventDefault(),S.stopImmediatePropagation();const O=$.property("__zoom").k||1;if(S.ctrlKey&&i){const Y=Qh(S),Q=ec(S),X=O*Math.pow(2,Q);L.scaleTo($,X,Y,S);return}const z=S.deltaMode===1?20:1;let k=l===It.Vertical?0:S.deltaX*z,H=l===It.Horizontal?0:S.deltaY*z;!Ps()&&S.shiftKey&&l!==It.Vertical&&(k=S.deltaY*z,H=0),L.translateBy($,-(k/O)*a,-(H/O)*a,{internal:!0});const V=ds($.property("__zoom")),{onViewportChangeStart:A,onViewportChange:G,onViewportChangeEnd:K}=j.getState();clearTimeout(F.current),I.current||(I.current=!0,t==null||t(S,V),A==null||A(V)),I.current&&(e==null||e(S,V),G==null||G(V),F.current=setTimeout(()=>{n==null||n(S,V),K==null||K(V),I.current=!1},150))},{passive:!1}):typeof U<"u"&&$.on("wheel.zoom",function(S,O){if(!b&&S.type==="wheel"&&!S.ctrlKey||Gt(S,w))return null;S.preventDefault(),U.call(this,S,O)},{passive:!1}))},[T,o,l,$,L,U,N,i,b,w,t,e,n]),g.useEffect(()=>{L&&L.on("start",S=>{var k,H;if(!S.sourceEvent||S.sourceEvent.internal)return null;B.current=(k=S.sourceEvent)==null?void 0:k.button;const{onViewportChangeStart:O}=j.getState(),z=ds(S.transform);D.current=!0,M.current=z,((H=S.sourceEvent)==null?void 0:H.type)==="mousedown"&&j.setState({paneDragging:!0}),O==null||O(z),t==null||t(S.sourceEvent,z)})},[L,t]),g.useEffect(()=>{L&&(T&&!D.current?L.on("zoom",null):T||L.on("zoom",S=>{var z;const{onViewportChange:O}=j.getState();if(j.setState({transform:[S.transform.x,S.transform.y,S.transform.k]}),R.current=!!(s&&ql(u,B.current??0)),(e||O)&&!((z=S.sourceEvent)!=null&&z.internal)){const k=ds(S.transform);O==null||O(k),e==null||e(S.sourceEvent,k)}}))},[T,L,e,u,s]),g.useEffect(()=>{L&&L.on("end",S=>{if(!S.sourceEvent||S.sourceEvent.internal)return null;const{onViewportChangeEnd:O}=j.getState();if(D.current=!1,j.setState({paneDragging:!1}),s&&ql(u,B.current??0)&&!R.current&&s(S.sourceEvent),R.current=!1,(n||O)&&f1(M.current,S.transform)){const z=ds(S.transform);M.current=z,clearTimeout(_.current),_.current=setTimeout(()=>{O==null||O(z),n==null||n(S.sourceEvent,z)},o?150:0)}})},[L,o,u,n,s]),g.useEffect(()=>{L&&L.filter(S=>{const O=N||r,z=i&&S.ctrlKey;if((u===!0||Array.isArray(u)&&u.includes(1))&&S.button===1&&S.type==="mousedown"&&(Gt(S,"react-flow__node")||Gt(S,"react-flow__edge")))return!0;if(!u&&!O&&!o&&!c&&!i||T||!c&&S.type==="dblclick"||Gt(S,w)&&S.type==="wheel"||Gt(S,E)&&(S.type!=="wheel"||o&&S.type==="wheel"&&!N)||!i&&S.ctrlKey&&S.type==="wheel"||!O&&!o&&!z&&S.type==="wheel"||!u&&(S.type==="mousedown"||S.type==="touchstart")||Array.isArray(u)&&!u.includes(S.button)&&S.type==="mousedown")return!1;const k=Array.isArray(u)&&u.includes(S.button)||!S.button||S.button<=1;return(!S.ctrlKey||S.type==="wheel")&&k})},[T,L,r,i,o,c,u,d,N]),C.createElement("div",{className:"react-flow__renderer",ref:P,style:Ro},x)},p1=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function g1(){const{userSelectionActive:e,userSelectionRect:t}=ge(p1,Ie);return e&&t?C.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function tc(e,t){const n=t.parentNode||t.parentId,s=e.find(r=>r.id===n);if(s){const r=t.position.x+t.width-s.width,i=t.position.y+t.height-s.height;if(r>0||i>0||t.position.x<0||t.position.y<0){if(s.style={...s.style},s.style.width=s.style.width??s.width,s.style.height=s.style.height??s.height,r>0&&(s.style.width+=r),i>0&&(s.style.height+=i),t.position.x<0){const o=Math.abs(t.position.x);s.position.x=s.position.x-o,s.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);s.position.y=s.position.y-o,s.style.height+=o,t.position.y=0}s.width=s.style.width,s.height=s.style.height}}}function Ef(e,t){if(e.some(s=>s.type==="reset"))return e.filter(s=>s.type==="reset").map(s=>s.item);const n=e.filter(s=>s.type==="add").map(s=>s.item);return t.reduce((s,r)=>{const i=e.filter(a=>a.id===r.id);if(i.length===0)return s.push(r),s;const o={...r};for(const a of i)if(a)switch(a.type){case"select":{o.selected=a.selected;break}case"position":{typeof a.position<"u"&&(o.position=a.position),typeof a.positionAbsolute<"u"&&(o.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(o.dragging=a.dragging),o.expandParent&&tc(s,o);break}case"dimensions":{typeof a.dimensions<"u"&&(o.width=a.dimensions.width,o.height=a.dimensions.height),typeof a.updateStyle<"u"&&(o.style={...o.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(o.resizing=a.resizing),o.expandParent&&tc(s,o);break}case"remove":return s}return s.push(o),s},n)}function Sf(e,t){return Ef(e,t)}function v1(e,t){return Ef(e,t)}const xt=(e,t)=>({id:e,type:"select",selected:t});function en(e,t){return e.reduce((n,s)=>{const r=t.includes(s.id);return!s.selected&&r?(s.selected=!0,n.push(xt(s.id,!0))):s.selected&&!r&&(s.selected=!1,n.push(xt(s.id,!1))),n},[])}const jr=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},y1=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),_f=g.memo(({isSelecting:e,selectionMode:t=fn.Full,panOnDrag:n,onSelectionStart:s,onSelectionEnd:r,onPaneClick:i,onPaneContextMenu:o,onPaneScroll:a,onPaneMouseEnter:l,onPaneMouseMove:c,onPaneMouseLeave:d,children:u})=>{const h=g.useRef(null),f=Ce(),p=g.useRef(0),v=g.useRef(0),y=g.useRef(),{userSelectionActive:b,elementsSelectable:x,dragging:w}=ge(y1,Ie),E=()=>{f.setState({userSelectionActive:!1,userSelectionRect:null}),p.current=0,v.current=0},_=U=>{i==null||i(U),f.getState().resetSelectedElements(),f.setState({nodesSelectionActive:!1})},j=U=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){U.preventDefault();return}o==null||o(U)},D=a?U=>a(U):void 0,R=U=>{const{resetSelectedElements:T,domNode:N}=f.getState();if(y.current=N==null?void 0:N.getBoundingClientRect(),!x||!e||U.button!==0||U.target!==h.current||!y.current)return;const{x:B,y:I}=Et(U,y.current);T(),f.setState({userSelectionRect:{width:0,height:0,startX:B,startY:I,x:B,y:I}}),s==null||s(U)},P=U=>{const{userSelectionRect:T,nodeInternals:N,edges:B,transform:I,onNodesChange:F,onEdgesChange:S,nodeOrigin:O,getNodes:z}=f.getState();if(!e||!y.current||!T)return;f.setState({userSelectionActive:!0,nodesSelectionActive:!1});const k=Et(U,y.current),H=T.startX??0,V=T.startY??0,A={...T,x:k.x<H?k.x:H,y:k.y<V?k.y:V,width:Math.abs(k.x-H),height:Math.abs(k.y-V)},G=z(),K=sf(N,A,I,t===fn.Partial,!0,O),Y=rf(K,B).map(X=>X.id),Q=K.map(X=>X.id);if(p.current!==Q.length){p.current=Q.length;const X=en(G,Q);X.length&&(F==null||F(X))}if(v.current!==Y.length){v.current=Y.length;const X=en(B,Y);X.length&&(S==null||S(X))}f.setState({userSelectionRect:A})},M=U=>{if(U.button!==0)return;const{userSelectionRect:T}=f.getState();!b&&T&&U.target===h.current&&(_==null||_(U)),f.setState({nodesSelectionActive:p.current>0}),E(),r==null||r(U)},L=U=>{b&&(f.setState({nodesSelectionActive:p.current>0}),r==null||r(U)),E()},$=x&&(e||b);return C.createElement("div",{className:Oe(["react-flow__pane",{dragging:w,selection:e}]),onClick:$?void 0:jr(_,h),onContextMenu:jr(j,h),onWheel:jr(D,h),onMouseEnter:$?void 0:l,onMouseDown:$?R:void 0,onMouseMove:$?P:c,onMouseUp:$?M:void 0,onMouseLeave:$?L:d,ref:h,style:Ro},u,C.createElement(g1,null))});_f.displayName="Pane";function Tf(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const s=t.get(n);return s?s.selected?!0:Tf(s,t):!1}function nc(e,t,n){let s=e;do{if(s!=null&&s.matches(t))return!0;if(s===n.current)return!1;s=s.parentElement}while(s);return!1}function x1(e,t,n,s){return Array.from(e.values()).filter(r=>(r.selected||r.id===s)&&(!r.parentNode||r.parentId||!Tf(r,e))&&(r.draggable||t&&typeof r.draggable>"u")).map(r=>{var i,o;return{id:r.id,position:r.position||{x:0,y:0},positionAbsolute:r.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=r.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((o=r.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:r.extent,parentNode:r.parentNode||r.parentId,parentId:r.parentNode||r.parentId,width:r.width,height:r.height,expandParent:r.expandParent}})}function w1(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Cf(e,t,n,s,r=[0,0],i){const o=w1(e,e.extent||s);let a=o;const l=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(l&&e.width&&e.height){const u=n.get(l),{x:h,y:f}=sn(u,r).positionAbsolute;a=u&&Ye(h)&&Ye(f)&&Ye(u.width)&&Ye(u.height)?[[h+e.width*r[0],f+e.height*r[1]],[h+u.width-e.width+e.width*r[0],f+u.height-e.height+e.height*r[1]]]:a}else i==null||i("005",pt.error005()),a=o;else if(e.extent&&l&&e.extent!=="parent"){const u=n.get(l),{x:h,y:f}=sn(u,r).positionAbsolute;a=[[e.extent[0][0]+h,e.extent[0][1]+f],[e.extent[1][0]+h,e.extent[1][1]+f]]}let c={x:0,y:0};if(l){const u=n.get(l);c=sn(u,r).positionAbsolute}const d=a&&a!=="parent"?wo(t,a):t;return{position:{x:d.x-c.x,y:d.y-c.y},positionAbsolute:d}}function Rr({nodeId:e,dragItems:t,nodeInternals:n}){const s=t.map(r=>({...n.get(r.id),position:r.position,positionAbsolute:r.positionAbsolute}));return[e?s.find(r=>r.id===e):s[0],s]}const sc=(e,t,n,s)=>{const r=t.querySelectorAll(e);if(!r||!r.length)return null;const i=Array.from(r),o=t.getBoundingClientRect(),a={x:o.width*s[0],y:o.height*s[1]};return i.map(l=>{const c=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(c.left-o.left-a.x)/n,y:(c.top-o.top-a.y)/n,...xo(l)}})};function Sn(e,t,n){return n===void 0?n:s=>{const r=t().nodeInternals.get(e);r&&n(s,{...r})}}function mi({id:e,store:t,unselect:n=!1,nodeRef:s}){const{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:o,nodeInternals:a,onError:l}=t.getState(),c=a.get(e);if(!c){l==null||l("012",pt.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&o)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var d;return(d=s==null?void 0:s.current)==null?void 0:d.blur()})):r([e])}function b1(){const e=Ce();return g.useCallback(({sourceEvent:n})=>{const{transform:s,snapGrid:r,snapToGrid:i}=e.getState(),o=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,l={x:(o-s[0])/s[2],y:(a-s[1])/s[2]};return{xSnapped:i?r[0]*Math.round(l.x/r[0]):l.x,ySnapped:i?r[1]*Math.round(l.y/r[1]):l.y,...l}},[])}function kr(e){return(t,n,s)=>e==null?void 0:e(t,s)}function Nf({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:s,nodeId:r,isSelectable:i,selectNodesOnDrag:o}){const a=Ce(),[l,c]=g.useState(!1),d=g.useRef([]),u=g.useRef({x:null,y:null}),h=g.useRef(0),f=g.useRef(null),p=g.useRef({x:0,y:0}),v=g.useRef(null),y=g.useRef(!1),b=g.useRef(!1),x=g.useRef(!1),w=b1();return g.useEffect(()=>{if(e!=null&&e.current){const E=Mc(e.current),_=({x:R,y:P})=>{const{nodeInternals:M,onNodeDrag:L,onSelectionDrag:$,updateNodePositions:U,nodeExtent:T,snapGrid:N,snapToGrid:B,nodeOrigin:I,onError:F}=a.getState();u.current={x:R,y:P};let S=!1,O={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&T){const k=No(d.current,I);O=bo(k)}if(d.current=d.current.map(k=>{const H={x:R-k.distance.x,y:P-k.distance.y};B&&(H.x=N[0]*Math.round(H.x/N[0]),H.y=N[1]*Math.round(H.y/N[1]));const V=[[T[0][0],T[0][1]],[T[1][0],T[1][1]]];d.current.length>1&&T&&!k.extent&&(V[0][0]=k.positionAbsolute.x-O.x+T[0][0],V[1][0]=k.positionAbsolute.x+(k.width??0)-O.x2+T[1][0],V[0][1]=k.positionAbsolute.y-O.y+T[0][1],V[1][1]=k.positionAbsolute.y+(k.height??0)-O.y2+T[1][1]);const A=Cf(k,H,M,V,I,F);return S=S||k.position.x!==A.position.x||k.position.y!==A.position.y,k.position=A.position,k.positionAbsolute=A.positionAbsolute,k}),!S)return;U(d.current,!0,!0),c(!0);const z=r?L:kr($);if(z&&v.current){const[k,H]=Rr({nodeId:r,dragItems:d.current,nodeInternals:M});z(v.current,k,H)}},j=()=>{if(!f.current)return;const[R,P]=Xd(p.current,f.current);if(R!==0||P!==0){const{transform:M,panBy:L}=a.getState();u.current.x=(u.current.x??0)-R/M[2],u.current.y=(u.current.y??0)-P/M[2],L({x:R,y:P})&&_(u.current)}h.current=requestAnimationFrame(j)},D=R=>{var I;const{nodeInternals:P,multiSelectionActive:M,nodesDraggable:L,unselectNodesAndEdges:$,onNodeDragStart:U,onSelectionDragStart:T}=a.getState();b.current=!0;const N=r?U:kr(T);(!o||!i)&&!M&&r&&((I=P.get(r))!=null&&I.selected||$()),r&&i&&o&&mi({id:r,store:a,nodeRef:e});const B=w(R);if(u.current=B,d.current=x1(P,L,B,r),N&&d.current){const[F,S]=Rr({nodeId:r,dragItems:d.current,nodeInternals:P});N(R.sourceEvent,F,S)}};if(t)E.on(".drag",null);else{const R=qh().on("start",P=>{const{domNode:M,nodeDragThreshold:L}=a.getState();L===0&&D(P),x.current=!1;const $=w(P);u.current=$,f.current=(M==null?void 0:M.getBoundingClientRect())||null,p.current=Et(P.sourceEvent,f.current)}).on("drag",P=>{var U,T;const M=w(P),{autoPanOnNodeDrag:L,nodeDragThreshold:$}=a.getState();if(P.sourceEvent.type==="touchmove"&&P.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!y.current&&b.current&&L&&(y.current=!0,j()),!b.current){const N=M.xSnapped-(((U=u==null?void 0:u.current)==null?void 0:U.x)??0),B=M.ySnapped-(((T=u==null?void 0:u.current)==null?void 0:T.y)??0);Math.sqrt(N*N+B*B)>$&&D(P)}(u.current.x!==M.xSnapped||u.current.y!==M.ySnapped)&&d.current&&b.current&&(v.current=P.sourceEvent,p.current=Et(P.sourceEvent,f.current),_(M))}}).on("end",P=>{if(!(!b.current||x.current)&&(c(!1),y.current=!1,b.current=!1,cancelAnimationFrame(h.current),d.current)){const{updateNodePositions:M,nodeInternals:L,onNodeDragStop:$,onSelectionDragStop:U}=a.getState(),T=r?$:kr(U);if(M(d.current,!1,!1),T){const[N,B]=Rr({nodeId:r,dragItems:d.current,nodeInternals:L});T(P.sourceEvent,N,B)}}}).filter(P=>{const M=P.target;return!P.button&&(!n||!nc(M,`.${n}`,e))&&(!s||nc(M,s,e))});return E.call(R),()=>{E.on(".drag",null)}}}},[e,t,n,s,i,a,r,o,w]),l}function Af(){const e=Ce();return g.useCallback(n=>{const{nodeInternals:s,nodeExtent:r,updateNodePositions:i,getNodes:o,snapToGrid:a,snapGrid:l,onError:c,nodesDraggable:d}=e.getState(),u=o().filter(x=>x.selected&&(x.draggable||d&&typeof x.draggable>"u")),h=a?l[0]:5,f=a?l[1]:5,p=n.isShiftPressed?4:1,v=n.x*h*p,y=n.y*f*p,b=u.map(x=>{if(x.positionAbsolute){const w={x:x.positionAbsolute.x+v,y:x.positionAbsolute.y+y};a&&(w.x=l[0]*Math.round(w.x/l[0]),w.y=l[1]*Math.round(w.y/l[1]));const{positionAbsolute:E,position:_}=Cf(x,w,s,r,void 0,c);x.position=_,x.positionAbsolute=E}return x});i(b,!0,!1)},[])}const rn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var _n=e=>{const t=({id:n,type:s,data:r,xPos:i,yPos:o,xPosOrigin:a,yPosOrigin:l,selected:c,onClick:d,onMouseEnter:u,onMouseMove:h,onMouseLeave:f,onContextMenu:p,onDoubleClick:v,style:y,className:b,isDraggable:x,isSelectable:w,isConnectable:E,isFocusable:_,selectNodesOnDrag:j,sourcePosition:D,targetPosition:R,hidden:P,resizeObserver:M,dragHandle:L,zIndex:$,isParent:U,noDragClassName:T,noPanClassName:N,initialized:B,disableKeyboardA11y:I,ariaLabel:F,rfId:S,hasHandleBounds:O})=>{const z=Ce(),k=g.useRef(null),H=g.useRef(null),V=g.useRef(D),A=g.useRef(R),G=g.useRef(s),K=w||x||d||u||h||f,Y=Af(),Q=Sn(n,z.getState,u),X=Sn(n,z.getState,h),ae=Sn(n,z.getState,f),de=Sn(n,z.getState,p),he=Sn(n,z.getState,v),ce=re=>{const{nodeDragThreshold:Z}=z.getState();if(w&&(!j||!x||Z>0)&&mi({id:n,store:z,nodeRef:k}),d){const we=z.getState().nodeInternals.get(n);we&&d(re,{...we})}},ie=re=>{if(!ci(re)&&!I)if(Zd.includes(re.key)&&w){const Z=re.key==="Escape";mi({id:n,store:z,unselect:Z,nodeRef:k})}else x&&c&&Object.prototype.hasOwnProperty.call(rn,re.key)&&(z.setState({ariaLiveMessage:`Moved selected node ${re.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~o}`}),Y({x:rn[re.key].x,y:rn[re.key].y,isShiftPressed:re.shiftKey}))};g.useEffect(()=>()=>{H.current&&(M==null||M.unobserve(H.current),H.current=null)},[]),g.useEffect(()=>{if(k.current&&!P){const re=k.current;(!B||!O||H.current!==re)&&(H.current&&(M==null||M.unobserve(H.current)),M==null||M.observe(re),H.current=re)}},[P,B,O]),g.useEffect(()=>{const re=G.current!==s,Z=V.current!==D,we=A.current!==R;k.current&&(re||Z||we)&&(re&&(G.current=s),Z&&(V.current=D),we&&(A.current=R),z.getState().updateNodeDimensions([{id:n,nodeElement:k.current,forceUpdate:!0}]))},[n,s,D,R]);const ve=Nf({nodeRef:k,disabled:P||!x,noDragClassName:T,handleSelector:L,nodeId:n,isSelectable:w,selectNodesOnDrag:j});return P?null:C.createElement("div",{className:Oe(["react-flow__node",`react-flow__node-${s}`,{[N]:x},b,{selected:c,selectable:w,parent:U,dragging:ve}]),ref:k,style:{zIndex:$,transform:`translate(${a}px,${l}px)`,pointerEvents:K?"all":"none",visibility:B?"visible":"hidden",...y},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:Q,onMouseMove:X,onMouseLeave:ae,onContextMenu:de,onClick:ce,onDoubleClick:he,onKeyDown:_?ie:void 0,tabIndex:_?0:void 0,role:_?"button":void 0,"aria-describedby":I?void 0:`${vf}-${S}`,"aria-label":F},C.createElement(LS,{value:n},C.createElement(e,{id:n,data:r,type:s,xPos:i,yPos:o,selected:c,isConnectable:E,sourcePosition:D,targetPosition:R,dragging:ve,dragHandle:L,zIndex:$})))};return t.displayName="NodeWrapper",g.memo(t)};const E1=e=>{const t=e.getNodes().filter(n=>n.selected);return{...No(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function S1({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const s=Ce(),{width:r,height:i,x:o,y:a,transformString:l,userSelectionActive:c}=ge(E1,Ie),d=Af(),u=g.useRef(null);if(g.useEffect(()=>{var p;n||(p=u.current)==null||p.focus({preventScroll:!0})},[n]),Nf({nodeRef:u}),c||!r||!i)return null;const h=e?p=>{const v=s.getState().getNodes().filter(y=>y.selected);e(p,v)}:void 0,f=p=>{Object.prototype.hasOwnProperty.call(rn,p.key)&&d({x:rn[p.key].x,y:rn[p.key].y,isShiftPressed:p.shiftKey})};return C.createElement("div",{className:Oe(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},C.createElement("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:r,height:i,top:a,left:o}}))}var _1=g.memo(S1);const T1=e=>e.nodesSelectionActive,Pf=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:o,deleteKeyCode:a,onMove:l,onMoveStart:c,onMoveEnd:d,selectionKeyCode:u,selectionOnDrag:h,selectionMode:f,onSelectionStart:p,onSelectionEnd:v,multiSelectionKeyCode:y,panActivationKeyCode:b,zoomActivationKeyCode:x,elementsSelectable:w,zoomOnScroll:E,zoomOnPinch:_,panOnScroll:j,panOnScrollSpeed:D,panOnScrollMode:R,zoomOnDoubleClick:P,panOnDrag:M,defaultViewport:L,translateExtent:$,minZoom:U,maxZoom:T,preventScrolling:N,onSelectionContextMenu:B,noWheelClassName:I,noPanClassName:F,disableKeyboardA11y:S})=>{const O=ge(T1),z=Bn(u),k=Bn(b),H=k||M,V=k||j,A=z||h&&H!==!0;return u1({deleteKeyCode:a,multiSelectionKeyCode:y}),C.createElement(m1,{onMove:l,onMoveStart:c,onMoveEnd:d,onPaneContextMenu:i,elementsSelectable:w,zoomOnScroll:E,zoomOnPinch:_,panOnScroll:V,panOnScrollSpeed:D,panOnScrollMode:R,zoomOnDoubleClick:P,panOnDrag:!z&&H,defaultViewport:L,translateExtent:$,minZoom:U,maxZoom:T,zoomActivationKeyCode:x,preventScrolling:N,noWheelClassName:I,noPanClassName:F},C.createElement(_f,{onSelectionStart:p,onSelectionEnd:v,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:o,panOnDrag:H,isSelecting:!!A,selectionMode:f},e,O&&C.createElement(_1,{onSelectionContextMenu:B,noPanClassName:F,disableKeyboardA11y:S})))};Pf.displayName="FlowRenderer";var C1=g.memo(Pf);function N1(e){return ge(g.useCallback(n=>e?sf(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function A1(e){const t={input:_n(e.input||hf),default:_n(e.default||hi),output:_n(e.output||pf),group:_n(e.group||Po)},n={},s=Object.keys(e).filter(r=>!["input","default","output","group"].includes(r)).reduce((r,i)=>(r[i]=_n(e[i]||hi),r),n);return{...t,...s}}const P1=({x:e,y:t,width:n,height:s,origin:r})=>!n||!s?{x:e,y:t}:r[0]<0||r[1]<0||r[0]>1||r[1]>1?{x:e,y:t}:{x:e-n*r[0],y:t-s*r[1]},j1=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),jf=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:s,elementsSelectable:r,updateNodeDimensions:i,onError:o}=ge(j1,Ie),a=N1(e.onlyRenderVisibleElements),l=g.useRef(),c=g.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(u=>{const h=u.map(f=>({id:f.target.getAttribute("data-id"),nodeElement:f.target,forceUpdate:!0}));i(h)});return l.current=d,d},[]);return g.useEffect(()=>()=>{var d;(d=l==null?void 0:l.current)==null||d.disconnect()},[]),C.createElement("div",{className:"react-flow__nodes",style:Ro},a.map(d=>{var _,j,D;let u=d.type||"default";e.nodeTypes[u]||(o==null||o("003",pt.error003(u)),u="default");const h=e.nodeTypes[u]||e.nodeTypes.default,f=!!(d.draggable||t&&typeof d.draggable>"u"),p=!!(d.selectable||r&&typeof d.selectable>"u"),v=!!(d.connectable||n&&typeof d.connectable>"u"),y=!!(d.focusable||s&&typeof d.focusable>"u"),b=e.nodeExtent?wo(d.positionAbsolute,e.nodeExtent):d.positionAbsolute,x=(b==null?void 0:b.x)??0,w=(b==null?void 0:b.y)??0,E=P1({x,y:w,width:d.width??0,height:d.height??0,origin:e.nodeOrigin});return C.createElement(h,{key:d.id,id:d.id,className:d.className,style:d.style,type:u,data:d.data,sourcePosition:d.sourcePosition||J.Bottom,targetPosition:d.targetPosition||J.Top,hidden:d.hidden,xPos:x,yPos:w,xPosOrigin:E.x,yPosOrigin:E.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!d.selected,isDraggable:f,isSelectable:p,isConnectable:v,isFocusable:y,resizeObserver:c,dragHandle:d.dragHandle,zIndex:((_=d[xe])==null?void 0:_.z)??0,isParent:!!((j=d[xe])!=null&&j.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!d.width&&!!d.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((D=d[xe])!=null&&D.handleBounds)})}))};jf.displayName="NodeRenderer";var R1=g.memo(jf);const k1=(e,t,n)=>n===J.Left?e-t:n===J.Right?e+t:e,I1=(e,t,n)=>n===J.Top?e-t:n===J.Bottom?e+t:e,rc="react-flow__edgeupdater",ic=({position:e,centerX:t,centerY:n,radius:s=10,onMouseDown:r,onMouseEnter:i,onMouseOut:o,type:a})=>C.createElement("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:o,className:Oe([rc,`${rc}-${a}`]),cx:k1(t,s,e),cy:I1(n,s,e),r:s,stroke:"transparent",fill:"transparent"}),M1=()=>!0;var Wt=e=>{const t=({id:n,className:s,type:r,data:i,onClick:o,onEdgeDoubleClick:a,selected:l,animated:c,label:d,labelStyle:u,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:v,style:y,source:b,target:x,sourceX:w,sourceY:E,targetX:_,targetY:j,sourcePosition:D,targetPosition:R,elementsSelectable:P,hidden:M,sourceHandleId:L,targetHandleId:$,onContextMenu:U,onMouseEnter:T,onMouseMove:N,onMouseLeave:B,reconnectRadius:I,onReconnect:F,onReconnectStart:S,onReconnectEnd:O,markerEnd:z,markerStart:k,rfId:H,ariaLabel:V,isFocusable:A,isReconnectable:G,pathOptions:K,interactionWidth:Y,disableKeyboardA11y:Q})=>{const X=g.useRef(null),[ae,de]=g.useState(!1),[he,ce]=g.useState(!1),ie=Ce(),ve=g.useMemo(()=>`url('#${di(k,H)}')`,[k,H]),re=g.useMemo(()=>`url('#${di(z,H)}')`,[z,H]);if(M)return null;const Z=ue=>{var $e;const{edges:Te,addSelectedEdges:W,unselectNodesAndEdges:ee,multiSelectionActive:le}=ie.getState(),Ee=Te.find(Ge=>Ge.id===n);Ee&&(P&&(ie.setState({nodesSelectionActive:!1}),Ee.selected&&le?(ee({nodes:[],edges:[Ee]}),($e=X.current)==null||$e.blur()):W([n])),o&&o(ue,Ee))},we=En(n,ie.getState,a),Ne=En(n,ie.getState,U),ut=En(n,ie.getState,T),st=En(n,ie.getState,N),be=En(n,ie.getState,B),_e=(ue,Te)=>{if(ue.button!==0)return;const{edges:W,isValidConnection:ee}=ie.getState(),le=Te?x:b,Ee=(Te?$:L)||null,$e=Te?"target":"source",Ge=ee||M1,Le=Te,ot=W.find(se=>se.id===n);ce(!0),S==null||S(ue,ot,$e);const te=se=>{ce(!1),O==null||O(se,ot,$e)};cf({event:ue,handleId:Ee,nodeId:le,onConnect:se=>F==null?void 0:F(ot,se),isTarget:Le,getState:ie.getState,setState:ie.setState,isValidConnection:Ge,edgeUpdaterType:$e,onReconnectEnd:te})},rt=ue=>_e(ue,!0),qe=ue=>_e(ue,!1),Ve=()=>de(!0),it=()=>de(!1),ze=!P&&!o,Me=ue=>{var Te;if(!Q&&Zd.includes(ue.key)&&P){const{unselectNodesAndEdges:W,addSelectedEdges:ee,edges:le}=ie.getState();ue.key==="Escape"?((Te=X.current)==null||Te.blur(),W({edges:[le.find($e=>$e.id===n)]})):ee([n])}};return C.createElement("g",{className:Oe(["react-flow__edge",`react-flow__edge-${r}`,s,{selected:l,animated:c,inactive:ze,updating:ae}]),onClick:Z,onDoubleClick:we,onContextMenu:Ne,onMouseEnter:ut,onMouseMove:st,onMouseLeave:be,onKeyDown:A?Me:void 0,tabIndex:A?0:void 0,role:A?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":V===null?void 0:V||`Edge from ${b} to ${x}`,"aria-describedby":A?`${yf}-${H}`:void 0,ref:X},!he&&C.createElement(e,{id:n,source:b,target:x,selected:l,animated:c,label:d,labelStyle:u,labelShowBg:h,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:v,data:i,style:y,sourceX:w,sourceY:E,targetX:_,targetY:j,sourcePosition:D,targetPosition:R,sourceHandleId:L,targetHandleId:$,markerStart:ve,markerEnd:re,pathOptions:K,interactionWidth:Y}),G&&C.createElement(C.Fragment,null,(G==="source"||G===!0)&&C.createElement(ic,{position:D,centerX:w,centerY:E,radius:I,onMouseDown:rt,onMouseEnter:Ve,onMouseOut:it,type:"source"}),(G==="target"||G===!0)&&C.createElement(ic,{position:R,centerX:_,centerY:j,radius:I,onMouseDown:qe,onMouseEnter:Ve,onMouseOut:it,type:"target"})))};return t.displayName="EdgeWrapper",g.memo(t)};function $1(e){const t={default:Wt(e.default||Rs),straight:Wt(e.bezier||_o),step:Wt(e.step||So),smoothstep:Wt(e.step||Xs),simplebezier:Wt(e.simplebezier||Eo)},n={},s=Object.keys(e).filter(r=>!["default","bezier"].includes(r)).reduce((r,i)=>(r[i]=Wt(e[i]||Rs),r),n);return{...t,...s}}function oc(e,t,n=null){const s=((n==null?void 0:n.x)||0)+t.x,r=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,o=(n==null?void 0:n.height)||t.height;switch(e){case J.Top:return{x:s+i/2,y:r};case J.Right:return{x:s+i,y:r+o/2};case J.Bottom:return{x:s+i/2,y:r+o};case J.Left:return{x:s,y:r+o/2}}}function ac(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const L1=(e,t,n,s,r,i)=>{const o=oc(n,e,t),a=oc(i,s,r);return{sourceX:o.x,sourceY:o.y,targetX:a.x,targetY:a.y}};function D1({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:s,targetWidth:r,targetHeight:i,width:o,height:a,transform:l}){const c={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+r),y2:Math.max(e.y+s,t.y+i)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=bo({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:o/l[2],height:a/l[2]}),u=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),h=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(u*h)>0}function lc(e){var s,r,i,o,a;const t=((s=e==null?void 0:e[xe])==null?void 0:s.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((r=e==null?void 0:e.positionAbsolute)==null?void 0:r.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const V1=[{level:0,isMaxLevel:!0,edges:[]}];function O1(e,t,n=!1){let s=-1;const r=e.reduce((o,a)=>{var d,u;const l=Ye(a.zIndex);let c=l?a.zIndex:0;if(n){const h=t.get(a.target),f=t.get(a.source),p=a.selected||(h==null?void 0:h.selected)||(f==null?void 0:f.selected),v=Math.max(((d=f==null?void 0:f[xe])==null?void 0:d.z)||0,((u=h==null?void 0:h[xe])==null?void 0:u.z)||0,1e3);c=(l?a.zIndex:0)+(p?v:0)}return o[c]?o[c].push(a):o[c]=[a],s=c>s?c:s,o},{}),i=Object.entries(r).map(([o,a])=>{const l=+o;return{edges:a,level:l,isMaxLevel:l===s}});return i.length===0?V1:i}function B1(e,t,n){const s=ge(g.useCallback(r=>e?r.edges.filter(i=>{const o=t.get(i.source),a=t.get(i.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&D1({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:a.width,targetHeight:a.height,width:r.width,height:r.height,transform:r.transform})}):r.edges,[e,t]));return O1(s,t,n)}const F1=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),H1=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),cc={[js.Arrow]:F1,[js.ArrowClosed]:H1};function U1(e){const t=Ce();return g.useMemo(()=>{var r,i;return Object.prototype.hasOwnProperty.call(cc,e)?cc[e]:((i=(r=t.getState()).onError)==null||i.call(r,"009",pt.error009(e)),null)},[e])}const z1=({id:e,type:t,color:n,width:s=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const l=U1(t);return l?C.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${s}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0"},C.createElement(l,{color:n,strokeWidth:o})):null},G1=({defaultColor:e,rfId:t})=>n=>{const s=[];return n.edges.reduce((r,i)=>([i.markerStart,i.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const a=di(o,t);s.includes(a)||(r.push({id:a,color:o.color||e,...o}),s.push(a))}}),r),[]).sort((r,i)=>r.id.localeCompare(i.id))},Rf=({defaultColor:e,rfId:t})=>{const n=ge(g.useCallback(G1({defaultColor:e,rfId:t}),[e,t]),(s,r)=>!(s.length!==r.length||s.some((i,o)=>i.id!==r[o].id)));return C.createElement("defs",null,n.map(s=>C.createElement(z1,{id:s.id,key:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient})))};Rf.displayName="MarkerDefinitions";var W1=g.memo(Rf);const K1=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),kf=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:s,edgeTypes:r,noPanClassName:i,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,onEdgeDoubleClick:u,onReconnect:h,onReconnectStart:f,onReconnectEnd:p,reconnectRadius:v,children:y,disableKeyboardA11y:b})=>{const{edgesFocusable:x,edgesUpdatable:w,elementsSelectable:E,width:_,height:j,connectionMode:D,nodeInternals:R,onError:P}=ge(K1,Ie),M=B1(t,R,n);return _?C.createElement(C.Fragment,null,M.map(({level:L,edges:$,isMaxLevel:U})=>C.createElement("svg",{key:L,style:{zIndex:L},width:_,height:j,className:"react-flow__edges react-flow__container"},U&&C.createElement(W1,{defaultColor:e,rfId:s}),C.createElement("g",null,$.map(T=>{const[N,B,I]=lc(R.get(T.source)),[F,S,O]=lc(R.get(T.target));if(!I||!O)return null;let z=T.type||"default";r[z]||(P==null||P("011",pt.error011(z)),z="default");const k=r[z]||r.default,H=D===$t.Strict?S.target:(S.target??[]).concat(S.source??[]),V=ac(B.source,T.sourceHandle),A=ac(H,T.targetHandle),G=(V==null?void 0:V.position)||J.Bottom,K=(A==null?void 0:A.position)||J.Top,Y=!!(T.focusable||x&&typeof T.focusable>"u"),Q=T.reconnectable||T.updatable,X=typeof h<"u"&&(Q||w&&typeof Q>"u");if(!V||!A)return P==null||P("008",pt.error008(V,T)),null;const{sourceX:ae,sourceY:de,targetX:he,targetY:ce}=L1(N,V,G,F,A,K);return C.createElement(k,{key:T.id,id:T.id,className:Oe([T.className,i]),type:z,data:T.data,selected:!!T.selected,animated:!!T.animated,hidden:!!T.hidden,label:T.label,labelStyle:T.labelStyle,labelShowBg:T.labelShowBg,labelBgStyle:T.labelBgStyle,labelBgPadding:T.labelBgPadding,labelBgBorderRadius:T.labelBgBorderRadius,style:T.style,source:T.source,target:T.target,sourceHandleId:T.sourceHandle,targetHandleId:T.targetHandle,markerEnd:T.markerEnd,markerStart:T.markerStart,sourceX:ae,sourceY:de,targetX:he,targetY:ce,sourcePosition:G,targetPosition:K,elementsSelectable:E,onContextMenu:o,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,onEdgeDoubleClick:u,onReconnect:h,onReconnectStart:f,onReconnectEnd:p,reconnectRadius:v,rfId:s,ariaLabel:T.ariaLabel,isFocusable:Y,isReconnectable:X,pathOptions:"pathOptions"in T?T.pathOptions:void 0,interactionWidth:T.interactionWidth,disableKeyboardA11y:b})})))),y):null};kf.displayName="EdgeRenderer";var X1=g.memo(kf);const Y1=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Z1({children:e}){const t=ge(Y1);return C.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function J1(e){const t=jo(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Q1={[J.Left]:J.Right,[J.Right]:J.Left,[J.Top]:J.Bottom,[J.Bottom]:J.Top},If=({nodeId:e,handleType:t,style:n,type:s=dt.Bezier,CustomComponent:r,connectionStatus:i})=>{var j,D,R;const{fromNode:o,handleId:a,toX:l,toY:c,connectionMode:d}=ge(g.useCallback(P=>({fromNode:P.nodeInternals.get(e),handleId:P.connectionHandleId,toX:(P.connectionPosition.x-P.transform[0])/P.transform[2],toY:(P.connectionPosition.y-P.transform[1])/P.transform[2],connectionMode:P.connectionMode}),[e]),Ie),u=(j=o==null?void 0:o[xe])==null?void 0:j.handleBounds;let h=u==null?void 0:u[t];if(d===$t.Loose&&(h=h||(u==null?void 0:u[t==="source"?"target":"source"])),!o||!h)return null;const f=a?h.find(P=>P.id===a):h[0],p=f?f.x+f.width/2:(o.width??0)/2,v=f?f.y+f.height/2:o.height??0,y=(((D=o.positionAbsolute)==null?void 0:D.x)??0)+p,b=(((R=o.positionAbsolute)==null?void 0:R.y)??0)+v,x=f==null?void 0:f.position,w=x?Q1[x]:null;if(!x||!w)return null;if(r)return C.createElement(r,{connectionLineType:s,connectionLineStyle:n,fromNode:o,fromHandle:f,fromX:y,fromY:b,toX:l,toY:c,fromPosition:x,toPosition:w,connectionStatus:i});let E="";const _={sourceX:y,sourceY:b,sourcePosition:x,targetX:l,targetY:c,targetPosition:w};return s===dt.Bezier?[E]=To(_):s===dt.Step?[E]=ui({..._,borderRadius:0}):s===dt.SmoothStep?[E]=ui(_):s===dt.SimpleBezier?[E]=ef(_):E=`M${y},${b} ${l},${c}`,C.createElement("path",{d:E,fill:"none",className:"react-flow__connection-path",style:n})};If.displayName="ConnectionLine";const q1=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function e_({containerStyle:e,style:t,type:n,component:s}){const{nodeId:r,handleType:i,nodesConnectable:o,width:a,height:l,connectionStatus:c}=ge(q1,Ie);return!(r&&i&&a&&o)?null:C.createElement("svg",{style:e,width:a,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},C.createElement("g",{className:Oe(["react-flow__connection",c])},C.createElement(If,{nodeId:r,handleType:i,style:t,type:n,CustomComponent:s,connectionStatus:c})))}function uc(e,t){return g.useRef(null),Ce(),g.useMemo(()=>t(e),[e])}const Mf=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:s,onMoveEnd:r,onInit:i,onNodeClick:o,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:u,onNodeMouseLeave:h,onNodeContextMenu:f,onSelectionContextMenu:p,onSelectionStart:v,onSelectionEnd:y,connectionLineType:b,connectionLineStyle:x,connectionLineComponent:w,connectionLineContainerStyle:E,selectionKeyCode:_,selectionOnDrag:j,selectionMode:D,multiSelectionKeyCode:R,panActivationKeyCode:P,zoomActivationKeyCode:M,deleteKeyCode:L,onlyRenderVisibleElements:$,elementsSelectable:U,selectNodesOnDrag:T,defaultViewport:N,translateExtent:B,minZoom:I,maxZoom:F,preventScrolling:S,defaultMarkerColor:O,zoomOnScroll:z,zoomOnPinch:k,panOnScroll:H,panOnScrollSpeed:V,panOnScrollMode:A,zoomOnDoubleClick:G,panOnDrag:K,onPaneClick:Y,onPaneMouseEnter:Q,onPaneMouseMove:X,onPaneMouseLeave:ae,onPaneScroll:de,onPaneContextMenu:he,onEdgeContextMenu:ce,onEdgeMouseEnter:ie,onEdgeMouseMove:ve,onEdgeMouseLeave:re,onReconnect:Z,onReconnectStart:we,onReconnectEnd:Ne,reconnectRadius:ut,noDragClassName:st,noWheelClassName:be,noPanClassName:_e,elevateEdgesOnSelect:rt,disableKeyboardA11y:qe,nodeOrigin:Ve,nodeExtent:it,rfId:ze})=>{const Me=uc(e,A1),ue=uc(t,$1);return J1(i),C.createElement(C1,{onPaneClick:Y,onPaneMouseEnter:Q,onPaneMouseMove:X,onPaneMouseLeave:ae,onPaneContextMenu:he,onPaneScroll:de,deleteKeyCode:L,selectionKeyCode:_,selectionOnDrag:j,selectionMode:D,onSelectionStart:v,onSelectionEnd:y,multiSelectionKeyCode:R,panActivationKeyCode:P,zoomActivationKeyCode:M,elementsSelectable:U,onMove:n,onMoveStart:s,onMoveEnd:r,zoomOnScroll:z,zoomOnPinch:k,zoomOnDoubleClick:G,panOnScroll:H,panOnScrollSpeed:V,panOnScrollMode:A,panOnDrag:K,defaultViewport:N,translateExtent:B,minZoom:I,maxZoom:F,onSelectionContextMenu:p,preventScrolling:S,noDragClassName:st,noWheelClassName:be,noPanClassName:_e,disableKeyboardA11y:qe},C.createElement(Z1,null,C.createElement(X1,{edgeTypes:ue,onEdgeClick:a,onEdgeDoubleClick:c,onlyRenderVisibleElements:$,onEdgeContextMenu:ce,onEdgeMouseEnter:ie,onEdgeMouseMove:ve,onEdgeMouseLeave:re,onReconnect:Z,onReconnectStart:we,onReconnectEnd:Ne,reconnectRadius:ut,defaultMarkerColor:O,noPanClassName:_e,elevateEdgesOnSelect:!!rt,disableKeyboardA11y:qe,rfId:ze},C.createElement(e_,{style:x,type:b,component:w,containerStyle:E})),C.createElement("div",{className:"react-flow__edgelabel-renderer"}),C.createElement(R1,{nodeTypes:Me,onNodeClick:o,onNodeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:u,onNodeMouseLeave:h,onNodeContextMenu:f,selectNodesOnDrag:T,onlyRenderVisibleElements:$,noPanClassName:_e,noDragClassName:st,disableKeyboardA11y:qe,nodeOrigin:Ve,nodeExtent:it,rfId:ze})))};Mf.displayName="GraphView";var t_=g.memo(Mf);const pi=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],vt={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:pi,nodeExtent:pi,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:$t.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:jS,isValidConnection:void 0},n_=()=>Zh((e,t)=>({...vt,setNodes:n=>{const{nodeInternals:s,nodeOrigin:r,elevateNodesOnSelect:i}=t();e({nodeInternals:Pr(n,s,r,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:s={}}=t();e({edges:n.map(r=>({...s,...r}))})},setDefaultNodesAndEdges:(n,s)=>{const r=typeof n<"u",i=typeof s<"u",o=r?Pr(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:i?s:[],hasDefaultNodes:r,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:s,nodeInternals:r,fitViewOnInit:i,fitViewOnInitDone:o,fitViewOnInitOptions:a,domNode:l,nodeOrigin:c}=t(),d=l==null?void 0:l.querySelector(".react-flow__viewport");if(!d)return;const u=window.getComputedStyle(d),{m22:h}=new window.DOMMatrixReadOnly(u.transform),f=n.reduce((v,y)=>{const b=r.get(y.id);if(b!=null&&b.hidden)r.set(b.id,{...b,[xe]:{...b[xe],handleBounds:void 0}});else if(b){const x=xo(y.nodeElement);!!(x.width&&x.height&&(b.width!==x.width||b.height!==x.height||y.forceUpdate))&&(r.set(b.id,{...b,[xe]:{...b[xe],handleBounds:{source:sc(".source",y.nodeElement,h,c),target:sc(".target",y.nodeElement,h,c)}},...x}),v.push({id:b.id,type:"dimensions",dimensions:x}))}return v},[]);wf(r,c);const p=o||i&&!o&&bf(t,{initial:!0,...a});e({nodeInternals:new Map(r),fitViewOnInitDone:p}),(f==null?void 0:f.length)>0&&(s==null||s(f))},updateNodePositions:(n,s=!0,r=!1)=>{const{triggerNodeChanges:i}=t(),o=n.map(a=>{const l={id:a.id,type:"position",dragging:r};return s&&(l.positionAbsolute=a.positionAbsolute,l.position=a.position),l});i(o)},triggerNodeChanges:n=>{const{onNodesChange:s,nodeInternals:r,hasDefaultNodes:i,nodeOrigin:o,getNodes:a,elevateNodesOnSelect:l}=t();if(n!=null&&n.length){if(i){const c=Sf(n,a()),d=Pr(c,r,o,l);e({nodeInternals:d})}s==null||s(n)}},addSelectedNodes:n=>{const{multiSelectionActive:s,edges:r,getNodes:i}=t();let o,a=null;s?o=n.map(l=>xt(l,!0)):(o=en(i(),n),a=en(r,[])),us({changedNodes:o,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:s,edges:r,getNodes:i}=t();let o,a=null;s?o=n.map(l=>xt(l,!0)):(o=en(r,n),a=en(i(),[])),us({changedNodes:a,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:s}={})=>{const{edges:r,getNodes:i}=t(),o=n||i(),a=s||r,l=o.map(d=>(d.selected=!1,xt(d.id,!1))),c=a.map(d=>xt(d.id,!1));us({changedNodes:l,changedEdges:c,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:s,maxZoom:r}=t();s==null||s.scaleExtent([n,r]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:s,minZoom:r}=t();s==null||s.scaleExtent([r,n]),e({maxZoom:n})},setTranslateExtent:n=>{var s;(s=t().d3Zoom)==null||s.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:s}=t(),i=s().filter(a=>a.selected).map(a=>xt(a.id,!1)),o=n.filter(a=>a.selected).map(a=>xt(a.id,!1));us({changedNodes:i,changedEdges:o,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:s}=t();s.forEach(r=>{r.positionAbsolute=wo(r.position,n)}),e({nodeExtent:n,nodeInternals:new Map(s)})},panBy:n=>{const{transform:s,width:r,height:i,d3Zoom:o,d3Selection:a,translateExtent:l}=t();if(!o||!a||!n.x&&!n.y)return!1;const c=nn.translate(s[0]+n.x,s[1]+n.y).scale(s[2]),d=[[0,0],[r,i]],u=o==null?void 0:o.constrain()(c,d,l);return o.transform(a,u),s[0]!==u.x||s[1]!==u.y||s[2]!==u.k},cancelConnection:()=>e({connectionNodeId:vt.connectionNodeId,connectionHandleId:vt.connectionHandleId,connectionHandleType:vt.connectionHandleType,connectionStatus:vt.connectionStatus,connectionStartHandle:vt.connectionStartHandle,connectionEndHandle:vt.connectionEndHandle}),reset:()=>e({...vt})}),Object.is),ko=({children:e})=>{const t=g.useRef(null);return t.current||(t.current=n_()),C.createElement(ES,{value:t.current},e)};ko.displayName="ReactFlowProvider";const $f=({children:e})=>g.useContext(Ks)?C.createElement(C.Fragment,null,e):C.createElement(ko,null,e);$f.displayName="ReactFlowWrapper";const s_={input:hf,default:hi,output:pf,group:Po},r_={default:Rs,straight:_o,step:So,smoothstep:Xs,simplebezier:Eo},i_=[0,0],o_=[15,15],a_={x:0,y:0,zoom:1},l_={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Lf=g.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,className:r,nodeTypes:i=s_,edgeTypes:o=r_,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:u,onMoveEnd:h,onConnect:f,onConnectStart:p,onConnectEnd:v,onClickConnectStart:y,onClickConnectEnd:b,onNodeMouseEnter:x,onNodeMouseMove:w,onNodeMouseLeave:E,onNodeContextMenu:_,onNodeDoubleClick:j,onNodeDragStart:D,onNodeDrag:R,onNodeDragStop:P,onNodesDelete:M,onEdgesDelete:L,onSelectionChange:$,onSelectionDragStart:U,onSelectionDrag:T,onSelectionDragStop:N,onSelectionContextMenu:B,onSelectionStart:I,onSelectionEnd:F,connectionMode:S=$t.Strict,connectionLineType:O=dt.Bezier,connectionLineStyle:z,connectionLineComponent:k,connectionLineContainerStyle:H,deleteKeyCode:V="Backspace",selectionKeyCode:A="Shift",selectionOnDrag:G=!1,selectionMode:K=fn.Full,panActivationKeyCode:Y="Space",multiSelectionKeyCode:Q=Ps()?"Meta":"Control",zoomActivationKeyCode:X=Ps()?"Meta":"Control",snapToGrid:ae=!1,snapGrid:de=o_,onlyRenderVisibleElements:he=!1,selectNodesOnDrag:ce=!0,nodesDraggable:ie,nodesConnectable:ve,nodesFocusable:re,nodeOrigin:Z=i_,edgesFocusable:we,edgesUpdatable:Ne,elementsSelectable:ut,defaultViewport:st=a_,minZoom:be=.5,maxZoom:_e=2,translateExtent:rt=pi,preventScrolling:qe=!0,nodeExtent:Ve,defaultMarkerColor:it="#b1b1b7",zoomOnScroll:ze=!0,zoomOnPinch:Me=!0,panOnScroll:ue=!1,panOnScrollSpeed:Te=.5,panOnScrollMode:W=It.Free,zoomOnDoubleClick:ee=!0,panOnDrag:le=!0,onPaneClick:Ee,onPaneMouseEnter:$e,onPaneMouseMove:Ge,onPaneMouseLeave:Le,onPaneScroll:ot,onPaneContextMenu:te,children:oe,onEdgeContextMenu:se,onEdgeDoubleClick:Be,onEdgeMouseEnter:We,onEdgeMouseMove:Ot,onEdgeMouseLeave:Ys,onEdgeUpdate:Ff,onEdgeUpdateStart:Hf,onEdgeUpdateEnd:Uf,onReconnect:zf,onReconnectStart:Gf,onReconnectEnd:Wf,reconnectRadius:Kf=10,edgeUpdaterRadius:Xf=10,onNodesChange:Yf,onEdgesChange:Zf,noDragClassName:Jf="nodrag",noWheelClassName:Qf="nowheel",noPanClassName:Io="nopan",fitView:qf=!1,fitViewOptions:eh,connectOnClick:th=!0,attributionPosition:nh,proOptions:sh,defaultEdgeOptions:rh,elevateNodesOnSelect:ih=!0,elevateEdgesOnSelect:oh=!1,disableKeyboardA11y:Mo=!1,autoPanOnConnect:ah=!0,autoPanOnNodeDrag:lh=!0,connectionRadius:ch=20,isValidConnection:uh,onError:dh,style:fh,id:$o,nodeDragThreshold:hh,...mh},ph)=>{const Zs=$o||"1";return C.createElement("div",{...mh,style:{...fh,...l_},ref:ph,className:Oe(["react-flow",r]),"data-testid":"rf__wrapper",id:$o},C.createElement($f,null,C.createElement(t_,{onInit:c,onMove:d,onMoveStart:u,onMoveEnd:h,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:x,onNodeMouseMove:w,onNodeMouseLeave:E,onNodeContextMenu:_,onNodeDoubleClick:j,nodeTypes:i,edgeTypes:o,connectionLineType:O,connectionLineStyle:z,connectionLineComponent:k,connectionLineContainerStyle:H,selectionKeyCode:A,selectionOnDrag:G,selectionMode:K,deleteKeyCode:V,multiSelectionKeyCode:Q,panActivationKeyCode:Y,zoomActivationKeyCode:X,onlyRenderVisibleElements:he,selectNodesOnDrag:ce,defaultViewport:st,translateExtent:rt,minZoom:be,maxZoom:_e,preventScrolling:qe,zoomOnScroll:ze,zoomOnPinch:Me,zoomOnDoubleClick:ee,panOnScroll:ue,panOnScrollSpeed:Te,panOnScrollMode:W,panOnDrag:le,onPaneClick:Ee,onPaneMouseEnter:$e,onPaneMouseMove:Ge,onPaneMouseLeave:Le,onPaneScroll:ot,onPaneContextMenu:te,onSelectionContextMenu:B,onSelectionStart:I,onSelectionEnd:F,onEdgeContextMenu:se,onEdgeDoubleClick:Be,onEdgeMouseEnter:We,onEdgeMouseMove:Ot,onEdgeMouseLeave:Ys,onReconnect:zf??Ff,onReconnectStart:Gf??Hf,onReconnectEnd:Wf??Uf,reconnectRadius:Kf??Xf,defaultMarkerColor:it,noDragClassName:Jf,noWheelClassName:Qf,noPanClassName:Io,elevateEdgesOnSelect:oh,rfId:Zs,disableKeyboardA11y:Mo,nodeOrigin:Z,nodeExtent:Ve}),C.createElement(QS,{nodes:e,edges:t,defaultNodes:n,defaultEdges:s,onConnect:f,onConnectStart:p,onConnectEnd:v,onClickConnectStart:y,onClickConnectEnd:b,nodesDraggable:ie,nodesConnectable:ve,nodesFocusable:re,edgesFocusable:we,edgesUpdatable:Ne,elementsSelectable:ut,elevateNodesOnSelect:ih,minZoom:be,maxZoom:_e,nodeExtent:Ve,onNodesChange:Yf,onEdgesChange:Zf,snapToGrid:ae,snapGrid:de,connectionMode:S,translateExtent:rt,connectOnClick:th,defaultEdgeOptions:rh,fitView:qf,fitViewOptions:eh,onNodesDelete:M,onEdgesDelete:L,onNodeDragStart:D,onNodeDrag:R,onNodeDragStop:P,onSelectionDrag:T,onSelectionDragStart:U,onSelectionDragStop:N,noPanClassName:Io,nodeOrigin:Z,rfId:Zs,autoPanOnConnect:ah,autoPanOnNodeDrag:lh,onError:dh,connectionRadius:ch,isValidConnection:uh,nodeDragThreshold:hh}),C.createElement(ZS,{onSelectionChange:$}),oe,C.createElement(_S,{proOptions:sh,position:nh}),C.createElement(s1,{rfId:Zs,disableKeyboardA11y:Mo})))});Lf.displayName="ReactFlow";function Df(e){return t=>{const[n,s]=g.useState(t),r=g.useCallback(i=>s(o=>e(i,o)),[]);return[n,s,r]}}const c_=Df(Sf),u_=Df(v1);function d_(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},C.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function f_(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},C.createElement("path",{d:"M0 0h32v4.2H0z"}))}function h_(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},C.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function m_(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function p_(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Pn=({children:e,className:t,...n})=>C.createElement("button",{type:"button",className:Oe(["react-flow__controls-button",t]),...n},e);Pn.displayName="ControlButton";const g_=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Vf=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:s=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:o,onFitView:a,onInteractiveChange:l,className:c,children:d,position:u="bottom-left"})=>{const h=Ce(),[f,p]=g.useState(!1),{isInteractive:v,minZoomReached:y,maxZoomReached:b}=ge(g_,Ie),{zoomIn:x,zoomOut:w,fitView:E}=jo();if(g.useEffect(()=>{p(!0)},[]),!f)return null;const _=()=>{x(),i==null||i()},j=()=>{w(),o==null||o()},D=()=>{E(r),a==null||a()},R=()=>{h.setState({nodesDraggable:!v,nodesConnectable:!v,elementsSelectable:!v}),l==null||l(!v)};return C.createElement(yo,{className:Oe(["react-flow__controls",c]),position:u,style:e,"data-testid":"rf__controls"},t&&C.createElement(C.Fragment,null,C.createElement(Pn,{onClick:_,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b},C.createElement(d_,null)),C.createElement(Pn,{onClick:j,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y},C.createElement(f_,null))),n&&C.createElement(Pn,{className:"react-flow__controls-fitview",onClick:D,title:"fit view","aria-label":"fit view"},C.createElement(h_,null)),s&&C.createElement(Pn,{className:"react-flow__controls-interactive",onClick:R,title:"toggle interactivity","aria-label":"toggle interactivity"},v?C.createElement(p_,null):C.createElement(m_,null)),d)};Vf.displayName="Controls";var v_=g.memo(Vf),Ze;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ze||(Ze={}));function y_({color:e,dimensions:t,lineWidth:n}){return C.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function x_({color:e,radius:t}){return C.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const w_={[Ze.Dots]:"#91919a",[Ze.Lines]:"#eee",[Ze.Cross]:"#e2e2e2"},b_={[Ze.Dots]:1,[Ze.Lines]:1,[Ze.Cross]:6},E_=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Of({id:e,variant:t=Ze.Dots,gap:n=20,size:s,lineWidth:r=1,offset:i=2,color:o,style:a,className:l}){const c=g.useRef(null),{transform:d,patternId:u}=ge(E_,Ie),h=o||w_[t],f=s||b_[t],p=t===Ze.Dots,v=t===Ze.Cross,y=Array.isArray(n)?n:[n,n],b=[y[0]*d[2]||1,y[1]*d[2]||1],x=f*d[2],w=v?[x,x]:b,E=p?[x/i,x/i]:[w[0]/i,w[1]/i];return C.createElement("svg",{className:Oe(["react-flow__background",l]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:c,"data-testid":"rf__background"},C.createElement("pattern",{id:u+e,x:d[0]%b[0],y:d[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`},p?C.createElement(x_,{color:h,radius:x/i}):C.createElement(y_,{dimensions:w,color:h,lineWidth:r})),C.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${u+e})`}))}Of.displayName="Background";var S_=g.memo(Of);const __=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),T_=e=>{const t=[],n=[];t.push({id:"root",type:"custom",position:{x:0,y:0},data:{title:""}});const s=(r,i="root")=>{const o=r.id;t.push({id:o,type:"custom",position:{x:0,y:0},data:{title:r.name}}),i!=="root"?n.push({id:`e-${i}-${o}`,source:i,target:o,type:"smoothstep"}):n.push({id:`e-root-${o}`,source:"root",target:o,type:"smoothstep"}),r.children&&r.children.length>0&&r.children.forEach(c=>{s(c,o)});const a=r.pname?`${r.pname}/${r.name}`:r.name,l=e.agents.filter(c=>c.tags.some(d=>d===a));if(l.length>0){const c=__();t.push({id:c,type:"custom",position:{x:0,y:0},data:{title:"",agents:l.map(d=>({name:d.name,description:d.description}))}}),n.push({id:`e-${o}-${c}`,source:o,target:c,type:"smoothstep"})}};return e.tree_data.forEach(r=>{s(r)}),{nodes:t,edges:n}},C_=(e,t)=>!t.some(n=>n.source===e),N_=({data:e,selected:t})=>m.jsxs("div",{className:`px-4 py-3 shadow-md rounded-lg bg-white border-2 min-w-[220px] max-w-[280px] hover:shadow-lg transition-all duration-200 ${t?"border-blue-500 shadow-blue-100 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[m.jsx(hn,{type:"target",position:J.Top,className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{top:-6}}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-sm font-bold text-gray-800 truncate",children:e.title}),e.description&&m.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-1",children:e.description}),e.agents&&e.agents.length>0&&m.jsx("div",{className:"mt-3 space-y-2",children:e.agents.map((n,s)=>m.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0",children:m.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded-full"})}),m.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[m.jsx("div",{className:"text-sm font-semibold text-gray-800 truncate",children:n.name}),m.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:n.description})]})]})},s))})]}),m.jsx(hn,{type:"source",position:J.Bottom,className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{bottom:-6}})]}),A_=({id:e,sourceX:t,sourceY:n,targetX:s,targetY:r,sourcePosition:i,targetPosition:o,style:a={}})=>{const l=g.useMemo(()=>{const[c]=To({sourceX:t,sourceY:n,sourcePosition:i,targetX:s,targetY:r,targetPosition:o});return c},[t,n,s,r,i,o]);return m.jsx("path",{id:e,className:"react-flow__edge-path",d:l,stroke:"#b1b1b7",strokeWidth:2,fill:"none",style:a})},P_={custom:N_},j_={custom:A_},dc=(e,t,n="TB")=>{const s=new Bo.graphlib.Graph;s.setDefaultEdgeLabel(()=>({})),s.setGraph({rankdir:n});const r=280,i=120;return e.forEach(a=>{const c=a.data.agents&&a.data.agents.length>0?i+a.data.agents.length*80:i;s.setNode(a.id,{width:r,height:c})}),t.forEach(a=>{s.setEdge(a.source,a.target)}),Bo.layout(s),{nodes:e.map(a=>{const l=s.node(a.id),c=C_(a.id,t),u=a.data.agents&&a.data.agents.length>0?i+a.data.agents.length*80:i;return{...a,data:{...a.data,isLeaf:c},position:{x:l.x-r/2,y:l.y-u/2}}}),edges:t}},R_=({direction:e="TB",organizationData:t})=>{const[n,s]=g.useState([]),[r,i]=g.useState(!0),{nodes:o,edges:a}=g.useMemo(()=>t?T_(t):{nodes:[],edges:[]},[t]),{nodes:l,edges:c}=dc(o,a,e),[d,u,h]=c_(l),[f,p,v]=u_(c),y=g.useCallback(x=>p(w=>tf(x,w)),[p]),b=g.useCallback(({nodes:x})=>{s(x)},[]);return g.useEffect(()=>{if(t){const{nodes:x,edges:w}=dc(o,a,e);u(x),p(w),i(!1)}else i(!1)},[t,o,a,e,u,p]),r?m.jsx("div",{className:"w-full h-full flex items-center justify-center",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),m.jsx("p",{className:"text-gray-600",children:"..."})]})}):t?m.jsx("div",{className:"w-full h-full",style:{width:"100%",height:"100%",position:"relative"},children:m.jsxs(Lf,{nodes:d,edges:f,onNodesChange:h,onEdgesChange:v,onConnect:y,onSelectionChange:b,nodeTypes:P_,edgeTypes:j_,connectionLineType:dt.SmoothStep,selectionMode:fn.Partial,fitView:!0,minZoom:.3,maxZoom:2,defaultViewport:{x:0,y:0,zoom:.8},proOptions:{hideAttribution:!0},children:[m.jsx(v_,{}),m.jsx(S_,{variant:Ze.Dots,gap:30,size:1,color:"#e5e7eb"}),n.length>0&&m.jsxs(yo,{position:"bottom-left",className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 max-w-xs",children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-2",children:[" (",n.length,")"]}),m.jsx("div",{className:"space-y-1",children:n.map(x=>m.jsxs("div",{className:"text-xs text-gray-600",children:[" ",x.data.title]},x.id))})]})]})}):m.jsx("div",{className:"w-full h-full flex items-center justify-center",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-gray-400 mb-4",children:m.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),m.jsx("p",{className:"text-gray-600 mb-2",children:""}),m.jsx("p",{className:"text-sm text-gray-500",children:""})]})})},k_=({open:e,onOpenChange:t})=>{const[n,s]=g.useState("TB"),[r,i]=g.useState(null);return g.useEffect(()=>{e?(async()=>{var a,l;try{console.log("...");const c=await wt.post("/agent/organization");console.log(":",c.data),console.log(":",c.status),console.log(":",c.headers),c.data&&c.data.tree_data&&c.data.agents?(console.log(":",c.data),i(c.data)):(console.warn(":",c.data),console.warn("tree_data:",(a=c.data)==null?void 0:a.tree_data),console.warn("agents:",(l=c.data)==null?void 0:l.agents),i(null))}catch(c){console.error(":",c),c.response&&(console.error(":",c.response.status),console.error(":",c.response.data))}})():i(null)},[e]),m.jsx(ys,{open:e,onOpenChange:t,children:m.jsxs(xs,{className:"max-w-[95vw] h-[95vh] p-0",children:[m.jsxs(ws,{className:"sr-only",children:[m.jsx(bs,{children:""}),m.jsx(Ph,{children:""})]}),m.jsx(ko,{children:m.jsx(R_,{direction:n,organizationData:r})})]})})};function I_(){const e=new Date().getHours();return e>=5&&e<12?"":e>=12&&e<18?"":e>=18&&e<22?"":""}function M_(e){const t=I_();return e?`${e}${t}`:t}const Bf=({className:e,fixed:t,children:n,title:s,messageCount:r=0,...i})=>{C.useState(0),C.useState(0),C.useRef(null),jh();const o=s&&s.trim()!=="";return m.jsx("div",{children:o&&m.jsxs(jc,{children:[m.jsx(Rc,{asChild:!0,children:m.jsxs(me,{variant:"ghost",className:"font-normal text-muted-foreground hover:text-foreground px-2 max-w-[200px]",children:[m.jsx("span",{className:"truncate",children:s}),m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("path",{d:"m6 9 6 6 6-6"})})]})}),m.jsx(kc,{className:"w-36",children:m.jsxs(Mr,{children:[m.jsxs(Kt,{children:[m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-pencil-icon lucide-pencil",children:[m.jsx("path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}),m.jsx("path",{d:"m15 5 4 4"})]}),""]}),m.jsxs(Kt,{className:"text-red-500 hover:text-red-500",children:[m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-trash2-icon lucide-trash-2",children:[m.jsx("path",{d:"M3 6h18"}),m.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),m.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),m.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),m.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]}),""]})]})})]})})};Bf.displayName="ChatHeader";const $_=async e=>{const{data:t}=await wt.post("/chat/conversation/create",e);return t},L_=async e=>{const{data:t}=await wt.post(`/chat/conversation/detail/${e}`);return t},D_=e=>Rh({queryKey:["conversation-detail",e],queryFn:()=>L_(e),enabled:!!e,staleTime:5*60*1e3});function V_(e){const t=vo();return m.jsxs("div",{ref:t.scrollRef,style:{width:"100%",height:"100%"},className:e.className,children:[m.jsx("div",{ref:t.contentRef,className:e.contentClassName,children:e.content}),e.footer]})}function O_(e){const{isAtBottom:t,scrollToBottom:n}=vo();return t?null:m.jsxs(me,{variant:"outline",className:e.className,onClick:()=>n(),children:[m.jsx(tm,{className:"h-4 w-4"}),m.jsx("span",{children:"Scroll to bottom"})]})}function B_(){const[e,t]=tS(),[n,s]=eS(),{toast:r}=Pc(),{user:i}=kh(),o=Ih(W=>W.auth.accessToken),[a,l]=on("threadId"),[c,d]=on("hideToolCalls",Tc.withDefault(!1)),[u,h]=g.useState(""),{contentBlocks:f,setContentBlocks:p,handleFileUpload:v,dropRef:y,removeBlock:b,resetBlocks:x,dragOver:w,handlePaste:E}=pS(),[_,j]=g.useState(!1),[D,R]=g.useState([]),[P,M]=g.useState(null),[L,$]=g.useState(!1),[U,T]=g.useState(null),[N,B]=g.useState(null),[I,F]=g.useState(!1),[S,O]=g.useState(!1),[z,k]=g.useState(!1),[H,V]=g.useState(!1),A=Os(),G=A.messages,K=A.isLoading,{data:Y,isLoading:Q}=D_(a),X=g.useRef(void 0),ae=g.useRef(null),de=g.useRef(null),he=W=>{l(W),s(),t({});{T(null),B(null);const ee=D.find(le=>le.is_default);ee?M(ee):D.length>0&&M(D[0])}};g.useEffect(()=>{if(!A.error){X.current=void 0;return}try{const W=A.error.message;if(!W||X.current===W)return;X.current=W,r({variant:"destructive",title:"An error occurred. Please try again.",description:`Error: ${W}`})}catch{}},[A.error]);const ce=g.useRef(0);g.useEffect(()=>{G.length!==ce.current&&(G!=null&&G.length)&&G[G.length-1].type==="ai"&&j(!0),ce.current=G.length},[G]);const ie=async()=>{try{$(!0);const W={page:1,rows:100},ee=await Oo.getModels(W);if(R(ee.items),!P&&ee.items.length>0){const le=ee.items.find(Ee=>Ee.is_default);M(le||ee.items[0])}}catch{r({title:"",description:"",variant:"destructive"})}finally{$(!1)}};g.useEffect(()=>{ie()},[]),g.useEffect(()=>{if(a&&Y&&!Q&&(Y.agent?T({id:Y.agent.id,uuid:Y.agent.uuid,name:Y.agent.name,description:Y.agent.description,prompt_template:Y.agent.prompt_template,avatar:Y.agent.avatar,created_at:Y.agent.created_at||"",updated_at:Y.agent.updated_at||""}):T(null),Y.llm_uuid&&D.length>0)){const W=D.find(ee=>ee.uuid===Y.llm_uuid);W?M(W):Oo.getModel(Y.llm_uuid).then(ee=>{M(ee.llm_info)}).catch(ee=>{console.warn(":",ee)})}},[Y,Q,D]),g.useEffect(()=>{if(!a&&D.length>0){T(null),B(null);const W=D.find(ee=>ee.is_default);W?M(W):D.length>0&&M(D[0])}},[a,D]),g.useEffect(()=>{if(console.log("Thread threadId:",{threadId:a,pendingMessage:ae.current,pendingData:de.current}),a&&de.current){const W=de.current,ee=ae.current;console.log(" LangGraph  threadId :",a),$_({uuid:a,...W}).then(le=>{console.log(":",le),ee&&setTimeout(()=>{Mh(a,ee)},0)}).catch(le=>{console.error(":",le),r({variant:"destructive",title:"",description:le instanceof Error?le.message:""})}).finally(()=>{de.current=null,ae.current=null})}},[a]);const ve=()=>{const W=G.find(ee=>ee.type==="human");if(W){const ee=$i(W.content);if(ee){const le=ee.trim();return le.length>30?le.substring(0,30)+"...":le}}return""},re=()=>{F(!0)},Z=()=>{F(!1)},we=()=>{O(!0)},Ne=()=>{O(!1)},ut=()=>{k(!0)},st=()=>{k(!1)},be=()=>{V(!0)},_e=()=>{V(!1)},rt=W=>{M(W)},qe=async W=>{try{await Wh(W.uuid),T(W)}catch(ee){console.error("",ee)}Z()},Ve=W=>{B(W),h(W.prompts),Ne()},it=()=>P?P.display_name||P.name:L?"...":"",ze=async W=>{if(W.preventDefault(),u.trim().length===0&&f.length===0||K)return;j(!1);const ee={id:$c(),type:"human",content:[...u.trim().length>0?[{type:"text",text:u}]:[],...f]},le=!a,Ee=u.trim();if(le&&Ee){console.log(":",Ee);const se=Ee.length>30?Ee.substring(0,30)+"...":Ee;de.current={title:se,agent_uuid:(U==null?void 0:U.uuid)||null,llm_uuid:P==null?void 0:P.uuid,prompt_uuid:(N==null?void 0:N.uuid)||null},ae.current=Ee}const $e=lS(A.messages),Ge=Object.keys(e).length>0?e:void 0,Le=P?{uuid:P.uuid,name:P.name,provider_name:P.provider_name,display_name:P.display_name}:void 0,ot=U?{uuid:U.uuid,name:U.name,prompt_template:U.prompt_template}:void 0,te={messages:[...$e,ee],context:Ge},oe={...Le&&{model_config:Le},...ot&&{agent_config:ot},...N&&{system_prompt:{prompt:N.prompts,uuid:N.uuid}},...o&&{authorization:o}};A.submit(te,{streamMode:["values"],streamSubgraphs:!0,streamResumable:!0,config:{configurable:oe},optimisticValues:se=>({...se,context:Ge,messages:[...se.messages??[],...$e,ee]})}),h(""),p([])},Me=W=>{ce.current=ce.current-1,j(!1),A.submit(void 0,{checkpoint:W,streamMode:["values"],streamSubgraphs:!0,streamResumable:!0})},ue=!!a||!!G.length,Te=!G.find(W=>W.type==="ai"||W.type==="tool");return m.jsxs("div",{className:"flex h-screen w-full overflow-hidden",children:[m.jsxs("div",{className:je("grid w-full grid-cols-[1fr_0fr] transition-all duration-500",n&&"grid-cols-[3fr_2fr]"),children:[m.jsxs("div",{className:je("relative flex min-w-0 flex-1 flex-col overflow-hidden",!ue&&"grid-rows-[1fr]"),children:[!ue&&m.jsx("div",{className:"absolute top-0 left-0 z-10 flex w-full items-center justify-between gap-3 p-2 pl-4",children:m.jsx("div",{})}),ue&&m.jsx("div",{className:"sticky top-0 z-10 bg-background w-full",children:m.jsx(em,{className:"w-full",fixed:!0,children:m.jsxs("div",{className:"flex items-center justify-between w-full",children:[m.jsx("div",{className:"flex items-center gap-2",children:m.jsx(Bf,{title:ve(),messageCount:G.length})}),m.jsx("div",{className:"flex items-center gap-4",children:m.jsx(gc,{children:m.jsxs(vc,{children:[m.jsx(yc,{asChild:!0,children:m.jsx(me,{size:"lg",className:"p-4",variant:"ghost",onClick:()=>he(null),children:m.jsx(Ic,{className:"size-5"})})}),m.jsx(xc,{side:"left",children:m.jsx("p",{children:"New thread"})})]})})})]})})}),m.jsx(ai,{className:"relative flex-1 overflow-hidden",children:m.jsx(V_,{className:je("absolute inset-0 overflow-y-scroll px-4 [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-track]:bg-transparent",!ue&&"mt-[25vh] flex flex-col items-stretch",ue&&"grid grid-rows-[1fr_auto]"),contentClassName:je("pt-20 pb-16 mx-auto flex flex-col gap-4 w-full",ue?"max-w-3xl":"max-w-2xl"),content:m.jsxs(m.Fragment,{children:[G.filter(W=>{var ee;return!((ee=W.id)!=null&&ee.startsWith(Ud))}).map((W,ee)=>W.type==="human"?m.jsx(aS,{message:W,isLoading:K},W.id||`${W.type}-${ee}`):m.jsx(Bl,{message:W,isLoading:K,handleRegenerate:Me},W.id||`${W.type}-${ee}`)),Te&&!!A.interrupt&&m.jsx(Bl,{message:void 0,isLoading:K,handleRegenerate:Me},"interrupt-msg"),K&&!_&&m.jsx(rS,{})]}),footer:m.jsxs("div",{className:"sticky bottom-0 flex flex-col items-center gap-8 bg-background/95 backdrop-blur-sm z-20",children:[!ue&&m.jsx("div",{className:"flex items-center gap-3",children:m.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:M_((i==null?void 0:i.first_name)||(i==null?void 0:i.username)||"")})}),m.jsx(O_,{className:"animate-in fade-in-0 zoom-in-95 absolute bottom-full left-1/2 mb-4 -translate-x-1/2 z-30"}),m.jsx("div",{ref:y,className:je("bg-background relative z-20 mx-auto mb-8 w-full rounded-2xl shadow-xs transition-all",ue?"max-w-3xl":"max-w-2xl",w?"border-primary border-2 border-dotted":"border border-solid"),children:m.jsxs("form",{onSubmit:ze,className:je("mx-auto grid grid-rows-[1fr_auto] gap-2",ue?"max-w-3xl":"max-w-2xl"),children:[m.jsx(gS,{blocks:f,onRemove:b}),m.jsx("textarea",{value:u,onChange:W=>h(W.target.value),onPaste:E,onKeyDown:W=>{if(W.key==="Enter"&&!W.shiftKey&&!W.metaKey&&!W.nativeEvent.isComposing){W.preventDefault();const ee=W.target,le=ee==null?void 0:ee.closest("form");le==null||le.requestSubmit()}},placeholder:"",className:"field-sizing-content resize-none border-none bg-transparent p-3.5 pb-0 shadow-none ring-0 outline-none focus:ring-0 focus:outline-none"}),m.jsxs("div",{className:"flex items-center gap-6 p-2 pt-4 bg-transparent",children:[m.jsx(Do,{htmlFor:"file-input",className:"w-8 h-8 rounded-lg border border flex items-center justify-center hover:bg-muted cursor-pointer",children:m.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("path",{d:"M10 4V16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),m.jsx("path",{d:"M4 10L16 10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),m.jsx("input",{id:"file-input",type:"file",onChange:v,multiple:!0,accept:"image/jpeg,image/png,image/gif,image/webp,application/pdf",className:"hidden"}),m.jsx("div",{children:m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Lr,{id:"render-tool-calls",checked:c??!1,onCheckedChange:d}),m.jsx(Do,{htmlFor:"render-tool-calls",className:"text-sm text-gray-600",children:"Hide Tool Calls"})]})}),A.isLoading?m.jsx(me,{onClick:()=>A.stop(),className:"ml-auto w-8 h-8 bg-primary p-0",children:m.jsx("div",{className:"relative h-4 w-4",children:m.jsx($h,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 h-2 w-2 fill-current"})})},"stop"):m.jsx(me,{type:"submit",className:"ml-auto w-8 h-8 bg-primary p-0",disabled:K||!u.trim()&&f.length===0,children:m.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("path",{d:"M22 2L11 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),m.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),m.jsx("div",{className:"border-t border-[0.1px] border-border bg-transparent px-4 flex items-center justify-between",children:m.jsxs("div",{className:"flex items-center space-x-4",children:[m.jsxs(jc,{children:[m.jsx(Rc,{asChild:!0,children:m.jsxs(me,{variant:"ghost",className:"text-xs justify-between px-0 gap-0",children:[it(),m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("path",{d:"m6 9 6 6 6-6"})})]})}),m.jsxs(kc,{className:"w-56 p-0",children:[m.jsx(Mr,{children:L?m.jsx(Kt,{disabled:!0,children:"..."}):D.length===0?m.jsx(Kt,{disabled:!0,children:""}):D.map(W=>m.jsx(Kt,{onClick:()=>rt(W),children:W.display_name||W.name},W.uuid))}),m.jsx(Lh,{}),m.jsx(Mr,{children:m.jsx(Kt,{onClick:ut,children:""})})]})]}),m.jsx("div",{className:"flex items-center space-x-2",children:m.jsxs(me,{type:"button",variant:"ghost",className:`text-xs justify-between px-0 gap-0 ${G.length>0?"opacity-50 cursor-not-allowed":""}`,onClick:G.length>0?void 0:re,disabled:G.length>0,children:[U?U.name:"",m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("path",{d:"m6 9 6 6 6-6"})})]})}),!a&&m.jsx("div",{className:"flex items-center space-x-2",children:m.jsxs(me,{type:"button",variant:"ghost",className:"text-xs justify-between px-0 gap-0",onClick:we,children:["",m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:m.jsx("path",{d:"m6 9 6 6 6-6"})})]})})]})})]})})]})})})]}),m.jsx("div",{className:"relative flex flex-col border-l",children:m.jsxs("div",{className:"absolute inset-0 flex min-w-[30vw] flex-col",children:[m.jsxs("div",{className:"grid grid-cols-[1fr_auto] border-b p-4",children:[m.jsx(JE,{className:"truncate overflow-hidden"}),m.jsx("button",{onClick:s,className:"cursor-pointer",children:m.jsx(bt,{className:"size-5"})})]}),m.jsx(ZE,{className:"relative flex-grow"})]})})]}),m.jsx(ys,{open:I,onOpenChange:Z,children:m.jsxs(xs,{className:"max-w-4xl max-h-[80vh] p-0",children:[m.jsx(ws,{className:"p-6 pb-0",children:m.jsxs(bs,{className:"flex items-center gap-2",children:["",m.jsx("span",{className:"text-muted-foreground cursor-pointer hover:text-primary transition-colors",onClick:be,title:"",children:""})]})}),m.jsx("div",{className:"px-6 pb-6 h-[60vh] overflow-y-auto",children:m.jsx(vS,{onSelectAgent:qe,selectedAgent:U})})]})}),m.jsx(ys,{open:S,onOpenChange:Ne,children:m.jsxs(xs,{className:"max-w-4xl max-h-[80vh] p-0",children:[m.jsx(ws,{className:"p-6 pb-0",children:m.jsx(bs,{children:""})}),m.jsx("div",{className:"px-6 pb-6 h-[60vh] overflow-y-auto",children:m.jsx(bS,{onSelectPrompt:Ve,selectedPrompt:N})})]})}),m.jsx(zh,{open:z,onOpenChange:st}),m.jsx(k_,{open:H,onOpenChange:_e})]})}function F_(){return m.jsxs(C.Suspense,{fallback:m.jsx("div",{children:"Loading (layout)..."}),children:[m.jsx(ay,{}),m.jsx(dy,{children:m.jsx(vy,{children:m.jsx(QE,{children:m.jsx(B_,{})})})})]})}const mT=Dh("/_authenticated/chat/")({component:F_});export{mT as Route};
